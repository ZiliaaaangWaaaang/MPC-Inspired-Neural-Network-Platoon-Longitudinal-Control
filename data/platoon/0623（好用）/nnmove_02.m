function [Y,Xf,Af] = nnmove_02(X,~,~)
%NNMOVE_02 neural network simulation function.
%
% Auto-generated by MATLAB, 07-May-2024 19:03:51.
% 
% [Y] = nnmove_02(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 3xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-7.24533041879789;-3.48140040292665;-1.96096032723111];
x1_step1.gain = [0.208245194035687;0.301846502519312;0.536437681142334];
x1_step1.ymin = -1;

% Layer 1
b1 = [-4.0133306497241783006;-3.384039658848572163;3.8179014959390022987;-2.4486558941215985641;2.8231741853082450433;-1.6104383109461921642;-1.4000392020691789785;-1.0364706070033882224;0.11808073261347755423;-0.21723230245095098701;0.63114485858793722972;0.89555002942119299458;-0.37841108596069678027;-0.89592317562178103163;2.0589265972170696095;2.1179211822931911513;-2.4919352394814957563;-2.9701624728203457337;2.5068418754577654894;-3.9225027090962472087];
IW1_1 = [0.10612996412632590137 2.5999973086646646081 -2.4419459407029306952;0.91313014911575496324 -2.9499897337340148518 -2.2405856434119915122;0.55872206777596433724 -2.1603662816970561344 -1.4022262111966838916;1.3564147267530863861 -1.7640052496944718108 3.1515332048624089545;-2.3032581043234814366 1.2076710447589478203 -2.2283458140563432437;3.2507873975969689972 0.59741561329840742189 1.8157415831146861418;1.0270007419477344968 1.8061928569591181315 -3.1210018335843785486;2.8132775489399692859 0.48720838527265614148 2.5456047847617431223;-1.9895173867117599276 3.4804717882441562615 0.98539457821197329324;3.3967607407140438802 -0.66709058696352530049 1.5030604114494616752;2.6197364851502062955 2.1571728930463978102 1.8089474777328036215;3.4053034960411170395 -1.5691634882223148839 -1.1477519325723057886;-1.9533624348528551007 0.061895644177119756024 3.4130064091545486704;-1.9982134170194940648 -1.8121537993693530577 3.4344111903732246205;2.18070141435095044 0.87492065256048434652 2.7877811941666759132;0.42475433886129609906 -1.531119670217088613 3.4582423499805825529;-2.4915494616879638734 -2.3833064650304831567 -1.812704787223087699;-2.2924062525907196175 1.799001028817792891 2.45609313673195917;0.45130195313855547834 3.6060065779216703419 -3.8864659240918326688;-1.1115275048252171164 -2.7548353628391044623 -2.2326713973541290059];

% Layer 2
b2 = [1.5495366273301203197;1.1132687622419665807;0.98662240254461797129;0.40644131046471626556;-0.14239254351874003346;0.064262025615688389557;-0.45104646681645366169;-0.74593063987536856185;-1.3804947359332704337;-1.6887280275919571704];
LW2_1 = [-0.84381559217413371066 0.27832176368392907984 -0.21928621622651994771 0.24238829500934386263 -0.75213584133263400311 0.24561479166599908819 -0.19176187398165336906 0.62470843327853353699 0.64956301406391137032 -0.065513354712574023431 -0.79841685911823645494 -0.51887534909177646103 -0.30741704454681717529 -0.53687659768836104579 -0.33489607312651770155 0.61949419639329406095 -0.66359949508644766603 -0.20940611759370628131 -0.42566318902999444873 0.30416235146998171768;-0.43540445221680895704 -0.37763783451136084812 -0.56269247558593926684 0.64706242018795745441 -0.28835050591737271253 -0.24089437278933004127 -0.015399413617669114457 0.44410257757509585819 0.048081692827543216773 0.32105475351974810394 0.5490169497378307728 0.37763210494950727458 -0.28627295907507283035 0.14726353647866727292 0.13951657263152025812 0.52933929957681224998 -0.31531292248057957162 -0.43286763308340270306 -0.056092269469675867799 -0.36029600877504180945;-0.050100275295523986896 -0.32579631861758151512 0.17141413736306201909 -0.33594199745939667956 -0.29539713584306520611 0.097247323373043287331 -0.38542754807954071605 0.27367324117908958803 0.84044062737480507153 0.018605260583068407992 -0.51920853481304751753 -0.64672672074381110097 0.67878846766461975459 0.4912130089351235962 -0.10669736333489772406 -0.37134690499886774395 0.21203533417284900486 -0.18043147146840482486 0.15074794167150187829 0.51729797015804623861;-0.52555805469172733879 -0.29342667390658139226 0.13387867729386074278 0.70222476465882510688 -0.016109871329312078908 0.63895783177929865726 -0.7751104597675468888 -0.16093680280744654398 -0.097110713547955682112 0.090844623204596325339 -0.35499024042299975878 -0.074309224314064906136 0.33352942322975681622 0.023149180945287398808 0.1167793065448667067 0.6869979605924889654 -0.21448739564632479659 0.24494094675591515653 -0.41302278887401455698 -0.64803114828616759091;0.32949047865659275569 -0.43530022861415340607 0.22112192429342614197 0.022926473978807138804 0.34304628613644483348 -0.4579795716108204795 0.37219380226335946338 -0.026255003959670224212 1.6069552529348585246 -0.070411220294422427468 0.023762838440800307382 0.2465742520628594614 0.30304445737604701616 -1.6249521129119408602 -0.14419038136106973602 0.27003518623463151904 -0.59184628330203759017 0.22498175502142836457 2.7048850706344333972 -0.62058963025037983119;-0.3313591431407242327 -0.067536567098075053761 0.72815987228874667903 0.40142846489986672154 -0.64076549903360691118 0.62767970617117074816 -0.51968148554436222053 0.16507433195008741622 0.6469535801513093265 0.14457852715124755449 0.47141017855760419808 0.72336886136517042356 0.13660524631158035835 0.68519373020221152615 0.52256007834745366036 0.048766577929623876331 0.075589213003683722314 -0.35947039134490932355 -0.35172200765378996978 0.12433953292108169963;-0.47843104398240843267 0.10318117777022671466 -0.28768795764742016718 0.53355585553505768814 -1.08317286369809751 0.23383309505009969298 -0.29238848770317621417 0.24756057556495780769 -0.61874892116444257795 0.0039465127190431974896 0.57363049088918383056 -0.071595448909860734399 0.73908502582105040091 -0.087748392390571375299 0.69132609931382815738 0.49230299402717436763 -0.064701096682958009199 -0.015925310987694986375 0.34323960675742987148 -0.47793567776814049886;-0.44701541025271723795 -0.65870009727684863954 -0.30116240903112179161 0.27966546958180832361 -0.43083325629472263296 -0.3634813359593214166 -0.82206522184698904709 0.14242873437928457725 0.65721160124002786507 0.045541777078202658191 -0.12832928160578188637 -0.70959016172636812936 -0.13387047931347442753 -0.67763808111251211397 -0.25422543961970089921 0.15948963205226623918 -0.11207234724241924018 -0.5993064147834998856 -0.07865543249139247961 -0.57706133601969544777;-0.32489518083138024807 0.12967830382242537257 0.29399745343291205923 -0.17337446530865394112 0.43056353489309256988 0.1211341907264164991 0.55810940402009245886 -0.45285164925796234092 -0.50340946893917348781 0.0061860190512031580992 0.25484099910496704755 -0.2067005204284029507 -0.036744446994075759261 -0.11311438733330798911 0.43889278409827409133 -0.15671322022727621204 -0.24754238325169122814 -0.24745432947864459683 -0.31751711224364104202 0.54252072779137650027;-0.022846458820568543713 0.1955478325157531394 0.19600750792548449208 -0.22138226448736128549 0.44405869293210786797 -0.25828889877577460021 0.36795803627393131041 0.54044471374220326432 0.18174200488134839571 -0.52833416381598963252 -0.087405332588035997143 -0.13311117679462905472 -0.21394376643318732678 -0.11669991837185404726 0.44467399536074303512 0.10885914294593482254 0.32683291951904375194 0.66125516804250705771 -0.45714069909777660383 0.5882698963590157204];

% Layer 3
b3 = [-1.7085873140923113489;1.7478533862580611924;-1.1630500080331904744;-1.3895300601272431162;1.1116693049898056511;0.67457431806815137953;-0.81657722425677781164;-0.52985604057739410511;-0.2117210858925309136;0.3178093527118998618;-0.092479855119895634785;-0.44767599182492362475;0.41471817884881734262;-0.67071790648177564975;0.87880913872772925544;1.0750786397076010914;-1.3505066677961117261;1.2973443565785440779;-1.3470862476300500266;-1.7867437844285896098];
LW3_2 = [0.33878374624031842854 0.88179297019808200453 0.19230180798323678881 -0.87532221726456360678 0.35903867862639293751 -1.0692421089648238564 0.48204767064302450619 0.41284811667359272436 0.50283439196541179772 0.65597826055586239136;-0.49534043884131845337 -0.54354729316105709902 0.55422416732007595552 0.91422471493339441118 0.54745131585173212319 -0.38788174654009649478 0.1747684051421110607 -0.59209349649856390929 -0.82977086572252956032 -0.51072094664071365777;1.0215692959815017016 0.70779044613787300833 0.62606283582168387181 -0.2558553285110161668 1.0056627619201523594 -0.26471369132008698566 -0.59500541838960108176 0.14934295112199613698 -0.60710526446149926105 -1.1469799444206196792;0.89880686503908169271 0.32908872305442693484 0.25303897381844797643 -0.23032803583181168938 -0.6848946419136952013 -0.81644245728148212571 -0.23056308761123692208 0.12412003774335386708 1.1067383129737238256 0.17950404561071972576;-0.42646863738027196433 0.6492243796799430644 -0.72841851882221431147 -0.45544831833271809396 0.80194988155136592844 0.22903667822321965852 0.81550930998895898583 0.84169670589662048954 -0.022859126541786449482 -0.41777913219699902569;-0.92381128339534246408 -0.13088039616386487607 0.86572511936081109063 -0.85800562495669641105 0.9989486670636283927 0.94821621351782070519 -0.96699934634449002946 0.17021154362983342834 -0.11455329056484903072 -0.47336931408622195949;0.39369883739736838413 -0.63669128979518274658 0.54326539494429004762 0.3050964272239108932 -0.32711544854873242372 -0.76803461381777105021 -0.85569406152846783087 -0.56743139186323832135 -0.98095492908504289264 -0.24850203066568860022;0.31005573781379403009 -0.76243477722515462514 -0.24314364733082813319 -0.86002019239428595387 -0.77100266092887415059 -0.53196257055074547271 -0.56006572096946860562 -0.45728035690873197749 0.61178902483050823236 -0.23388361771657692478;1.0503363578589703931 -0.21411665184869316247 0.19180844657156687072 0.56463647056472909824 0.96826585124444719543 -0.88982889754038418939 -0.8052362416004561485 0.59860057210860717625 0.42379636287127608885 0.65158620071816897301;-0.71488647547566985807 0.77430723120931910231 -0.14351810808467777014 1.3882532302380710121 0.6894360089961415472 -0.24144779697569684895 0.16784388780294084986 -0.49883393814416882028 0.54231116516795241367 -0.45861441073018410775;-0.61336891751554423191 -0.59861864803606168461 0.67970351971704345839 -0.5061536647125802757 0.48095693979558984399 0.77037576851668188027 0.4209471299914811504 -0.39043025287959026715 0.67051692196770507071 0.6894105001381439779;-0.557599973263322779 0.57172570878786532766 -1.0692962659470632847 -0.60339811865037362715 0.43525767523590541686 0.23378272439419833795 0.21783872939228665633 -0.20089290433914422374 -0.32869111848022142253 1.0820921636378735275;0.3667315824030376592 -0.87534771268274025324 0.45314913664159750528 0.43317660399358692835 -0.31261868422117877753 0.50965930892912636452 0.75499798623201908043 0.26003457067690416427 0.48030213639484820032 1.0862156240537270691;-0.13512863184936074745 0.91498821059953816537 0.90695751879271979679 -0.4757246191832122939 0.61346189979460796771 -0.090269134853472862701 -0.98172346418221134723 -0.24652175382472812926 -0.6670934879518454208 -0.65729410570012225534;0.79016937879584137061 0.30237487791070655208 0.85217658399502493882 -0.35898470773488633245 0.27526775116253787701 -0.52418370643310352452 -0.62699014815662279521 0.52430327577954582985 -0.99183260820332674879 -0.042916035283981482373;0.69419654199802738326 -0.0080706350430545820834 0.054283051811582772039 0.91962520971451822138 0.91348422144092589203 -0.71834530715269750978 -0.14535956144024680947 0.68648696781905993447 -0.57578467101818020524 0.19898768236510525065;-1.0629369594154955969 -0.12088168102969219786 -0.62647006445023001309 0.072301060209944853496 0.46787015866291314925 -0.36924066861997767441 -0.85000268045143367868 -0.013786601990807612061 0.69396727423173998339 -0.84403994993467157393;0.40557400382373393066 -0.58801207328255244988 -0.33357532196166672644 0.12300269702803212635 -1.0067679517775134368 -0.69943914848885235802 -0.098278127257912933912 0.13223757578485864639 1.3833870113970947457 -0.44888551418228966883;0.14907981891328617174 0.67536385540932275529 0.23025312929872360224 -0.21881811664424349884 -0.86979027693323662795 0.83290521869898459517 0.46264380116079578675 1.0315693771905283249 -1.1952188836250530191 -0.79860682303906427304;-0.57901935201840881717 0.66945404203752290062 -0.52105914285957410925 -0.85274512940373825565 -0.47187353594267006374 -0.10263930467112171441 -0.058600105426785883966 0.77513011004061904696 0.5414855555577224866 -0.88047498823200331941];

% Layer 4
b4 = -1.1653597526058632194;
LW4_3 = [-0.62795706188408162429 -1.2693364667437572191 0.33764402077337923869 0.69836640299438446089 0.50117396683501203025 0.90886666703744667384 -0.39316945904226680009 0.44626651032956909937 -0.9855586860902705304 0.6086278396967677029 -0.21260358279479502075 0.54614660304077689013 -0.38268198901206113005 0.87182122489810953692 0.050266085103668305123 0.49204009834685979996 -0.38152211338923358586 -1.0441878003538151987 -0.7778627281192149745 -0.27744074826161102543];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.499999999999988;
y1_step1.xoffset = -2.00000000000009;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = tansig_apply(repmat(b3,1,Q) + LW3_2*a2);
    
    % Layer 4
    a4 = repmat(b4,1,Q) + LW4_3*a3;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a4,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(4,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
