function [Y,Xf,Af] = nnmove_03(X,~,~)
%NNMOVE_03 neural network simulation function.
%
% Auto-generated by MATLAB, 07-May-2024 19:03:52.
% 
% [Y] = nnmove_03(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 3xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-7.24533041879789;-3.48140040292665;-1.96096032723111];
x1_step1.gain = [0.208245194035687;0.301846502519312;0.536437681142334];
x1_step1.ymin = -1;

% Layer 1
b1 = [3.9029001912780287853;-3.6713940944298220082;-2.9782863745604974959;-2.4679100152593784756;2.252967186585682402;1.5654218384053963931;-1.31042631343442606;-0.81614256039689614397;0.63836254226293764891;0.089295488633627628783;-0.2711629038721109497;0.52940756275904965467;-1.178287017178006657;-1.1345764952883692356;1.8536492710904035608;-2.2512820509033182326;2.6419388420074776391;-3.1277360615351135209;3.7894827386393616919;-3.7876017801730688106];
IW1_1 = [-0.033038169334699468704 -2.7060408168656979733 2.4575650709330818522;1.2867487060877873528 2.7019625150425170546 2.158476514373524946;0.68101259443740869148 3.6033450378857727614 1.5092192029826994037;1.0811874892331103659 1.8942333169098564127 -3.217623128357967488;-2.5639857144604398798 2.4524312189565398157 1.2791469374263095826;-2.2319479110451396764 0.057618887086539241627 3.2506639892358815125;3.6645001127664920126 -0.74932893378343312651 0.84271717126902667694;3.4432828574431519897 -0.67604188559423905591 1.6449807952919246468;-2.669121053618115802 2.6031019470996477061 -0.74303440719887492438;-2.7214945622896800081 2.5227713487331242526 0.82332960177562242166;-1.1926814889744241643 2.7759848169079197611 -2.1814287047201221803;2.2132926584190344421 -1.960186915899304827 2.373598428545699246;-2.0228814176292462257 -0.044850886887844221285 3.2588357072090832212;-3.957101121547906164 -0.23664816490582843422 -0.7645656214160737596;1.9796450809798866732 -3.128791615483322186 -1.0229535917900201003;-2.973204855338297925 -2.1405953736554939049 -0.76193808864973788797;1.9626382646479785254 -2.2173521238745497186 -2.3614046749611246057;-1.4512525158997913177 -2.3372835702502245958 -2.4783947298725745867;0.42622882128034966787 -3.1299411042223916901 1.1790495796841391485;-2.2893059266559530052 0.21525501323431694978 3.0315689511544832158];

% Layer 2
b2 = [-1.5001532601515827903;1.2911576657337324736;0.84485492495346981023;-0.52873456438580002104;-0.29954724303042662426;-0.25825171350594644526;0.58402866515355444932;-0.68667871011934877856;-0.9496337700955812533;1.6310319675551130381];
LW2_1 = [0.29905535870557103939 0.36287623152826659068 0.36614434979833887507 0.37074811265603718757 0.071058013390383228947 0.59596935335333567352 -0.35606800009768513338 0.67149099352475372093 -0.47448460742014109126 -0.47118433952259469732 -0.17716499980823738336 -0.01509150830420890807 -0.091708481975012814957 -0.20538431252215499923 0.60832644666942481404 0.22378126113780461015 0.36929576331765673336 0.30718258032061884766 -0.3050833051807262386 0.039151367216980259567;-0.48449280718713327865 0.22654219263114969141 -0.066972288109510780263 -0.56457294621847786686 0.30655857018542137515 0.1440396376294048042 0.21492482385546843315 0.49947692969806750662 -0.24755044737991732662 -0.23434919682515170658 0.060271491741268334863 -0.44131442077539828617 -0.60968135892266073217 -0.35886398948924008723 -0.15372082542765919122 -0.33339586088438039058 0.4529542875288723458 0.13484608747540685614 0.29870772896873060143 -0.34262983667223667616;-0.4809341725313571736 -0.23688550984529499477 0.9410278301672510004 -0.09520501829639134439 0.58077154148261900257 -0.15520989926602499209 -0.080351083769502534837 -0.62685885337681046536 -0.27893938255827283035 -0.2136570358199667008 -0.29543852946334031584 -0.48714959616040642842 -1.0044663942457141559 0.15397538397513416131 -0.0523468396861571858 0.011651726626259418726 0.26949172269884247299 0.12108029123919110404 -0.46121577601857349782 -0.38579583555844892961;0.44079029225814675419 -0.012969336502795135099 0.10515799700255540339 -0.18721802186627709008 0.056568856219780590255 -0.17243309449666172073 -0.033462906490493216083 0.46443620038038241349 0.54065815091498736766 -0.02554589752889969631 -0.063222456979467100968 -0.21205843085729608744 0.5751447849501344356 0.20461771907152839778 0.45739563466307064932 -0.64127189328687850267 -0.15110500548496416662 0.44139508822850603842 0.22951394744528863523 -0.39103392969171457683;0.11702321376511154449 0.058130595736644828653 0.44637136602731342094 -0.041427350557563004385 0.1328992739678709345 -0.21430763067717806258 0.49858602560274800641 0.44428974647551117139 0.40329481431103947342 -0.1374781286118298973 -0.48309701680556538239 0.3515986880179653995 -0.45091970505450579276 -0.083498359853886053306 0.24980059064313467343 -0.17996969670237278338 -0.61307520092608835949 0.3471742816065156445 -0.54607244638851171192 -0.38677192613180444436;-0.16932231532878042057 -0.90640614493773297156 -0.73852325616817993126 0.20289144612826073844 -0.0030053863476639502278 0.023224068394787487912 0.76490461743304571929 -0.056379261658094238785 -0.42748584241909437509 0.23291845484389231413 -0.20391726144789507069 0.47440951455831337213 -0.46058706132959981172 1.1137327584527549895 0.38927150115463104996 -0.20715206990164089507 -0.54456028514897969472 -0.31530762996029271239 0.50858781369189320909 0.35901461033001513812;0.51049979821177027262 -0.18791007693464681361 -0.072248462976017349679 -0.36453092713680368409 -0.12981587574843261867 0.072228035608974477944 -0.35374905222869273969 -0.59646809521532495602 0.43728455199097204797 0.079649888399740451095 0.41545317662430436556 -0.046225377901924422086 0.18787720247483163938 -0.55860617110088095494 -0.039369136051913555807 -0.18129705227672029966 0.3928433589018169303 -0.33563055422922610793 0.62551114816260122709 -0.50227258270722130451;-0.18918916109184863439 0.38251204965073087871 -0.35468009408007961092 0.42346482493690568161 0.26208865791955632263 0.42897202633584891052 -0.41507924181814892517 -0.43402027450163788158 0.35412259145275370997 0.031565968226443565092 0.35346538392498744185 0.2157614106408046184 0.26585702596967730749 -0.011992673339324315743 0.46424799104172409514 -0.41707830432851311642 0.24030333311257026652 -0.22969523264505092852 -0.21658145890661267829 -0.81236724752607425426;-0.58963851585279636325 0.034398409301499469071 -0.43308839104925206387 1.0335684355309349147 0.48681719863141770244 -0.7928721251383799018 -0.085988687464837898489 -0.048611577350224033367 0.16134010037602075638 -0.2212591642567723893 0.64119027227903646615 -0.63358564556453966787 -0.35390118372156087467 0.47198370695235308814 -0.33373478831471664607 -0.04464694700777181724 0.77458976804237666958 -0.59975327282263279915 0.07427044797981507962 -0.41326930904594166849;0.40017203988310395824 0.12091913293649224348 -0.028214981551927330317 0.47417260640288028117 0.045509346171538615777 0.41752917364248859355 -0.36709721053674509994 0.52285068726725825172 0.51368192015425617747 -0.73729180362668378379 -0.056102230731180424694 0.46777646378044451803 0.19253678330005824515 1.7719146465174842042 0.05834532552704058822 -0.40917459050376359109 0.14199413492668983006 -0.045629346578806739831 0.58508194469271224136 0.56470887140176817542];

% Layer 3
b3 = [-1.8929437587069888327;-1.7198467320629833299;1.6113678125826922383;1.3132731293436892273;-1.0663107257273682915;-0.89544215521013725834;0.62940009550760489532;0.55577852836636787437;-0.34659968814279573657;-0.030816123341909969907;-0.10919372890238016049;0.46459743854211604797;0.50656839706786338517;0.61781269759541201925;0.90150297781421351306;-1.1242097876845371651;-1.3549261806929508989;1.4069131350535684088;-1.8295800525587238017;-1.954005268510746518];
LW3_2 = [0.70564467553764720353 -0.43540625020329448702 -0.0092558891407325035589 0.93109393208938884268 0.092055916415774735606 -0.81591588076637289184 -0.49763592447713622668 -0.70040571194158207646 -0.23535108748949648549 0.73196729026539497642;0.8130918863210130354 0.79180187135411139732 -0.69788158673298750223 -0.87218892025979777305 -0.38406351337903094079 -0.046206380421837937866 -0.34596388174639419733 -0.21052973269019534253 0.78798680912083485239 0.093349961851862048312;-0.31880330434902642844 0.30826951431813287563 -0.6284173975081422947 -0.44926475035524754409 0.60810747263460906975 -0.72898207284874239065 -0.39738776602992020859 0.74837314026709100823 -0.81160604234401956258 0.50890750268654416644;-0.79112949774989471674 0.91661147150874344725 0.76425817941344720285 0.1857450949223078962 0.010520929775143570903 0.06672603973588310533 -0.18092619572188212151 0.93477697581885077494 0.32840205127962124321 0.69148935529137767197;0.17768507137715244815 -0.57209224312822604119 1.048023008233959219 -0.25470511074726243095 -0.88775696241193202685 0.15111112385312561179 0.42525377826354765487 0.14675906901832300178 1.0359069462916343785 0.32130230630959022431;0.23449508560949508529 0.0040164602161057048543 -0.48713034544070132892 0.38164684339036275551 0.57847396819727181505 0.75234757626739612313 -1.1389577757113014123 0.89008019645247682394 -0.0015407002735852697722 -0.37330427896266926702;-0.34892212520855764302 0.60248501758056594024 1.2258662184559789843 -0.30667511307153560995 0.69148739605494746741 0.032396654401096805498 -0.86066150148567521772 0.056408707769225921447 -0.46317085696426046892 -0.43429154037312711623;-0.10827552055945521836 -0.47432512852532804359 -0.6058888822093431159 0.87400778080457652841 0.76319685589888963673 0.51277672310433197733 -0.15069292537362213857 1.0424482676278297166 0.02596397205307696826 -0.58980323310786797464;0.22649269959120194029 0.18445128822873932406 0.5866547402658442989 -0.2134319237190192009 -0.19836981992959687449 -0.48942275408307839291 -1.2759894808983742731 0.54467853496445650663 0.73525426474440547242 0.201819177619635165;0.22415950293296782458 -0.30661706656066134435 0.31449754073174879254 0.10911728553306516976 0.48542394475046962699 -0.97073261440817659729 -0.31753514342997918307 -0.47442650113408596502 -1.023398671127484727 0.75480440540336968258;-0.69358885712853624028 -0.43538002106865308916 -0.58427269169194340215 -0.7086394113262612926 0.18472983678692850296 -0.38147540047208094993 -0.47459240102926092408 0.22822550571334510039 0.28875869329359116211 1.2054117290522943229;0.99188660454747634709 -0.3089755656346092616 1.1601030520305135596 -0.74603780350980297698 0.48897246883357603497 -0.92644834759714012051 -0.45000774054860870343 0.047798648039958806233 -0.16984929022053496528 -0.073229297411840699183;0.39280443911415258151 -0.26771266981009139707 0.28757573415328152588 0.53355342644114467365 0.43100823552253880733 1.2084167285946572079 0.189041666082947174 -0.67396500166280848276 0.4331799832614829926 1.1123973204518935454;0.44354199022891943605 0.57196375347410177703 -0.64249101548319742516 0.6076495404875161821 0.81146794634330954299 0.001855960142307566587 -0.41502276119927178355 -0.57828131788986669726 0.62523037924939417476 0.6898733022139962312;0.7396575688952711225 0.14103084898528930879 -0.16008834664600984921 0.75180576184242398075 0.62736781537302077627 0.73661262728073606532 -0.55530619656670310302 -0.26860099684222765726 0.8336118269134886738 -0.61615443179276430108;-0.68601330598874665778 -0.034223794884288859242 0.61311047583924505044 0.21977689380411716269 -0.8297756291252962324 -0.35756599563672369912 1.145115283824436947 0.32947071373694047924 -0.19001576984817772353 -0.26643476584570247034;-0.24987276676961703292 0.21110366520562662274 0.49785972467039324441 0.27715791113676280233 -0.40729455810741904687 -0.6961412931354454825 -0.9366239846975148442 -0.035956189824752141093 0.40288980384159883696 -1.1731650362980834412;-0.05443651490500507617 0.69663754256840337842 -1.0073160704252361874 -0.83163320632053860937 -0.19844345156212980785 -0.34070665818587236862 -0.58750463730520763317 0.59275518057973741737 0.55532176715344105933 -0.66957891499928512413;0.03180179413777033115 0.3849255218938622547 -0.67534514000463308214 -0.96790622368362344563 0.31326394290796527597 -0.31353197758465106704 -0.83863286464190378577 -0.53536253937378253109 0.31110720283055304236 0.59011271499476403157;-0.72846644412563132942 -0.85865711286657220302 -0.2512423582005037237 0.56739608994651224982 0.28072287847426113938 0.057330981038809097905 0.60623948056065246615 -0.8728588374849092224 -0.2833604373231171647 0.55778333136805224868];

% Layer 4
b4 = -0.18961314971801701557;
LW4_3 = [0.016439770441037490634 -0.26216114450249872192 -0.45323979650441770239 -0.35783575248126708868 -0.69428907783012894228 0.045549440872825364135 0.84658379688750784453 0.5286181046905383818 0.75568001042955346147 -1.0435943059095704744 -0.15080525020763163591 0.94768188451702117803 -0.83915450595585883153 0.2434201770662058617 0.098736338535305279152 -0.076522453069268775439 -0.84619639354079856375 -0.58542569761203833156 -0.65957303195975724996 0.16533097503864516153];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.499999999999988;
y1_step1.xoffset = -2.00000000000009;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = tansig_apply(repmat(b3,1,Q) + LW3_2*a2);
    
    % Layer 4
    a4 = repmat(b4,1,Q) + LW4_3*a3;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a4,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(4,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
