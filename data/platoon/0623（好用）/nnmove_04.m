function [Y,Xf,Af] = nnmove_04(X,~,~)
%NNMOVE_04 neural network simulation function.
%
% Auto-generated by MATLAB, 07-May-2024 19:03:53.
% 
% [Y] = nnmove_04(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 3xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-7.24533041879789;-6.70139767883548;-1.96096032723111];
x1_step1.gain = [0.079079131894632;0.203130617198869;0.5213160777832];
x1_step1.ymin = -1;

% Layer 1
b1 = [-3.8220979168025683848;3.4784604410454353918;-2.9955396286899418357;3.1857198186396171735;1.6579763759209049656;1.5042224244300221869;1.7335997212255558342;-1.2471754409093787075;-0.54945924272040913561;0.42950851229169434431;0.36425918976752136302;0.047636124113726967255;-0.79758292825253818137;2.0775489048681889948;1.1814806359102569822;2.642249511813585805;-3.3639038606631301853;-3.0193000290167661959;-3.4579776418666425819;3.3592527942936003527];
IW1_1 = [2.794180552829526043 2.2297513416940710762 1.256974164029547536;-2.8099324992063245965 2.4116546934394684776 0.54997878808296385422;2.2168340659876020204 -2.2543859494117781672 -2.1421242239481101954;-1.7706153205170891418 0.69693394787397100476 2.9147086470716860873;-2.1208800377399974479 -1.9265134788077495909 -2.6691811450042646214;-1.4215639630660523718 -1.8217208433415010838 -3.2639254490279085985;-3.6687414668925226735 0.61316466631516441943 0.2319605915767449511;1.022074497974042151 -2.0845118709813470481 2.9060026550212070262;2.0891063097609667842 -2.4720811966340319188 2.0393275608325107662;-3.0132876362099869638 0.87119218831325218044 -1.9232028675802632645;-0.67370217751026728603 2.391034110819267422 -2.8828981852916490958;1.5216752349383451115 -3.1571360378368389377 1.6963039220962790044;-1.6736263731137501765 -2.3873827732826784498 2.4213483433518527832;2.6057321031869520311 -1.0290585748113132425 -2.4656483031320695076;-0.62570484252245173185 -4.4718601181479993301 -2.202333957433801892;1.3995971454594937633 -3.2790523771446222767 0.062068972554906086392;-1.8967389035093629168 -2.2986081806369749181 1.1423762484252035776;-2.1224829399486884185 0.6445971894106971023 3.3795370893147165248;0.03810933663529608717 -2.9873603373422823459 -2.3386910834980119134;2.4199029264527749383 -0.83339242429210791396 -3.3223937582911400312];

% Layer 2
b2 = [1.5897795604838953487;-1.4256054886344822208;-0.82169062179683016733;0.38086461111992575557;-0.30699524382635434705;-0.17463264665299732536;-0.45222197758622018071;-0.97270652200015750299;1.2500459201692972755;-1.4227477326905832999];
LW2_1 = [-0.16021696476385594021 -0.33768781993000113184 0.46350292563045886185 -0.18051446148058472585 -0.47429873498237673513 0.23467044331317041261 -0.17727250514162329331 -0.58499561100811103831 -0.18210814347059356422 0.56610274092278589642 0.062735809453746044229 0.19874639137227850805 -0.50092168575198858793 0.38895967067648634652 0.24644343317351827261 0.33027192476655936604 -0.65481337773501691046 -0.78309032268628409046 -0.24497928117179823548 0.22352302496695578005;0.74945797237207967267 0.099027623829889513396 0.44092203724903045181 -0.40577441499303290584 -0.43938573112433410017 -0.063868441260518535318 -0.36379342371002132417 -0.0080397010467592282257 0.2217240021715569942 -0.0024808901613680334371 0.18585424850980564182 0.19362536707884825393 -0.17544281713704887316 -0.038051856724796502551 -0.65041506539214044569 -0.0007843773089300977051 0.53633689766409586852 0.16868046620264934288 -0.30472967581277982108 0.47735646240581375288;0.30675534125761916293 -0.22113090017262376774 -0.25914996155851482973 -0.39510797760512939014 0.29890958266968653545 0.68438759322604103552 0.30040323760406706377 -0.36925121789524689708 -0.36367351626726490688 0.3830690538444553872 -0.10348721066505917054 0.031075935403553703318 -0.35881124676449566158 -0.056996583377951257066 0.49260997435408959699 -0.31651171292724983308 -0.1873736992390563072 -0.56500123281221814597 -0.41893932586012816444 -0.38683502430417082696;0.061661148878781622817 -0.10569323433051136529 0.66409433925052407943 -0.036616462499596449942 -0.075550053047210005697 0.0031072129077515213413 0.41848520029144287147 0.42911570833923556867 -0.20035970817860776494 0.0261933362310475433 0.44697199981038582273 -0.71473615286391756207 -0.11219697279298632142 -0.27203333466566953502 -1.1138049556952882568 0.13414373130065890272 0.11404469857930600585 0.38828106670084278074 -0.12780130320979232739 -0.15797554611199859931;0.66598370580383481343 -0.40589125117837682177 0.17546091645658459801 -0.65333366207763243771 0.28810161269974216003 0.27422103965120064872 0.016768815061184445814 0.15125545004270218863 -0.24596040266588090062 0.55821734100805753265 0.064192671456332117685 -0.51380177269678883878 0.3507722824694544661 0.43869232158803245225 1.3691256737170909297 0.25770018305319608576 0.53224104593991328205 -0.57254017543878588103 -0.10705090677485550044 0.21341563574899186095;-0.24316097706729916661 0.5632540993190161549 0.19665701494827955709 0.071678203990612643359 0.030107599251406446522 -0.81399594050964618752 0.34571250862302410622 -0.15530703729613706821 -0.49905339636410001036 -0.24365603044888456408 -0.01035805510916339503 0.59553372383003178037 -0.20250540703636241147 -0.20338902142654749494 -0.41030419555549230148 -0.89410764842650425344 -0.055652790980774961838 -0.16356562788904091543 -0.64034823051323186416 0.40496167362049573235;-0.62489916817690238648 0.46876162052584380291 -0.61338661672338046227 -0.76940881585828002631 0.28395629607034128528 -0.060384572041755742167 0.14506640895856812157 -0.30511410335362632029 -0.025088450685608238572 -0.30779722599983405651 -0.50487818602539491497 -0.50559945727499255863 -0.58392005778082389789 -0.99987631997973125397 0.32643070691110642745 0.632948142043936679 0.44002584480472622941 0.10314442239371621191 -0.076887662992499633541 0.047647743814120076256;-0.094039647900110170942 -0.56436664338034303601 0.39802218132350580815 -0.008025922080364495878 0.41334818565883080232 -0.42113139236035967983 -0.44017705861104355902 -0.065483739814935534862 -0.19092388914511637665 0.47038886182754535703 -0.26402632660327984837 -0.23659631082806004132 0.18195221934530783625 0.42527502677629036576 0.25264234108155331215 0.12062493453085969264 -0.36516736736295657417 0.53526791004728968559 0.36007668698998962498 -0.63978204381046777094;0.22634720417723758201 0.10713209994845930562 -0.76451034398901651645 -0.40053048976302119133 0.002012662839845271584 -0.31727757498091557764 -0.013126142442603695379 -0.014323087845599092455 0.57826520186746432906 0.097517156308446859003 -0.1152705903780288782 0.1002572203391685346 -0.3670314698096650563 0.94883561730536336576 0.44568646000722011991 0.79479558647615478062 0.17723981251394840819 -0.51781085025469164584 -0.0020050855857872422645 0.20049989692194272739;-0.65516775228334855896 -0.19244021552046289281 -0.4824319713376115093 0.056264327928267431067 0.87363958505769789831 1.4312231354591591348 -0.040733285379677366955 0.055234213770538755084 -0.18069390626949705103 0.34749923361324625004 0.11102651803358290494 -0.4276849060268753111 -0.2357817434994586292 -1.279987815359066694 2.2400696457715838505 -0.96603541261539671581 0.88906009044873779423 1.3388568879743831808 -0.21176122805000488492 -0.68431148833196353554];

% Layer 3
b3 = [2.1636796291029529726;1.8476974617733317174;1.5457089248474302767;-1.0758431803313119879;1.0186675185357423334;-0.68228571495983614259;-0.48145069737410328692;0.060841442453306075755;-0.27994638447911573964;0.0862649865125274945;0.23518920276570456918;0.16576982976062834552;-0.2689802931476601433;0.78732685987490647062;-0.54808141840674817757;1.0463371129933181081;1.4491637243077113428;-1.3833787828157799726;-1.77622711077825568;1.7593093261911438852];
LW3_2 = [0.070686200191471953991 -0.17068218134710355649 0.75817030520539019367 -0.37492064439878070026 0.62688601417802980453 -0.62691550805647588973 0.79420945651048324709 -0.79026885529768531313 -0.36350890494977239342 -0.053377284208977505975;-0.86346631300479081972 0.54402032414637147006 -0.19155141804258432603 -0.1544845230202007702 -0.12466916173976864968 0.29683237144644614158 -0.34706142264569900258 0.6767551273127249134 0.46843424857526727578 -1.1868209811189023295;-0.73208306810948897692 -0.30851990566475923083 -0.81469944702432894879 -0.69073171003583555549 -0.69471901330381968798 -0.29715837709375897413 0.55092919488717073673 -0.22942403065149563623 -0.79420667467573624609 -0.18105056116273804401;0.82743857456961644736 -0.50662590001313734245 0.081763563402473080077 0.030288620327057778903 0.67165412762591469864 0.77322004909575270393 1.1100924129364704296 -0.40579963876784636012 0.41249144605174176137 -1.1609518437278234515;-0.49630229917686408125 -0.51664591042379492958 -0.97269335859452088489 -1.19554997141427366 0.64487705131546269044 0.60416646571583365599 -0.13726779321093451891 0.22449912378097949817 -0.18151882410818398483 1.460376369041344935;1.0102398953765101552 -0.15546834521041658084 0.79370087468840855305 0.1190398217796229674 -0.64354177081605923316 -0.55997418402460830134 0.36682059294221669443 -0.99343215781281468679 1.0395855793917205823 -0.030464782943872458637;0.58775985125099361461 -1.1219170727676677224 0.68031865126530033372 0.48084079897402981496 0.57805053459275079764 -0.52053797409310120781 0.92811442430069068799 0.33058798106144732243 0.35646512027867355288 1.4490264981069678196;-1.0339464895406385025 -0.59926377102233485683 0.13640449110589875081 0.00094364524180586082519 0.45523424869614637078 -0.80705892389488709249 0.76324401215870518733 1.1160691358387384575 -0.33875190581962105751 1.6025356363571539031;0.72220650007263942349 0.72444742355334712514 -0.9116072247161542963 0.54607452024316271988 -0.22525684430835088423 -0.78199423406083046206 -0.15604111894254929505 -0.56635391792960687596 0.60400143985887244646 0.23332414500611403652;-0.31728836898594409144 -0.23315778035435535953 -0.5301223159734873569 -0.49878586251862561118 -1.0811381560548778413 -0.59504781564278474981 0.25611712100673977854 -0.39951074093455973824 1.0353680460145611164 -0.25062797437171202564;1.0356576287876333442 0.64976571811595018602 -0.93525248806786542843 -0.4497513715266202583 -0.42211050737551208956 0.72515742054808507433 -0.52132781008009343449 0.69603933425075326102 0.43100507717942132535 -0.33291862385461812313;0.7239886252472743644 0.054714491106270253529 0.083473241825824939788 -0.93613361910190695525 0.64808717187880948707 0.48691564290432692852 -0.92042850155248712163 0.2741427220597879022 -0.47591023034990270757 1.0884556592659451191;-0.33627668531530641172 -0.32447734498379332546 -1.0255101405341056076 -0.53407510804726454623 -0.30832708402851272123 -0.52703914195721923708 -0.87780934078218852967 -0.47578947112446851042 1.1360680427976148632 -0.25579570921948663331;0.16702954336133360447 -0.53398970351057550854 0.97050542458960253889 -0.71740902918523008491 -0.50021003681074283076 -0.23117554870098031006 0.91985047677114617493 -0.43463764521647069161 -0.15994733470895639016 -0.72051397298767394517;0.034251293060815715674 -0.69254014298890076429 -0.37116519239330753033 -0.11124456489661845027 -0.064234694069197004196 1.0931103538378497131 0.6364412111944219852 -0.94344334791238726456 0.96519996189481060966 0.5563684839155209616;0.29357025752767751392 0.35657366329732664845 0.43498964361604047779 0.58984364056012050792 -0.098730371644959652455 -0.96837416416621546755 -0.74754861890502544153 0.83252426198536988444 -0.57896856833227239303 0.62827523010872032838;0.30054207190827991747 -0.3879609605774326786 0.44674564711879588552 -1.163228756938403885 1.1845126226571411898 0.46465831885290664882 0.23145594294790597378 0.31752997028032803328 0.30249358467207404511 -1.0658650079529434773;-0.44181483580028796387 -0.77796037475984403109 -0.67470202725313799252 0.76886067308079431015 -0.90155474675657087946 -0.23495130030954991529 -1.0196907246178288364 -0.83534987480704703255 0.38135310280044848463 -1.2658968156996959209;-0.48655231786182978615 1.0921055805379031867 -0.41369346066499185222 -0.76153479727932005261 -0.37265913005460321594 0.097268838210754701712 1.0735599397340458427 -0.72057841800386690512 0.50893353421760401112 -0.53358852763093100879;0.31493692919815041709 -0.51207038151736328224 -0.1157249844916375392 -0.61335247891143607202 0.85978489290542969847 -0.5595921415865836579 -0.95997122403811463442 1.0541036166014210451 0.22451708788201801825 0.67956444280884875653];

% Layer 4
b4 = 0.52824183757552001239;
LW4_3 = [-0.35042851725884943681 -0.56830847192578937133 -0.16667758467594581684 0.68307046036473884065 -0.67510630435901286539 -0.74767041487614616102 -1.3308001772564750365 -1.1853379662535148409 0.10916670768708762462 0.50190515651364009386 -0.90632042190962069927 0.49421063510899887472 -0.89640688774077448286 -0.47268492854858584762 -0.66785217524411566448 0.15751192452467488447 1.215795101993474514 0.7100966739712858411 0.93729609486992815359 0.79613562689909744829];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.499999999999958;
y1_step1.xoffset = -2.00000000000009;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = tansig_apply(repmat(b3,1,Q) + LW3_2*a2);
    
    % Layer 4
    a4 = repmat(b4,1,Q) + LW4_3*a3;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a4,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(4,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
