function [Y,Xf,Af] = nnmove_104(X,~,~)
%NNMOVE_104 neural network simulation function.
%
% Auto-generated by MATLAB, 07-May-2024 19:06:46.
% 
% [Y] = nnmove_104(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 3xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-19.0505965768031;-6.70139767883548;-1.99738196042707];
x1_step1.gain = [0.053913604005474;0.149967019141203;0.500604127399131];
x1_step1.ymin = -1;

% Layer 1
b1 = [2.9723065640498669282;3.7175248820231021618;4.2296698143637430078;3.1975875664427562128;2.0878182846930823935;-2.4755582148909418549;2.7781509564038699978;-0.14023829411606530959;0.23211221606761969771;0.96064338111363001271;1.0570604378558956515;1.566004243991003575;-1.3006922206635271877;-1.931371159025761175;-1.4632873560981536354;2.3108086309874105169;2.7500957818171833935;2.3361016223138721948;3.5339846081652157572;3.9325839241617468467];
IW1_1 = [-2.68534757615943942 -2.7170048372037567397 2.5969181255657818319;-1.3163491483825870976 -2.449905565819471942 -1.7405848600373705626;-4.0502419604039152645 -0.096928553460487884563 -3.5363578059473010917;-3.087004478215657155 -1.0989229847194719181 1.005730315859133972;-0.90354248494887623444 -4.1129326470585203523 -0.20405279870137657539;2.504864451301997974 -1.0217948019776663671 -3.1606465480637724319;-3.4892394385490401731 1.9286899699830746258 -2.2819864803280363041;6.7064518600499942735 1.1662720273760796008 -0.82431176178243492636;-4.3986528906349082746 1.6592413778954482328 -0.22816935426047554869;-1.7719410645886601863 -2.2566598204524161986 2.378046369153819839;-2.6367346653056622507 0.23119000197379080408 2.9383241806908366733;1.2717714082079691895 -2.3963019475014224469 2.2752280546590619714;-0.77856451572240836789 -2.0842754841538728705 2.4106880975256910205;-4.284631185835645617 1.3339430927923312531 -1.1165061948855827811;0.51094511106737261485 3.6482994955974148432 -0.24552087742445710683;3.6937225189514926171 0.031274295543800428865 -3.3046054528866690703;3.2181125493028672757 -0.18891342756789919477 -1.4313441839442180292;2.2428525154550196241 -2.614137589519072602 -2.1154739712373507032;3.2219380971720741336 -1.4570847026985023209 -1.015846178539018041;1.035799382417867287 -2.6072335576878136187 2.5845879010685766097];

% Layer 2
b2 = [2.0964023104368312289;-1.1760043737178409451;0.95923073513779710808;-0.34310116320232919573;0.040393716231312416787;-0.52184468653072069166;-0.28806910549486758333;-1.2025184839522493618;1.4504091109419321448;1.8049217629363776272];
LW2_1 = [0.15837104210961397421 0.33512067342999857233 0.10613992708338770843 0.029755770998374522773 -0.023391750085476645943 -0.027486091785082947259 -0.25925064686065169006 0.05220756722229125818 0.10606623762600396466 -0.15696076659273086595 -0.073166403065764454294 0.23605466424579757412 -0.22881926630557528068 0.76585873633150203244 -0.57289377077257008786 -0.026561489992688407796 0.12515061509095290471 0.82073978103518108185 0.22080758397332572729 -0.1693779717606583024;0.27885306955187355582 0.045596769609589360428 -0.33502600015553896107 0.028552514552212741872 0.086601858616152493919 -0.99657995275237853949 0.883922529631660292 -0.1303040163861666767 -0.19381866948462256328 -0.017485576259736866633 -0.32687652304465225628 -0.89941032672586596064 0.0005774604018036477715 -0.090068978281114459028 -0.11212173257162869056 0.4814138259437131806 0.080501842311346161196 0.27279764637520731441 0.29784872597475081646 -0.16534548344658198116;-0.47142702833585720112 0.19096359962480410899 0.46538560636434850304 -0.14618480331468639011 -0.05071998384627580958 -0.89442559669339272155 0.014809375533145315712 1.0194448111758678266 -0.88671517031497615324 0.48795931333769154703 0.23891677529526364476 1.1933336232935505272 0.650727749276596934 -0.93726151897007770053 -0.16263172099395273307 0.27001196420701822909 0.16492422449159732656 -0.25315730391518515008 0.53025337396194005546 0.05298521688469369495;1.5537440698024578278 -0.15975827499898417883 3.1205122643560647688 0.2559552252639817338 0.75311478569716727716 -0.45788846298971658255 1.1616852919984315129 -3.9761244809457685356 -1.4206951267139760198 0.27663908754142957358 -0.29694717362426553686 0.29161150472541991219 0.37431360094292775997 2.8337182840951475882 -0.71777086020728253501 -1.8716440112965520015 0.34291471620892666206 -0.87276494959722616951 0.083527830960326163168 -1.4589176305060158612;-0.37895610731036116769 0.24723002695976398213 1.3371970194742703875 0.183185494047848757 0.82070510461232348831 0.57727081246308475926 -1.2401402276805453262 -2.728215808421731392 0.55235015266782183652 -0.37147853800684754733 0.6036418940008643208 -0.25226677760520055394 0.20180955520988999585 0.30038109623796216407 0.64149243656152477033 -1.9979893678599585094 0.079099429433993534433 0.14785203573930932874 0.24476747518286773309 -0.98510469825981317182;-0.11793764687454952322 -0.40972539055729223501 -0.15295579627126526523 -0.51366868582380442732 -0.49444341947805264814 -0.55207615474959803592 1.1885471824662332541 1.8893195343372948258 -0.88832923339458758072 -0.21678447366705491661 -0.48694629464650907025 0.3794808678200690677 -0.32241225797395073327 -0.38244682095844345637 -0.086795447905056111182 0.92549128006200920282 -0.22271810123247742785 -0.14543986595197691547 -0.86856131972413930242 1.0441676402622959152;-0.72519099476815518379 0.74805965016151376723 0.6318351334637325456 -0.057267071152789443544 -0.049191372952845438538 -1.5889722679084268275 0.028072244557406384607 0.75172582484747163534 -0.023193065703246792952 0.32691662750782457536 -0.35393836490727087485 -0.93114734161073386964 1.0372872363253342609 -0.20978105873711805351 0.30546638878510368187 -0.61962838860292279719 0.10668946316274542652 0.36202364435822348421 -0.016290773652750271949 0.24837580606063866528;-0.11679487622035870931 -0.2968645683965271953 0.72482973184840904235 0.35822156548440931001 -0.7321794927075728765 0.18269103476300385669 -1.1456826567642701686 1.0079443900000062406 -1.3320563772408375858 -0.20323147167372795918 0.20245247377840402958 0.72126199627193010588 0.20127884588568109581 -0.52072693355016996808 0.3833331195556159976 0.9499712450598634117 0.11810351874749391854 -0.30729553393151026741 0.0074353270824461196314 0.072902407022134810277;0.14223297161630704677 0.79807486885778322616 0.76945803469391382823 0.36985649199928904984 -0.28770666064236433135 0.26093139016509964145 -0.48708214034543378945 -0.32930112882140688546 -0.088974087446079652697 -0.55098067688988749957 0.35962552917528511909 -0.10541468178587561078 -0.48576028917113578398 -0.15786495967772018467 -0.0023258207392651553125 -0.35495418255025024123 0.42072697337982672972 -0.23930755773219553051 0.039615700699242389904 0.31359320836274617861;0.39347110943019636409 -0.38588351841664930708 0.25915295517611225407 0.46863397037534060274 0.23400378167549201747 -0.55931089450056414858 0.55542379218697468524 -0.415383450192455983 -0.36474980639801418691 -0.80118168240427878324 -0.12867225403540619166 0.39311910176191905419 0.50974085162362736678 0.14182180927657031533 0.073143400875655503746 0.6113957663782606522 -0.12374910425770761779 0.36707051030431120386 0.58466013544371575605 -0.43562203776868979599];

% Layer 3
b3 = [-1.963070750947018217;1.850063767575962137;1.4937738830805999957;-1.2341871898256413509;-1.0895651346851211727;-0.67539057645799605023;-0.85770402722085226088;-0.094691295576457251704;-0.79799329244145589257;0.2099654575854737748;-0.22107583566899122185;-0.23376166461997799351;-0.41802965841156308757;-0.96091630388003612673;0.73583479871757406787;0.93956162858136993421;-0.89941053855056884991;1.5086527363562769466;-1.9102484203711274091;-1.7484411345316075437];
LW3_2 = [0.49545227799004182279 0.15126156892438386015 -0.29185823764312524009 0.36302747325179074434 -0.74984062600289735911 1.394970114554344498 -0.65800707337057462443 0.29710428929684257193 0.19397720043412933211 -0.28014080266783442097;-0.49983760700048562864 -0.87034471481610620192 0.65051545536317689766 -0.3191713762902587681 0.056594624393018599928 -0.93669571294303011211 0.33006781009588637144 0.31041925074590587252 0.59912754207020579855 0.58776505003093015844;-0.089569943823320147258 -0.13688312628659971004 -0.82765632350619444679 0.80182969882481658352 -0.088882622573088224116 0.42485444420643947439 -0.59283246921250454253 0.99666587757482982823 0.78645694917751718389 -0.13976644245159947078;0.62779384447514585688 0.47911187959006246162 0.21511530119932631422 0.63642986894956465882 -0.29747433698683789505 0.89506194560423302242 -0.28455935152212974426 -0.92764183246887443879 0.4687942723503583653 0.023448633249666884365;0.30933771665107528959 0.34419903046955357961 1.0472575689694658685 0.60270170022686886391 -0.44221587249147509269 0.089089415899703094937 0.15603921032625620025 0.94633843470315859303 0.69804810749711143636 -0.4554479547994196853;1.1399195130781343277 0.96897431885704743415 -0.32616517721572657607 -0.1289258022036613438 0.014212873706661098561 -1.067240328154329676 0.46554572787323283967 0.23305602679349002315 0.52681214929982389528 -0.072451854340910282204;0.24683973203262699059 0.3504369020173047633 0.65127869540333982457 -2.0464788870470420612 0.42825933579634012371 0.4784091538873117555 0.36956647329904157573 -0.10284289169313309831 0.80501650247421641104 0.21565697258226007582;0.53122074042289568752 -0.53907398803554040789 -1.9988611423173514581 5.6591311622079398802 3.2131970767988371485 -1.0370789681157699391 -0.075627529115374902968 0.13743517312860675794 0.1663344490947362142 -0.056838056431528193035;-0.009458778485099475497 -1.170721912272050913 -0.86619566211596243921 -1.8804286680035888768 -0.39397509440091615929 0.020818987762196594637 1.1514819984131108299 -0.54716870259562244705 -0.055830543070228486058 -0.18268011099762287985;1.1648637585948102835 -0.74896292863103808291 0.66192741889251127674 0.21700070499761095477 0.23235735183963063255 -0.13925541644331240754 0.36893923537170547622 0.68868861256504443347 -0.62969932173879161752 -0.00093251878975999288185;-0.90103074574288255505 0.70799856338493494246 0.21283818850317498539 0.9999965488267982261 -0.22612300239179236594 0.22748937470370311775 -0.40118570418417109913 -0.9175175326070137416 -0.71135932834718784701 0.11256631250209726824;-0.26243129544299564904 0.23778193645910716825 0.18656367077817193056 -0.98315625931817030025 0.87281947010063776204 0.83140218633048501573 -0.090706864103593520809 0.66982779898547983866 -0.013952698742401625775 -0.88377696111201953233;-0.56968059585846986259 -0.87376694864877824109 0.69301406906862006441 -0.47662484707311375542 0.95319031705040802027 -0.62788741212244125744 0.31000059621075387595 0.11313791432467978915 0.17670963211158455253 0.67080842081092972862;-1.219243741931648195 0.34322693577813473409 -0.022284069672969128439 -0.6003908032299922759 -0.012693336620252872876 0.64756416754104406674 -0.81074271591993296582 0.79190643954296469076 -0.58479775901815311823 0.88782140786525809428;0.071123459876081415731 -0.46926721226992057501 -0.72564398752095604639 0.32411913296143790575 -0.43076037199872252437 0.4660686739194883077 0.32564175468006334446 0.39179835021992082122 -0.77313025195441564819 -0.9958262063924629981;0.41608268510259388551 -0.46730088874968994661 -0.83925100647904549156 2.0417421945403271266 -0.31233558447532311364 -1.0421706286439311739 -0.39676950158413121228 0.32033684755848929049 -1.1054378129381423612 -0.890774413350196137;-0.054101952730659583213 0.78795727930815306905 0.014391490008581248397 -0.7042873321656993868 0.80557834936289907102 -0.75194523246704203512 -0.52863970754567446431 0.54788302770460728386 1.4225516768947523705 1.2734523000598620968;0.42617880174311678632 0.18565851525605853167 0.73795549160648943321 -0.57605687156574969521 0.60420861873613274096 -0.30359703546120936357 -0.15435439376009219004 0.27887084419217145204 1.3882146517905225025 -0.095356401416119243586;-1.3090957282226454161 0.098390810774102957503 -0.15714855043466258167 0.58105105254378974777 0.77288639430890104798 0.32436813367325711965 -0.4131442531663799822 -0.050048967863863230709 0.69274808274373311789 0.33259495021217783117;-0.22810491022004716899 1.1119453676887625093 -0.019748588853430875528 0.030150763258167293662 -0.70305049731090873966 0.78627791717428241469 0.37961024130827475398 0.40247140739622738748 -0.45648911107267298171 0.46758220568981678777];

% Layer 4
b4 = 0.13439623362681960006;
LW4_3 = [-0.089833018876631406946 -0.19292711087016198301 -0.017080643664772337392 0.34206375465039584594 0.12192175289715062592 0.56081806786116517038 0.61228559599953980008 -1.097326320507011399 0.34822365596643733987 -0.11884730851535361962 -0.2239420550913651109 0.67585180745127193536 0.11820060251707338594 0.50610024853897284114 -0.39652236228980203281 1.0438009344967031922 -0.65244305810440106352 0.34031045427185674379 -0.077888957085056886864 -0.48789346783458042989];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.499999999999934;
y1_step1.xoffset = -2.00000000000028;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = tansig_apply(repmat(b3,1,Q) + LW3_2*a2);
    
    % Layer 4
    a4 = repmat(b4,1,Q) + LW4_3*a3;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a4,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(4,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
