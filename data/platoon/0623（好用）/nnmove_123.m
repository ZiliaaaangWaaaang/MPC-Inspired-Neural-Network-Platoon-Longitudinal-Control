function [Y,Xf,Af] = nnmove_123(X,~,~)
%NNMOVE_123 neural network simulation function.
%
% Auto-generated by MATLAB, 07-May-2024 19:07:33.
% 
% [Y] = nnmove_123(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 3xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-19.0505965768031;-6.85918092085871;-1.99763696099884];
x1_step1.gain = [0.0522252737181727;0.148213484472979;0.500572177293996];
x1_step1.ymin = -1;

% Layer 1
b1 = [3.7488287532309527705;2.8080582592012723886;2.6272484437213106112;2.831716594779112306;3.7128308048638372085;-2.1167034402800743997;0.35774846356010914228;0.87720936385291248261;-2.6289195413171708715;-1.4081228226349005173;-0.98437507778232680167;-1.2291006231278551741;2.6507810110314853347;-2.3633255017465972792;2.1591065845518184751;2.2266549236554684654;-4.0021049117552376373;-3.0069633233831258856;-3.1750588232536083311;-4.2724729916628092496];
IW1_1 = [-2.8950551535363349132 0.36384426279801018733 -2.3940688082927632507;-0.90047745486128305537 -3.4417680227774880564 1.8180923825026256146;-1.3437665375333021078 3.7121325964831721755 -2.8419382660592553691;-4.8355208466457932914 -0.40918908965623207452 -2.1048742269571030228;-1.7452348625931428661 1.0023026188293091554 4.6422749344498166479;5.3561192181742089957 -0.46696645509076623037 1.1877959338293841984;0.12699198961446192535 3.3221891441266655498 -1.3008181545792294465;-3.1110425053879282586 1.3629333021155811689 -1.8644258984765684772;5.4520890280475766687 -0.29213912167082528581 1.6802735910666604102;0.066247543874322203927 -2.9795240443551960219 -1.7217498654876106645;5.3653067160710907757 2.4763257683926838126 -0.67708035341617600622;-1.0409418828051972827 -4.5035965902657100202 -0.0064973354021557513244;4.3890315739155330022 -0.0041675017973046429853 -3.819279539367211207;-2.2187976114470044919 -0.023303674979434665232 4.0570017599278473952;2.9546706924691648055 -0.14603433259753936801 2.993045381208866651;2.3986457568284027531 4.4881660905337419365 0.72477231763854399471;-9.0075200886011259627 -0.38117700533868453805 -2.7562061169162412888;-1.2004108801600714695 2.9491170171377798503 -2.4575097133809054029;-2.8633854222009205159 -0.56473140683191269673 2.6112910208997002215;-3.0667604986886685126 -1.2141536354003086284 -1.1494566572423559059];

% Layer 2
b2 = [-1.9228218732957051973;1.6790596922461922258;-1.18339904759328296;0.12493310592146249227;0.30594568960754664477;0.34615545824789301088;-1.2086434713568654509;1.4803640810389284699;-1.5726438091370158467;-1.6322208074493440577];
LW2_1 = [-0.065425512714368833089 1.0265809172692939022 1.6724955115035398112 0.40080541799765817546 -0.65877964235309161012 -0.5880655636970153477 1.7364672602931965351 -0.72379078949522979158 0.56969811131348113697 -0.35033773182473015861 -0.9861262756299352672 1.6138348131169817368 -0.58808754086236025849 -0.16631523247743620897 0.091681603890300736315 -0.1286736029544246207 -0.93147569611803116008 0.52825390634380298138 0.12915068425609005365 0.71294455472426454534;-0.55125300009646382993 0.57897409319585158016 -0.30801464061790995164 -0.44755318843958685759 0.4026536632467419552 1.7643256607087804966 0.10811497758062203756 1.5999435934246359903 1.5022315712803937515 0.28472954872245481717 0.30329824816530848164 -1.0191645141795371288 1.5471572578463288483 -1.185458916495842896 0.047506040326985889133 0.89926990223227543098 0.74698152465793343779 -0.014257303532487393405 -0.48711112283542162826 -0.60597453718869653816;0.35124810121920646555 -0.61573533806860492046 -0.3100517315062546464 -0.4116240876801866011 -0.59430980545704503726 -0.30951897292540747619 -0.51142136614979472053 -0.11809274885105602859 -0.29347619914499906146 0.69315372214723902644 -0.40275279166836075451 0.14906695213791593124 0.18801352258305581433 0.49586519392718747534 -0.2452866130160681335 -0.14944280539034554556 0.10930428288013943616 0.26756863688527493528 0.81682532224769477391 0.63635508220957248682;-0.84886869319591939931 0.15832766253210411866 0.14937436738921203161 -0.020391677496418611493 0.44454712215056346736 0.32300243001246609076 -0.50877967250653854947 -0.10136594818847963206 0.080162259487800327507 0.84132408641639078173 -0.32223175634757711405 -0.85041894782053850665 -0.40022036461846655087 -0.014014942182219713995 -0.13144059020923301584 1.0958216606279855831 -1.154154327105609612 -1.0633143873870860574 0.97721377468630921115 -0.16944472473092375697;-0.10563495163904650098 0.059444544401441784531 -0.76330847238300525426 1.0134948561014818225 -0.11289091442503020046 -1.1077612128512104306 0.43375310262822625029 2.155805251472858064 0.17590834788028530955 0.27669333949906954606 0.09881121042589981196 -1.3676893664203895185 0.63917991258033435287 0.56002036229205598428 0.29575008136131436531 -0.45609329850342206214 -0.2868427950641296853 0.20985262539939714133 -0.24858843678493786067 -0.10539171966014759807;-0.10647574969887775576 0.67304523777970859388 -0.84133606547391437402 -1.9973896197859593027 0.016863921268265778114 0.16530308225825532387 -0.31314538333507391243 0.14910567495731186227 1.3234605172164966014 1.1111845150912242897 1.5832589156758636317 0.064008327851984292423 0.62232057020456266194 -0.52460983247061632184 -0.41477587491111606033 1.0995881382091590162 -1.0213088293699130737 -2.0749080273859883405 0.37287955908540532102 -0.38928441672616237446;0.26924174448553600536 0.34672727234034583788 -1.0219413247730371186 2.3734126985622974182 3.247419650681850456 -2.7954325379884510383 0.85197410873447743107 -0.81130104726978458096 -3.4287561795487220273 -1.306913690589524446 -4.9815802468859953223 1.0713983085174472176 -3.6386236929789048666 -0.45566230242965410913 0.4080275536727717145 -2.5407003690677592012 7.3841593382043857474 -0.55241022248475968315 1.2957425568127505233 0.89263839717073700797;0.36654636769192711077 -0.087302132749808927792 -0.63832843701451680296 0.750073459050542235 -1.6007731852493680691 1.0228706887823573179 -0.075709014799784007943 0.68339373958275473342 0.14002007105812977472 -0.75328677947438482665 0.81546624090505748228 0.99952561099839853931 1.3127803167152076735 -0.24429928217495552878 1.7517175625689862528 1.0023666945656464211 1.0362041276403863854 0.26107375971722268648 -0.61177216397021283445 0.046777200989837036671;-0.71471551857069504088 -0.42634097078502009026 -0.015741144014052240591 -0.030476709142472604291 -0.43246883437981026299 0.46885894463879834726 0.40885599911814385354 0.040914310844202959883 0.50650307403179062327 0.42342516225326842783 -0.25156293525470829753 -0.22487914818022897157 -0.33767871751127181978 0.20686612201145626599 0.055952358947341976347 0.17001100198573387834 0.81375534565460438952 0.074569584814737702172 0.66094100455324034105 0.33199193836054702311;-0.46700755192338860855 -0.49879623107949289107 0.50121646403269337622 0.14925199254910787028 -0.92438458064753792343 -0.91559967808746833828 0.15926965418328234425 0.98549916166605522339 0.022863490173378728243 0.42373001607598392848 0.065650975463321797898 -0.2049520405344678331 -0.22365109205747232823 -0.051559287668038689123 0.32285327813557040955 1.3124623628320133406 -0.34475248257065876922 1.7345704456394255288 -0.391616310449632965 0.1404578552186132312];

% Layer 3
b3 = [2.4242434241908203951;2.1795571065975272163;-1.8057319107697751281;1.4443881612911935175;1.2026119185060724082;1.232236258841940435;0.88956842556829474056;-0.063009206250827731743;0.49426599726438535942;0.49847012842975679803;0.038747753188396710788;-0.32064715944930821667;0.97783277206726726405;1.2343874131868044497;-1.2468882720273510856;-0.68694904892616626135;1.6018591201078808961;2.6756254696284420547;1.6421447417592731632;-2.0126448400609402434];
LW3_2 = [0.061738637121953911235 -1.2597043752480499013 -0.42149499571956894339 -0.93757005607253496304 -0.076064303234027519363 -1.2312292453879933873 1.2015068016370880066 -0.5266067406013767993 -0.024277812508486075471 1.0830824995393788512;-1.9330509755655871373 -0.47935335588004512886 0.16933392813218664519 -0.42821354635110941977 0.10375819343703822362 -0.31438772352063865112 1.1127699748271586699 -0.83764572441491635946 -0.088515116841974661455 -1.042240120409810622;1.5723047042345621449 0.40137027169238909119 0.69660634880011862435 0.090256471662688353419 0.47892138916402537951 0.44652075346287922741 -1.4423093121057097843 -1.0529049308802334028 1.0715001680646050186 -1.3017998876346381643;-0.12341363194909792111 -0.34260802101015003229 0.41950470924666194428 0.45041720230352627619 0.46458671622906916321 -0.7555893288881718739 -0.21971566273001835734 -0.19804500026264526547 -1.1025083436834925976 -0.4092983377055521288;-1.2563721674989514199 0.59614248470467745555 -0.82099295922367354628 -0.60898110772199132157 0.34773824678014580991 1.2823801146539322016 -0.25577593647824797829 0.50471172949941267571 -0.43673461781472905363 0.35984782290820177542;-0.62446421064339285856 0.40192007701462711955 -0.62353034286527964092 1.109029312390654276 0.37148730291333570408 -0.22297745503075530604 0.18339129636162534998 0.72225479660537350579 -1.0473976942553273606 0.095209960325252390723;-1.06430791243875289 0.62488976402717921754 -0.66221694757288684929 -0.12467824182718457993 0.42707391815367151677 -0.80701604167172225068 -0.38931027284480757 0.07861432648559187053 -0.80159031205377528906 -0.30467440210667523504;-0.23791997366929260038 0.0097309550846337890262 -0.44372751866636034324 0.91398832827439369098 -0.8903107976068739271 0.27267215382086723574 -1.1837992444610678788 0.58512771543293362608 0.39326745543701174812 -0.027978684648651198918;-0.096985883063372468893 0.54770639831893319638 -1.1235320883115049728 0.23127730489860945373 0.91489702696270469584 -0.4151970427477758574 1.2317883782283516325 -0.74990910405001931505 -0.64598448663124963254 0.010262564851335085822;-0.40226516668752065886 0.48377874603299786394 0.30774742047157471747 2.2809887223016405144 1.6901180186375870385 -1.724210550895619809 5.9415221767660186813 0.22079465516236240763 -0.04283922331430491115 -0.94791317847527523099;-0.46320356503677240223 1.0940952214603838488 0.54294417705717157308 1.9178154055973464231 -0.47248389779772315133 -1.6380039265256329806 3.866089878200394736 0.48311526848120894817 -0.33312045946388252338 -1.1877341248087109893;0.80483344073878104741 -0.73016111986918086352 0.91989391930299813094 0.55830870514963593099 0.10263434735928689268 -1.2955933389223319718 -1.3810561158679555138 -0.86847412105016286166 -0.64833944483676431148 0.30538333953203228299;-0.41324133872301055392 1.5470310599407788299 -0.44083596992361218092 -0.53449832557402565669 -0.41781580374760135532 0.66543950183988886948 2.3561148898276198516 -0.06427628325021358946 -0.30875994325741473734 -1.3271710819139432846;-1.1888814497123654235 0.36524743572666873437 -1.1217892486944458508 -0.8659698443833107051 0.68977459113004957469 1.9021469148649148284 1.394861032783503374 0.19229639803167544732 0.46156635354666675219 1.2318694592503172114;0.0054674244494597040722 0.81262649233208783528 0.29639990616544137358 0.67476212995742712586 0.12761310688399213342 1.0310766263679469468 0.7043388398498613423 0.81321968308256209479 0.54494464344301041248 0.60142922470015380831;-1.6333578436288862523 1.4813631436630554372 0.15312380368502265249 0.29845608449158655961 -0.58225021657860220881 0.38112902644059082347 1.2299799802412547667 0.82166024507492962936 -0.88836417353011498665 -0.63967903980356211058;0.30276838393030491847 -0.035445819938151337802 -0.69829755985376384952 -0.90118197052654458457 0.86700561337885595492 -0.21889697993200213366 -0.78049636521436793757 -0.69254278764945176317 0.31404025805360474832 -0.12912017298257152942;-0.35734717713887925727 -2.0686706856237444541 -0.44563517029085641941 0.51525437960373521307 1.0009269364195318985 -1.8139143991438511083 -1.8356241169643205957 -0.45323590750987158282 -1.6732203634540609993 -0.37433275786089126314;0.51814386013757074423 -0.12182327098394303555 -0.83138548967616854313 1.3232990159489566029 0.0058629524943169418136 -0.52467677046381866468 -0.076709523560001505182 0.16466455250326852977 -0.49416197331419997596 -0.4588956436936663108;0.86635059646191081573 -0.86800237444929262409 0.18935636104898315168 -0.29510609481157851208 0.48112881607966812014 -0.40288809652756135682 -2.408135500861829037 1.2659570775845931934 0.48719294807369373235 0.6214352898762848243];

% Layer 4
b4 = 0.016423196392916665498;
LW4_3 = [0.28337747644196953356 1.1042212093790528815 0.98241424546516786798 1.0365288610245051437 1.3378144749784075529 0.44796047465073324245 0.34818089988793499145 0.58559895805341088959 -0.41756543900916653911 -0.93274949621936131816 0.29028913730494937395 0.20982105185370547584 1.1040351282904159458 -0.48988078175228755295 0.066934810822351489823 -0.58234260749274369129 0.59783959126048424881 -2.25974460613741579 -0.070611243996409348012 0.96445692545916383853];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.499999999999931;
y1_step1.xoffset = -2.00000000000028;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = tansig_apply(repmat(b3,1,Q) + LW3_2*a2);
    
    % Layer 4
    a4 = repmat(b4,1,Q) + LW4_3*a3;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a4,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(4,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
