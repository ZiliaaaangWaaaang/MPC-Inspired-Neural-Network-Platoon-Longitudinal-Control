function [Y,Xf,Af] = nnmove_127(X,~,~)
%NNMOVE_127 neural network simulation function.
%
% Auto-generated by MATLAB, 07-May-2024 19:07:46.
% 
% [Y] = nnmove_127(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 3xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-19.0505965768031;-6.85918092085871;-1.99763696099884];
x1_step1.gain = [0.0522252737181727;0.148213484472979;0.500572177293996];
x1_step1.ymin = -1;

% Layer 1
b1 = [-3.4816989952987369428;-3.6411602695725751033;3.037031715705413859;-2.7922473172005513042;-2.4859903165623378207;-2.4694747036822684016;-1.810042854222757569;1.5912675967685823153;-0.67249544466729527237;0.34010987696244621148;0.87297605288835977699;-0.18315314180951272616;1.8583096964769594273;-2.4530818263463776141;1.9419955786058733516;-2.5391107820469502876;2.4930097843337097885;2.8177023673353294164;-3.6650470465094837635;-4.2000525115818909683];
IW1_1 = [1.6378029638650160038 1.0605530232841395843 -3.9763603773378828343;2.8361247653469021657 0.55042314047301643676 3.0999233102098981973;0.064749681421196456088 -4.0751599046444519914 1.1413844524787180035;4.8513262411792528184 -0.040780754061808630051 1.959404910337648742;2.587844270859951834 -1.7383444058054939863 0.90894183061337818774;5.1597291218125747037 -0.45195998579838625453 1.6124158466774161091;-0.0070332448662672516354 3.189652348792090919 1.7207969699032281685;-0.25523190359156977536 -1.0711613027000717047 3.6544125508076303888;1.145187221129459143 -2.7264074720641682248 1.3707949021517744637;-0.45141442432395334494 2.5579746986925449015 1.9887293676313415602;1.0562102961431636405 -2.6021478014969083858 1.824673769556976799;-3.1363498523358814829 -1.9620637173609354331 -0.6794105585811148762;7.2113870748646862197 1.0309027009973568134 0.68642740125174606103;-2.0955788911359940485 -0.76003319267128188752 2.9361757742596870102;6.2811884307826426621 1.890806739376142076 -2.5150221858075463288;-1.5417832892220182384 4.2597754625545132257 0.94114589217092126106;2.0949988203730258718 -2.3450963429587052822 2.4521870988839622463;3.6650262430319315854 -1.493679232100233456 1.646392728528240923;-2.3316170116111458732 -2.4490264709318312342 -0.38284573851549741352;-0.2092926375322332333 0.86274643831720931875 3.4037261435448233904];

% Layer 2
b2 = [-1.6052299491736474746;-1.33240792541343267;-0.98492392114100202338;0.64830742025666376893;-0.073226483736616360121;-0.31208798887474697992;0.43450827267283570476;0.92501710956597638091;-1.3946307597584213234;-1.1144520443814449617];
LW2_1 = [0.03908864377142019092 0.25207740588088040079 -0.22095878771991592227 -0.32981739490075467902 0.62503695190308616869 -0.24232282332129542746 0.24582539669455577558 -0.027011895459542589054 -0.035508124868610498048 0.016176665363574864454 -0.5527114118991643954 -0.69732598747087259916 0.25398684294796541883 0.30804136915703689281 -0.1462455497577400676 0.011731392442781211211 -0.28823343637031251241 -0.42788171117033035884 -0.39165203593331832099 0.54763361738709659399;-0.81143568691715450836 0.47031391021271945485 0.24736331451871348963 0.24844277217051480289 -0.47142637796374431414 -0.34158586325416351315 0.12472283820957062728 0.068043495146257459982 -0.71384594406937418309 -0.023730882823508686608 -0.85795255615264365279 -0.3812337263139872201 -1.8999379541228866852 -0.1564916899452366561 0.84332609342664421881 -0.22769204074316631847 -0.43477584968812349464 -1.0910775321471382071 -0.020622753832801023199 0.37459731889124420201;0.17170325331052715967 -0.021919576170685992761 0.41392192748663786395 0.11753692059674709924 0.38722919903399921626 0.13700769990802674769 -0.37269422697207482686 0.37490303916769829318 0.70025858368627724726 0.19252783408063081638 -0.49024568799743722947 -0.20280116947714105224 0.30547737672305669276 0.15608711272639291812 -0.3894255494447591559 0.28391609159201458557 0.40845686434596228942 0.1980564926060451314 0.10335741612539126044 0.34698702072455372969;-0.70194322712943102438 -0.02641633293117883613 0.40625861778910338229 0.55792433834223587041 -0.075673854716756749905 0.14911657273692013881 -0.33883340288532265427 0.87737106296026712293 0.19490788910107625931 0.19039423498900090448 -0.84162108905402888137 0.23499794274767640823 -2.4051869065803468395 -0.5453738922331959893 0.42693582631010046358 -0.10855282357087556178 0.10191417036289684983 -0.36049449483052398158 0.0068888704177787396174 0.37470192460598583661;-0.6103874279790636459 0.51830882049899662523 -0.86163532607115767004 0.010895843644869835157 -0.49384902672812147628 -0.3876335686757956811 -0.74693763142974789471 0.23624717023610222744 0.10107559221927027437 -0.83427994240769065559 0.61629356259977075005 1.3610913800893056358 0.4439196914304439634 0.10821830404450311081 -1.320391922433383991 -0.19923897930781062082 1.6672595174757787184 1.0096034194655898464 0.43165805659025435759 0.57847215195685119937;0.11080648956459503152 0.24470507276228192772 0.20031908035737980289 0.094683411352180488207 0.17027335433899606909 0.10947601687577429574 0.90948823111682364218 -0.14390875568260008688 -0.55730404453572723877 0.052437766398111623767 -0.09957918429218651224 0.85471647074626899698 -0.058414225860800958468 -0.21339914661562242593 0.1792477457042727651 -0.055496788458328019655 -0.41600748334595682998 -0.082844352134288784528 -0.19345088042928826333 -0.22001391004621037584;-0.16397788155713802216 0.29228078370223870008 0.67424837951030236471 0.95166671660463442173 -0.4878181657306965846 -0.20787930274899246719 -0.62925504955877431534 -0.44195402872643341219 -0.70303253383981156865 0.18620186915577890963 -0.39838914915827683405 0.53660816717904413764 -1.2854820173577872211 -0.61896949406910750646 0.66877622396738944932 0.12529417600524658805 0.78965973917219056677 0.50073408933162344425 0.022008952922607006447 0.18903509638210108657;0.39060799985364191844 -0.095667174797878451464 0.31734796355934141721 -0.17285958662489323001 -0.37295734474491476496 0.15700874821522053937 -0.56307392036822756509 -0.38973996065044053116 0.088549281364658269378 -0.21541323286833574668 -0.48446899191878339819 0.40109464772140768218 -0.14872670507546259522 0.16207001872534734788 0.16243673091204458014 -0.12242363787649021556 -0.040579619260438314077 0.52081781710265784291 -0.36689272698384151061 0.060528729465323581616;0.30211293658361820791 0.042877144961679422575 -0.22558867847182750843 0.16983648989058383605 0.33418900638339610332 0.25105971298141899206 0.091819979563756773389 0.28687873142699771289 0.48850051020661083845 -0.58920225830144379309 -0.24960196604433071421 -0.081491859149435935672 0.19138489974970604446 -0.456454152435849414 -0.50685405923940551887 0.12878342844136284051 -0.18583659323412857201 -0.68033244335811171588 -0.091488835054166689487 0.84738441159163890859;-2.2817900782672242421 -1.6070774557460920651 -0.92050548053286285199 -3.3165628154964625907 -1.8557267281902920519 -4.1324782732581937239 1.3066667417435893217 1.0948084031034812647 0.97172734842566133029 0.39931557899131503442 -0.013375317257736819149 1.7080173009027799225 -4.1567450591323868991 1.1464629919473534603 -5.5911964894204233545 -2.0019855096581737897 -0.074295641813858365188 -1.7498949576019482421 -0.83194607915807605725 -0.025908494642719909207];

% Layer 3
b3 = [-2.2933524222834109629;-1.6506825298455187756;1.7309290290984906679;1.7369074862818445482;1.094989341466799937;1.1690629833548829009;-1.2387039246633237966;-0.41069730581676255898;0.57467934107727725035;-0.40088601276317331612;-0.42859848415506085484;0.45086759671295917329;0.58261317903640075233;-0.94760536868462974525;-0.57207941428312858445;-1.5392840101381073392;-1.0407501144368183077;1.3210173744215005787;1.8780085765659502162;2.2616076557201170161];
LW3_2 = [0.73546217624993970308 0.61756423425099760127 -0.60882311042449155369 0.1471309496477102019 -0.46705253487045683691 0.32766270570794830963 0.020476069370623902616 -0.66476772573707398895 -0.047537286597441733016 -1.0160141661519874745;1.1262683531495236711 -1.1138455040955970166 -0.16504579669106633766 -0.018406063863919755463 0.42317184845880312372 -0.73177652323462982764 -0.20514855208725571445 0.35375218942881270223 -0.13599990831126898549 0.12856714957719506121;-0.63690571652073846298 0.61406242507594432922 0.57540721909592840166 0.71332328397711641799 -1.0750799772286927514 0.17228603662754829462 -1.156228983545626976 -0.23435175000003946599 0.36750288573466138864 2.8520489712933545512;-1.2516524550859668974 0.095808188089755344508 -0.98121760626206377953 -0.98162733399470503137 -0.69788171713055258127 0.75902464201009289813 0.75663295634363192388 -0.51550836216160367265 0.27162267901332676212 -2.0556490187670144465;-0.60277565165885516052 -0.1958421457139466193 0.74105824542917453357 -0.81283753900435895545 -0.095575195516946057084 -0.089308990912693772546 0.74743355946990952532 0.48577463013796201574 -0.84011452530778907288 0.60495242635811408149;-1.1033331428891468562 0.32853265247853369324 -0.069903576546843218531 -0.43221520963300902318 0.33611625373186460042 0.39056244145680157898 0.87117772074577970454 0.070985718917458945354 0.48661739274575388503 -0.1667409574044640963;1.4323597900810205452 -0.012700476637509228173 -0.81561379137451217591 -1.1005861740739499854 0.47830256391461067889 0.15676572146515740935 0.46134994549044100465 0.54405395670125344942 1.0042460493068006144 0.90273950407891179193;0.2188445911110761255 -0.45651609037092050203 -0.7976045938988595152 -0.35770770539583224279 -0.28010407276380050456 0.54021006758122769309 0.19517661163763633247 1.0002922684952968435 -0.77059997571477090172 0.88039933476592180384;-0.55509050475567456306 0.091963513973827085146 0.58034399426293203916 -0.6237434775292673983 -1.0049275136098061445 0.4142382690975185966 -0.061743397258765528313 0.63684199101319061143 0.13737338698662374115 0.92460431034237899883;0.95231729547145027581 -0.37398010867948927594 0.74889943723035967693 0.028682429489004013234 -0.66848336472580482948 -0.56120314204162291549 -0.29149876609358288393 -0.70938780332082895796 1.0834687006361103379 0.31755090999075119562;-0.61696885254056044179 1.7063769805840947047 -0.022640441540540789944 1.3251553163597222795 -1.1206189029130215751 0.065029878563110543599 0.53761323881953215764 -0.073899684759665767997 0.87386339496422227313 1.8692663251104537636;-0.9389515775908438 -1.4235858374965497664 0.32363598404305554679 -0.53475464310234477328 1.7747252321900774952 -0.15759277714377642465 -0.64730030484280520753 0.48888742878558522076 -1.0360928007194314393 -4.9146400151787794641;0.43937691585943822181 0.36075963338920902235 -0.68551244227053309555 1.083777855014749214 -0.68023962683167960019 1.0078571577385850855 0.13511968046361347295 -0.66181330830550155753 0.14788509521893306031 -0.5833608876325694359;-0.29649012756395765056 -0.32087336669882621232 0.84571261044078904767 0.78327364220829287511 -0.19296148205053018088 -0.032664098436788704949 -0.53803611070493995161 -0.76609693357959052218 0.14292623450035771282 0.91720567452632539851;-1.1491696755837510491 1.04155494256897585 -0.22729730409071624564 0.15240328572451330991 -0.7804551722154833282 -0.13419691906616382227 -0.94545854676141483086 -0.66070449095960193109 -0.39613548638767975829 2.753248349523742089;0.29539661212215301278 -0.078876007142111251302 -0.2031063426954090867 -0.54424290325855473327 1.3502963307862805298 0.043986986617669560085 0.99404817038294102094 -0.18252855766992787112 -0.32328185875418458117 -1.9095865396292526217;-0.94306866385279275455 0.42871920785790718078 -0.18977728344196564958 -0.53373691718022187036 -0.43067883957456631894 -0.58730889892149273912 0.99267491166437726857 0.74706769490913982334 0.50774632479319503631 0.90845543820980567684;0.4547386779491346398 0.21276192930006304627 -0.57688718165419405892 0.76143356306334764039 -0.90580247275030822962 0.1450368395516161979 0.95978540868566031286 -0.94799896362781821413 0.96103360220846756334 1.0203553445861446303;0.26551111214457395748 -0.37020465745217689957 -0.40180380713985275332 0.59466910331344102758 -0.9922311371195793317 0.29077049050366626792 0.12687628566797651275 -0.13588836657231700977 0.90668888799370239706 -0.73622963419889964065;0.69108704745404292424 0.10382761885383146039 -0.29838818571848135797 0.78730750166677820889 -1.2397422521776073623 -0.31711275625487406193 0.20429649149519468754 -0.40032802558324692699 0.15202096313701710106 2.8470740202696616095];

% Layer 4
b4 = -0.029879816544888842395;
LW4_3 = [0.42945708403994437008 -0.28232785093363699236 -1.4757434921147747353 0.62593524497479258173 -0.51296295298422900366 -0.29075092276726893781 -1.2158468836382316791 0.007824304862644588382 -0.24449326399735582527 0.7714495202602618118 0.81543276159006605752 1.7485844280883036106 -0.34861342755327895393 -0.15093288482430775033 1.1945629392047223405 -0.74486664145321146435 0.11355593500480083702 0.59608636407095649812 -0.16669594798463563401 -0.70316540761433699025];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.499999999999931;
y1_step1.xoffset = -2.00000000000028;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = tansig_apply(repmat(b3,1,Q) + LW3_2*a2);
    
    % Layer 4
    a4 = repmat(b4,1,Q) + LW4_3*a3;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a4,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(4,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
