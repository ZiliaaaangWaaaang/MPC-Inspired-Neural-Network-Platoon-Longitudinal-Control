function [Y,Xf,Af] = nnmove_128(X,~,~)
%NNMOVE_128 neural network simulation function.
%
% Auto-generated by MATLAB, 07-May-2024 19:07:48.
% 
% [Y] = nnmove_128(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 3xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-19.0505965768031;-6.85918092085871;-1.99763696099884];
x1_step1.gain = [0.0522252737181727;0.148213484472979;0.500572177293996];
x1_step1.ymin = -1;

% Layer 1
b1 = [-2.8998462466987278141;-3.5321507267395024776;2.7565419867777252172;-3.0372226495475036501;2.7651232770418507911;-2.2804913209601025414;-0.08156209506078496152;1.9451117527639121274;-0.48271624297032106332;0.43827123119717731337;-0.098090425877987705294;-0.77339302087143657616;-1.1818095905102441456;-0.73215824600325085658;1.079030485490720892;1.8487347919345464842;-2.6693408341572615328;3.0904070480076635263;3.8724183643279697087;-3.7931173409401051089];
IW1_1 = [3.049432181367361494 -2.4669221049565948078 2.2930578609859919581;1.8434893022949063734 -2.8817255723637908993 -1.6087345760471232214;0.19677401939581234958 -1.1600350558884726659 3.9298261626939945401;1.0074119368806979669 -1.9160133648304926712 -2.5731177990734805938;-3.9310060384015437229 -0.35554631163518501946 -2.1819193121158586557;1.5400318414030047531 2.311345201628748125 -2.6830583334292117392;-1.6306485132446739694 2.8456522536165937964 -1.2248303451927811114;-2.0353331235066702831 -2.1827870761858068072 -1.8994976207721225858;3.4132979911180383326 -1.8942330658207056082 -1.3621922638036951803;-0.38644346909872634432 2.1097143191620801872 3.0569417711997020071;-5.5599407365869151221 -1.5937471319158675875 0.57545186816533666629;-4.134430726165360781 -1.4757900512212196453 -0.39765243202905359299;-2.6355779032379738069 -2.4216544960710031376 -0.94696410284227727772;-3.523556950571159696 -2.2557158922060920325 1.2372586561480460876;0.98664517893043379715 1.1320666221453734579 -3.6899646241351686804;2.5283916404706361369 -1.5096276706029245762 2.1802106535161431822;-3.7383536058825130866 -0.15867032420092055944 0.34117641517206298563;3.9489621119348257139 -1.0978866866816425762 1.9340774760418144584;1.4471288153980266245 -2.3889884507935108537 -2.1313688890642112916;-0.78156841397643905811 -3.3676344765416841298 -1.6997591600582910853];

% Layer 2
b2 = [-1.7221371903760878119;1.0673956170085721062;-0.77082738010145479546;-0.50436276035336213841;0.16509789096291593857;0.05111983017031734855;-0.84607028579536891488;-1.0464689857039164433;0.95532752727452863173;1.646732409577438716];
LW2_1 = [0.1722358676980881298 0.39755969272915137047 0.33466033592927146856 -0.12080383230309985065 0.10486418310106417062 -0.24479751743984215495 -0.4248613550935247396 -0.48558446883631328772 0.52997039887767993793 -0.10158697212093267814 0.21804519211596010142 -0.24621281066017783323 0.20120664875651242398 -0.016963494835424603596 -0.48483274544475979395 0.014506008269993569959 0.67942420997557362305 -0.11084023691053618288 -0.082238253323785037718 0.50619504256702985145;-2.4200944072768368898 0.73807655617385536928 0.47841073203420247939 -0.058033001757938330878 2.1255766549431007739 -0.99305540891442722895 -0.81054194016906222497 0.51016606200716541064 -1.6152045847931111311 -0.57070163769977277912 3.7120756380932036222 1.6855416299979981698 0.70472493692564919243 0.35177059733684762355 -0.64341590041014951051 0.99721383865313761863 -0.32885707668533187276 -1.9130665998794964544 -0.17166076890592246729 0.62561212754575856732;0.79716967814795303138 -0.59306477996787820839 0.32859459913578881185 0.15418725908044636497 -0.49902130675734734933 0.20438400732881503719 0.33937750611548195279 0.40957467933779762026 0.68466788944791390215 0.039341598768484309367 -1.6529858190316928379 0.24929643698584191824 -0.80606136862108546115 -0.99739097534118770216 0.18697936513769078393 0.24733892861182049661 0.062847830794030043466 0.91518738524324350081 -0.3995853682705781118 -0.12236209752474710988;1.1484245841441396152 -0.18467104645825963005 0.47881318733778965857 -0.47693553485798478864 -0.30130285673591522544 0.25493613999180919638 0.29135766213695590832 -0.96287451427425152506 -0.48023410931508120347 0.074665883113900183288 0.17898566198117979442 -0.27341989047279768865 -0.21135633538179410262 -0.99552117414674656803 0.59339347875610448657 0.77069335062468902198 -0.88862919056563161035 -0.21543639380464502109 0.071267475409693387123 0.30437487563716414396;-0.73864428678426652386 -0.58480292077648843296 0.04596176957597966628 -0.013351759957466312334 0.82805579791229688702 0.25640602365170822585 -0.47250899856055933457 -0.12507989503833605305 -0.021575711758154113296 -0.15813914508762672018 0.55250962805578340831 0.68581949055590496478 -0.34466715070534226228 0.39325464178003527449 0.12320335705363032186 0.79127261259878101107 0.16166934919169395624 -0.84077147305431187974 -0.38127194554994864317 -0.23770624590620606509;-0.24159890976573503152 -0.0026532685346757171885 -0.16863884788988559027 0.20603181105543275087 0.052165845902161063485 -0.16121532800910148842 0.11904957344401620456 0.97279092145311130135 0.60092172760922679675 -0.093578725711409627142 -0.74255607818839819423 0.4920538796448572505 0.0027926278030513604356 -0.47841998662552082111 0.97692405061146203593 0.7297821851813522942 0.28998474990478745328 0.51053533621487778849 0.6122824496335408373 -0.68429383743111804606;-0.24979508889728277432 0.45501454252606116091 0.84255981278324831862 0.35264055731776910996 -0.041550379688456394456 -0.13774263391119595523 1.409214486176797454 0.49045546218983637754 1.9891003236656050746 0.1102646589286715717 -2.9794248076816898241 -2.4323531189690501542 0.12219619462439741675 -1.3871537161038007824 -0.055622037102696836319 1.0820480330246482481 0.40455609914029450058 1.2262762431943812214 0.14127541220424610913 0.29570279017630274332;0.24997041728705979291 -0.41260835324232891796 0.40842794706700463747 -0.48731280593625264652 0.14551096882791514364 0.066835269070879971265 0.0054501030008472645116 0.07012552968273930154 0.12615651664085869577 -0.71395702026350371661 -0.26436594763371479289 -1.1766494658988317923 -0.79320278168031554955 -0.73121482227853229485 0.47263835292002737143 1.138344094678915841 0.042596093521780023505 -0.7047235854993584292 -0.064008709094976842802 0.45492366479112478217;0.56762637114299507868 0.52149028614673575976 -0.13649160265738757847 0.61763856475286615932 -0.47035428807093504489 0.61643068957636348859 -0.19404681765529271931 0.34539791506646144725 -0.84806315258500242216 0.03728612867277882742 0.22908189335920492447 0.31583912650493783936 0.16946171158640033205 0.26829690726058230688 0.46322419215130550274 0.42116242289226202278 0.34930118310873786713 -0.019826191606518002442 -0.23017000038518045657 -0.3722221306876295488;0.18546033578057755098 -0.28018411733876674719 0.28896737152435914009 -0.52057965457520460895 0.54640278795977159643 -0.27893665772299225392 -0.48049794149276037203 -0.041773819103057878432 0.096390667983313832456 -0.15795450406122765741 -0.49333156489828594582 0.37057753585939784413 -0.19483284127615310699 -0.27621291730488600757 0.1776394902624636174 0.19304397860558206168 -0.46040528683006465283 0.19484317334781900422 0.67595281735691548075 -0.3434451164292099401];

% Layer 3
b3 = [-2.1331529377609124154;2.2554331426274103478;-1.6782149792699654345;1.0640131560991734627;-0.98121332288452578485;0.87095892086160042744;1.0271140531428828435;0.10509662793857554863;0.29299519846498311981;-0.082034858837993371306;-0.30671199923414810273;-0.74271830127512517006;-0.063873685367031335369;-0.60950283421596818112;-0.70833486224145769672;-0.98149105710667750024;-1.7152165919698529883;1.6402106731509498161;-1.7360793586223821627;-1.9007808602222640015];
LW3_2 = [0.22507981692748030289 -0.17617396301774188028 0.41300497330406077401 0.41637955365178580536 0.49877345763930336364 0.27423202892105569273 1.0083250349162875548 0.3185069880186641722 0.80034098125717190175 -0.53401644409890169918;-0.79512580524745601895 -0.44589199716369937176 0.047694254781519167252 0.19570230451332820687 -0.47419819469343310603 -0.55794402940915510669 0.36455050734588706485 -0.32025536710404717278 0.19471155632478398534 0.80365101938276672922;0.68610006603558915117 0.23764338305739002299 -1.1224910795458156176 0.8434215604493806584 0.38057666604242068598 0.15018378410558358427 1.6083668785599913864 -0.69444535622327707713 -0.2310120057354843881 -0.25232963890160020615;-0.032794234075196847245 0.54077541254044947383 -1.0464289303321390179 -1.082863553994146022 0.028808582715163955079 0.60288185312953945783 1.2186716739191847392 -0.62638754642752403345 -0.52213126726448022552 -0.68380693449695817421;0.18253519374636045791 0.24176815223347147832 -0.49812021624263647102 -0.16007767140768025538 -0.22025666458289372418 0.55059478415207163682 -0.30337460285636896895 1.0509055016691835061 0.72199349155848258075 -0.90478531811831208742;-0.29341174548147430645 -0.63936574336292517629 -0.81063659613296179529 0.90930613300411733402 -0.63276484112414776995 1.2766532345225862777 -1.0796219351360532013 0.093551472376422320498 0.38522442102078474635 0.64817572030517422998;-0.80253448418195894032 0.054750296328167871729 0.0089755057609862652634 0.6055029207024400506 -0.10133245656408053359 0.87496974463499233021 0.32445684172862682138 0.71075229494427760724 0.35460121883839601509 1.1384431717251715099;0.089051061627989008818 1.106465940367775902 -0.22883534161253921146 -0.022158428372152792069 -0.48762274403479832774 -1.1161386877682353269 0.28037607622543692099 -0.25231782409714870186 -0.23951530346911995006 -1.2329063759578948734;-0.42266633624778643386 -0.75600050896423409696 0.66935104384130250654 0.63848199122861593047 0.42448123695770312302 0.6739629622549648813 0.65548614631844792644 0.22520265248208096165 0.64540784286086427812 0.76966219579468908574;0.98011882127309224444 -0.66539110213386232218 -0.29570362431623870014 0.86962515278555774234 -0.35545570875568843761 -0.46726045673477784037 -0.026007634508491958569 -0.4397511261352780032 0.35313676280460393198 0.66071218666720965551;-0.068531808845457661827 0.133009981672322114 0.30211880031147370085 -0.49323160047099617875 0.48268735982638383275 -0.71751066748647651661 0.74450824933444570419 0.80760680228584247331 0.61332181724832235403 -1.2142244980938043941;-0.74019441575656841348 4.8484351241892991169 -1.0564548768145187729 0.10736522638303239163 1.3651680742140495095 -1.5619842383939015473 -4.2682801585865712823 1.2174967133700287381 0.90165246106036156526 -0.064665804346147839898;-0.69663831051898228441 -0.79265710579162507177 1.0490949883796050202 -0.31275419258244174792 -0.21477397294961170227 -0.063285717386752801672 -0.75020106685518539447 0.089388868871809828986 -0.76445640110223589403 0.49602261905006433951;-0.91663180126415599869 -0.62618639830078592912 -0.4295836545098961623 -0.175695893247688667 -0.24106829409107893847 0.30140546948971469465 0.4178387184645931951 -0.95186656964235971667 0.80458832829791471219 -0.51775897410380955499;0.0025112883783749880007 -0.49486642994615187563 -0.57038625037355517033 -1.0301239747304979932 0.41537013282390433666 -0.042799266203993324709 0.37350068484905357691 0.068065354067247813008 0.7898475737545238573 1.1690615619391044877;-0.28247436231206407564 -0.68808818423981521484 -0.0096898995516212366175 0.64413396748556439597 0.36047430400426672126 -0.38265540709010625875 -0.45869501317989025413 1.0927472873707890777 0.41018685391767656379 0.58181660734273088487;-0.020021644196330044135 0.43687597496909696959 0.3264204978578127414 -0.12044063883463031195 1.0414137541925700958 -0.65741043260361697875 -0.24001225281439830805 0.82013469371946101649 0.29284228466941952806 -0.67171092962656409053;0.081846338956216874161 0.37359225459030648286 0.045264367245783712623 -0.76923960191593887536 -0.67405946382783732407 -0.40202962285457954916 -0.77802274499398194063 0.97494763288966734827 0.31978945164617511576 -0.60026172895440965682;-0.093023582713058647342 0.70368697056776430276 -0.43062160779952662892 -0.48742734811809190765 -0.20638032581160642431 -1.4431536442659422814 -0.1956410916109706799 -0.1331870686096706391 -0.34434417891980523274 -0.38797018722933818147;-0.58298503498816145463 0.20770295557406562303 1.0747502751889794759 1.0981323274151681968 0.17478817299238441629 0.39063434977151639815 -0.37386746923534347475 -0.060614633715301124983 -0.68418000673906975706 0.61623162617313198552];

% Layer 4
b4 = 0.13678194322194514587;
LW4_3 = [-0.32664474614244892736 0.22117080835945496231 0.94454026323051054614 -0.26046038371008911616 0.49453128460608786199 0.97444948760468708127 -0.20798514853480393194 0.63351913224268108227 -0.034226935027832978975 -0.089768490651200405495 0.40771757233512123664 -1.0437581931735615548 0.0065005453249222210077 -0.02905954836186266585 0.26831158995505782761 -0.26292045991512547065 -0.54147722939975895251 0.011964547075990846284 -0.40222890514953052454 0.30202670026686689875];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.499999999999931;
y1_step1.xoffset = -2.00000000000028;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = tansig_apply(repmat(b3,1,Q) + LW3_2*a2);
    
    % Layer 4
    a4 = repmat(b4,1,Q) + LW4_3*a3;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a4,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(4,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
