function [Y,Xf,Af] = nnmove_129(X,~,~)
%NNMOVE_129 neural network simulation function.
%
% Auto-generated by MATLAB, 07-May-2024 19:07:50.
% 
% [Y] = nnmove_129(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 3xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-19.0505965768031;-6.85918092085871;-1.99763696099884];
x1_step1.gain = [0.0522252737181727;0.148213484472979;0.500572177293996];
x1_step1.ymin = -1;

% Layer 1
b1 = [3.8576668340599984397;3.2878675161714703279;2.6996306488189851791;3.1369037214249582135;2.2125484361666565292;-2.4874245802914125569;-1.657688262083377273;-2.7682699038250748735;1.3416755712273478185;-0.32762758452926954433;-1.0341329384358812771;0.49088829114723070424;1.9907138849314192086;2.5576989192949488583;-1.8286277761875293635;-3.098698974143419882;3.3646602564347607434;-3.1103449613848499489;3.3747291578280416147;3.4387563492153292444];
IW1_1 = [-1.7424812958010627018 1.4083532311161681694 2.9839936975403693609;-1.1146589154128547783 -2.7765689205704893183 2.8306843465959219408;-2.3706762230645135325 -2.9469444326184968119 0.90564633308423925229;-1.8019442680946808899 2.5245122363733094595 -2.3943120921007645663;0.22253980153769933881 -1.493158906158570165 3.9269132228101524262;1.5316426142513179798 -0.28908680998298291742 3.0509330396105815986;2.937090087321791998 2.8915737279124535952 -0.97488703426165113086;7.3741809853299926658 -0.34914170567526997546 1.4999239581348728922;4.3177652633249463676 0.83387570702490898533 0.65140686849150852833;3.2538154536975332221 1.6029889994494646022 -0.19970316010870886592;-1.3516425183202966931 -1.6142852667101355024 -2.6500157591911692734;3.1017553066235725723 -0.67389931283064141709 0.88162573117734432948;1.3757523387929337932 2.4540833314352612504 2.0505068737702112358;5.8107262755873705373 -1.4827277980549571357 0.91536264565832614615;-1.8308551045420928816 -2.3846338679624077272 1.7973368485263336858;-1.3673687807098129365 -2.1648550773158574678 2.3139026320965472294;0.69268618541591320259 -3.0608225964372453021 -0.41226973079581297199;-1.5714793734560004168 1.219288763750847604 3.1491217127296251554;1.3235684925355655217 -2.8528798685351621778 -2.0545360907172312004;2.2282211457329763604 2.4161961840319943207 2.5131343413905340434];

% Layer 2
b2 = [-1.1499708377515591717;-1.422698650653253738;1.2105614648233997688;-1.1048222486692436117;0.10038916837435866991;0.03573998197322792586;0.65416202286646163433;1.1272463025386592061;1.1729607302837705696;1.5525213097173007348];
LW2_1 = [0.93576143283145940543 0.74779903474240660977 0.24612312466865421401 0.2113975091355085878 -0.27652759988639108446 -0.10075559880414615421 0.085487805006753778136 0.70832289653769242577 -0.020466033224774318744 0.080671908945298007043 -0.024056436257392510569 1.0998371813059109048 -0.30030276793987792372 0.023996378582231969734 0.41297768893236280752 -0.38562404562305896416 0.39149326359938135811 -1.0194088385239596928 0.12369664462435976671 0.6091359346757514448;0.13610328819482631069 0.026522143174234839857 -0.12651173932585474402 -0.019114842906606276107 0.12138744487603152222 -0.12994906432824160358 0.15342295607623135378 0.44344042119342902408 -0.081217698799499971063 0.35104414097864766742 -0.047591342937188141349 -0.52568176000986188701 0.49595555800195095797 -0.51146359157226783942 0.33206556250768048955 0.37341305039648836628 -0.10760449488724288525 0.39177715025617459998 0.068504436836173326908 -0.37996199301105210155;0.1429162853388451504 -0.53936199083937508281 -0.41798165498162748177 0.27199050444447914199 -0.15453809641611832015 -0.0036826254267959650235 -0.37068082141223718251 -0.75191543590705534061 -0.27427412755725560922 -0.35262480485018926624 0.69087909191844087964 0.63548486322504593726 -0.534135024696422267 -0.2202848550663868421 -0.062124215674302707413 0.14266488361426796216 0.021506332652290585661 -0.22168063259929232656 -0.002381943979836757385 0.53788214919320342933;-0.11709804679890685464 -1.2044819410768932144 -0.75156440825150117035 0.39209217160509612921 -0.65083892114240782245 1.9458990913730760397 -0.084411384876723977166 -3.663302983531819379 1.4988511761398921607 -1.7977653803447435354 -0.036764337660751940373 1.0995410239067413549 0.85456148485414262783 -0.18680575287334683088 1.2116528314099690444 1.1235051811869569693 -1.0716261758651650648 0.80076583518003197071 -0.10161747691658841453 -0.087429718555507254796;-0.54599428553777584749 0.15084684168417628047 -0.33815844376795556325 -0.35707473508112702598 -0.11128720015708194746 -0.053205288431801063542 0.3700904527304620939 -1.4030586565874907379 0.89973412135944841328 -0.2823293457721319788 -0.18751881680661600105 -0.23489026487186867587 -0.19299508783402996581 0.097657708849524252348 0.68897082924647856661 0.13783104609320667722 0.32165735246335508402 0.044901732015820455812 0.078489053965813765368 0.010579648771785167549;-0.027201842530631056838 0.56634940581508330659 -0.083476694898004688561 -0.42420007515099678042 -0.61793702414828732827 0.73001811679769923469 -0.44616831649227195467 0.30207444646170716895 0.4586498916904324652 0.678328310466523976 -0.76540172506077130965 0.24401322300217714867 0.503736065289165591 1.4090923207870162948 0.46600598188798586508 0.47446352487453474778 -0.064541708130362376861 -0.36772576492557224048 -0.090008388098197181226 0.4165985934903685961;-0.38140587555697358368 -0.9666604080854587222 -0.70640860106952518827 -0.60177515181473972827 -0.48806902741398672241 -0.64703839006195584815 2.1627245979215112826 1.6997903190475287527 1.9709642368490181141 1.9398469901141550675 0.14294766663433913778 -0.64266683543584779414 -0.94771186039300836512 4.9713009948560564766 -0.62970479407457558008 0.024486453024348868446 0.46306815347865121213 0.55043788247719349638 -0.21865143978447917905 0.1965669166870402107;0.36038217680138101562 0.36742051082811150176 0.046542258980898171261 0.44246681963608736066 -0.079405857862388934398 -0.38658124160526358137 -0.76672407467175396345 -0.61692149551150665676 0.19205153573074962292 -0.61573276847024571712 0.40416049572756462815 0.74372062972225538857 0.3374349192400224462 -0.3033427337832478865 0.0031346452898435750618 -0.56107427950341381973 -0.049257361462310557398 0.12117593388723567338 -0.24293611359314190579 0.77004740827543560755;0.3930401145493668813 -0.12817119908833587982 -0.36051808109019434223 -1.0985214978764616944 -0.13971996927267590904 0.66158722574068529187 0.27783228086976563542 0.7522382173129791294 1.0819232132733278551 0.62049805594682982957 0.59447742872979736362 0.1639955427844768665 0.76620563173804911994 1.4306559873575146469 -0.090756041534626352707 0.33357934712784775844 -0.30021463856991104091 -0.31465326041678004509 0.4731424055222662739 0.17479785082875959334;0.41570566209971843152 0.50978649264663178364 -0.72352625851023899539 0.7279977155220926921 0.12500114867648023931 -0.37082479393543527069 0.084982048987203129276 -3.0968401694453557838 -0.53493158594820899854 0.20552312164259123328 0.5381106618803378483 -0.36171186219042267274 0.40607881717815719202 -0.35569379796081246337 0.70255889704227314496 1.9243349575482531222 -0.13708365864391683364 0.12249114624383944383 0.4443917113322965462 0.086799859421435976436];

% Layer 3
b3 = [-1.885504727451004392;1.4641201635128899827;-1.3796401269514335652;1.598088534755537804;-1.1566486762601047023;-1.0160256649357446435;0.99291042506778770527;-0.57163518170478333502;-0.14676016418153609022;-0.077659786844943817785;0.31165759591026348518;0.79994217921258381487;-0.53603170609037764649;-0.7471042417512087086;-0.72004270045752982732;1.4250252276763804016;-1.3508174882390826532;1.7878048446359495749;-1.7722509061472211389;2.012421407799337203];
LW3_2 = [0.15435029689934376407 0.71881342765213318557 -0.17760370224081498125 -0.26280776670375050053 0.42284330738136727268 -0.68219265825692121386 0.55456357638391207132 0.098910145499121818191 -1.0737176099165992582 -0.89717064064211371477;0.091826747871575756244 0.722143441790722318 -1.0265641378032512865 -4.4296162988442224773 -0.42552858509892055316 -0.60822921413334607443 1.0548739468654999563 0.51304501037618044368 -0.859658643228299435 -3.575999768824134506;0.88492135014006045868 -0.68851874179856586977 -0.0055348586763571691952 -0.91682398155967370634 -0.14728915613941093166 0.20310440271666863055 -1.0923582937445981411 0.89698276293540546433 0.085217730220336296298 -0.56821759179150976848;0.042664524199167025431 0.6975947786960486896 -0.62124474688030328906 0.69284870515015861692 0.34171162303549607042 0.12113491876823045956 0.8930229495501965653 0.41333305143715859398 1.4553794254513570117 0.55105879522434619844;0.4382236406977570442 -0.70611194100993968092 -1.0465707608446115362 -0.84044272402404573974 0.15059316698719696359 0.25114625441593496635 -0.17705829600703207327 -0.36858678374126147004 1.0919842663598402499 -0.35972114871852645113;0.15302532298041271464 0.062136359232740509539 0.80601908257489007781 0.58226741482271093808 0.68392992036954414203 -1.646041788339428491 2.0089878146266255676 0.47021043382322635917 0.55982320570194255005 -0.5327654527652683214;-0.14753952110194187841 0.62006221801388217152 0.66707869900714589217 2.0123682606831412301 0.59270141817902577408 0.66387761861331118229 -0.5031556426079176747 0.82151176265239500562 0.5484717696065972703 -0.55350032822533989929;0.3897316605639082332 0.83240144382119540811 0.2338060341002805298 0.59622910863802469628 0.4441490846649606139 0.44291072193624464459 -0.28378249963345458795 0.56742438952441165423 0.71946552294609300571 -0.82679603889280905982;0.22690150451338578219 -0.14904555494847299135 0.68387954049957688785 -0.80495516266080457957 -1.2086285569437227316 0.36811306737624305274 0.18516889804388722562 0.804582837642140003 0.57350323183064066956 0.36087436122965477203;1.0606377614834949785 0.20054923407547209369 0.18835291263047396204 -0.80917045039434531972 -1.0648619143022033384 0.33086402790590652145 0.32422967070796698819 0.46265222794679267126 0.20585915800591336744 -0.14017187659898000529;0.10158279538110612239 -0.3256754772085878602 0.3306737809263492478 0.26164142827211817055 0.33208616751336350603 1.0647273722848391575 3.3299675915337267895 -0.84403876743636541136 0.86968437673819498634 0.79735985852112900574;0.67183568023944484349 -0.24008166627855009878 0.56309615428924830738 0.98376852894148192341 0.086019448399248882309 -0.23743567910160631729 0.30672570223626011154 0.34670050337468788504 -0.33733607410103139124 -0.51064593313864092838;-0.5610526749409148195 -0.80484678776498264074 -0.18541167031337676963 0.89492797327456508061 0.65634953849906141343 -0.08369657212413857128 0.32725456494350113612 -0.91652278868589698302 -0.82557926605583842328 -0.25272579417538598712;-0.68396882268719705333 0.72666486252972184445 0.69116370415698669127 -0.78213225783877404762 0.30938056101317062963 -0.18394609975643033684 -0.27728070800579401878 -0.0087652767734511752989 0.041059602670812149483 -0.89348916302006098356;-0.71295126080261217449 0.29721485245594531088 0.31405107459557241034 0.12045114565097209125 -0.4171605574855384857 0.84815291653256441595 0.72507057130076346674 -0.97582804889677288163 0.88708423602855701606 -0.31038557285327905699;0.41246740163471606877 -0.32974995832375120219 -0.08578197936310176519 0.90560020992088874348 -0.2226574492123038207 -0.62891151238408826707 0.81482997114136634931 0.32835165756801731884 0.93258799170312789428 0.2681286540128900997;-0.47081873351205266731 -0.70390918759574772068 0.28579226091622911277 -0.48158359198036299054 0.39137182266278669474 -1.1737363632280830572 2.4208728355985984493 -0.7101716911066909832 0.60337904265608888199 -0.3458931871009516823;0.86533781240720930583 0.32230408466085541663 0.35524571707994812009 -1.4226234440396112735 0.9138220790926917525 0.46243587515007167354 0.61956147240279224597 -0.12882545133311612551 -0.55710821189180947943 0.19341930588970665528;-1.0121924810753377688 0.46767293843921919905 -0.235379863109710874 -0.19224879664535793333 -1.1195567537747868059 0.76418426719446341799 0.276743596535513392 0.50039544171368222081 0.5653201206026226 -0.21532874898004203401;0.81481507599659053209 -0.74101311431990413148 0.15989749661870680808 -0.06165557765122275935 -0.058511272741058308056 0.71479787294029117906 -0.86483548366557494447 0.74085817437016365794 0.025114588316037751714 -0.24592935869784951497];

% Layer 4
b4 = 0.48510132766701435925;
LW4_3 = [0.82789875574535232161 1.0859286798614007363 0.32673643054296536148 0.41865017440940316407 -0.46808419964217445886 -1.02132338820316515 1.2201194218840798467 -0.63220279368584775259 -0.65094664771417731775 0.35075617254999885697 0.49741234835068082187 0.022660287995626929303 0.40121859441594209805 0.56183003042565549112 -0.65668106501029521738 0.23859020226137789278 1.3027692023646875175 0.87101309629016787639 0.48871625451615768876 -0.75956416395597947666];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.499999999999931;
y1_step1.xoffset = -2.00000000000028;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = tansig_apply(repmat(b3,1,Q) + LW3_2*a2);
    
    % Layer 4
    a4 = repmat(b4,1,Q) + LW4_3*a3;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a4,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(4,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
