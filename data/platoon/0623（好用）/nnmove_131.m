function [Y,Xf,Af] = nnmove_131(X,~,~)
%NNMOVE_131 neural network simulation function.
%
% Auto-generated by MATLAB, 07-May-2024 19:07:56.
% 
% [Y] = nnmove_131(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 3xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-19.0505965768031;-6.85918092085871;-1.99763696099884];
x1_step1.gain = [0.0522252737181727;0.148213484472979;0.500572177293996];
x1_step1.ymin = -1;

% Layer 1
b1 = [-3.6380066444346677024;2.6074476912376720605;-3.3356963917250066487;-2.3294038077129539666;2.8329833521860914303;-1.7011582845591852742;1.8338278173707496244;-1.108503120176207668;1.1563975367014305284;1.4578032120482866674;-1.0476322363618857381;-0.56739006727997387536;-2.5432275743604222384;0.14792865584598727247;-1.9829981330954977725;-2.05091479452211356;-2.1624237079500758796;-2.8025591513223133688;-2.604795619872656065;-3.9617491101133510689];
IW1_1 = [1.5284017428496139424 0.95491982679393405675 -4.4661819054384483962;-2.4451264577570155367 -2.6350222789951502911 2.6115961595030179332;1.8195316096292108998 -1.5383197598252724703 2.6587670001043890444;1.7478859899434111558 2.6320281114062584749 1.984911278211028085;-0.89770399707043435633 2.0426283559372890863 -3.0839149894649726669;1.287054769386813069 -2.7890514738537870443 -1.7524706700741548016;-1.5778331810317083317 -1.9443506325287596148 -2.1519579220523756824;1.2904169305515946764 -2.8651430062908169738 2.1959876183451965126;-3.0481586363418222696 0.40621455692788033254 -2.8973159748876629038;-1.7635660765917096082 0.49077722770268011887 -2.7802215157635719045;-2.4828528131274909541 1.5551573462732981579 1.667325314837571737;-3.0178406242434818729 1.7208874088521319834 -1.4237254242363601708;-1.5976922612557589165 0.015696616997845243974 -2.7434605631115482893;6.4332050014933965798 1.2372222036988620442 -0.72209916591250578044;-3.2233223910598076678 1.4280649358324495335 -0.95205502177430545441;-0.91834847037360178845 -2.8686413036330185022 3.0148796753019349026;-1.9318052580360380865 -3.8998580514662504193 -0.75612001267014650185;-2.2465165762364613933 2.0483985676191522884 2.5180311008084541591;-3.6243155606436530114 -1.099224585502495577 2.9530769159386083267;-2.1003932136929570618 2.9812241608803340398 0.50312550131802047382];

% Layer 2
b2 = [-1.2717982500790121492;1.3162507153931610748;0.87380865290677856017;-0.32432147108289144377;0.15832471803339753791;0.75772237008975529271;1.1476253807693945763;1.0045632752673319121;-1.2823718391590972487;-1.9180784257690299821];
LW2_1 = [0.9029492201864702805 -0.26794163331033499231 0.94117026643138756992 0.009911742124075268584 -0.83328650510195279022 0.31135308248162413269 -0.70162958108267914348 0.74535681007959608824 -0.44973839396475767671 0.50669963969086828648 -0.57778908651452876022 0.42372274147605204497 0.07821484193959207798 1.4448019922363839473 -0.77831580043378978395 0.44547029617973660232 -0.16568668916871392982 -0.40323431398467635134 -1.3071683998837508867 -0.72660413043032778813;-1.2480545666498035207 -0.20800806279209110849 -0.4296597293724618849 -0.015519109852422956555 0.23643967948451963257 0.16735741891352207134 -0.29912400079526396679 -0.31452407597054465871 0.28197193337053577666 -0.35695370164557332915 -0.59705906019145982278 -0.43923109672265409076 -0.90720006429365174228 1.6298413760914269854 -0.38770159161184675201 0.76108067385715205688 0.26004189769499086449 -0.041491288422696892546 0.5628465939188045386 -0.41463534503753546323;-0.067713482604901328865 0.2020566127397273315 -0.1900429744443552782 -0.061758124127000137149 0.73569738715081289815 0.29136639743187003893 1.2806209316699830314 -0.40679354399458506064 -0.2288791569793292846 0.58642193087660476891 0.091971610169671494384 -0.19336474846178419718 0.34799785391950810443 -0.011136766299491642623 -0.3833810041091726406 -0.68519004624072432641 0.075858948703504069933 -0.11423749507451799734 -1.0710499780370934531 -0.4214514761125066622;-0.050996290711236992588 0.71748767363862986368 0.97401948781609459793 -0.47887867115804805263 -0.17430890737470067231 -0.48261239822288853896 -0.32337602471123816361 -0.15655638160976773077 -0.053717318038611711062 0.087750486858402074186 -0.021015449794947554246 0.84216476069353052303 -0.23874358276127838341 2.312534018377670364 -0.7241474968789505251 -0.445621577408026881 -0.21917701117843016445 0.57855424852108172651 -0.4754420670244035585 0.34867822352190563917;0.005202326225703709367 0.13077127530663515409 -0.048575822127331351463 0.33547434892467725698 -0.50134343110090284767 -1.2860931794440602083 0.40779354096498127147 0.19426548853521713456 -0.31225595112466852932 0.047449011124577701592 0.034080705938872218885 -0.010595674505662448783 -0.091568105557509632542 -0.27991735573609016763 0.351752668149905523 0.2265716876011908687 0.16681631172667488183 -0.40181293997179656774 -0.30810244255021457249 0.45699531023688261255;0.3238823839383448977 -0.12928519419125031331 0.20110655597158202945 -0.084462843220365541042 0.29033074964204119706 -0.69020987921062759707 -0.82511320210945360287 -0.52094695168084348413 -0.23489065622865906713 0.34179942414282687979 0.70281873197088295946 -0.082903832334772692425 -0.73259575934463494473 -0.85027178028788030772 -0.060687687372422569054 -0.65552322932434747838 0.19649558438590702947 -1.0598743505717491686 -0.57616173216856714223 -0.84440058049525390516;0.25177365886875890943 -0.36354902402240535375 -0.22066522130399449098 0.15060374794504799434 -0.32367770050162408824 0.29703299978620240074 -0.20132262717832299925 0.47903906416943353719 0.93990629528039559837 0.69138324092387981601 -0.41275126191460770331 0.089709558001183839493 0.27076313186444123104 0.54833105113996272184 0.53163847646293016513 0.1535973910814603105 0.30623177543828988822 -0.83934275152435411371 -0.44047716977756273815 -1.0769447745636067104;0.47239719943228830612 -0.088940278310074089019 -1.3233351072384191838 -0.52870233220280948849 0.95092081324374178042 -0.46785178639244284771 0.37485245111215409475 -0.040687223970333613599 -0.20258690739590151653 0.70993698510084091158 1.3713302898893873216 -0.20829765260100524538 -0.27181282190354960626 -0.9526464818479513097 1.4081788587920667233 0.20047398666918381238 0.279607766626839227 0.099489728912044522735 0.51727385627226729614 0.16576218940042619643;-0.51526738482227818494 0.75780131397165162443 -1.8702291494372873526 -0.33791118746378162596 1.5027495593364916804 -1.040244851578738583 0.73371700913215609496 0.24838697639657916771 -0.44306544902720274015 -0.55679812710957798938 0.020615656423698152516 -1.1106619790079195198 0.14432426911264342739 -4.4349720356578119507 1.6538836234912213108 -0.72690140925052726395 -0.57685373440272191825 -0.35920353314373110187 1.2314987351632391555 0.56249868938366398563;-1.4454212871970222309 -0.40750721037671666647 1.3987150473509100124 -0.87054071049365100432 0.0075018672439026564888 0.57964118006228226854 -0.87401659940781184499 -0.42381611473011809865 0.42737930798487350215 -0.24522473576095582537 -0.54642294231081844913 0.1547797037974550094 -1.2927644265230178178 3.5888400640877269332 -0.42592932157253010628 -1.3848621105854519442 0.44994207846418998731 -0.43290618548748471817 -1.3214915393190758142 -0.35992635564838404427];

% Layer 3
b3 = [-1.9821400357174694395;-1.7426947763741023056;-1.0984969919162148599;1.3729849116709733625;-1.0596775051713038795;0.82390549828788428588;-0.55199959453589997338;-0.097776767210551188136;0.17504535616921884644;-0.26082150400212350538;-0.080300475699330811641;0.18317391815883535267;0.31685627843458069597;-0.8893483731682526594;0.7554687870693759244;-1.170229888347708247;1.1641863205372762202;1.7232058626276236524;-2.0462760033363371903;-1.7667744070722717353];
LW3_2 = [0.088089510267525289455 -0.84641124779903009756 0.54593220952862997475 0.3850228135571176491 -0.75867329217553203247 -0.00095238375281227563053 0.76780757266192201094 -0.19500214917635433354 -0.88503469419361924242 -0.61360587742887640061;-0.063363792457985290696 0.71819557552417845336 -0.3052605741057759503 -0.6776067554541742588 -0.77988662034124112132 0.36696638248167406937 0.10722942029107539186 -0.66185604943241915787 0.59534772005374569925 -0.94081300118306232516;0.20959409856940303118 0.40133074126743012444 0.59939520233585252829 -1.0534368251888086565 0.63366693900195147915 0.18463627103095114901 0.020678585596889002829 0.83492992456344261587 2.3070872898723964184 -1.9028599909107155597;-0.53234059083915774568 0.57475160154163151827 -0.25341934924249653882 0.2982021032634410429 0.4927830310972448058 1.1118217339144147449 0.92399330944240065655 -0.15158325541019385119 0.1627034339495079529 -0.67152864381022459028;0.6748864128772292803 -0.53244578155794985985 0.6819558283717017666 -0.66385813918640179665 0.55124307128096416974 0.38999589861305228311 -0.86231539119935873838 0.53976492909964324252 0.4611252547652398559 -0.67685688525425857787;-0.75812219782256884404 -0.61828392290843980916 -0.76337109935675728778 0.24534633135266906145 -0.11195646843193941822 -1.1257780282256124593 -0.56052223692507585628 -0.082950941164159852637 0.39089395726682468757 -0.066214054696265456368;0.77594032671819235247 -0.0027581360250126694608 -0.12238987846037305274 -0.71810775601671550383 -0.21046411859681296574 -0.91505157988818464077 0.19267300260577360782 -0.031473095329315706192 -1.0226280030187415715 -0.72600531169947635224;0.17987444768951160734 -0.41577798109030811302 0.69634747793748796862 0.53293214855756676496 0.53126769568317810943 0.81099185858835498575 0.93362448951922338836 -0.90427652679524539447 -0.27665220775580379176 0.60374735972974469256;0.35105282062042575397 0.95106969019098908102 0.38231798331905347821 -0.44653934353629037846 0.15742483963992032203 -0.071723130162547513167 1.1136121687934847913 -0.090557896302649709686 -0.9431373495349065772 -0.65065814196976456962;1.1383051385209927986 -0.25697878043298716388 0.70083815612566147113 0.30309964750784529341 -0.29206261398045424427 -0.56908570570235783581 -1.0186610015520802808 -0.4966939418100045911 0.1257138556872710311 0.35721968380401264431;-0.60661243876125747754 -0.1453543999327512326 -0.64355315126053713737 0.7909659875995492806 -0.75625776349458839753 -0.81699096046519648073 -0.27209711745183440268 -0.17979541159531484129 0.89896691364531544632 0.20575491519790939376;0.78852151389927116476 -0.21127238040133977659 0.14106675956895872726 -0.36366560737755077026 -0.014028679415748689444 0.52482836949478195443 0.43528613359287909867 0.80032523594790416777 0.82280044945287422742 -0.35604089314182868486;0.59042180325863591328 0.63950254804356809757 -0.9484943876359279713 1.3591929881925151058 -0.18212032253995988351 -0.045466662150901782091 0.83335250354612000478 -0.066777763071523943417 -0.97349171247208754476 0.81086404287147906267;-0.90607292284560070339 -0.66599943333235234189 -0.34327452044853762336 -0.0820436337916691516 -0.39386835018962074173 -0.57015298416781112767 -0.60506338009619908824 -0.67164858274152205997 -0.5631458177590220604 0.61148499164021274943;2.5143664255156354947 0.6888249524230714016 -0.51735364430103825129 1.7250254591268134874 -0.96623513292061546931 -0.065312646424425524483 0.0046732465041678808784 1.0069072331906612217 -3.9199306258517196966 3.5820244014830535662;0.086237647089020125213 0.068857893379552684299 -0.643024789260539964 0.57837285080690403749 0.89642586577115090929 -0.57711571121610427682 -0.78966545482629868502 -0.31610858368510624805 0.15750468727032207461 -1.0287824972416961256;0.92973623659402360175 -0.3606318756399443104 1.213629008259287323 -0.21613066144545614589 0.27856088277983814816 0.21560521126685133764 -0.68163807686562538635 -0.00433301867075276681 -0.40586574102410249987 -0.93881399301109103028;0.69789732174740315429 0.77368025289762798469 0.6295755755753367211 0.83981013536269721875 -0.67044650194368804463 0.25900070536870523075 0.21378528007091701646 -0.50763973453328037344 0.48369600617148050814 -0.23823189813390718839;-0.32760059767200844227 -0.16458446843906160417 0.34824254739660603919 -1.3965480870818580694 0.47437592117042570727 0.68015396128326122138 0.98357153863177548825 0.043175801342113968861 0.93810939046887875659 -1.1949654519027803623;-0.29223923762880421595 1.0317030272252853962 0.37314671867539211947 1.1178756551607267333 0.93167777017465325251 0.21847307190898365703 0.13040622766039652869 0.075907051175247292063 -2.644720979737662514 0.41161321824169505579];

% Layer 4
b4 = 0.22764159530257874198;
LW4_3 = [0.0083385819035068156624 0.0013569200650122531342 1.7496775330466374232 -0.26299010278595363888 -0.015994124202457327133 0.047767772315834206021 -0.0033976642360030681091 0.0040732926281141813851 0.044699304920244743722 -0.0022245404902180641697 -0.040846835763468737623 0.0034503604531389967837 -0.62620244495394339346 0.0040966883824582519397 1.629035574038419254 0.0088733326427131182373 0.0020969219435729856589 0.0046918019656337446241 -0.7381915403518057861 1.0016351537605217015];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.499999999999931;
y1_step1.xoffset = -2.00000000000028;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = tansig_apply(repmat(b3,1,Q) + LW3_2*a2);
    
    % Layer 4
    a4 = repmat(b4,1,Q) + LW4_3*a3;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a4,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(4,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
