function [Y,Xf,Af] = nnmove_135(X,~,~)
%NNMOVE_135 neural network simulation function.
%
% Auto-generated by MATLAB, 07-May-2024 19:08:10.
% 
% [Y] = nnmove_135(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 3xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-19.0505965768031;-6.85918092085871;-1.99763696099884];
x1_step1.gain = [0.0522252737181727;0.148213484472979;0.500572177293996];
x1_step1.ymin = -1;

% Layer 1
b1 = [4.168318565530739761;3.5582429152475598677;-3.4466355502750385398;3.2947698584518652076;-2.3397272549066512326;-1.975381339743628839;1.9415598219809790947;-2.1092085529741368966;-0.055675078841200743851;0.025986418779751239982;-1.001389895997724544;-2.032277209950104524;-0.37721250637392211846;-1.504812417700053695;2.4527171180852787025;2.7330558684052630447;-3.285292011145935831;-2.2282226041293631269;3.946893069393345943;3.3881610919350553246];
IW1_1 = [-3.0301661030081832315 1.7903176111912895152 0.22049139765357753107;-2.9615865946189185998 -0.30622275843723228972 -3.5187752887265535406;3.4281966672605101998 1.2330117287844242213 1.4580587505030373485;-2.3146816886544860914 -1.8040051064641717815 1.6521408222067366367;2.0841013882049259642 3.3118163434243030885 0.33797746945617862524;3.5731417471641857553 -0.93132123623768037213 -0.29871738172183615045;-1.5321457460076828294 -2.5606420437581904892 -2.2844440337079063852;1.467474965525791486 4.6617175243841373344 -1.2991550694675424449;-8.1865868024713499551 -1.2809157021208303906 1.149793729295423228;4.9564116320052820086 -2.0409536116195559075 -1.1061442061389785696;-1.1368440587968111632 1.2973432181664226182 3.133410518481044793;-0.39704591247353493433 -1.6420615696039784215 3.4218675187031513119;-2.5067653278807267014 -2.6562193135654021958 1.4251454061180930388;-0.68764340254071976144 -4.7989231108152772265 0.17501441113331686616;1.0358812004088855385 -2.3520578037367636526 -2.147032887762472253;0.7362191566408241572 1.9242086720326956328 -3.8867173263162269059;-3.0050686275452713758 -2.9821595353760983471 -2.8917684263143010881;-3.3110605256290277509 -0.064651149113454750572 -2.9084498740055932942;-0.074074514576202135641 2.846162221377699808 1.7258385662871762456;3.6072790198698680975 0.14439383898871982481 2.8874990788496970318];

% Layer 2
b2 = [-1.8175272286721957382;0.37734246372887492171;-1.295286936319993476;-0.27390325330177872631;-0.047438468672314555719;-0.40378169792302726071;-0.10182426897299153012;0.67063218990057338331;-1.2579802909202151273;1.5955306750021640561];
LW2_1 = [0.051250591404578854648 0.42645055180147900531 0.57907047611538320364 -0.32730083542509147421 -0.0041533291720606980296 0.23051733520439171565 -0.30260392102835437234 0.044857192763107296696 -0.44722125477801372151 0.3407868935289486978 -0.70005141901438716623 -0.18899286631056599894 0.2556673220390657808 0.25899474263129051987 -0.48010266615568802928 -0.70866739881996543282 0.57603748921624986501 -0.025318725137137367692 -0.14950592768003009847 -0.31263840094401756931;-1.1522443047903243585 1.0862872751892793666 0.77750894401596704064 -0.083150313289891322754 0.060580408129618512625 -0.33075553365292087449 0.46429408096588392629 -1.1471069380838117002 0.96399936108240757981 -0.0035844637462986491533 0.065895673229394810533 0.2176599815483471756 0.16224119540475520629 0.9152388489678316974 0.20529906549759024958 0.028501381138300876938 -1.4496508742576996731 0.37260476466432140841 -0.58568454970329886233 -0.17948084117738885568;-0.38465442996648618879 0.25821614380569923863 0.16364207311015002699 0.042861214966356357692 -0.3701249697830570895 0.37752865932788587378 -0.16689957285007528398 -0.036995280194174598454 0.10012383458952900384 0.18134193915655466567 0.0087267768875402985246 -0.27331571792924114206 0.11369296521065236361 0.062960172188633839463 -0.62003908952281594491 0.45802457943395996631 -0.2306393005665922924 0.65296054613190401827 -0.65677352432096625101 -0.64604264329948546397;0.24273558859802732424 -0.64135566154823275831 -0.56655478417427529436 -0.13934536408390810203 -0.040509163093660670307 0.77241234548408643779 1.3845281580348229866 -0.0019947854485256695176 -1.50780609281947231 0.16490218588151342449 0.24708783550137020102 -0.50368945868846193292 -0.47003329737961518919 -1.139016233534241751 -0.037968671252301584851 -0.19248175623249275112 -0.16431871557683588869 -0.52761083676872400083 -0.35161169446309786801 -0.17091707517800824867;-0.33332956837239252623 0.13140051976164116021 0.62505467509925383141 -0.61595975164513816491 -0.3272006203709170169 -0.068265236648466481872 -0.77755318594576172675 0.70565687781006758428 -1.1941813445439182217 -0.83006639855008601536 0.12930975580106718326 0.34109839755974297182 0.55635275354275504078 -1.5639207162739330315 -0.68506088269806819646 0.4875248985115545608 0.069686899249636877207 -0.59736197175001626292 0.1529780549577640647 0.15550346744311871472;-0.24443819590843465783 -0.091681789316026371384 0.15825685821403623343 -1.1312719176069783167 0.038964152818427959246 -0.35624051245754684292 0.28561028465668064635 -0.53165772937499222728 0.44493228859467853775 0.44722457001189719339 -0.74272409113050208429 0.059822410287602760526 0.59133013382028754013 -0.23955742288224948777 -0.48716976684772350659 -0.19315599292952800869 -0.084238740783667498402 0.60753727295544546205 -0.45470675274958083367 -0.40284652623394812121;-0.041143652844875762409 0.43013168616438657299 -0.9388454967955149888 0.23658792536905026704 -0.6461344983078902704 -0.87124713965037281493 -0.080143386086954690462 -0.25255579290173962859 6.1460474266415348055 -4.0240238722331103105 -0.35162783239769951349 1.3713481272561516278 0.048312611603623101253 1.3435936001855819377 0.53616743198656457992 -2.1953479368880448597 2.416847670304473894 2.2415000084739924446 0.88473943496423856914 -2.0950570517369047074;0.076954585122486943161 2.0506024788117258595 0.85648288571868325114 0.39297013247324841245 1.1183645957849113195 -0.069876678555681262517 0.57680041668730763771 -1.5059727554336606037 3.7811078684599541688 -0.69526720102516459399 0.81891408985986968716 -0.28712302763069402767 0.12662348321256913786 -0.4084199750367231152 -0.24643817417104049716 1.4337971814092111966 0.53985918153734702152 -0.14872873759712251784 -0.4367602792832159242 0.16131026451988575432;-0.52998757686605102446 0.80585642565692372496 0.029267031098478522855 0.11347442438098519213 0.024013342416530136791 0.14355052867700038299 0.20303267207567582409 0.040203017265941505543 -0.18311598819603519539 -0.57921823883041956282 0.020474656220564275977 0.49445249956599940377 -0.056631275181523103857 -0.5731797788566429519 -0.85140100945263852417 0.24369821253202306188 -0.7340211804932758044 0.35190005133046575736 -0.22335098105049799866 0.49268515014197949986;0.32542381704595002567 0.36707148167309122666 0.17958544436339304862 0.10690416273354463872 -0.55721831326156456843 0.14535727354999083971 0.16819273396218881178 0.53849799434248490915 0.26099558088546837009 0.36695838296140670387 0.37645218316575634887 -0.60245307840109818542 0.3901894269143640348 0.11389525358288749013 0.67490959035418063294 0.53037556401483865187 -0.56343681694347613753 -0.48165655859994843668 -0.18077887799314679151 0.71443544761663391185];

% Layer 3
b3 = [2.1201502092153128309;1.6213427941072655614;1.7647625485725559891;1.3543666010615806883;-1.2655577664747881261;1.0640502841279688706;-0.80332398194562237848;0.53748336102057847619;0.41119679151711741039;-0.081995219070709890463;-0.05850885998118218051;0.50006799966068937735;0.77729870268433842728;0.529783761804470954;0.5964324200351878158;-1.0118111746182971711;1.5565747650523660273;1.3559616780892003174;1.6162405827834678274;2.0129954843941182396];
LW3_2 = [-0.43976360177948259356 -0.60852913931040375495 -1.0804332190723524576 0.3898605892826653152 -0.44490508553228413913 0.55873769753215374312 -0.46076194317147367574 -0.70084994912278952839 -0.35511881325708688495 0.23142075315880916708;-0.47025469382840268118 0.26415671923172484581 -0.68715889447360789521 0.49704810705012403282 1.1187787768890327111 -0.039552030421507546054 0.63141724580423452817 -0.86951654325702376624 0.21488081202869743769 0.56935542036506381347;-0.78861312799636307247 0.91301289214561709429 -1.0915401386421392793 0.55223906286215351802 0.5302645030272354898 0.090070712733191199417 0.87608572045273747086 -0.33161923384089897482 -0.084071780638621265713 -0.013754786388248469581;-0.60468295869962007671 0.22481399975498136956 -0.48490610996080357742 -0.79802787750627468544 -0.66981344365460115942 -0.92665125444592710835 -0.86006933479951142019 0.68308352296124419389 -0.067102883217869918608 -0.53982464577584698961;0.56586914337109772699 1.1826323920142194357 0.69576435199931652154 0.17102101782819287279 -0.71613478133781627299 -0.21991546887893759221 0.2520016972349142792 1.0280760439235259174 -0.074233691800425993801 0.64002132775682640808;-0.6070438211103461601 -0.26945079804998067763 0.18357639852904350519 -0.06989754702764328087 0.23752787359462490535 0.69276387247769510846 -1.1741631689462315169 -0.216321220510541673 0.16434194654058087437 -0.4424775671429960755;0.59734336606372273604 0.43272306516308711721 -0.23214770967489714582 0.7588061664725540556 0.78480798849663202521 -0.15901716039680138803 0.10010064804241827763 0.84137746148491576736 0.88868265109526645151 0.62283357884016066208;-0.23421329904495288843 0.85743480531985794002 -0.40796370096533629557 -0.14876950226861904159 -0.77182137645196435827 -0.86666243653606400699 -1.0581712295172682747 -0.81359143816472667687 -0.53022899933940470518 0.61991276420051721896;-0.35603523403878123421 -0.91470819968212813134 -0.2724881483690780315 -0.26789707037365162456 -0.7420881313848902705 0.16991371699207688528 -0.89542654458441417464 -0.64422202238378989403 0.22570297745219070062 -0.55177501865877209841;0.67747085590501832097 -0.71546202564597027873 -0.72044641408150433826 -0.82016433048631376401 -0.048814655808620183164 0.12312841968416772531 0.99157238907734646105 0.78461363940972572717 -0.56138818378830790401 0.64876152763655925426;-0.27254551756005657159 0.38117537261551215355 0.00098892153055364553221 0.37453610506575019112 0.89277578912628807739 0.66738845882815145405 0.89752653793683634387 -0.45937782684586214721 -0.0085837215951013075277 -0.43326976534240452255;-0.11333332275202945283 -1.0055239896492493834 -1.0255348790380860446 -0.31824298173779169696 0.71431576559822429484 -0.42606760186604103469 -0.46783306175698202711 -0.32902962785307826588 -1.0609718533179162137 -0.39471628008284276312;-0.17754371407385499682 -0.22747183776022558699 -0.72942694862626511476 -0.45200993006895667792 -0.80338860494201735918 0.23150534455762861175 -0.79489155298674563088 -0.36963230304601307763 -0.52905388886404636217 1.1187055164630343995;1.0590435494228067625 -1.0828457543302996147 0.66559154175009671572 0.83744444812133034262 -0.82612351302535191877 0.80797789491390747951 -4.9432849304877359842 -3.1563909366049136551 1.5353434326416517397 0.52481567867858935905;1.0509173740068529224 0.28188932522698700867 0.052381450757060382672 1.0836102930212172524 0.16177455756980169133 -0.56335349547742752385 -1.9773829164039002926 -1.1357800048349790956 0.23102315679567372864 -0.99715936795716886287;-0.77616835955492968768 0.78848849919739860681 -0.76289165780046719334 0.6047983258996230127 -0.51504345183193411817 0.17962657950721536149 0.9080028043379031466 -0.30215043128156698904 0.0059076808004626876758 0.34936089280224630338;0.11866156054578576307 -0.49505148926228104145 -0.86131782347900109897 -0.89117266188509070002 0.6830707803250571919 0.47129327083649535934 -0.45698266260732767208 -0.062237662098756932338 -0.94501669620341122169 -0.20090483011465615215;0.89231603936535897059 0.43459080621231649388 0.12321377012597581335 0.085612794754764520722 -0.61093562217258901015 -0.4803276136195943069 1.6345822608658402419 0.13506708502494887969 -0.26428864049406364245 0.71784943504005482851;1.0128106655118622736 -0.11547417563391799977 -0.39733076517021120866 0.41743184322077436788 -0.3797994083581721636 -0.70196260641557228777 -0.099249443633304929024 -0.3733592884756956054 -0.65496229328607191711 1.076200887484877633;0.65038510059290255416 0.80964450701883061701 0.014128817590781031846 0.38564348456124569742 0.02489463306759379102 -0.61610898190954521692 0.38775946854515697115 -0.24902276924557878446 0.70837479967352678933 0.71097188143865830412];

% Layer 4
b4 = 0.6586965681744400003;
LW4_3 = [0.45411679637393598252 0.24531425625583658245 -0.83069446908373978378 -0.34669979786986782067 -0.30191548250713923229 0.30731560733201146451 -0.058063471960961107743 0.50966233185764175939 -0.57672023031233499157 -0.44710309033742579032 -0.22950906626605802052 -0.03058895329047763012 -0.48557394173855145114 1.1452211870922850423 -0.58077023070078481748 -0.3765611896148444715 -0.014028900169741303008 0.32677174663846197955 0.0004332755786281944051 -0.30350493217310087202];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.499999999999931;
y1_step1.xoffset = -2.00000000000028;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = tansig_apply(repmat(b3,1,Q) + LW3_2*a2);
    
    % Layer 4
    a4 = repmat(b4,1,Q) + LW4_3*a3;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a4,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(4,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
