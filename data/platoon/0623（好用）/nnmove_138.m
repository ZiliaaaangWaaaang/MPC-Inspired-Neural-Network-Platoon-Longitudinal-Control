function [Y,Xf,Af] = nnmove_138(X,~,~)
%NNMOVE_138 neural network simulation function.
%
% Auto-generated by MATLAB, 07-May-2024 19:08:21.
% 
% [Y] = nnmove_138(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 3xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-19.0505965768031;-6.85918092085871;-1.99763696099884];
x1_step1.gain = [0.0522252737181727;0.148213484472979;0.500572177293996];
x1_step1.ymin = -1;

% Layer 1
b1 = [-3.8494502956588152465;-2.9752137320590756886;-2.3791995995108665696;-3.8760230667886435008;-2.9625541983733922891;1.9505251272110748495;0.29249123487057948623;-0.99530619747064152936;0.53924185111909883616;-2.4188677420615407598;-0.1125365557712269815;0.82323623314877580892;2.6690502573360848082;2.4751483217960084104;2.1583491152852740669;-1.3665298978123623375;-2.6296511273869027647;-3.6855967960838835751;-3.4584098078665101994;4.2383309416505170475];
IW1_1 = [8.6789329052860342273 0.10501599213265970512 2.9574679374530630227;-2.297201824930275027 0.04036030752314341552 4.0022235197877655821;-0.092352466022636803267 -3.6836607254539339706 1.7497363510283929777;2.0196823410881767913 -2.2805115110456894989 -2.1060235872912396182;-0.22732300579029426912 2.4531103724865257476 -3.8670045626694116159;-5.539396756702112512 -1.2598557223900044288 -1.0977671108508664233;1.5212351232604377493 2.8527434868155152614 2.950512642009955222;1.2241544582707697408 -4.2331116162488537924 -1.456115348378140828;6.2767426702819912876 0.55500022964765649558 -0.99171228067799199746;1.3633001996303721892 -1.3272163387517255106 -3.8166280555678069319;-1.4722519406724483559 -1.0112329027395041692 -1.7206732985114203682;-2.2236692990392139535 2.6343498845291466459 -1.7416567893559449232;9.9012548483497706542 1.5162518203599311128 1.2343881983469671137;6.9469905719038695935 0.85028820132632654261 1.0349922548293413183;1.8090889415031210508 -2.4280918105114768224 -1.5911042272337514447;0.5828405041100871431 4.876105114067128099 -2.1210587274963361715;-0.24039746912037149307 -2.5531511265823954027 -2.3929695872473923934;-2.6667235674599720774 2.2091141894684773739 -1.039974689047516998;-1.2294394557254992861 3.5054360079691151419 2.7653017749020558647;2.1003755330532305479 2.2041166110851926341 -4.310452404067782517];

% Layer 2
b2 = [2.6082332053994887744;0.55056481277251956286;-1.1159254809579224332;0.93127224823012944022;-0.62049586094518760504;0.44219092099926887718;0.50416730034108037106;1.4000521832274088752;2.1546230569291981993;2.5815463171961638977];
LW2_1 = [-0.026634849339775109461 1.1153381491408085324 -1.490385793378869117 1.7214574847071839603 0.47235335861361743559 -0.28592466747530531634 -0.3700059501332524925 0.35520999393191948768 -0.77535086291078336718 -1.5054556023682270638 -0.72003219976668386693 -0.26572419982677003558 -1.2061865459882552543 -2.9356181091484057077 1.188686741897645005 1.0720967207330562854 0.54527044428662696518 -0.23416921328821790893 -1.0653676323068863585 0.69394423686538897478;-0.5090567019637163293 0.067633508246844484257 -0.047744838750759945045 0.8075129394635278679 -0.74781927796617908566 -0.44886697541656922494 -0.51279833443838107598 1.4222605191091919341 -1.4545532846382966952 0.72141300912812433843 0.63244004675009524163 -0.44296819826859284985 1.6181460260388527139 1.9034570993656472204 0.83523231528545605062 1.8626967306840094274 1.0337760498791743746 1.1308192269271566399 0.89798799873270240823 -0.81726855698539402351;-1.5773811103153263513 0.59910116043457350976 -0.43344473858933707522 0.52219057901949206268 1.1302330603992938318 0.13162501274513929705 -0.42184010217297235323 -0.45777284396130368815 -0.37044489408535352659 -1.2317410402797110969 -1.0535987553073444811 0.89384583965015995677 -2.5649426845187335289 -1.3901206600416233794 0.022840031744739516806 -1.0138305394829409956 -0.02050766938791241667 -1.6204627727588938324 -0.5319022211937435296 0.14777823623510336071;-0.68266802236321866282 0.10090036295381485387 -0.47086727248858928352 -1.0689145139083773284 -0.58424556306653596671 -0.08478775999176532685 -0.48516733609042478337 -0.56002992170112975145 -0.26948561581091190487 -0.082522669420623598335 0.67996255031758812137 -0.26568225803374134752 0.12090116660334376819 0.89831803358496009615 0.3513651949838118016 -0.15599938447341801795 0.15293634394190647185 -0.10289240324412041172 -0.21785786524792172258 0.89125109485038878088;-0.79722810381739905861 1.2722663272406065094 0.42210599199509851731 -0.033454981345583001406 0.99661950827318035451 -0.17759131278271469978 0.36353241828342580666 0.092833555065875442147 -2.8420310394630248219 1.3993376209147920797 0.21223814904778370849 1.5665283340873596973 0.19953146657978901302 -0.4190671058859870568 1.0931667028178739809 0.68844629955667713261 -1.0524016069621686675 0.031801963665657219382 0.2296218077014381409 -0.36137626794127619689;-0.15865099404892368806 -0.3453652331909033979 0.84556695406882487198 -0.81167648323900487561 1.1286882070474604234 -0.67915980059968017457 0.27295174992982712547 1.2637862458172723912 1.0849404768561303758 -0.48214789304206473464 -0.9109500985649520155 -0.26663331294126418891 -1.0223551381315210129 0.55893541181505135285 -0.77933011061941692699 1.1029371709525159773 -0.42002469853374452269 -0.59420897291181495881 0.05012564810843886387 0.39777634686630225502;1.4948259792383344902 0.66577774065454453645 1.5132444874831108006 0.079904794378518315123 0.21086208430268757463 0.34217582100006910251 0.18425567396481806748 0.24336916505034220104 1.0510598514444744467 -0.72522488426635600689 0.036573771606685685776 0.32312946338474690666 1.375704748082151152 1.3205284977835123339 -0.49503281732048665109 0.94852634562591853218 -0.2032844991740003493 -0.13591431302172862772 -0.013652860510643512887 -1.8138700911178562425;0.91263951830393563736 -0.55582263530806896856 -1.1701028626150644651 -0.70989609569821543467 1.5197338944053651044 -2.8134221380360977527 0.28745086139276304626 0.089454624921617348354 -0.4479213273374050841 -1.6980019831886383752 1.0355460524492390295 -0.92392892296787521023 -1.6297122170777464945 -1.1963807937250097169 0.33802425658332918568 -1.0492165851343173699 0.68268614872525146264 -1.3716916183850675903 0.093121171824370754799 1.4417520582730367629;7.3348057248073965653 -3.8041401329209936222 1.3064044822234317511 -1.4121342543369068689 0.10501954641606239815 -3.0009558970699039548 0.67245479099782301535 -0.14068043356461132354 2.8177901713255941729 -0.2772275069730343322 0.88775385162022601993 1.616161145924645437 0.0738590094866538871 -1.1284162164563236175 -0.57939380904606962996 0.79824127790087051615 0.45323938787476975021 -0.78462392116816481735 0.63912271352289218296 3.1534059496566948511;-1.0297091505929458766 -0.98853820951526316652 -0.77224832859423386822 -1.7770807858815813596 -2.5464675152435591876 -0.40686576988666367516 1.5824826531318079148 -0.84257553899583770285 -2.5844051333138806648 -1.6657296185518557508 -0.61069934425829008884 -1.7843181934232261732 -5.9258934495363089212 -2.0228866499998252593 1.1185077267316310135 0.40166726797629515033 -0.048514000040314829432 -0.77988399140343389604 -0.92884334555565706282 1.0034481590313428789];

% Layer 3
b3 = [-2.4986423615646540242;-2.0444610573895198868;2.1063567324458483121;-1.5783633538116688122;1.001985368863235637;0.37973398927000390213;-2.8499095172666426556;1.313656071927639557;-0.22084835890917964285;0.28750345676595540079;1.9611619135594571262;0.808405754990414116;1.4905333222041432517;-0.18712308335852287366;0.19333628114027118228;-1.7161892903047739622;1.5160093705090300631;-2.0685820416837557012;1.9487317608964127569;0.83938398133450919936];
LW3_2 = [0.42108970312759552712 -0.15831296890016402501 -0.146413634097534745 -0.060087122801547772355 0.39296224950364128103 -0.11996838131252464399 0.7138988040714743244 0.61383027949875212936 -0.87334970582801019212 -0.46005966668959374921;1.0226186509794215063 0.47818774504626276878 0.01505819480441734047 -0.55544574924235068369 1.3106626276739701265 -1.4293578957755033176 1.776770364563274196 -0.55450127536653281979 0.57195373414038741533 -0.64083496001598339031;-0.67644019654150644438 0.31384342100098899797 0.25541362323514887889 0.71522660567311713287 -0.36189031805873028702 -0.27979130500226484513 0.11031364620880355909 1.0660404950209765307 0.77932518454570809396 1.3653384637200021157;0.34275905880960633176 0.55291099536625065713 -0.40685566168237496942 0.371952190115257042 1.2897150006853328463 -1.0042382598762280566 -0.52867567806034343469 0.46791898054880637359 -0.27743175231772682077 -0.48897025748214889562;-0.63730032446216178244 0.50188762423369814858 -0.5725729865698534482 -0.855574184963438511 0.91222460372492264469 0.27604885470366252731 0.85697573362841616973 0.45772426727669601743 -0.40994933557243923294 -0.44245413626500473825;1.9368641625389679817 -0.098399881714246767439 -1.5277558579809140671 1.2786336116629060111 -0.58231983433363143643 0.36339268585186668137 0.70037254262515391545 -1.593039403663583542 0.16943326606765879427 2.0853255465259890045;0.3789188391347214635 0.27142121312171341163 0.67043206596118498641 -2.0401833141013243633 2.5493971057105193623 -0.78960021149868664381 -1.6281598676275657045 0.71039748758546894525 0.2599505120484703613 4.918039158381188436;-1.5606437812994322645 -1.0610845004325664132 -0.54803050017125221061 0.98382125255269403663 -0.215554669260660553 -1.1060849812608857246 -0.05380352263277596303 -1.3081013600477633396 1.5955902369599486157 0.73500923529105810506;-0.13889642200904042668 -0.35954549537337465726 0.83557982280694864663 0.63736650329865385256 -0.84677577187438513029 2.0569367183004203525 2.3041594282166504293 0.049998654297491729182 0.28077154937135795354 -0.14238103418871944639;-0.15447260411661878354 1.2187558610681559212 0.10877681061817906505 -0.72146254596996528541 0.74045081567910053799 0.21136432368849339403 -0.16743944396476989622 0.39647029801258087955 -0.68763120923958287456 -1.6260819170857379046;-0.69507279351290940372 0.37965228560367164645 1.0656220717637876483 1.8105924342730499443 0.32883414356354268016 -1.3685433016537906781 -1.4317526547510592838 0.95055757435537935329 6.1434278945256757254 0.75674224115223387432;0.037268023049607044983 1.3867471277359211257 -0.8533690493547679834 -0.045965928930072882941 -0.034884566367284174093 -1.6124313704027239957 -1.7227849054583403987 -0.99441136165677213032 -0.31310384552616021825 -2.3012428143810104153;0.095741778015263165336 -0.25148520886882425041 0.76033359793229293722 0.60961661560435309593 -1.2688163488843478 0.9216230154709424971 1.5792981207160508017 -0.14693173817687790739 0.34356668902705306268 -0.21844712932385412785;0.33540414324049411254 0.62271669077871005804 0.84315681872635828142 0.53095871118304438507 1.0402273980374814322 -1.4659322276784363392 -0.45628788231486666627 1.5578720340018719082 -0.73298613850489602317 -1.1197529411688682544;3.693136375212418443 1.3339108996212214464 1.0267651483391126987 -1.2423596715537097435 -0.021409956400936971943 -0.3809389258724189542 -0.33053050802502753625 0.4749121858309992561 -3.3210225442024743359 1.2818116363578537786;0.10541414500607604321 1.1534525362005434435 0.4671163376693299174 -1.1779406559522005438 0.79177518155975945557 0.13879936411773988181 -1.1166738596569543152 -0.77209006977199301502 -2.0758771281101604522 -0.26736496007798676855;0.47694921868074330318 0.20938295804901002617 -0.56786082009998439801 1.0053962601215427064 0.63565565748395980172 1.0969750688879806866 0.059030909002026579757 -0.19925265723320614852 0.58858392261467562534 1.0276724467648394867;0.12477445163921055404 0.50551703883417598018 -0.60894661890234069723 -0.39889996888535583786 -0.35292520723636389146 -1.3345802977419902735 0.42272728174818369196 1.3821776083008965319 -1.5702650365756252171 -1.4399781232360742145;-0.025653367144993988874 -0.30403489439395642302 -0.90135484786108344135 0.13369116880016443383 -1.0666568177078037394 0.58297444935108633235 -0.14698622473141509381 0.81901726294580279308 1.1799897492696755918 0.63043868386845947072;0.38385869207759704125 -0.15957712850126692938 1.2335689277933266084 -1.1352635737418805828 0.9081744702201366426 0.13329469090583309643 -0.36660791820788757311 -0.93553199503714445928 -1.2437732574963293875 -2.008561200964296134];

% Layer 4
b4 = -1.0291847991215266056;
LW4_3 = [0.13710516559837399031 -0.40958032048780468326 -0.32564780401122095377 1.1000827781235908986 -0.0013865442949576852003 -0.88272299521451524917 -0.91777501323142884893 0.21306132835109722889 -0.087733702539226882111 -0.65841529892594286011 1.0008914457507187556 -0.17417084402745494631 1.4648155992192672947 -0.42827959861685388487 0.29693898142064584222 0.59713440121280947359 0.50340523629108269166 0.40857690501652305093 0.53658295659239874098 0.44201192608237221959];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.499999999999931;
y1_step1.xoffset = -2.00000000000028;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = tansig_apply(repmat(b3,1,Q) + LW3_2*a2);
    
    % Layer 4
    a4 = repmat(b4,1,Q) + LW4_3*a3;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a4,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(4,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
