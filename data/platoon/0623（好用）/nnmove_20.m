function [Y,Xf,Af] = nnmove_20(X,~,~)
%NNMOVE_20 neural network simulation function.
%
% Auto-generated by MATLAB, 07-May-2024 19:04:12.
% 
% [Y] = nnmove_20(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 3xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-13.2925490923537;-6.70139767883548;-1.99738196042707];
x1_step1.gain = [0.0638195875959219;0.168202204644631;0.502170423671263];
x1_step1.ymin = -1;

% Layer 1
b1 = [3.9585418853067095846;-3.0400151049381922697;3.3249043875841022277;2.8104266741397396778;-2.4201452738003941256;-3.1026804174182527341;1.3965322661526631265;2.0017653295456558915;-0.61215170596588852625;0.41903720488085915985;-0.83089148023859138448;-0.47769020983481003118;1.8294034397269665071;0.91485362052092944474;2.0018046032111036503;3.6132280623728241231;2.6561174606190234293;-3.7544806142921935965;4.633528316695043614;-2.7541819757671306412];
IW1_1 = [-2.6855368002453325893 -2.1864455068965469309 -1.565635877585940916;2.6773553523980391233 -3.0325747891070053974 0.12986360008813815914;-2.9550846965100054931 2.3710452980517144894 0.043036571942462610585;-3.1327363236730856322 2.0663323468247232206 1.3408441481522312966;1.0797974777383481104 2.8141182266581354909 -1.4441355199943699539;3.1930432658242069444 1.1919168768826176041 -0.35717799181508042006;-3.9147739306997282327 1.5409799169618807468 -0.73010515431306022283;-4.9273177010746334048 -0.3345397909278217119 2.1097447434416172207;-0.060427648429225863658 0.84693730912626763452 -3.1850204230265104499;1.5872359977883869764 2.9640302557729962807 -2.5887101688547211609;1.9794815909380383268 1.6517982385711027504 -2.1305692323147873424;0.9905064348607013347 3.2066016784734401313 -1.4898678443499628887;2.3692506525779859494 3.310212161282066301 -0.25389448573709538781;6.9595873739071842934 1.2653277582894051356 -0.88804716673558581341;0.39577752156645062964 2.7391627009649837099 2.2476653905457957272;2.5576540687301188015 0.64367308235043196873 3.429866092381227638;1.7239250597196702497 -1.4689356526712060713 -3.159244090577554509;-2.8563684318413735674 1.3916000027559927155 0.89750086396625972096;0.73552047108870877157 1.3333651715262646587 2.4135263713180523659;-0.95898442103543823922 -0.76378891370320800558 4.7447468483659278604];

% Layer 2
b2 = [-2.143348737207845911;1.1788643605630315658;0.93338558195494281122;0.87226975814967067091;-0.097095158621035751456;0.13545716893934464653;-0.69155253905916269641;-0.45905722220592476424;0.95615233411503708361;1.8605811293444782795];
LW2_1 = [-0.13120097651013637452 -0.23427384704504225499 0.61675328614823943241 -0.06783221304487124792 0.83545980849699175153 0.41915552202105116342 2.3863928474364874965 -0.85832308026105885723 -0.32101123296832656528 -0.44077427133914276469 0.44527841030666348576 -0.089457120075716378693 -0.61757002344037414954 -5.9148456990595281724 1.4411252230706359523 -1.0050901562537088996 -0.42065269009231354147 -0.37202100878249833027 1.2054943266291600068 1.5722127484893211324;-0.37883159123993864759 -0.41708745268974029008 -0.0076488390681691970086 -0.23751643106901337843 0.45729957249602437575 1.0902454030885886382 1.2228246226541223951 0.88306436315858105601 0.27980491055688117008 -0.94841559162744182299 -0.10031143790995693255 0.014473717943468321356 0.19965452183696946742 -1.037927885264773753 -1.2787473663673951663 0.41586427694454869419 1.7183737876711102643 -0.084513965694411358198 -1.3061621153106592885 0.96022721367491004063;0.065913763573150901953 -0.60312049287580415946 -0.082178317397031228064 0.43223914664614465631 -0.33783981745131708152 -0.56374126672249091907 0.1779659399143697085 -0.041850041895768338995 0.26307167352984184294 -0.19398213334756364556 0.2022925976165474149 -0.32789940552146318309 0.20901721629962907723 0.44921821908571651916 0.036677817637839692233 0.51227521211798165979 0.59076776857332968795 -0.38088555783241462294 -0.077601448812834136759 0.087977955360433193754;-0.025728313956882607055 -0.72222486327128565531 0.97042619647368044689 1.1684354131881695693 0.67526729748558667055 0.07603805199516387725 -0.98240840866952283683 -1.5133582014525008841 0.28292284458405247971 0.4541771982866419366 -0.24250762663389202611 -0.11695680189602492005 2.0770741494661919546 0.66810111829736451572 -0.91700856602613234347 -0.56610128072985910208 -0.62540720444550879087 -0.50954895452364612485 -1.4864788665260961764 0.36751191427597168504;0.90073279868079214605 0.64428708567130599238 0.049601662759894492305 -0.99180971198385392551 -2.3974084591534445821 -0.70943487792206727516 -0.33634930350914754582 -0.8685639461806236028 -1.057852027202720091 -0.65032063742668910766 -0.61279678284738370309 0.61592669408853595314 0.42405570729286057308 -2.4739039361891217439 -1.7655499335422240037 -0.22819042498359792814 -0.6763414267036174099 -0.5298248365237866464 -1.3368384816109670776 -0.013764422736392568566;0.41808517522180327353 -0.56143604034100724753 0.23029322222622200522 0.88955566560736643034 -0.51867426105547875803 -0.062423532610537887932 0.42459138632582488215 -0.72483725168242596482 -1.2245047907926742692 -0.0063893482133835777237 -0.36437465578454869553 -0.83596384290184788668 -0.065229405228943285189 -0.13393546699114408649 0.20533656384380968851 0.2509336902008692527 0.21032756032114777178 0.072724233280914138411 -0.99389813846527730323 2.0154896711618435212;-0.81435244301332820882 0.36167796045527067506 -0.57276125877486716576 -0.2982483023956354895 -0.27125934926763883848 0.22479839723129571571 -0.22811748954829469405 2.0237164629821831063 -0.14399744149625789968 -0.00084390179251331992605 0.034342710226751588243 0.12326454648566916028 -0.76370188617190570834 0.29973511431463395471 -0.31392620761111184047 -0.64488583270401556025 -0.55667574195625602052 -0.28046600355534345717 -0.55847941369313103266 -0.62471318675837350654;0.36362382254852815278 -0.4570388124542272279 1.0009220379737384654 0.39390280799792515287 1.70122168381117711 0.045258441474577942865 -0.13489541418337239187 -1.108951259721806748 0.65492148339030242798 0.68992685902892947336 0.22442962369342314699 0.77557100077667506799 -2.1757648229639232618 2.3526145069416166677 0.88936330488675474637 1.948690697713596931 2.2420688113606033198 -0.27112434632081422459 0.069092381945409078736 0.27641053603788184878;0.84064627781996703604 0.48134155353937946309 -1.1402487569634085496 -0.36941657358061547045 -0.062939790803645478956 0.24892431227978217834 -0.4594048237212541852 -0.33454198961403808221 0.96919829502106158436 0.33294560631923836302 -0.39706452536253883379 0.66519760488842105683 0.086488155994922572001 -1.3380867264749758405 0.23008755184201673538 2.4536393379610128562 -0.16496185645796385133 0.56855926014542579328 -0.38585465784524408672 -0.74468339777390335499;-0.11886731108291395675 0.080525700617485262978 -0.17640886159738053407 0.53132428194498571017 0.6617101590419300905 -0.061365241964661719487 -0.42839885541826888682 0.26527312134034219948 -0.082993982457464435254 0.48554270013948719331 0.31497586779454361805 -1.2485194845196816438 -0.86451476420343820184 0.51496017387323234082 -0.014221197974942936804 -0.55848276154419262962 -1.7061534796675661418 -0.67604459948411499415 0.74392685866894436852 -0.32072981798812599807];

% Layer 3
b3 = [-1.948828137877204103;1.1119398935071742596;1.4378977411824089838;-1.6160967493741809076;-0.94879902296595974853;-0.11721445381090292437;0.064022347323183015355;-0.3142775833555985221;-0.121631355953863457;-0.5158141154052331423;1.0059622956271423444;-0.8310738464525970759;-0.76573767649651924838;-0.87981738123794295259;-0.84480141514303153105;0.95046835724212908048;1.351110739533863736;-1.8818929525532033242;1.1018772669857239688;1.3411363434189569332];
LW3_2 = [0.037017927056512217598 0.050435785819831845112 0.36999225277400438205 -1.0109660751108748844 0.16004410804198940244 0.76600121360997686093 0.92878838118537865309 1.1857936371242612239 -0.32865694034106035515 -0.75259954415391305815;-2.1452311726155373073 -1.3551665341747809457 -0.15727579273303199381 -1.3651611425829486279 0.078315465654838212206 -0.27681683121298694683 0.021809416808808008287 1.16055033890200332 -0.76446424029588055937 1.0539203500021434579;-0.74862312058655999802 -0.27827159712141091852 0.64549507164561059636 -0.41428361396747059864 -0.86220986200456350979 -1.5772481490215903843 -0.37792395579125265259 1.1469200471938432173 -0.35121166261819719567 2.1514251543613940321;0.6145986130638371181 0.55322581053493014025 -0.33409697534152760223 0.9858185176485153578 0.43206278217450005963 -2.1252939787967504159 0.59905835774515270309 0.019160924924473646258 1.758040913330920052 0.082535845440026012199;-0.053459882078932825789 -1.0092340813822753276 0.25310645345804222428 0.40383768001673969739 1.4510921726727297187 0.5445454028765014387 0.019434846034077871146 -1.7550252690882817141 -0.70754641857268885108 -0.57485897747371184074;0.79889180564379591587 -1.3120374373090626374 0.9934868028043734034 -0.98259889522975984999 0.017045879129772914529 -0.23102609920866723492 -1.6170407523816561213 -0.14675256782384510368 -0.77895655689769516261 0.65053577901624637381;-0.2620144241982080846 -0.092398222500537557922 -0.93185885155977432603 0.56010225489020271095 -0.1577717265475541697 -1.5855175569947839165 0.84688895330436519959 0.0039361911219920279331 -0.58630774019674403164 1.8684795770734889953;-3.3115146811744287092 -1.0070592238395725815 -0.14982656185163256701 1.3960787938887808668 0.84353547964941821835 -0.069426302144145746187 1.9503639135145756089 0.50653624879990688523 -0.93071657056305356903 0.33681356790830924153;0.35417830409387579538 -0.18606317110379766433 0.034500089975233468043 -0.019504093051039839146 0.46296640038116187998 0.75415652633924501469 0.53849785752925027893 -1.1254896302109429485 -0.51103601068699000542 -0.64332405460543595765;-1.6132563719876849007 0.22718228038186774609 0.051565617364394647493 0.26676166759416852781 0.91103142322563657185 1.3175577881799021007 0.19223203451032289113 0.00062365950412037601813 0.34321435028112612375 0.73885699213874422853;0.68260675131695658369 1.0953140376592667149 1.1477336051294093622 -1.5141110482368396184 0.81560813669762088907 0.46636914237368265468 -0.57841599245987695976 0.92104143793709969401 -1.2811278057699664323 -0.29332403296671344384;-0.79319824900656632494 0.6897280872839820498 -0.54112274522052650205 1.261580813734308304 0.20425896607066323929 -0.081766726754811114297 1.0234905044119673168 -0.058129308699270069993 -0.66870201959100006306 -0.19178827207867699123;0.95362638842404956474 1.2732131905641193015 -1.3763103496108284318 0.81400650815862285459 1.2656845813106127885 0.57381402273228632183 -0.10097254550790976668 -0.08714462466910288807 0.1174854619254350474 -0.63593741812700610438;-1.4003694795790779803 1.6768132845590955071 -0.88122717702443764676 -0.40265063071708662168 -0.49865925844863251415 -0.54005004870551509555 0.036629101384853618439 -1.888714267940065028 0.011575893422478941014 -0.32162934790648822769;-0.95777856981828501937 0.87920404177936950507 1.0561475846352199603 -0.39116824311798620295 1.2675913286267872504 -0.15452583995797342098 0.22260034140444892592 -0.48933143324675293373 0.53698664734683865252 -1.2805915268155405595;0.45233386896670180199 0.25127350151210903206 -0.5510277339701982191 -0.24144204680314718114 0.88238508299220963504 0.98546565762368565355 -0.69624732631850061448 -0.18497945670344051461 -1.0541261114240312313 -0.35672731463151885478;-0.34719424338599341739 0.34949250028520928435 -0.60139938984477314676 -0.99747674522757778792 0.24126340223505196581 -0.20269532736228035308 1.8856593844747790989 -1.1215002933570541455 0.59505107741400631305 -0.20742017564921078066;-0.7945046286093548904 -0.94872029994743833914 -0.1917897224323955041 0.24695967043286076725 -0.29840224688589400692 -0.29519422296128983163 -0.90243670102349804463 1.0153472360605173552 0.69571949511961028723 -0.34262429163152063882;1.3418771278614274323 -0.7376217635063090361 -0.37184370449409470671 -0.52745387333883564374 0.97530635262086218251 -0.9008351261122607978 0.63573438747445054631 1.7286024911493553802 -0.31920793442085187985 2.4852954104728834928;-0.20107317357564757909 -0.097631525319378742456 -0.12458554274002499318 -0.61549361352440534745 -0.69647565120994825438 -0.14628040211875037446 0.02121129776039350906 0.50802798826927708653 0.87514492943758837029 -0.4997852910172882468];

% Layer 4
b4 = 0.47333563280217749725;
LW4_3 = [0.42997754836390950084 -0.11308210091289251642 -0.095195032889370007068 -0.0061803710010878941394 -0.20622687189475202851 -0.42153750900519049161 0.055320814047056091067 1.0283402493548021717 0.027237283745797490758 -0.053000620603990744595 0.12311904047290653241 -0.56487940949046899775 -0.17540124661127448613 -0.37575307530823265356 0.34116287313300275308 -0.051706087625680505204 -0.083625020238065408962 0.23766019388400255741 -0.29523134688274621507 -0.41559375732141612403];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.499999999999945;
y1_step1.xoffset = -2.00000000000019;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = tansig_apply(repmat(b3,1,Q) + LW3_2*a2);
    
    % Layer 4
    a4 = repmat(b4,1,Q) + LW4_3*a3;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a4,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(4,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
