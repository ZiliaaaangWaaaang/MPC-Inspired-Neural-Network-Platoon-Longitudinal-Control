function [Y,Xf,Af] = nnmove_23(X,~,~)
%NNMOVE_23 neural network simulation function.
%
% Auto-generated by MATLAB, 07-May-2024 19:04:16.
% 
% [Y] = nnmove_23(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 3xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-13.2925490923537;-6.70139767883548;-1.99738196042707];
x1_step1.gain = [0.0638195875959219;0.168202204644631;0.502170423671263];
x1_step1.ymin = -1;

% Layer 1
b1 = [-3.5277328504520868435;3.0330860174371117033;2.5717881848472332607;-3.2853292140154066736;-2.8398584175685983588;0.72819537119317057083;-1.5089772687393394612;1.1462979890939481997;-0.15734833929986008494;0.11129025664011035768;-0.4697376098017458923;-0.5038075921258750034;0.63146351928699773204;-2.2742410048950114643;-0.58718982336425307178;2.4160392291715453439;2.4876931870262177782;-3.3550639345094048771;3.8428736535522216577;3.894438746750491287];
IW1_1 = [0.48331187965385630223 2.3375216766820079428 -2.9014363663599831433;-3.1785955338350158073 -0.12074229190079356633 -2.6322705159184223156;-1.5359430834710847691 3.554454169578104672 -1.4358710585035159291;2.5047685988610308705 1.3316973015355755283 2.0797550718751720567;3.0613382433950224737 -1.748952400092249615 -0.61934903282756237353;-1.0032836583428621502 -3.1214575990921784587 -1.3441621761071833596;2.2779097090628579458 -3.0228733594060392953 1.2883207389811011101;-2.4741496875962396551 1.8526967775526625992 -1.4352258202666319242;0.46936967034834736756 -3.591374646284480221 -0.7268396620791797158;-1.5180698240291869983 3.3879412895206719725 -0.94547456037231714099;-1.5342694692502854004 -2.9742337817044854908 -2.1918554241009569061;-1.1862706163504486145 -0.86031677131760275756 -2.2107431204279115455;5.2793770925169098973 -0.72520512701438855085 -1.6466710588902313539;-0.97647957069305846289 -1.9778492439820685167 2.7094040636330389837;-4.3474984444291724373 0.85769910919332847943 0.87444063364450086429;1.1263554312336470087 -3.408550197239869739 -0.85666909130142354645;2.8734123325634346457 -1.9850326112276204249 -1.121943282271104847;-1.0757177823191674815 -2.2966253648571473001 2.7370919796445178918;3.1101667865088615805 0.78856768605948690531 3.1165260679419404255;2.3980797201809109787 -2.3536661352113354972 -1.5974296807019265909];

% Layer 2
b2 = [-1.3723145412693427136;1.2531709340733663272;0.62417075221593532053;0.50059112153244678112;0.19186336830391445551;-0.40732062660961670941;-0.42194943426256281693;0.76009646565768251847;-1.3888582330061238768;1.5884963372802947124];
LW2_1 = [0.12891742037488462813 -0.37080185781190994065 0.19956054860712779675 0.45603292517937099593 -0.082321010816079176475 0.078054120103135879449 0.84797458138562198382 -0.98656745563342407301 0.0076249514391753822964 0.23597984781067743443 -0.25024874193189772242 -0.30098159596567214402 -0.13871335742786117251 0.14428650771356030247 0.1339549473100740129 -0.37624904507518569519 0.35981455743849388718 -0.4001506768863025143 0.72072011601302388151 -0.32600584669856208508;-0.40108921399269398256 -0.60566429375916541744 -0.77180266354913285021 0.78543513141192367044 0.12362589789244018967 -0.45795816849204917798 -0.36101738571287150803 -0.6100207778690676097 -1.9157844191716046911 0.3196296131904449167 -0.46910021087230685533 0.45727099527202746954 2.0222067278630482257 -0.29697707884344942686 -0.20214308022120300312 -1.2525377842822653651 -0.22222493363096207375 -0.42471972252615208809 -0.17175931489781490202 0.5043558024586556332;-0.82491791911675937943 0.47630055065887533239 0.32614864782700314638 0.67352252346941665628 -0.69489606964928962718 0.34235268631109300186 -0.88096676982203292461 0.38786763127551887598 1.2794250273716367694 -1.7024885681333437049 1.2774606065784517295 0.052194919335558767615 -3.0918371017536205869 0.21062118087538286848 1.9013688497533989263 -0.49386527424377707485 -0.58553616891788384802 0.62866464569277324959 -2.1835261403230195043 0.2177262333575467057;-0.34245014797008166418 -1.598366615874268426 0.15759802953769846967 0.48916362933145973724 0.32980460163290903353 -0.074047417426198691714 0.2556773059398500525 0.31533002762785050654 -0.33757643049527447099 -0.34380994289981958723 -0.73658541721463066665 0.45982783026784068703 2.2202065149395946442 -0.42005192323967016632 -1.2815260250623330407 -0.52186434066680631449 0.00070910460589797817167 -1.6165067513663651244 1.2395462484859109953 0.4700574317724161566;-0.206894038584997636 0.54220904998323404822 0.51793129666339821071 -0.091707165216093206039 -0.44894945284714787848 0.61327417221626012722 0.10595183418486786575 0.44240574878109467649 0.051869614893523589838 0.49013818158218258603 0.27127333096237438159 0.88777859194500774453 -0.2116135210480901141 -0.30337581176380079562 -0.078295354736116262728 0.31154706693820238828 -0.12281954012607741722 0.24750226226371579985 0.69351381448249105333 -0.47189859953071544574;-0.18425137673360597601 -0.21176626080399812979 0.26107509100002790348 0.12369386061040421598 0.34599198457396962425 1.4986031077158898928 -0.52087500431531019718 0.84305356548884535783 0.050816117061427530655 -0.53967815360890336596 0.15279733581959717426 -0.59275093160127811931 -1.2571260427529644677 0.67780489483336892054 0.67813614519765685884 1.0266540477152428235 -0.37230704934174468912 -0.033562431479506923959 0.20478757991535517791 -0.32674366105545843419;-0.63279638790431425033 -0.23902724174997727613 0.43747532757401835779 0.71438502756161592622 -1.3513842679266894198 0.11520328729280580882 0.41577387010414906809 -0.12859297154079918357 0.97544068393908522907 -0.83929982059790808613 0.61428750721319702599 -0.45886342636279126017 -1.0541223948410072264 -0.42815502478512795781 -0.18439390033756905551 -0.06426548112929819645 0.11591924300916867097 -0.15591958836710606562 -1.3818490216849761421 -0.22149881697073631193;1.067776131533195727 -0.28291279306463834597 -0.55184530019882449547 0.95506947198343161709 0.14159376626730385551 -0.20002117366382796138 0.48777913136133943528 -0.14010680671471398284 0.1372624419398421336 -0.53275398199766155205 -0.29233137036699347044 0.19888516695310817783 -0.012890415747510351047 0.1371503702330973129 -0.75482925532070832553 0.027364477663605672048 -0.10228103101235007377 -0.549822872922742234 -0.63267954624464184388 -0.52854087332371479935;0.067262446436807413197 -0.051279684658531179964 -0.2280332605881265351 -0.13644023124762952315 -0.20558571654031701503 -0.41264642687286734457 -0.61566061730337373614 -0.090047061807973866054 0.3723731121080480766 0.45256914218770161185 0.65500898688649900059 0.23884687092718603907 0.67723651443442178799 0.024006200709195672782 -0.029336515266327630597 -0.1194154773852569712 0.082326147422684861632 0.20930983437597985852 0.28999842737595604714 -0.64876437206811554681;0.20837693483469710287 0.012879918245842775573 -0.22948535147791823685 -0.47878120538648899496 0.23017645021707047737 0.44859244989348023847 -0.72408961884883138449 0.58985242099058554643 0.3268151170477481271 0.41529106017834183096 -0.27587515121712385957 0.079498583530294888999 0.69926886715528702165 -0.84843338514169608366 -0.39115871713924621478 -0.26235420884589044643 -0.22360028951429744559 -0.72149150671905959431 0.43339160737503640286 -0.18387266644619740252];

% Layer 3
b3 = [2.1128175184803077435;1.0788657152246827753;1.4744101184627012024;-1.4054373458978941525;-1.2636503847668556499;0.53525043551375917072;-0.74353526456338214778;0.73225807674866916219;-0.6605030664272276697;-0.30921812402863657621;-0.19383172429551398519;0.42019873825963299785;0.69664517661037406171;0.59184490503667053218;-0.94778570142661300313;0.90283096602049783819;-1.3508555611888650727;-1.3042898953193735601;1.336029435885830674;-2.2517738551182642226];
LW3_2 = [-0.33194025103912355723 -0.17204477815335472712 0.71656858784840382626 -0.027249483243593535658 0.89948590313163290233 0.80443263115716234779 0.25916850841842392628 0.60317332327623418564 0.22208074947398362409 0.3956745890704930213;-0.24906738420837237769 -1.1761163525992468504 -1.6260425077554974127 -0.28511050591981529356 -0.92110188388566405226 -0.32096724293925882332 -0.68349452303291102773 0.23147909170650202149 0.14593829271689379157 -0.87888815761378979996;0.038925532421037412067 -0.17336750611158804891 -1.4355119600134322866 0.86029010854137843989 -0.90177342330440124485 -0.13919132475045617459 -1.3220796942822252706 -0.25271654817414984651 -0.47912259620340325039 -1.0176710593037023855;0.11082591242398755205 0.50450595459711244928 -0.90490077598529616854 0.89289528011899443882 0.57799723470275043979 0.50980419034587942662 -1.3548656718307325875 0.82283756959729237312 0.019122904806779281867 -0.1695992573818287108;0.60091706076609752163 -0.39328002818744717262 -0.67607428939327141038 -0.8799739271334793278 0.024643800926051551842 0.11272878232782253261 -0.82081707978760687361 0.31799878285006094591 0.22979004165308741792 -1.2410272464384257685;-0.54462286470426557461 0.022443655067906128492 -0.80691041912824967852 0.42050851367327035657 -0.75202063103208138806 -0.98839072358273283303 0.87904876032717005341 0.28628671015443801773 0.73618585538902525656 -0.22453405961409031444;0.098275566399712382948 0.71945381380835538021 0.86767086220364952887 -0.79633649797900440959 1.2724771124851212978 1.2403412293954900747 -0.45291807810868284223 -0.25009502620231738312 -0.51913380185991653271 -0.097983277318534234279;-0.77531566219330871892 0.33961789085917293285 -0.82046418940938592446 0.92908022427037717517 0.2386839279307725048 0.97404530578537462659 0.21814634795019621771 0.87419506294119875278 0.23584022977431221002 0.69900489474478266771;0.84094547574386191435 -0.30857593866257782 0.87553682818635436558 -0.46642457920767921298 0.27932611146411306935 -1.019430794899047088 -0.72822055530763663 -0.66637355351045801655 -0.18880433906239613151 -1.0117760801433532958;0.12689525867779036239 -0.18006843909605074749 -0.90136714580238364025 -0.5672819509692104134 0.2413915406435115929 -0.22777813888682776899 0.52704430043416183871 0.7089212817815025991 0.6214667515600629244 0.68924067691987478401;0.095957790682827628914 -0.83029600906143419259 -0.61428454267054399818 -0.74993220355109246889 -0.6052857630160477509 -0.86596145695576476342 0.25591042707608419038 -0.36198191332049256541 -0.012191391352202646595 -0.51253875916337465757;0.45326557618913992931 0.67668324949805036539 0.3491195639821764729 0.84611465398898988433 0.21060509247792807974 0.51629147018469223607 0.62173996654626906277 -0.7900534012459325961 0.61292305489637766147 -0.50029303371953648405;0.20127410330894651702 0.49140702345115055971 1.1680566296314645047 -0.44772387409612629527 -0.53884127444715856914 0.59144036940935051927 1.0554833979018387602 -0.61929710955681260831 0.90995913286852958546 0.79615059816317967911;0.69489515443919980253 1.2873258000704936865 -3.5181732779116412502 2.9353683808868913374 0.033942545573596653863 -1.6555047412915029348 -0.82143397199048695523 -0.51575585421630942839 0.32231056088174919738 -1.2854577229776098513;-0.81010980418780820234 0.50446885952842956957 0.047845822969118489976 -0.65560077221707324657 -0.32641649276154383053 -0.70251482753759630917 -0.34131907763628377417 -0.72655736007507321084 0.58090541560865660564 -0.31501764257976988537;0.70355392055206833479 0.23596140919858490936 0.89821905134144675031 1.0954889921889521265 0.079770751004309803367 1.0526511835314433796 0.36854125237879908905 -0.16577028573043539605 -0.27031553969979477126 -0.38911594759953138656;-0.3784173172592368295 0.34944399292545669233 0.74667215276179055294 -0.72090217533697209529 0.41110174134084981334 -0.25605936722491562385 -0.2938197052440927326 0.78469768650991356118 0.67795837126090041647 -0.55894170886995075964;-0.81191430200199743439 1.005382782447824308 -1.3614153330891740623 -0.11809960316629523891 0.42274986758003313403 0.68961509531284292951 -0.47905536480058374948 -0.0020332395842864395968 0.47779648161030213727 0.85243419913864104664;0.74633365149983854625 -1.3464052757613325095 0.3840541202980493618 0.59605633831249305032 0.68093050874426463981 -0.64325390596667286758 -0.031810463747002776236 0.84148538256374094679 -1.0976507861340134564 -0.55995866644489433739;-0.58303840048986765865 -0.15079206569250297454 0.337194269390561574 -0.29606779240358344074 -0.01772234093910730543 0.71480120398704205531 -0.33003261827590935074 0.4611371671717650611 -0.16546851165354911628 -0.86311907939211152119];

% Layer 4
b4 = -0.66958237701281009269;
LW4_3 = [0.19535054207193322529 -0.42120779088212934038 0.40455742951860085288 0.56395312301679045852 -0.72643206191720199882 0.88930282428812523765 0.47696017341311441884 0.32545501718002367575 0.45120270956016900188 -0.2816713888883012884 0.35831668820331580294 -0.094520177855630563291 0.92667714985940752292 1.2263644190419411562 -0.35296059455675415917 -0.22746624198148712725 -0.46358117674538151798 -0.40873984101317895057 -0.70052055599303075795 0.022240208807991445478];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.499999999999945;
y1_step1.xoffset = -2.00000000000019;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = tansig_apply(repmat(b3,1,Q) + LW3_2*a2);
    
    % Layer 4
    a4 = repmat(b4,1,Q) + LW4_3*a3;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a4,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(4,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
