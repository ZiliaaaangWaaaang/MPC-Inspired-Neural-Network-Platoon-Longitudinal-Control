function [Y,Xf,Af] = nnmove_41(X,~,~)
%NNMOVE_41 neural network simulation function.
%
% Auto-generated by MATLAB, 07-May-2024 19:04:41.
% 
% [Y] = nnmove_41(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 3xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-13.2925490923537;-6.70139767883548;-1.99738196042707];
x1_step1.gain = [0.0638195875959219;0.168202204644631;0.502170423671263];
x1_step1.ymin = -1;

% Layer 1
b1 = [-4.4985971125374826229;3.5110690945375639949;-2.5713711525045650497;-3.0414778914017550626;1.7678854217423625173;-1.7341880630010757525;1.5886096511006218002;-1.4855809520911271715;-0.41374508989458880226;0.19067381189423127097;-0.022915457368182269582;1.4091699238363462054;1.4691358289637375112;1.1561186254312054711;-2.7852644040729126473;-2.3458806605871109774;-3.3148865361439381338;2.6149608305605016589;3.1576637897222425977;3.0229942150403390499];
IW1_1 = [2.5042901244623667623 1.2414475254130616921 -1.7068860362555418053;-3.3925752255995549334 -0.52216263684047381499 -1.7419959247112433154;3.4311436722543753319 -2.2778545534547745 0.42671933337254069896;0.6677038819161081884 -2.9699930634368820748 1.8311797377483483018;-2.5071210832893089382 2.0942788834204439929 2.204662451934650047;2.9711917091659163503 -1.880194551601203079 1.2385375248194561149;-0.53026858563109424693 -1.6236763606351094502 3.4103353460513288198;0.81856663575595456361 1.2100483091368279265 3.284689139564411775;0.99539835677554944215 2.3811487171084060321 -2.6390839720335841356;-3.5023160797936703226 -2.5331311445090389789 -0.48650185339568158271;-1.6722494957411895289 2.1322588666786463918 -2.6141112444453842301;2.4284755938229571903 -1.3136708170982527299 -1.8559443651125435704;2.3405384015428496447 -2.0766511112279282258 -1.4029842333112976238;0.90967962055602213933 2.0994456672290304766 -3.083658765082860409;0.066274540951219429452 1.4359824271284766795 -2.8167513850118122143;-1.5494622035611647082 -0.50886830950654748928 3.487996212193083867;-2.0060126324315175061 -0.59102451513706755204 3.4189442965721577039;4.2375651400433360649 -0.66663492521367162524 0.85148655056736521907;-1.9716659643792695533 -0.73252203826654893604 -3.6072766257393018563;4.6722998558161892291 -0.60480777359734283483 1.226185867168073873];

% Layer 2
b2 = [-1.5886111521843686578;1.2895884528323244833;-0.92622132161444448162;-0.53233639639944829725;0.23839208297141686876;0.33549716961045122909;0.15045370137686356338;-0.82722927528670553432;1.557204756671791257;1.666399505328927777];
LW2_1 = [0.21044664574658125678 -0.43903558037356354982 -0.10082607497864648494 -0.27792648799992136777 -0.319771871601859492 0.53061561314995620009 0.38820170954077276582 0.17849887779608883398 -0.52140839940697958355 0.096423344368380417557 0.39386751458459307029 0.37782212436402334843 -0.44269415877741680188 0.11724899864753907108 -0.093533311847464689626 0.68355995717106399212 -0.27629546459059772801 0.060554144117179055373 -0.5075831274982532948 -0.11295719781420833494;-0.53876914345878990087 0.43217735816555863382 0.74610919248935869685 -0.69730086326790063911 -0.56393036353623182677 1.2693924546677790577 -0.51127390798591376697 0.56458687835942800159 0.90780048497591236956 -1.9892332032712958245 1.0734050622589916824 2.0366919371406879691 0.76743618777197319947 1.0696949366224530742 0.30599894950680833761 -0.45581839561498432856 -2.4632520631586332094 0.88148012291888366843 -1.7204940495630152153 0.99007471537665525663;-0.82444024975397145472 0.35859646799040301168 -0.80585705208104196906 0.23445792548482993767 -0.56538634762010453461 -0.0089619308202544128994 0.33210728844908954382 0.54515030881081405489 0.27789789143477594546 1.2407530798427173213 -0.0267493645451881909 -0.23523873937174183402 0.67083508018806725648 0.015010415875439362537 -1.0429144554132077083 0.0039528306126625466221 -0.17300134437565869994 -1.673122372277249692 -0.28920401533092943147 -1.6049304259188175159;0.59242423592398196774 0.63318829181267355377 0.18019573546250122753 0.27575887551786820717 -0.82788455456404308475 1.4167216655372507628 -0.50686686586048335101 0.79462940089363232055 -0.10586980869820236673 -0.79322668892085934633 0.36853400513515066628 -0.1824301947353408615 0.56307227380224633695 -0.50949869644582657102 -0.58659694714760024503 0.47515478869094329717 0.48906224431305828082 0.74974295477420760392 -0.24478300396282609563 0.24692916951639493073;-0.31442597236427471952 -0.094277038070624694099 -0.52043802500127267496 0.38088022079351824267 -0.59248100965699790343 0.73660400335639775182 -0.16681478628225604455 0.094790094603431712672 0.41170926301012183979 -1.3700664454349016363 0.36405951636228855994 -0.014138506409896929236 0.13925184281298408351 0.24180490104470059309 1.0071747922880918136 0.67550228302028625382 0.001994505273416188277 0.99282173925246752777 0.013001739858723701526 0.23056074095099379773;0.082335331404325140525 -0.086703032129690493779 0.37132339173192990822 0.11500886914038181696 -0.34663110492141196994 0.55718740644039577159 -0.50557870819964101372 -0.36760787564022961993 0.0064892299083635154866 -1.269572999866969143 0.3686651268736771403 0.30453763977729580992 0.78202428589829864336 -0.27343470199897523809 1.289095285733546703 0.51230381532473256989 -0.36609413191046258351 1.0917416159013373367 -0.48975114453643858736 0.85736646354889167743;0.80719263968557797284 -0.044050040902970995227 0.042371787496072357837 0.15806686733899472097 -0.51934951049032707093 -0.057357951112452759679 0.40377989155783394759 -0.26519041911729879235 -0.28963960437927011027 0.71977419647906037969 -0.44533681744519681978 0.009264809630709646554 -0.10018090973606208482 -0.13314234982991204892 -0.23555357585188091418 -0.18328351145355287199 0.67174610595516470735 0.11590979733616166292 -0.50416363301840083633 0.025942479777250969375;-0.056480489415603837844 -0.0024833240804393932888 -0.67515103711917112683 -0.44420015888382508029 -1.2313666166776209288 -0.10381866721052564195 0.61942023766765619275 -0.42934321146288229043 -0.78042928564788383028 1.542080302899127231 0.40561532585328002876 -0.052543728903784212014 -0.15119091389215752463 -0.31824591551407727108 -0.41652504697939080058 -0.34039803569394500027 -0.23160113928339620681 -1.1775296667827552799 0.0017824675831935622716 -1.6158555702435952739;-0.25431276704900890318 -0.16694455728641818815 -0.62822859882698511846 -0.4124083015234110694 0.30540455888189643741 -0.50274385752576955522 0.054801366468264327281 -0.44423921721231129922 -0.26572758411543417889 0.34644017323487363846 0.059540463623805252313 0.78764945529017793557 0.29569622107757437268 -0.050988412583112700804 0.38493490121089452005 0.30937512012011075813 0.67878701302992416888 0.11231559824351486365 -0.29114952130063281865 0.68673121106700318883;0.29555169130890346363 0.10395638937612716735 -0.059377644098208247347 -0.69106905741760971118 -0.21222099782543640822 0.48370659671610283237 0.27279286950429226799 0.39368101442833836057 0.0026060965710858713211 0.16055194625230481686 0.38356408027259081273 0.80138254155688637415 -0.38331791900981176946 0.33502976815739266003 0.33131983324448738282 -1.1679166074859148594 -0.99402337428478260151 0.22732627346125527934 -0.11570065844685420431 0.24640210487988206678];

% Layer 3
b3 = [-1.9801936291628166042;1.946589205575589121;-1.6098760100692623976;1.6138414668060365731;-1.1310640020344664425;-0.98325353161612860653;-0.4607713407787488169;0.69340639694906924806;-0.15208955271067661763;0.16890803147762792347;0.014968625668168193676;0.52285122615668244705;-0.36648054744552432949;-0.34967705821165834257;1.1472287359386035277;-0.93239850519599432044;1.1370414642013908502;1.4406769863982777924;-1.7826367728022074477;1.8422968994425119593];
LW3_2 = [0.91562517136869359113 0.70376047990540913091 0.47127575945479482922 -0.14769454400823803231 0.42800646924939678151 0.50570486895939614769 -0.030205933688520189562 -0.85290797525704964421 0.59412562231928311984 -0.26415326108680642347;-0.46716226439524871639 0.21916350378545434996 -1.1162213674250256457 0.507952691446612703 0.28765748070175528595 0.16369402305665425867 0.74380459338431004213 0.45907542450600080652 -0.37688556194224065443 0.89923660511125513839;1.0034604615181621501 -0.94041780506595462619 0.74850293446612736759 0.11806522424827976814 -0.22657751110397433836 -0.49250726790960791535 -0.37436460325590914522 -0.17112505975411859693 0.29321380839346256053 -0.81349086945748849686;-0.97433230311185980987 -3.3308779913452548627 0.63226332033214316386 -1.6895971901460709041 -1.3566768246610190207 -1.0400648857697483152 0.58769399611657791027 0.59184483843614121845 -0.55789432624346968481 -0.46645070780682440503;0.19725631779496979878 -0.82377928040951997612 0.63126708256937069663 -0.1586063063862382938 0.59544154549746342031 0.12965696751787703089 0.74403570276723307586 -0.46233043727165079595 0.82186601096262013044 -0.1168304102986404136;0.34691767170339893323 -0.17633269077660587709 0.93153288981074289232 -0.13695314641636538444 -1.2320489870050483905 -1.2409750371330392493 -0.14491338051067101378 1.1358392804817774024 0.18001808429895863051 -0.26818325649605279093;0.3824250015384871304 -0.99237475979327671727 -0.10435539040304202263 -0.5771346355366248071 -0.61721347987247965339 0.058252046357252396103 -0.57523870677157651343 0.99006536886108609252 0.78541943996273644313 -0.16420549975038203905;-1.2256702312700973323 -0.13811415002164662003 -0.77465029832722065439 -0.23379734879474767251 -0.43305774653053413781 -0.7627136522784893069 -0.1950560701661038232 -0.32488825317391734071 0.71343209390247308566 0.23506732425579432433;0.63137826293881582629 0.67000642328371051715 0.083218893341823169107 -0.47169584314595314201 0.45106738817087393967 0.86715481825624662893 -0.63337126285458167363 -0.96239589218867260811 0.69908906782701740745 0.45253741585012940973;-0.30674014900668100658 -0.333733973381582949 0.49875819812156096944 -0.54498751008288248698 -1.1436494715130161026 -1.1449567380792105009 0.97109574265195131026 0.35253722669012743651 -0.22028304591766434406 -0.21003001074270155613;0.71763203247465201517 0.030404974697189553895 1.0604808256855859927 -0.29963766606580299889 0.20980445677725065301 -0.76481528516082675218 1.325581705814676825 0.021058005374872693083 -0.53508573976276929685 0.49579284187091327007;0.7350226455233183076 -0.69690706764014886954 -0.47604435014844953544 0.35007685144741135241 0.43262276285197293069 0.98466043672297898226 -0.090452421018917206208 -0.2474699113561230901 0.29316600119412572489 -0.56975333912919501334;-0.71382702175107026754 -0.2680320339542848207 1.0256459888094131561 -0.20817536125655641821 0.51531943425026793815 0.60289977377129855274 -0.25061700485500409963 -1.1257681782229218559 0.094516184162817859504 0.42911588777951403806;-0.73403923625470102188 0.10790464560712426101 -0.67956127384376241451 -0.16556072732617829746 0.10723703809755505412 0.71469728029603607489 0.81537267405146351962 0.93484106304498837403 0.5602986789473032303 0.92862107794450365894;-0.19539116944251902486 -0.62475592327874429621 0.19653025437700102906 -0.88423798730071356822 0.0057691713177790782466 0.80050010931096837741 -0.19384547268903784545 -0.99124172712499314386 0.48430302137563735476 0.65966224352733449088;-0.70150650314172524613 1.2835472762942172764 -0.0097185782025367428716 0.82592843273076477217 0.53699414978668980059 0.57156446381370284993 -0.78916920331124140731 -0.93118791435287762148 0.38168514873905334817 -0.20268169379236056216;1.1628125285268682276 -0.52016375712427476152 1.7310267702025923242 -0.38410948157563601368 -0.90765060741750247519 -1.3777369434498989431 -0.35131579422084385778 1.238739336547320713 -0.28139195990735854647 -0.42860899686251868745;0.61678639021209602511 1.1223052415735703669 -0.79640307833831747164 -0.30387430265749626468 -0.78782976729680342931 0.84984951883543247142 -0.71937248214788562795 0.19522680347853108018 0.63166529228154000286 0.94053155887550121683;0.11037164917342140447 -0.35097486230291835563 0.81105010785545716967 0.34933466202317964289 0.48526369083072951049 -0.7368731017650895776 -0.17567395191599247117 -0.7664760948029610832 -0.82042045437259492058 0.70303752743639269518;0.74479622890065710905 -0.76623633222683884547 0.63572410287867853196 -0.060996264804326662257 -0.1808391725461448718 -0.18943546696003504826 0.19938222560107685122 0.45041063954180343698 0.66147614272140498048 -1.8132082325593454897];

% Layer 4
b4 = 0.39492606013508452234;
LW4_3 = [-0.14765707027075622437 0.45256275394561795711 0.92417863784977860586 -1.3983693165094950306 0.39086069939508205628 0.81015719376588313239 0.71629511625116293327 -0.80644766705388271077 -0.28189821542677512278 0.47488552658745808444 0.11928091588889602748 0.1149133930007503468 0.16001945554597424293 -0.43103947176640594607 -0.28710335805541248311 0.31649699922789137352 -1.0978226152525432102 1.1537620834253463631 -0.73119832679158036637 -0.31115798587972987033];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.499999999999945;
y1_step1.xoffset = -2.00000000000019;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = tansig_apply(repmat(b3,1,Q) + LW3_2*a2);
    
    % Layer 4
    a4 = repmat(b4,1,Q) + LW4_3*a3;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a4,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(4,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
