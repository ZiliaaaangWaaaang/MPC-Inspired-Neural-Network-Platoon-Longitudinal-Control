function [Y,Xf,Af] = nnmove_43(X,~,~)
%NNMOVE_43 neural network simulation function.
%
% Auto-generated by MATLAB, 07-May-2024 19:04:43.
% 
% [Y] = nnmove_43(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 3xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-19.0505965768031;-6.70139767883548;-1.99738196042707];
x1_step1.gain = [0.053913604005474;0.149967019141203;0.501978146831578];
x1_step1.ymin = -1;

% Layer 1
b1 = [2.9128056671041271386;-3.6847391492567855842;3.1712879240817213322;3.0003516960097291744;-2.3940560324199537945;0.80380189866039042368;0.6969847552392317569;-0.43590635234271013498;0.64810829235071965027;0.3204541837211085098;0.19235463829374982447;-0.24609147074424672641;0.6701030340336578961;1.1893532608376944371;1.9218575704217744082;0.97459380064033374058;3.2772333024887285724;2.4743994886301452496;3.5124184285444370879;-4.3865300709279670954];
IW1_1 = [-3.0102950419490759337 -1.3553995260608020512 2.8671785767647550713;1.8033312826103864435 -2.7047394089905294479 -0.51558697768688721563;-3.6796878370387546831 -0.63311964712237511765 -0.049174520355050641007;-2.6258579446831338267 -1.2992031717822627446 -3.2937898168102446306;2.9234689632266941395 -0.9558560309000880828 -2.5347190692064862638;-2.1559069608374885618 2.1172234947741523925 -2.5375902728367827343;-2.2939341628655096628 1.2145704452553240937 3.275181082208055372;-0.70051337643095790142 2.8270266684642422206 -2.1671938395404257705;-1.4940210919049476956 2.7270289770622131442 1.9449007806449212232;-1.9121036343983774941 -1.9123945559713497744 2.3947234449435370607;-5.7561533895597980504 -0.90495285193659524836 0.70128427033855156303;0.79738943466196154919 -2.1978495082589648568 3.0395593484371241644;1.0064190497036307193 -2.0181301846192720717 -2.748852509429243085;1.6648950395667965196 -1.1155671134265709998 -2.9865459978467865376;0.85103650010629294798 2.7542527977112984949 -1.9634293665068340839;2.604717728336634508 2.2279408616411653377 -2.2868443278384651407;3.1265499420785789475 -0.68761306778368380677 2.9363704787643047922;2.7441011529422434378 2.9089841531637206096 0.33978254041785815875;1.6595310283761750547 -2.3034570042277819901 -2.4531668125963448368;-2.3233572032156240006 -0.78550711423355490393 2.1402720236144574528];

% Layer 2
b2 = [-1.1472221624434859599;1.1154291381620922152;-1.0294285534369127522;-0.10055486635488442015;0.067936765617901059833;0.24209177885072205583;0.71688951128952427272;-1.2778633686441938089;1.3275487522198112789;-1.5420232677305114599];
LW2_1 = [1.3695990987070707501 -0.81482127252508440574 -0.19054369884434385618 -0.93595302842646710406 0.53792428704344374957 -0.88772346635848009555 -1.1373442723180511305 -1.176220218777846549 0.57015163820182890309 0.35524203453534491937 3.4623381750924666633 -0.22657551219989244262 0.79440785701429827981 -0.10640049562698286612 0.2882918267271781243 -0.1561001653609477291 -3.035245201065982279 1.0341225051422799908 -0.073753299807137975841 -0.10512184523766604505;-0.60720568660599094635 0.39820961960286271886 -0.90459878775025071018 -1.530378906522295468 0.27875921402990833098 -0.20116566741398186902 0.28034648367572218008 0.35178129661015927754 0.25855912285783516635 -0.5069735476587925449 1.0699542019708598861 -0.14799537932056605616 -0.097853807979505172399 -0.31067603537173965611 0.77133523109887447422 -0.86778307094548023937 -0.025214645170101007005 -0.34572319984454874531 -0.44962655416180125068 0.43337893558999868171;0.37267785719867047023 0.33919015052486944928 0.095291911231355830303 -1.6082671274607704959 -0.88680577428796791839 -0.19600007632972288318 -0.37542148564160249258 -0.83630934744309093354 -0.65901241050654968401 -0.41024187996633498798 -0.71515806211348997845 -0.38943525605372664167 -0.50619703672593463484 -0.11703270365537307707 -0.74533318824237981826 0.020031020564857518473 -0.58066268805924403651 0.49200285399090565308 -0.2122205369670178976 0.37252048819122934864;-0.94530542596739230987 0.69515755058110073605 0.47783015814575541258 -0.46568634443392187272 -0.61385403038660990571 0.22363358995543841656 -0.11742272373798549878 0.11200794485747944673 0.97569500664992425687 0.059274660525500129371 -1.569285036103214015 -0.34928468334627443825 -0.31442442936942843756 -0.23460336494386757611 -0.47715903920012986417 0.51919771321626173588 0.3098171709655465067 -0.023482660727745630069 -0.65545891778687193074 0.043640270051445002875;0.91269296350794304473 0.3279040380230702767 0.19844792171588190866 0.53641399060031236257 -1.1701203526221735096 0.096147993276138613017 0.90998764256835495967 -0.78747407728096396884 -0.42753284885864295539 -0.71961023904939336315 1.2469119989417558614 0.13317907642760748455 -0.42498597728953402264 -0.20985099569352394511 0.43340598575568811679 0.29911919221066401997 1.0814655304464133589 -1.2364897379118249265 -0.28296844468648352233 -0.49767259442938743819;-0.49210594355635683961 -0.4198983990189421589 0.34769825115970898199 1.5519179847695625529 0.74554612993872959592 0.15676145460300142109 -0.088626906553066389649 -0.21355463545328084995 0.33560198869603397043 -0.35592013341164607798 2.0567263423685044899 0.11317471646884519343 0.02758407221616744967 -0.5174245074888499385 0.47984323974017711878 0.99311615663413488342 0.21768292482989284875 0.051326136702045964399 0.40439848100244535356 -0.6992116127288283689;0.22008539406219576606 -0.4289060800766638093 0.68554440912285452558 0.67357059766506921505 -0.4773700018313285498 -0.44313674609484116074 -0.04005866219698062114 -0.16004839711384502565 0.24122081512977033846 -0.021227964187254796946 -0.40627845567478015898 -0.031428706373579119726 -0.021305262981856518123 -0.36256403047506485793 0.48895459838247101736 0.47760270340692384528 0.57094732274696557983 -0.16415788338319023398 0.65215615785370839586 -0.10596924203147219112;-0.40080609995364213649 0.25448754263663164732 0.12359139398337806726 -1.1127784290028830405 0.23337834935513673829 0.41191623520079095888 -0.19024578600801800299 0.95427935897448645797 0.6476188869558208161 -0.52624413328048191829 0.17157212521547834938 -0.49161832484782325148 -0.067532265899610741111 -0.37222040615867096891 0.69917992169505605027 -0.32876127869339516474 0.87337588660256748607 0.022263638416908732021 -0.21454117764735830542 0.54426840606358284358;0.708625558355678975 -0.56404131290798298348 0.46270048577691569314 -0.12577856852793733999 -0.6880540573973488172 -0.15964539005268116312 0.16251103122600801809 -0.038874442722676802453 -0.34410243878154483932 -0.10073955262036687897 -0.085530261264893367446 -0.065115770208716047818 0.22844681909859199109 -0.40074240375917091761 -0.048622265934282052346 0.20627914596080415555 -0.13700720370536156878 -0.55165672365749740536 -0.17467425343972653451 -0.71929866365241190707;0.17973526640019787948 0.34941463207919293277 -0.47353723843267625515 -0.041779397768176497474 1.0312078295388298343 -0.66868797727119499985 -0.39593788511710081846 -0.50396618449582175625 1.3312627550733786563 -0.18060656681726078299 -1.6168431560924305668 -0.33996833055528280498 0.052955954807050294175 0.32887698066172205147 0.46760957489535265319 0.50972332815549070695 -0.37336645480736085911 -0.40857950547425059273 -0.56231008173462748712 0.49792121480469381245];

% Layer 3
b3 = [1.569402318153573006;-1.6514057345435375623;1.5306161111201168623;-1.3253093127813153629;-1.256682334273749202;-0.96498572757519307519;0.64794589704550165088;0.48761650195467620694;0.29531001503434689548;0.14281234012181590054;-0.25057549250908395244;0.75465179472746191092;-0.26715025713250961648;0.73098426992147014225;-1.2156345780596518047;-1.6279154665862591855;-1.7229629230125598216;1.6182514114130106542;-1.4292142653535822028;2.1713772839708576079];
LW3_2 = [-1.8943470760530891628 -0.049603627183096944686 0.2460561022069328585 0.88428531152401101956 -0.8715781060839907779 -1.1759008602130265331 -0.47516875039629435928 0.5939688269365240858 -0.11980894264519283132 -0.51307215186804788765;0.22801433653008848501 0.53562277778190348076 0.66714045462300919365 0.64017444039372173314 0.38978510107294017661 -0.82461421057911021837 -0.69560997605905161567 0.47405071294389461434 0.4544249325487776936 0.84128745645599845027;-0.29553959413152824931 0.50062668311143876387 -1.303058501465793606 0.43000600625501483876 0.16351426352993780888 -0.72650314774182966904 0.79433181867439228707 0.70910176336239649775 0.74413415929894266565 0.19432496187987458036;3.6288071770524821247 0.36523242660141813642 -0.68022641245703541202 -1.303141174083801701 1.6720992791968236624 1.8280677738843842395 0.24332750940789835137 -0.85540499841329653563 -0.059084050008559305112 1.0029096006324875745;0.23519961827386065556 1.1369726016161845195 0.92401958208041812259 -0.28738051311453710612 0.35968314600773615419 -0.63926247488860443724 -0.376051810493753913 -0.65601646564289639585 0.057315577494286368276 -0.38299976420926462595;0.34203414442992013944 0.42515272810345144938 -0.93627689149945225733 0.64076976163796117714 -0.54810323743663935669 -0.29487010244990169427 -0.48213881732218472065 0.15014791828651521954 -0.18246172695787121754 1.1057964052242605923;-0.39773478113035670711 -0.09041940362292370803 -0.62385828149923716612 0.24137161821073191414 0.12862024385750639444 -0.95385365391001397661 -0.93586110066482242065 0.40721908402267320559 0.41625525702252169635 -1.028206828644332882;-0.55576490438408387984 0.7472442271682558923 0.66280619156695408378 -0.20714914415090698863 0.62109890496271247251 -0.85234190408660848171 -0.40065164852396101258 0.50667144628295124331 0.87572546089265312919 -0.32986770099621753882;-0.6596583877180413058 -0.59355846113319554735 -0.24809366990793182972 -0.46827279649225883595 0.25594083075012480366 0.96859702390885582535 0.86328327695728013236 0.13021136943143485354 0.76182002922905567299 0.19328711460305794678;0.42322590287220523964 -0.92110676128462332102 -0.63961824574664105647 0.6363201290606055327 -0.33256494866694391588 -0.31232210416728761748 -1.0487441785287627827 -0.014030053474100639618 0.59983316108542916734 1.1489026383906639772;0.26689610660033669109 0.49953802476157488366 -0.38736130423014158985 0.26595363543456884692 -0.64831083149045343195 0.6608867335155456102 -0.4061723386514022871 -0.76870715355478547171 -1.0700468836551526586 1.1101565006145175385;0.013539626114243460964 0.5360174034554563427 0.089829805276902041644 -0.52125568108071362872 0.17733906003991012357 -0.29585201087503931738 1.1588990321262471195 0.2224961908030862745 0.51235531672811240878 -1.0137143556290226787;-0.15752968554410023971 -1.5093815425957959331 -0.37843303646854714595 0.71653488449377222835 0.0026150102761181362454 -0.437325242952419313 -0.021457208523334068972 -0.0076708541507115226427 1.2059471549958378223 -0.057530442405341532253;0.36179860675607189435 0.027686193803312754425 1.3378389285492389149 0.11270808194565541671 -1.2750188414052081587 -0.070099039711793320606 0.58181959409168226838 -0.5008489893579213259 -0.25694755461789242634 -0.092103410124596815645;-0.98094152991178118484 0.90587214063409082776 -0.40033597551731398001 0.50660651035987513957 0.19041478282195190008 -0.26283259039198947349 -0.53993167832548616403 -0.16033600291756205936 -1.196262446353189679 0.31861441813961216551;-0.47497988703452798109 -0.31642657044286442991 -0.14439918920784775014 -0.89278452325870016892 -0.74083152229371151964 0.13886597043705101173 -1.3080019159889135771 0.74303361032554027243 0.24387950380247278015 -0.021278433244246150458;-0.36974101064041198228 0.25314612831461125175 0.72296853981678965706 -0.1309153869754890176 0.64524305226337042019 0.85804421392845875438 -0.96958016550965275826 -0.001830546971863918071 0.75646606547655637076 0.33464904403310125058;0.73923712252615714213 -0.61165013353501573867 -0.068631819151411060931 0.7413015809449010618 -0.71820421538528478322 0.034298151554586715772 -0.62725641119417896441 0.44098086860662372155 -0.13471273572610298341 -0.82433179948670110004;-0.25875634527014801378 -0.71737029394373141855 0.68184341201882003869 -0.66479262740236910734 -0.91787655612482699219 -0.6625644186235826183 0.77239253591233403284 -0.35123390140011812033 0.97008406238126898558 0.3104527883857766124;0.38663111031858021782 -0.50537267899923365988 0.54495607213093100185 0.81410121781762800897 -0.42584351505612166866 0.050375602719332605861 0.9188891761891072596 -0.16854695192360544254 0.15739429901875010009 0.51054271267128348288];

% Layer 4
b4 = 0.51090660522440478619;
LW4_3 = [-0.83353072381429882398 -0.43741839409797278471 0.51626275806965160609 -1.7298353884784407608 0.091866964553736357724 0.17999670863482319927 0.049039925707433262847 0.061412948269663827916 -0.18609698011770761661 0.080502115478420954719 -0.28945531754124748103 -0.33596257385438155207 0.29238084249357959576 0.093678906695592853437 0.49787080753184476123 0.84203037802205948914 -0.43486166869527981271 -0.064622409236989100667 -0.12514945005608757445 -0.24825188880279053238];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.499999999999934;
y1_step1.xoffset = -2.00000000000028;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = tansig_apply(repmat(b3,1,Q) + LW3_2*a2);
    
    % Layer 4
    a4 = repmat(b4,1,Q) + LW4_3*a3;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a4,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(4,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
