function [Y,Xf,Af] = nnmove_51(X,~,~)
%NNMOVE_51 neural network simulation function.
%
% Auto-generated by MATLAB, 07-May-2024 19:04:54.
% 
% [Y] = nnmove_51(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 3xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-19.0505965768031;-6.70139767883548;-1.99738196042707];
x1_step1.gain = [0.053913604005474;0.149967019141203;0.50069484362843];
x1_step1.ymin = -1;

% Layer 1
b1 = [4.1453138365710175961;4.0883299081668376118;-2.6894036096984055284;-2.7590525368301648257;3.2417222714030491382;-0.84779499683759984574;-2.0828039296442475425;-0.27233332560680456602;-1.0196898506197902279;-0.23786920430604688304;0.042874330340651752025;0.40012014755427438573;2.0296156779578824469;1.3264403740612096261;2.1688888037027780342;-2.919095647505754787;3.651695887963421594;-3.2420769156877176087;3.2938397692241170311;-3.8737004465902322714];
IW1_1 = [0.62163184874484733733 -0.015837210588456777233 4.0246496851374216064;-2.6216374790453915722 2.0357965141338985049 0.54042658438448409886;3.8638372171975245983 -1.9863633870287913386 2.7356090541044073561;2.6224630603635215031 0.55890069058722469109 -2.6912096004184506981;-1.9161513145659199164 1.9284296109452632173 1.8623714600011838094;1.3367789196929076301 1.8652156854509658324 -3.193772891072185427;0.47950816332462103952 2.9479347745369830491 -1.9443141744197429688;6.0051251848171398606 0.032904211242915135105 -1.0525853754700367215;2.0638784009722312973 2.8038648826334435782 1.7400766263797633471;4.3400887407361397052 1.9577814037907086409 0.31868228742938364828;-2.5467156975426505916 2.4490795629159709534 1.4492797503633809697;-2.1804963837520769943 2.938724967166118418 -1.743096002790360588;0.9469391077146461777 1.4870675191176727648 3.2176667267738836564;0.22364560617035639245 -3.3052040111647476017 -1.1405961526138257423;2.6477542458709932838 2.7517024492796271495 0.92905909679861431449;-0.12376386279169794558 -2.4983682318706033065 2.6344903164832085274;2.3566615202656548966 0.85725708387174992531 -1.5971156338358698523;-2.0489487625245721425 -2.9429669819764909811 -0.24240845498011526216;0.26004110392296042598 -2.6504744317506521156 -2.9014336492496473063;-2.9544492481079696056 2.2912254542876828722 0.20307028734340581977];

% Layer 2
b2 = [-1.7215965980639371669;1.4867886428846759372;-0.8476308650145830681;0.59317885589241581279;-0.14816398646237080583;0.4762895047536139792;-0.26886696255220476903;-1.078934997914084537;1.3266447806688406175;1.0216370098237703701];
LW2_1 = [0.65927440382748581094 -0.41800950746797410629 -0.56382959338967464369 -0.73863132605552295207 -0.023793802509074889195 0.15382502728419678029 -0.10868349513274762341 0.10972991502963655441 -0.31920305803256998622 -0.66019626160290356687 -0.19623041253316483856 0.11139120074666458704 -0.34307005493457148892 0.44426676146465127193 0.62081811633043071375 0.45766688382974490823 0.006913192215962956147 0.57469159493494004209 -0.46345355075732014294 0.32779325998924763175;0.02829384948571505437 -0.28615873545465142502 -1.4655167292566768644 -0.32866375633238076315 -0.21740600850771288344 -0.014274289079202535924 -0.61199253435645140087 0.20341450422332874037 -0.9553113859574003941 -0.64902629316668281056 0.47494355569311047516 -0.48123740060416630993 0.68630098057954413981 -0.047455213965176136492 -0.26310305220106228186 -0.95005608746041825263 0.59923864145072047727 -0.53893852681503684465 -0.63133516482629448152 -0.55167108585780832986;1.1060150997536324358 0.54246489939039588268 -0.55501352584002483503 0.46953273401889461525 0.17818581541011299652 -0.0094631857516655412677 0.33624815583504796823 4.4044430590000596126 0.85934592826212496952 2.7804579443616077583 -1.5238999382684013106 1.8259494553706758779 1.0950932548075580364 -0.13174051718488072327 0.80435946059028928801 0.32452564125807048523 0.49025267567714253536 0.50600434896432400222 0.26375003175641409392 0.00074902854377344044515;-1.4904369178617065117 0.35054869702851976232 -1.579700541794261559 0.48111487417960963064 -0.49993195309453292152 -0.67164232006611179759 0.22315906963769238658 -1.2853830899689095979 0.23685861241581582237 -1.6212524351961810076 -0.83819836999017771628 -1.3273937731971665599 1.2751338239254352835 0.95991137043396734807 0.60182938779563432963 -0.90498409710164329223 -0.99817420548498503319 -0.041240689885792047864 -0.38233579219265978466 0.055536064117758895953;-0.56096219315086615076 -0.89770018093461223518 0.1629098409197311248 0.43897354033733548828 -0.6118623235447225861 -0.34238295934627865913 -0.27310402487391338688 0.25788338397589416484 0.2575227747081234031 -0.18724406139251703607 -0.58380784989874445756 0.56798078328319390184 -0.021197609264079736446 0.62733443141104172636 -0.54860584519796740111 0.017945595535947274357 0.099752504858843946134 0.59575094772606340676 -0.07726580536698574031 0.29384492818531410263;-0.032362522728117716631 0.01604812051937275913 0.72224754653341716182 -0.17715175364430563176 -0.37305084570552271561 -0.23517953031497446093 1.1080268935629771221 0.85709481255239972075 -0.047033429843837307183 -0.43990884035428562404 -0.3173486988417437149 -0.087124220332543689249 -0.5312177954321624096 0.56098596814687928802 -0.2198134314623744201 -0.50599524491663261383 0.42503399058956764511 -0.51739390116155858923 0.40327321226766621454 0.40803286654973441872;-0.29745088337298380976 -0.10171983580791056634 0.81523618680374565493 0.52837985606234372238 0.30726039019715251088 0.12702206855899181304 0.20870740831270268023 -0.56160699666635338634 0.22094809901856071743 0.78909324531034452654 0.079633241069654678301 -0.01442280500311634607 -0.8662224915195402275 -0.11068359253382495377 -0.079577421280979845908 0.090215782106022129883 -0.177587161477714639 -0.36001212626805373374 -0.10169886217566340147 -0.57793771378589542387;-0.36993818784555204671 -0.24934384748128751719 0.5763714604853134027 0.26513214675074336935 -0.70354431189804622626 -0.13661605250860950345 0.59048069550306447884 -0.00846066415094465403 0.33247237116077621444 -0.33602003055212664728 0.450511345749678771 0.12102141010835462676 0.12036988886508777352 -0.17167964157482057397 0.34561175425540496819 -0.04739054707252813442 -0.48293369606119829207 -0.1009646299649301221 -0.15258626419352105952 0.79098647826483292622;0.46342556916467331218 0.66830751066871407762 -0.52100444900637166157 0.21774380461226491845 0.34855119882710722257 -0.44966729414994077718 -0.36866392600272684943 -0.44970833094027329313 -0.28225441651240523733 0.28169601300378044328 0.15115278984147414998 -0.37646627604880589235 -0.21060534902462782481 0.51912761557206121843 0.25409979542497018734 -0.4551107920656789485 -0.018071137057127251851 0.0025321210444617893096 -0.053728285830680150292 -0.22698695789052700245;0.12991255377648558422 -0.45577601255324917684 0.98893705593991598768 0.7581837129422346333 -0.79357476950525729364 0.87825100275024658991 1.2917597607979345309 1.6873697551991266863 -1.0692583188916362502 0.41990459162942056492 -0.8958518565016123647 0.68926690162742498824 0.95549284977273007957 0.72425618118194923234 -0.05853860226408132833 0.18050054662250769599 0.02332807738148008625 0.3468632595727184631 -0.88564637035587834291 0.572690001810751248];

% Layer 3
b3 = [-1.5254903607981917801;-1.663345740582583332;1.5449947524376090868;1.3087804150207531517;-1.2752752187701741349;0.87547897945648622819;0.69657662550434229498;0.2828890447166230171;0.18335054816126977739;0.12578489099318343469;-0.41203292704942712232;0.20861791819460334674;-0.51605809941835256716;0.41824786391690721432;0.60507216229733240542;0.91858025669972032112;1.0794158756292466794;-1.2447728459189364436;1.7457759043594449633;1.6366553354599395753];
LW3_2 = [0.69302477425703035152 0.96549112482855803385 -2.7738163660720216441 1.6627347978281488139 -0.75542468828510278556 -0.68917670049584922598 -1.8513280447042594901 -0.66931882733002512342 -0.2594705580679899648 -0.38364460526412319519;0.44464082368006946355 0.49304230794560383044 -0.43262356756581354933 0.61579406725330032568 0.059370971694682098119 0.76408711852428234934 -0.8875836210536507398 -0.36158492252473795059 0.56541443717948247638 -0.96140192427074833148;-0.50454533329613082682 -0.59977512361521778672 0.4217623648630025035 -0.5058340182518321626 -0.72881183905222113317 0.27780654166896739943 0.67298662305052980859 -0.70593119163367945568 -0.27234110670073435889 0.87180504005672343482;-0.53487436485800543551 -0.80418841896914683431 0.76204764148462067475 -0.58566546868395608083 -0.2802469091558092984 0.18244632991698506164 -0.82571583679701776592 0.1503670749576923038 0.67795183924631929884 0.48472972185224233455;0.69954407789467376588 -1.094508419342076655 1.0713624033167734595 1.1022202414735369214 -0.28298015593129682843 0.47026390855672578484 0.73437841757361277395 0.243642840937221411 0.27330501763725145725 -0.2552767192587450662;-1.0305242932356235563 0.34959703569035227577 0.78838246398176048402 -0.18606276210659505876 0.32149353274723962981 -0.89371781045859977066 -0.2663413009420360078 -0.23219662073000110758 0.2811880208073412879 0.59828277886296743482;-0.63125767544052113767 0.41796419935010831193 0.37258526060046753825 -0.58980132979141519645 -1.0130262855455751669 0.34802019557583507847 -0.60530041444811089058 0.62626748106692120555 0.36964082187050267825 -0.86549829726410920649;-0.36169347264105716766 0.82406656024376079284 -0.85053368809011120621 0.15248278552676619579 0.71899303959130578257 -0.98312269641670257947 0.50959582766019517752 -0.20743935442488692367 -0.74363215734355270214 0.033251134033721055361;-0.31968960670195722962 -1.0984584023479380122 0.079202697965213980646 -0.01147132781611600455 -0.60270935941995185114 -0.50582100479695601969 0.7432586347310289332 0.97725977884916936933 -0.43779823506120146837 0.098217458288533621147;0.15996657464387020742 0.59854190133950424535 1.0166772101165286735 0.77212418040368846484 -0.041102068387750240186 -0.077652544337790688211 -0.89559251694951780287 0.18283582105551715591 -0.65545754740645534309 0.30385306917181004183;-0.76259163212846658997 0.40055121495943096788 -3.0829277365867295835 1.5837578829414844517 0.57392279363224851796 0.20348279404565489115 -0.011187867185415433652 0.85802809050646022815 -0.25428442665729211747 -2.2478153241696507969;0.48173860210838553852 0.69521530736755032809 2.594162570660751399 -0.88736641173281904926 0.064524245195174301237 0.075809665631292197374 0.59341978993845878598 0.85391234924533310213 -0.29932494768099060511 0.11305466192138025061;-0.91942207927013486213 -0.8732356419427631522 0.23777596889689112114 -0.29266145643065993864 0.59183985868229072036 -0.34231249756207859924 0.47003517709481024145 -0.48323714382072474605 -0.42619392956843249465 -0.2108248830458132328;0.64609501218002518552 -0.45151403597219147423 0.67172507966123418122 -0.80769855047346172938 0.28684390254224989558 0.38790041199263686211 0.80322840588449828658 0.20906691311257438737 -1.1681878947271149283 -0.64481971196395371226;0.72905040382810171185 0.33606176602248322149 -0.40580490541493419165 0.99768432547213747874 0.080393890441308735184 -0.49214112421003941567 -0.5523764737984954154 -0.099021746446250516471 0.54976126514176415494 -0.75809336309379182772;0.33810730209749351172 0.23075904392365567674 -1.4013548845111913899 -1.2899836333413772227 0.16029517749348265454 -0.020755116763414044323 0.20901550857940812134 -0.29217558532863235898 0.6366933216331098766 -0.074704278122432188347;0.43381571400579621578 0.050978097361601006077 -0.50455243768867819032 0.5999461427419394699 0.19558933708920467343 -0.99862929785891796364 0.9270238667370495067 0.92889575443753957806 -1.0072114576078980974 -0.31479253128926593108;-0.61122927953874739426 0.017491125365755179344 -1.204031735553495075 -0.29097228354387877358 0.14573329814833832496 1.3053961384232275478 -0.61154116870340513579 -0.86132855536084973469 -0.1483544522822623779 0.12866535037141502151;-0.0054677135981957090266 0.9695755854405020413 0.60726193475181455828 0.97708883521338851796 0.70117272260177510024 0.47614501054852853557 0.3661677693945933898 -0.52591319859310159401 0.070334896110885669618 -0.485380091755717058;1.1153457916181723775 -0.21407178958413264347 -0.4169187680475260338 -0.51241581249535905762 0.71445569054499391548 -0.82995980842086181095 0.55849263865843645771 0.41774379865537442091 -0.61995714796899448196 -1.0239448507292958634];

% Layer 4
b4 = 0.85889524969893527029;
LW4_3 = [-0.76001042972892129956 0.61450775982613514703 0.17272381756512061868 0.072137249980900070012 -0.92273598460480710237 -0.21744080528376241723 -0.72923074675164234471 0.30698705801977105301 0.25192507017645998646 0.18011356362171440648 -1.5513455110137797099 -1.5010166060336447291 0.31845337050995226047 -0.1702551952394082968 -0.72437538766698494896 -0.099856152795900349206 -0.5907870188935292477 -0.48655332968696496376 -0.68288455293347094521 0.042211039422778928731];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.499999999999934;
y1_step1.xoffset = -2.00000000000028;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = tansig_apply(repmat(b3,1,Q) + LW3_2*a2);
    
    % Layer 4
    a4 = repmat(b4,1,Q) + LW4_3*a3;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a4,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(4,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
