function [Y,Xf,Af] = nnmove_53(X,~,~)
%NNMOVE_53 neural network simulation function.
%
% Auto-generated by MATLAB, 07-May-2024 19:04:56.
% 
% [Y] = nnmove_53(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 3xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-19.0505965768031;-6.70139767883548;-1.99738196042707];
x1_step1.gain = [0.053913604005474;0.149967019141203;0.50069484362843];
x1_step1.ymin = -1;

% Layer 1
b1 = [4.0776037163955383136;-3.712589789372092941;-2.8627904945940039205;2.4153288757541253595;-2.102777668257703958;-2.6385482273392977248;-1.5991325083363236992;-1.7095224696366739803;0.84319820804438305739;0.38322837995111708187;0.24333344148398211582;0.4217810202260264818;0.79604987497266888052;1.5232642359864829729;1.2946426722836401613;-3.2505485197623720239;-2.6685475645013712054;-2.9120365138602908317;-3.327001141477949453;-3.8609585533163186533];
IW1_1 = [-2.3390954246656816551 2.1190911387876631977 1.7486064622202934782;2.2326251660038778368 1.7572929086891888595 2.1583657855019495742;3.4129966129590010304 0.25798032281983068748 1.8335764865441142035;-2.4632278937675047281 -1.0958082301618625731 2.916459252757939602;2.0791518963144386412 -1.0341016142607515338 3.1280680080608584959;1.9536857877214783841 1.5035578963468385627 2.4249048786408624601;0.45968969645708607219 2.3571533202226579995 2.773670465879819691;3.3957277982668765404 -0.69262978347437020865 1.2099515686460562414;-1.0173990017619380932 2.7312119169058375334 -2.2600863580404286779;2.0637592486514826362 -3.2057247187190078819 -1.1030244462879732481;-5.7168172394501244327 -1.3345020279597978874 0.48204301883135958207;0.62010823114210245066 -0.86338410001507548408 3.6550516635511356434;1.6229848871484942041 -3.3411307687798350585 0.15117253706990987916;3.4563842484798783516 -1.0857142577278702245 0.69447082729474307605;2.347375698799438748 -1.7358826627869801129 2.7383046893120717158;-1.3748256508087215444 -1.9625800666745725209 1.8721353051026625725;-1.6311403865706435301 0.10820766425029079705 3.4284135439470797557;-3.1372422448329344569 -2.0864290201038553363 -1.4184237580891221331;-3.5297223771757280097 -0.38987455140763543904 -1.4218183093278538021;-2.747807467720189134 -1.4417676755325872229 -2.3636916990478900047];

% Layer 2
b2 = [-1.729768274061739719;-1.2070837049466298652;1.0864733942552093904;0.41855114823525607637;0.17666986852468841152;-0.16176734780687201942;0.43181165828598105927;0.90005355807729614526;-1.2130220924745973576;-1.7710019038387811996];
LW2_1 = [0.0050045810769855317984 0.4233873029062715232 0.43098200082822496482 -0.56348484640890372788 0.12587153591385952245 0.16147451040850752113 -0.32263824916253397435 -0.072757865860760884136 -0.41561846346150660425 -0.088341294159582695045 -0.47538665757388737232 -0.30443213036091149037 0.54233180805939562585 0.30556433913510494538 0.075770890171035831795 0.082730328678442210943 -0.45176324851019233897 0.70245677847983511999 0.12688832124841897819 0.59081249396260149265;0.49780434440185855616 -0.55355116376200164119 -0.91833957536260213406 -0.50732582642048862365 -0.43583837791141888385 -0.53933409703194046259 -0.16010104322607165983 -0.15635673193394672431 0.19789969457888156867 0.12785142851495850946 0.71631076338016286265 -0.45789319731048028217 0.36131256000622047342 0.45389546645530792768 -0.32719451571258656442 -0.13490023380081059279 0.42940349264064353596 0.3899687966416080509 -0.32231600479195493536 -0.49179596701308314621;-0.27156025727839105954 -0.25557486519771166478 -0.30344652673626792971 0.52829318346627351932 -0.14743606680070608927 -0.24945451243722838175 0.02217066732060136991 1.3840116992877040669 0.42112110895007853761 -0.21904902825319857995 -0.99205024281187437207 -0.086626397504295862828 -0.72989095872271481102 -0.40867955084731039106 -0.22312534493361430021 0.065638712809648530611 -0.87600425619040100944 0.38569004405148743508 -0.35939932292062631847 -0.26834026305791219835;-0.36822240728495381212 0.369930850793225241 0.31709945573326070445 0.51128439195638009096 -0.73646060917439859494 0.42080673053692863039 0.42057020419096607933 -0.50911328880903272687 -0.41576148231301002234 1.0817526337441554229 -0.37710546274526085542 0.060814762474153696847 0.36569314742078301572 0.26231985647469846512 0.2943499274374203889 -0.30369167005439756668 0.10079797180978369853 0.36555593882167580766 -0.27078595385205989077 0.41556131258055578614;-0.48264613770075986965 0.55466430188570081672 -0.48232386080130390527 0.2490199671479185195 0.22286236685403396085 -0.39768033984017364668 0.33620524369482768234 -0.46418314982508213085 -0.7170111341930204274 -0.62425130151498486875 3.1951334559549784409 -0.16213975446857228913 -0.091069364986565135012 -1.0018489254968174773 -0.0058172072736234585466 -0.86978301630736754024 0.585589752327243529 0.26269254300601774244 -0.29821345875234611666 0.048140740851148340618;-0.61937129413057046001 -0.011207481309018496596 0.35803568508285932293 0.94191702311159253291 -0.45793205508008683058 -0.17255519911995292892 -0.74844216843152600038 -0.18171789565149606971 0.15265934620854806902 -0.092987928110521034242 -1.1725872484864543477 0.31923176873388414698 -0.40176484291858932663 0.098183686310594459057 0.40354665847839910064 -0.57156499269748217706 -0.70321407697309135099 0.13666397889817830102 0.063598120763998733374 0.40880366019665476118;0.028379555533027310543 0.32516176868421636792 -0.03662011866722586495 0.20422100387572778013 -0.53027275824797825976 -0.68193954786818489211 -0.19443486968636564116 -0.049129185456660978693 -0.15490341100250434869 -0.048846168425878078168 1.5465532698365545006 -0.53778733845588400087 0.043295059888177389595 -0.18218748662413933315 0.94160374079868169872 -0.25069861755665978631 -0.060859076324984537343 0.17512894547369112219 0.2173872837650579759 -0.075032316297722334575;0.19424443093004922778 0.35854821700643024762 -0.4780801851850629558 0.19467409117212633451 -0.1327364290040985717 0.4014704188413871222 -0.090637108464588680978 1.0055579509100913693 -0.068678898193011983508 0.51920073044486514391 0.41721871384098291324 -0.68841428974979890221 -0.41938048724979637427 -0.1884727244619962272 -0.11175714698730963848 0.46904331072179605844 0.26574497191964779885 -0.41072184031025643636 -0.50686519770999083345 -0.562468673379260653;-0.206789603177940845 0.25527929595975745736 -0.31261202661598880281 0.25508257192627903365 -0.1894007228669676024 -0.64527176401332086986 0.16029114129572588632 0.019329541550012464823 0.4109071057533708049 -0.090430743894108794878 -2.3444885186506576602 0.071342782527963319317 -0.078679810585166778947 0.81243471828173730032 -0.32388387985100586253 0.77336794518990870095 -0.31029894520402739877 -0.027876290892428361862 -0.042007066487128243149 -0.48953064531198781095;-0.40724699459959090575 -0.13696564782984751996 -0.21105725315318898949 -0.32743654954784495725 -0.13656349824975236307 -0.53275257280747934097 -0.095076956087632738535 0.26343000742499711464 0.83744068763828827251 0.27811500411247097597 -0.36041765760953214937 0.60705523763633439938 0.10077003089558669857 0.078349287847873191892 -0.4972162566939929973 0.35719682618051934453 0.39949793267930666651 0.32434240996901975151 -0.37368772437672465037 0.58052592117329493426];

% Layer 3
b3 = [1.7682731947999346112;1.7171455313839827372;1.5152882663460858215;1.3064277226026945744;-0.94210214764211697158;1.063165292708438292;0.61211065238563067137;0.49564925681623100973;0.23908950965097092167;-0.3939433949893559328;-0.15103539164878732048;0.14087018313510030199;0.76691711514981208975;0.83495809271010934527;0.87350654404484440185;1.1677870389995790301;-1.4016519840644507955;-1.4899806266802786414;1.7038336698597451591;1.9297514567591922408];
LW3_2 = [-0.78839146228173595521 -0.64966707478093976835 0.43684648893331162745 0.75070727217946142673 1.1664819941773090228 0.13567802145032015204 0.2328768516542079059 0.48150930403174035943 1.0317535970698568093 0.7379564866025675185;-0.94746301543303712567 0.5986961981991423265 0.51736401218897354326 0.31881963167119514724 -0.48857251539221929759 -0.21923588084844827795 0.28983320538347340234 -0.8341684661874504414 0.2926115151264588321 -0.86462933388891760611;-1.1774848530536643487 0.58416416894693612427 0.61197654934194256615 0.70063141921885685459 0.64693893387760170732 0.17227249985812348454 -0.36357826576022589382 -0.0035284377688095621729 -0.089910660348873794323 0.57986614875151432091;-0.98749082419866718308 1.1316396923749976189 -0.053773000152320969691 0.68934275608838768701 0.30943365369579611812 0.10740085592375148149 -0.58867070801777932054 0.013908584434749848846 -0.3284578020457077363 0.45637946112229543782;0.083869920506458112142 -0.94477040149166235938 1.4040872197418146072 0.42424580115603022223 -1.5510303774024518653 -0.95064610295963403175 -0.52738498793193577807 0.80971715274902356096 0.20569711845864258049 0.45869034675174868987;-0.25329048743929871712 -0.37125037315776943103 -0.69458957175715330123 0.12187010258185845823 -1.562244364079411918 0.45555513029855260188 -0.40640291216553686704 1.1438514796698648901 1.4026325882993686545 0.62856431160313175344;-0.48425742161339591085 0.42408160559316926408 -0.90381879301035183971 0.81607469557688971928 0.024925182995277541526 0.47831358437644500015 0.14872736026002966736 0.59873422702528600325 0.32808316895703892868 -0.21932711892982131863;-0.23043083754973908706 0.52203352559936666566 0.8506873928333420487 0.33002170673505087928 0.15817384626084485255 -0.059581170661194476912 -0.48244540698591947825 0.48445152318235451538 0.64241036089261538411 -0.88554416473617014738;-0.11634097465450757292 0.78164442888211571603 -0.58794215836284335897 -0.32278440529984181451 -1.2271213361587591795 0.68067094110752568437 -0.53096237006047031226 -0.062726440840068939386 0.6222468384116326412 -0.58647180413539867772;0.75249911011698611407 0.92225575916158941681 -0.18465670995942859434 -0.75391729460129575102 1.5012761937852234784 -1.240989617451331295 0.17273893721591396244 -0.47524218317642485943 -1.2535300201020360689 0.1304213901916939089;-0.41811340440772698512 -0.24923587134303898383 0.61139132252923578115 -0.53205957878095810898 0.89227470327201152678 -0.71451943724193922591 -0.30171102159721380209 0.348931378919450641 0.71739559970183874871 -0.69543593351905341748;0.33295671076772448416 0.36844838327196482997 -0.55631024925501082468 -0.2323899314033122665 -0.90008399092266289099 -0.12981707451248145069 0.31301289590870001733 0.74758493004506176849 -0.27654007717518430676 1.1228800120281581254;0.2867381433332129026 -0.88137504797195120876 -0.78863991305171499135 0.65003128949178201612 -0.86636630851973661649 -0.21759347107285387235 -0.9230827351466927011 0.74895760327553451141 0.38207429954090782465 0.17154438265305996247;-0.062776485157914521662 0.50054945360940328314 0.71381921483183874422 -1.030736814682135627 -0.61269607512472479272 0.48105747056133801864 0.24129894878957483528 0.63179829526536535056 0.31955947618020508205 -0.30309333515339575982;0.35734407548807023414 1.0759276904166443778 -0.33672649766230305923 0.65455304067248754052 -0.88733336138961793615 0.80225515523755919212 0.30399616211141688993 -0.024547558150559534162 -0.046726677680537488657 -0.6457328161791848764;0.77381447547008797017 -0.34205797472005250448 0.86141045748448219488 -0.45651057788806626014 0.26418686258830392788 0.64445282684041349519 -0.2376041097641146127 -0.37232327993561686874 0.93219640778659040858 -0.42654433765408833468;-0.3610137213712308335 0.12394107010836243055 0.55655510435203570108 0.5921592337377405979 -1.1952226075188987497 0.65394025334622762902 -0.66131715160630777373 0.2943888021820262324 -0.4558914865061862165 -0.41575053855545135439;-0.69480419347362154525 0.11230757337869590184 0.45161796445290230961 0.84356013062409918035 0.12192707362690942408 0.69440717939639207135 0.06573081566396173081 0.56908752485482694272 -0.73113395052267327046 0.70280486179438239613;0.93224285459044931024 -0.13255002849836147738 0.82373127945079460677 -0.47359445534814315071 0.35210275014596392751 -0.050857513940337620295 -1.3920152430063621463 0.28665119228467705881 -0.12538056631886215775 0.35450294672821852648;0.64221496818258017036 0.11688395668198969801 0.59783078111596466009 0.91759279598713094916 0.23888575714967588692 0.69640732438470420718 0.0042712199099492311263 -0.79448898771605591662 -0.14625192690764582393 0.44417667192179427493];

% Layer 4
b4 = 0.78064355135743956904;
LW4_3 = [-1.0666846670571110689 0.060568838038874972529 -0.22525496886938686791 -0.12162829923372929508 1.5498562383979397339 0.89196541712298405002 -0.12334676366671795678 0.35725232229909059667 -0.23828288999967772721 -0.72495837352676328891 0.31114508636884075088 -0.394712435914737092 -0.96802428092617165412 -0.34311183046244780881 0.53220648222901290048 0.11097502214602325554 -0.99425213283697244648 0.12087172867023064649 -0.28644124330271686363 -0.23657842537896556223];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.499999999999934;
y1_step1.xoffset = -2.00000000000028;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = tansig_apply(repmat(b3,1,Q) + LW3_2*a2);
    
    % Layer 4
    a4 = repmat(b4,1,Q) + LW4_3*a3;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a4,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(4,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
