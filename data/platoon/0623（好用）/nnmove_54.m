function [Y,Xf,Af] = nnmove_54(X,~,~)
%NNMOVE_54 neural network simulation function.
%
% Auto-generated by MATLAB, 07-May-2024 19:04:58.
% 
% [Y] = nnmove_54(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 3xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-19.0505965768031;-6.70139767883548;-1.99738196042707];
x1_step1.gain = [0.053913604005474;0.149967019141203;0.50069484362843];
x1_step1.ymin = -1;

% Layer 1
b1 = [-3.6674779004469284516;-3.7958763243999924519;-3.5292097527791010947;-2.234914327452553362;3.3075306609739660857;1.6025943379701264035;-0.46678845078121966594;2.0360603882683858679;0.5336974664537167401;0.425406855554842811;-0.5065638797416800454;-2.008492600630440883;-2.1070580856240299639;-1.8473531189016587639;2.1853617708599384351;2.6968873578272551939;-2.5807491655155958554;3.283307228257595245;4.1374320737243328594;-3.3649039647996499269];
IW1_1 = [3.0859401425018915255 -0.2724735504687043619 3.1380835664680906127;2.9937224125746930703 1.6725246995375839809 -0.89486682725054478293;0.63360369578167519133 0.67671049453817633257 -3.4740905082780395574;4.493046525981457151 -0.99428652911679027415 0.7621061004287013052;-0.18331915311755422882 0.46946585758716630199 -2.8758666025328665228;-4.0382101196586273062 -0.32437633159423301388 2.2897901291344191499;2.6531323139068678785 2.8440191525352083168 0.41503495959900044143;-1.7142532111277957174 -2.2180717699881982163 -1.8287904910779324563;-2.5303852393242465268 0.87322724259178896578 -1.8565402402589301634;-1.0033098313872526042 -2.1045582792009986939 -3.3294969251623220963;-2.7000991322269127792 2.9653034683912045111 1.2799008737339088171;-1.1955484590150839974 -2.7710651824660756937 -1.88472716831782372;-2.8749161467538724146 2.1734847312550216181 -0.08696882013832578362;-1.0573628270749138025 -1.9450173894465572211 -2.8997945383455654422;1.4595174341444023813 -2.2981490435571494402 -2.6746077408144435239;3.3807622687486973412 0.83758184943709146353 2.4290492783220649642;-2.4077245287641733107 -1.4301367699841955883 -2.4476108489956631686;1.968342858744827506 2.6955711211864517018 -2.6406708294693506112;-0.011281506842439037105 -3.2043883974826052885 -0.13527742902330264219;-2.5800472866683974438 1.6229548032185681095 -2.726329646673378182];

% Layer 2
b2 = [-1.8606928921086809403;-1.5113190802172453697;-0.95932991574752679576;-0.25433300083715321138;-0.20870688175318527491;-0.84791175502308324674;-0.5175444958801822537;0.36432289849972637752;1.2857756808251408209;1.232203537864221321];
LW2_1 = [0.54222285957486915375 0.1841669326256483441 -0.1111280459713810953 0.59265239478790598948 -0.25001130920276687375 0.086640117376491465606 0.41942191514394427942 -0.3913268869505948655 -0.56455794303834527792 0.54490654939458160744 0.46022844327952727728 0.24496382164795668657 0.2526903061581601273 -0.26320273458310700088 -0.6085271024063514389 -0.694040597599552056 -0.07565179318959325272 -0.37139198570508857866 -0.030017131396362733281 0.78806686891194965838;0.52726613870997895983 0.65666897002098001401 -0.25242645851791961631 1.1810487668017282115 0.81505665971196616937 0.79995557517055038144 1.3803051807340056545 0.10708550850937019472 0.43020969312738821522 -0.20647024020884030548 -1.1220161468007323613 -0.85278301334069794848 -0.18237988512290151388 -0.12054200383370908267 0.34840472801528155067 -0.026108017409589560909 -0.21341373517637138302 0.57877032623333068972 -0.49983126704332431212 -0.16857995801743302922;0.83180196814577578301 -0.4150917448691134326 -0.22965427276600480777 1.3242263382906718228 -0.6343607538785611677 -0.19152306234493668424 1.2334453612117788346 0.1912996124229970063 -0.57169089237731296471 -0.52410665128679612135 0.54020985950086597427 0.3279014204192889359 -0.27748873926780909249 -0.35847422812263313174 1.1575460127976682223 0.25837736201554323268 0.21119154638680243119 0.65284297362282939226 -0.15615389014647537702 0.34884891728783284925;0.53476572405660338649 -0.40370135411758839572 -0.40182843684958929886 -0.50411289340276099757 -0.32608326378327090467 1.1359363523572238996 0.53809317817045176913 0.16915630992726080062 -0.28711373580237842251 0.64437847479744225776 0.61059615028181890573 0.32574508326697815264 0.42878990534980471194 -0.44454822360086282407 0.19014452457424096954 -0.30591917580821237355 -0.13255071768082127281 0.53161890168356884523 0.62594371841960982916 -0.49039278137695518911;0.36285815933716430992 0.21268645963094345852 0.33202448259743216896 0.14489363615310885125 -0.10058026293770476467 -0.43058997805364329636 0.098733336200634916335 -0.16890023920685404146 -0.1937701090229552725 -0.43447236025661856162 -0.36941420742394637244 0.25632039790905591925 -0.50056791528873278985 0.52592571228695117469 0.082733004631656587025 0.26933210237038229806 0.062888882682232860599 -0.6888486923301917475 -0.47903275565969422045 -0.026750323981881776736;-1.0737546514436306921 0.37546589974928945566 0.43517916498271774772 -3.0044191031152167604 -0.36510645194301460936 -2.1418742990512718016 1.1488776446655606378 0.71335861738006167698 0.30052157167989279607 -0.30001318872801630011 -0.47271409716213791397 -0.025167308667856495147 -0.18841901069113242695 -0.5623065487818420527 -0.098952986304265813655 2.0578863782302776464 -0.027731931953465512736 -2.3962757306279778291 -0.55880819189477215492 -1.3839663510906958788;-0.89873481742103489278 0.27440113351740474945 -0.65085118156828347669 0.38450956060221880284 -0.69735097754054553576 -0.26188714894516040843 -0.59482423852547627874 -0.37804766633542652432 -0.063501761224273006734 -0.86152165590892759717 0.33186975899696591341 0.16433406158745950121 -0.63136945686622059082 -0.31208468852425813589 0.69633868143239063819 0.27593582157664015009 -0.81782447517615164401 0.47033148114459244482 0.18257391624735733182 -0.37706123253694801001;0.30186143716821151051 0.18084542040291773368 0.032403930918126010174 0.10367620345859618336 -0.023249729369257142453 -0.69021733566123522063 0.017950247005014342144 -0.29252660666790969435 0.80536106805968832312 0.60297241728750727852 0.47823285240203872171 -0.69023226870560339119 -0.25329868797013754822 0.35405771083275222599 0.16380651833987841526 -0.58609614006508625739 0.60287696176831240269 0.17735409812077679303 -0.65498785164676753823 -0.16419611793097327324;0.19632821350895640622 -0.097652656183143893287 0.48413078938891046521 0.15568698912332692985 0.61523162733514602518 0.59166036437797520087 1.0978436895217642544 0.40081268945421921757 0.92087545724294528338 0.86410272049002845307 -0.56626394780986855082 -0.018038954954076810017 0.5111602022431754877 0.11210085230109329002 -0.27589894845497014986 -0.11987329372255949023 0.5117406251958838137 0.60767746727300586684 0.48681013918761362191 -0.23473115966158256129;0.4279035022195014637 -0.041132733931038681363 -0.44248113083521367628 0.069009303149890441342 -0.22033320366630110287 -0.62926416973910326291 1.7266849447543057838 -0.60912088001873909704 0.81115368854026626 0.11923454381882578335 0.14911284993226847639 0.31877132893734932972 -0.71377521295277968072 -0.54536390683624536013 -0.47142735830382381801 0.022591370696945778374 -0.19230131094871122377 -0.54042983432206703753 -0.68781486380756606813 0.22985939401987334763];

% Layer 3
b3 = [1.8996789397732858351;-1.9158802741976705963;1.3324569397106720281;1.3673573420685323221;-0.87508456992015515308;-0.90932311580043512222;-0.62711195414402975956;-0.75873191202254997023;-0.020852831431875062246;0.17625115545115910276;0.16005673941587678089;-0.070778031331899957102;0.056579089948017767531;0.93217248009453734792;-0.55134927319374849031;0.79932898301563981569;1.465891785861924701;-1.3860180966074777675;-1.4995564347156273843;1.8120718165606604089];
LW3_2 = [-0.45430769917618263332 -0.86692340836408976479 0.21634085463300412044 0.59384820599747933922 -1.0116748698830473341 -0.10250775348090650219 0.87666796908195698812 0.031577259249176634071 0.21793919249179177777 0.60025836772981588929;1.2099061788888128 0.33850249397824422326 0.50552580813768677181 0.0032141126931155509366 -0.91532904670379189316 -0.48705960515518753606 -0.025541895555363132442 0.32816339508300113037 0.50209059036869319037 -0.20220032505345700291;0.0908844914243942259 0.45962931918266625164 -0.85347947110342836652 -0.77020464244189579262 -0.93769760911757715771 1.0388587890096296906 -0.48976162221290636678 -0.35365718787792149724 -0.52003544820431868434 0.42298850661661502315;-0.94645641915125955368 -0.50894149299343238724 -0.44900922272832899385 -0.72340601681057636885 -0.18922099825549637542 0.68303607653623443774 -0.095906670317331188524 -0.82648371088093208758 -0.18949670603806401115 0.72246951891614208385;0.18018680625798599859 -0.63254733135717056136 0.6216826964542531142 0.93913828895100803784 -0.400663116591846169 0.69917152506798063705 0.95417196001791360072 0.17669060859906360328 0.96490224555013170971 -0.29479315551400409046;0.11200491378167889978 0.84545063559576127954 -0.32068223709962612178 0.61438875831372230518 -0.52513878508269107304 -0.56536106716780931691 -0.21964161533352519196 0.31226590002613990871 0.95032972898931122874 0.16701126925256526423;0.83635862260060378492 -0.32454305700722307915 -1.1003709635097793651 -0.91330581672242294733 0.19378106982399692648 0.082000297266288324494 0.90153038336798951846 -0.51644624398157956691 -0.73835187537306368188 -0.19107305770867363814;0.63313765521274001369 0.95849043812251755181 0.16932276681300892363 0.55052079363695105574 -0.75424123981065971378 0.96705794610149642399 -0.42128076376840389861 0.64027549797168437085 -0.092940789735483989031 -0.99514011643180289024;-0.65540543604181977777 0.88077862059739919776 0.92975087640088360796 -1.0926808891524573131 0.19008895953162685544 -1.3284538994103414211 0.33873125732204917293 -0.7281404274383354025 0.012573439566154948066 0.15036308554298569162;0.58703023189314440522 -1.6883291168974519092 -1.6270672562500063663 -0.086129196185064496594 0.73002119126312592368 1.3736469172514418347 -0.4693344591785876263 -0.12954897897595585299 0.22832421002077440964 -0.89317709276681034325;-0.84638969575973566073 0.1262140048787213642 0.27676549496307778497 0.43500790905011055276 -0.41780230775249416197 -2.2001191818332159755 -0.46552674379967157181 -1.0779525654267800849 -0.18731449145010384272 -0.60601514556504443298;-0.64943404283224970275 0.27022272236929678613 -0.1238499287664871773 -0.60995157051973603046 0.065040438972768843673 2.1291811045806929847 -0.44318450591978186814 0.57161209438097138058 -0.71332739635039843495 -0.33651116807749020809;-0.60864800789908801715 -0.38159013748819015088 0.11097309538355445979 1.232630859536401946 -0.88961484920551647804 -1.0546027915427098609 0.9214683029281690585 -0.89516591735622508264 0.42752544834417954833 0.87254457820036257498;0.62200844300683066912 -0.31089898706594509825 0.43122518786924296519 -0.91745232984612856697 -0.24848392018795165126 -0.31828640547170444774 0.87979598790378421569 -0.76684582993882699498 -0.17273383719867960173 0.35124004598491925799;-0.51406594288093077072 -0.49885320180827413816 -0.8008188224984926773 0.45680509567452781683 0.024707666179471780843 -0.73949675487701105325 -0.59577759161857024583 -0.36114734996426273161 0.77915620754008663162 -0.59162644030683886331;0.91496649352618664164 1.1923628174172749006 1.2714205869728181231 0.41127781288982756536 0.89097466571284944514 0.23024302674641872191 0.61745416270961928085 0.21653130412485843692 -0.52065246117414754057 0.98224145195689216425;0.78139796361889035659 -0.51896500584755544949 -0.58373568536410047614 -0.36847101457933550961 -0.54433787861491211846 0.34039605166042541384 -0.16129179331574716727 -1.1401903452827641949 0.46588556508280293267 -0.29681271747833465335;-0.54933926812937283746 -1.0473511133445490007 -1.1512608523576361996 0.30698852360258105376 -0.25115277477518305194 -1.0812506336498628468 0.18419915509583870139 -0.31891482536753024135 -0.89166344307981915129 -0.60064976474393882988;-1.1419601078102341596 0.45231432290891326886 0.23376106506132879326 -0.78731173796636411133 0.75320354453073667944 -0.67193102613125277323 -0.94111460161031668115 0.11762021705797418014 0.18975365870177018923 0.0027717790348888958485;0.9524821652910029357 0.31219326114843032327 -0.76424577868592602492 -0.19087403186805584898 -0.18486935072928276091 0.88376551203393072242 -0.11681844133965887944 0.66570186552647636624 0.24854194940357296484 0.85619276666990051794];

% Layer 4
b4 = 0.86506894813817980516;
LW4_3 = [1.1448188502712102199 0.5359933009543202953 -0.52792841782067789769 0.95103940994937119502 -0.45607871290955703802 -0.63133476097191931764 0.54111877238465699858 0.7900398709053932933 0.65084102514692765418 -0.58479726698030176646 -1.2110979688390888231 -1.1229486362269482935 -1.3218974268512266868 -0.31590259592122543753 0.066798634410812740558 -0.70855412126243222382 0.34025330465849557005 -0.98506051495409818752 -0.87901382151114992869 0.15287031313656759823];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.499999999999934;
y1_step1.xoffset = -2.00000000000028;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = tansig_apply(repmat(b3,1,Q) + LW3_2*a2);
    
    % Layer 4
    a4 = repmat(b4,1,Q) + LW4_3*a3;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a4,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(4,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
