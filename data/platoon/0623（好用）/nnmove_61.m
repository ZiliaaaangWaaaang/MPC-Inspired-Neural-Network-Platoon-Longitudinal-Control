function [Y,Xf,Af] = nnmove_61(X,~,~)
%NNMOVE_61 neural network simulation function.
%
% Auto-generated by MATLAB, 07-May-2024 19:05:10.
% 
% [Y] = nnmove_61(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 3xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-19.0505965768031;-6.70139767883548;-1.99738196042707];
x1_step1.gain = [0.053913604005474;0.149967019141203;0.50069484362843];
x1_step1.ymin = -1;

% Layer 1
b1 = [-3.8856545197913296974;3.1286714510539614942;3.0489003405607566499;-2.6023877904577852327;2.1492781752549667829;1.9494979547580431056;-2.0433911087345077995;1.9733787242587390587;-0.58525891012397190938;-0.077094209287788525997;-0.10594159151049548084;-1.5376967908238141636;0.03991192850533885339;1.1045960301690957994;2.3278623574408792152;-2.6566725516129072737;-2.6760626170311083705;-2.786034310297363259;-3.4800054351345504067;-4.0400069452481846];
IW1_1 = [2.417542503088953243 -1.3934682046130475452 -2.5309810248782191877;-1.3714750556404093906 1.8916698579415511805 -3.5123535266720327108;-0.80158886305676180228 -3.5653246127699422807 1.5668681314606280885;3.1674957616636754132 1.5175989632653335004 0.4891256552247927325;-3.0917984202601478394 -2.4506833101204059666 1.4811169214676946915;-3.6921081654095146973 1.3783271343417609067 -0.8072331372700302099;0.57071484664202465353 -2.2894619603445280909 -2.3260879385188863999;-0.41964644674926615542 1.8900986369930099507 2.6597655538015763099;-2.1993735654201205243 0.48627329272019120809 1.958305392436169301;2.9983997611163131225 1.2875117958690180942 -1.5531235810150569865;1.0490916476999148088 2.9076009451297553099 -1.9754404759157178084;-2.5494298615743788972 -2.4972800501591683187 -1.7756320341847304789;5.6029123487491840905 1.2392489761322895703 -0.61111651915775189181;1.8540801000575128921 -3.5624807795981467962 0.15650122869654886637;3.7581206367554278458 -0.78741606980508616065 1.4022227881353754864;-3.3755605752251454099 -0.70220893506081494273 1.3332660141383421148;-0.82126469546700897606 -3.4762746874325767266 0.063718452369303402172;-2.239607722898360187 -2.2762734072731101165 2.7902294979505630756;-1.2969410284705809033 1.3787663890646744136 -3.6753552151486288402;-1.8735346057500277261 -2.3121606798476994626 2.042072083137033367];

% Layer 2
b2 = [1.7377050610834230415;1.5855760349249092833;-0.8734621838370962843;-0.2233876493705744537;0.099248184124307997633;-0.48629918331829058431;-0.67977242970864126814;-0.99433785619460923755;-1.2398298060901977724;-1.4727393711868297377];
LW2_1 = [-0.5044688748557323299 0.69767376793075353003 0.21895352818440866338 -0.87856562677020555441 -0.046615314324560397363 0.61766874253347248125 -0.3156277130295498945 -0.062659977852378798135 0.49969347270548714057 -0.35693984705703946103 0.25892272805530325286 -0.054579361782055697827 1.1174233986941850549 0.25133706053907833855 -0.35182150910149234679 -0.91784653056968978913 0.22339797551023421462 -0.27837961595107058033 0.32111111952238169387 0.18404978600261381882;-0.73396254315044084926 -2.0510596587550073977 0.39262248471170213548 0.92818297374069291816 -2.091053970016822916 -2.7068657488482492646 0.6521539575876800221 -1.0786976541894484072 0.007451688473371506638 0.23771797001607131161 1.218118229571817146 0.52271225006893751175 3.9580670893846487957 -0.88382669762899002119 1.9422522489521283351 -0.066952479733535047446 0.20491292211529049672 -1.3937642322004704099 -0.61235819338310060189 -0.23942241745392664476;0.41461184269375256362 0.41474048963931137157 0.3793837621636927393 -0.0090732583996425003603 0.33807980963434519639 -0.21323157831456648892 -0.020954360495731419456 -0.07085281892940263615 -0.071338936662378310549 0.057197865651758737771 -0.53781580222752811693 -0.085829511206826886172 -1.4206120831256201509 0.88344299200149956075 0.30638807160923903217 0.030353206431720458625 0.20042241726973480942 0.64055802330776134834 0.33776578066819329393 -0.0032992260069367659869;0.057468947976337558803 -0.25465007252735938348 1.2319763970314876467 -0.72151490480357138857 0.78554992856225969167 0.33356866991635919506 -0.34238830140181819583 0.58925369572047414657 0.57377806942144959912 -0.0016634314512731166857 -0.81307086207713985537 0.18405607492697734218 -0.44640081972049733272 0.55386464906531363006 0.36099883452399783579 -0.17124904191680048737 -0.06825644647174480828 -0.42951035458975317383 -0.66643702390791415002 -0.16125836768910734031;-0.2315080492428880643 -0.79305594128166700951 0.59846809679223755829 -0.24368232819066201755 -0.074534882487668360773 0.42612576067982121941 0.37040009166536713714 0.066045443468550596444 -0.2375999992232667446 0.31334524629594345813 0.019978309712325267866 -0.062529104239864394255 -0.59847156415618429914 0.64412261301014916981 -0.27742618294054111061 0.14924906565367873634 0.34039983208799479142 0.36655747093002505332 0.6981701975808698446 -0.22957203355411015533;0.23393731899523512174 -0.69723989569105104813 -0.62705577506256782172 0.53302788270531031856 -0.57562300375956687581 0.019879038744393898869 0.52789052487260146318 -0.57437532522410006397 -0.10160007373583819501 0.53580966660358475551 -0.34311257732459593539 0.42235739830934476702 -0.27150383448994463986 0.53171267547947376197 -0.095913361650019929305 0.62496864071242230754 0.50680186820907902057 -0.17854589530032397016 -0.14237318079240599 0.38848893594537625695;0.068048594939791873237 -0.38471162619663162863 0.12956208971060012569 1.0086538990705977703 -0.19976649457366069118 0.49662214636829210557 -0.098107638839796992847 -0.38155239132164786575 0.20564601452087807876 -0.75409621763478396073 0.18306632653217175255 0.85258013498905016458 0.074453299856478014074 -0.78209065796226517886 0.032653923646082737287 -0.1651634695728733393 0.41553653939901724623 0.12230272340566807066 -0.34594244146891994784 0.64643900777401752666;-0.3543250196845236788 0.0054846264084422551022 -0.10258281017103461352 0.19575479233574744065 -0.30855645873129067258 -0.14754074442658227095 0.15741791069889138344 -0.33388939842333642538 0.1373091075810807804 0.018036386801016098674 -0.04803318869288401155 0.044920390781610267106 0.48774196272672198926 0.19867197608496681149 -0.31196107036396503176 -0.36746073586466215799 -0.33090231965062749664 0.042830967351100056317 0.61275742324575266373 0.59603066027061735177;-0.2719174060335955434 0.85438014219531588367 -0.54421930694206732682 0.10916927953648519756 -0.1782262545873928572 -0.19193283212831038775 0.23976652692496330799 -0.23660880501286954414 0.26100623003590595061 -0.040991539983413129156 0.20868191144273573467 -0.32575775527094008588 -0.69524082449750312929 0.68023488115308927693 -0.23807849746491221987 -0.54879958571745457441 -0.00051140981633442128031 -0.75814688114790240725 -0.46272462925700830194 -0.18071744782824850084;-0.36322174035245302637 0.1030108655654586175 -0.022903071223092350689 0.10482746070909333691 0.54104227092128542864 -0.06727095453625418775 0.48914869207583538957 0.22444842290374111826 -0.40552109835751293243 0.25863127662337159762 -0.030038658137092309058 0.99728054550758427066 -1.6036422118055073671 -0.62763515330717090102 -0.76904726276559842724 -0.013126814917672546129 0.052609668145684344853 -0.45973522847618281117 1.2134153471440571881 -0.20740400672302947149];

% Layer 3
b3 = [-2.0224992573683993058;1.400841214295352799;-1.4694888363619806881;-1.3125221235690325283;0.81810789799218186502;-0.65320163231776506851;0.8106094306480892131;0.38667747921531198108;-0.2912191522665503185;-0.0071032697495502193641;0.0075802113086104825485;0.3150827927227862757;0.75451115675033642027;0.53631005059526082324;-0.87898231391706871385;-1.1540332216884450212;1.3153252417453009659;-1.5872420215625693274;-1.5033931068641728235;-1.7863180117004902048];
LW3_2 = [0.67945485736132016363 -0.46737995331912285391 -0.15956119239082866557 -0.45954043109334552497 -0.51726916736292505306 -0.43625808747758482165 -0.050009743124293272454 0.77257031204048909334 0.61056088066774394374 0.6837012487789795312;-0.20117566464618044653 -4.3410178548853348701 1.4899434564490343647 -1.5320462615201309031 0.60995994781371820626 0.98824400197630279941 -0.23436817651977420729 0.1068462397910591305 -1.0608405434682985913 1.6203454062222373278;0.23631779896452531631 0.51222744805759079512 -0.76951286656817219356 0.12697735467298226775 0.70657252825571115196 -0.35596437287974036501 0.8367735733246419727 0.88944293222423553846 0.46674722969734044886 -0.0044442939172954949723;0.48810462695642337083 -0.28576257260203835608 0.45780683912831582338 0.56854869338194957695 0.97264244229499141614 -0.062622930860627923355 0.61716336058178000723 -0.44474780481842274282 0.82873755337812271549 0.38427017460555240591;-0.83582848054387126613 -0.97219570057049686795 0.5807494788209055514 -0.63943661948402652495 0.99753681978915675899 0.75078768437868370622 0.13737746523890817518 -0.73841737074107771654 0.90462697479387521593 -0.39418054823406495357;1.1009390932859519641 0.92705878228617955017 -0.8525845554536308768 -0.96854355402450664769 -0.41927222172745903794 0.08551360076835187729 -0.61831814278244789929 0.047374594302509454025 -0.77369512009111207629 -0.42841975992956704555;-0.77307289792252487093 1.310712913144323144 -1.2693597554700788432 0.012866275112223711161 0.13147931871481546851 0.40294269489674444662 0.1887847998429518781 0.28345982234697653102 0.56193263178734564889 -1.2747936911837711715;-0.6821955364538500044 -0.63890323313132446614 0.52852274632964402201 -0.8323280506179024929 0.43445018650201139288 0.45104382036677559409 -0.52560157976971333404 -0.25463196612190797108 -1.0717982777318832976 0.31268164118673758001;0.59750357308437374027 -0.22208594970621534093 0.35896646938878085109 0.28078007481055405892 -0.22752117789537321113 0.85516754114318827007 -0.75891200852657636489 -0.47546795264450292251 0.59056475097828831089 0.24712938598831871162;0.30967394609519555138 -1.0346624480460986373 -0.7212827017227522175 0.84806451196571930318 -0.62497355780650887258 -0.10936765521445894478 0.15587682134957353552 0.12552588268195746801 -0.056337560479192180796 -0.32183847290255179763;-0.26143327972106522594 0.60860582152535225298 -0.72852284199355854533 -0.20296837873212664194 0.35131517481178570206 -0.73397844435686387943 0.64908640435673647939 -0.65283313950708132811 -0.29098794397770327835 -0.80471349295436689353;0.36498278549824303418 0.14612138889607567682 0.75090902401017123324 0.4800436822914173618 -0.66694759445921658614 0.64436961889814470261 0.44843044540634596773 -0.59806250163482066462 0.86905282152852458832 0.13829553348296153015;0.95914379958509587976 0.43415837850031985257 0.2161962553029855294 0.3290795226471194268 -0.2557683303719016088 0.10747772352530696183 -0.70054995584678148024 0.15284506304873074489 -0.76596114475948740008 0.67232145795675790634;0.51315772976857954024 0.67101296113439723445 -0.78741161048985341964 -0.63670455494662836493 -0.97140633484531280217 -0.23483752096919494057 -0.52988686840033583092 0.67426197153230582604 -0.42671010415994042875 0.33965304614481467427;-0.60576365460606618196 -0.73143066800822365003 -0.88349596781115580235 -0.52642299362098277093 0.71428639312025621333 0.76589927025899517954 0.020116755426424371561 0.5197475113593416074 -0.43880329909200599392 -0.099829385713773699518;-0.94635870411157407833 -0.61970146578415630234 -0.64007533567652852291 -0.21069592537614351135 0.091049616276331082898 -0.62446836745376210764 -0.80447871881139632055 0.070446137555828194921 0.76437249928428419032 0.23174714517988059814;0.43035896057193973041 0.53929592686014815595 0.86617495675080569129 0.79337569185609457811 -0.82082863301968522762 -0.44574260119643616118 -0.656624284384507928 -0.49176723879662193051 0.074247022770240478362 -0.10176298453926022058;-0.63729127854130196429 -0.15248924697334334533 -0.88965700058766306046 -0.42749808639146974487 -1.1108949870819093686 0.52983179899906496235 0.63706360165892506053 0.21013269296765396676 -0.040612142925329101917 0.28144095139019414953;-0.43799870845224597726 -1.908431991288144669 0.7051861015636959884 -0.036420000480467264181 0.98456297151790794775 0.25271036928155632406 0.29128060897398322382 -0.76108431034230761281 0.50631640481449413649 -0.30883134688018265557;-0.68806536306352839016 0.94391123462803894206 -0.7451152345480787087 0.51256925776584238985 0.82836391383836838198 0.25500190456432586528 -0.4917226954233040459 0.73575294791726397747 -0.42331039453882529644 0.011070136471753269647];

% Layer 4
b4 = 0.0012172742754027938462;
LW4_3 = [0.22337809269490677133 -1.3577972508368258975 0.050435592226818613815 0.1387085661668856218 -0.42468713772315569432 0.33115359970389868227 -0.6888489836979136971 -0.22431737021455333547 0.24814633944781067099 -0.13333122781218140207 0.21165357992520911212 -0.095336702947933907315 0.52653948788840609918 0.34495431054418068673 0.079662213246536980882 -0.080115638257063193084 0.19721287366003084629 0.41364260252466233947 0.8758896930339401532 0.11932819046054177203];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.499999999999934;
y1_step1.xoffset = -2.00000000000028;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = tansig_apply(repmat(b3,1,Q) + LW3_2*a2);
    
    % Layer 4
    a4 = repmat(b4,1,Q) + LW4_3*a3;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a4,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(4,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
