function [Y,Xf,Af] = nnmove_85(X,~,~)
%NNMOVE_85 neural network simulation function.
%
% Auto-generated by MATLAB, 07-May-2024 19:05:57.
% 
% [Y] = nnmove_85(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 3xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-19.0505965768031;-6.70139767883548;-1.99738196042707];
x1_step1.gain = [0.053913604005474;0.149967019141203;0.500604127399131];
x1_step1.ymin = -1;

% Layer 1
b1 = [3.2489534781356943505;-3.4205981704365253648;-2.5211487344069158922;2.2315862672277084755;-3.0154906710319018259;2.6479764599400126279;1.5772284065712909307;2.3150949283494841602;0.9354450483752237977;-0.60318284388499177062;-0.13465138682065566633;1.2678162836979323114;-1.1246526253357753689;2.0992611827792844181;1.6519674204152574593;-3.1857012981297549992;2.8599100238105426008;3.5260651369361100116;2.8498490830385327932;3.3151443020916957494];
IW1_1 = [-2.7798594430524432575 0.065519853399332958488 3.8294576707113678893;0.46834791021271382494 0.21454364388252089579 3.5799584904701293731;2.4551802755711222837 2.9985688230604257143 -1.4949682091255458438;-3.0522780724900711036 2.7599172815370116574 0.10718312246356924422;7.5175304948296464147 -0.068465189910711904409 1.5779991035490392726;-1.7386907743353277045 3.8530944295370925801 -0.95529315827814653694;-4.3233437827847138735 -3.0848584267569738593 1.1380178835890775169;-2.8464001539866758961 -0.3221254076165162572 -3.0296543989933213403;-3.6765193543152454581 1.2945028127182762745 -1.1686523439366931498;1.0496081892920727796 1.1764782616117139824 3.2924724790740622637;3.8699376251240238389 2.0249553514600444615 -0.15658043061341919699;2.4373310901948324059 0.59275458225683941293 2.7462380282645102447;-3.8506653369928902642 -2.766889194458624246 0.57743712547145464864;4.172999608341234179 -0.99849570203356230458 1.024177774540189656;3.2516812271490715958 -3.4937824065419871289 -0.045404427717462725322;-3.7234731918025905095 0.03816985868609161503 -2.7919679416547915629;3.1338760274345429657 0.37091544456818115183 2.7304391411502666465;1.0589531184046279133 -3.2494086701370039627 -0.53247207897175652391;1.2318565319180241335 -2.6493752853225003285 3.3674971947090623914;2.2698132452969641548 -2.1271960670379996827 -2.8640003532248079487];

% Layer 2
b2 = [1.5749370860353522072;1.3159938805392625838;-0.52139280321906533722;0.90448778714162081371;0.7703430941614927141;-0.041836930839483164879;-0.813576149307290164;-1.0988653946858570887;0.93606192858025250025;1.5226027597346485365];
LW2_1 = [-0.44396665475648333654 -0.512106261428896814 -0.23704723222513926495 0.41858477725504034117 0.43488755864099892801 0.28241408771448128778 -0.30801744294127664237 1.2269043275515936209 0.45321961115652759089 0.066396520930700406171 0.26722798543389980619 0.13198596174906460088 -0.056294167167935484086 -0.24845628986129406068 0.53635466299577960747 0.22959470570352619179 0.23395025406464439732 -0.16348640493101088134 -0.31730653840136585631 0.56956622607129803182;-0.37230524469184783642 -0.024484313628583932038 -0.39012045879321427533 0.068523640630472532065 0.6474921645246793922 -0.78045710863693396053 -0.35821723402404448411 0.31473208865579016535 0.21181793851523711414 -0.13915772517679653175 0.58419614661797536481 -0.22856096917139126501 -0.57181922121633332878 -0.20663950381135082202 -0.17822627854356276611 0.65628783463432693868 0.41370841667707608513 0.18923639217237975263 -0.02223178378126655988 0.069188723011692820908;0.62224168646679689498 0.05726532743288402505 -0.75187687916519418962 1.3451660205225126621 0.17184267770858796531 -0.83579326894180683283 -0.055256829368754742382 0.61481225890846002979 0.24583482534642731032 0.056269693712834786825 -0.82559256990442342339 0.39389204730548749156 0.79721443719152917939 -0.50380601352770038037 -0.27804180512753173815 1.1892128764695493182 -1.1286251779306748499 0.24606025892387131671 0.18465547102036775073 0.29123182998728702753;-0.1267730341724261911 -0.74522155152478686269 -0.39833300474269534019 0.65201410702877460324 -0.1021750826520805705 -0.39222122204619436214 0.001072707116604551536 -0.2281137347337789667 0.37575528407154307198 0.13539450197831026657 -0.27250261308919121461 0.34996671538795737222 -0.06655396627705628676 -0.34071421565299164769 0.067990980024366931556 -0.57948102398142775638 0.060947073037295289299 0.39990940902405269775 0.2114477487918747789 0.85663919737294003109;0.38431410572482915811 -0.43995572358085649478 -0.70178715860708540397 0.25074049709707313394 -0.36463439021600063672 0.10444781481167142445 0.39995629539616922576 0.22434232575149901101 0.084473597118505369674 0.35186586744816117367 0.030359041712247340772 0.22818120359363053273 -0.78985655998445425396 0.26183782291329227299 -0.026527358923612260472 -0.48329412320901643518 -0.86448175683886308018 0.63724866216271303099 0.13369792201043614877 0.21364274455389539731;0.36015091871466214934 -0.33514809200897743846 0.14745395573786593268 -0.41797892829297489392 0.18062787494849197323 -0.23232902893349308138 0.53482319821563140128 -0.22179659944513108183 0.15413438009110080884 0.2495110213513721531 -0.74239708449459662631 0.20729685179606530121 -0.65503070499877924515 -0.13050424546440911322 -0.68063217822105148702 0.85983305756263739283 -0.75531565739453010444 0.018174590383167654739 -0.12711077277605664637 0.60723988303902109998;-0.11081447081927198184 0.059065733237161362201 -0.27207762549985808898 -0.21701906532723067023 -1.5774284233145048351 0.30331086646841654009 1.6679388330800826168 0.32517313603742487027 -0.40660164817569793838 -0.45378425922605658549 0.71120435791967206995 -0.59939191062711483227 0.059913443985613233644 -0.84142315721759486369 0.1183688255149128038 0.070073318217269184305 -0.56400438371027439288 -0.57028080221244692449 0.69461529011440259485 0.11123491037426268269;-0.41701536588693594032 0.19116986659003787352 0.48585104306734244739 -0.48734934484937725285 -0.19637498160360841726 0.10109128383285952146 -0.12630508859423195123 0.22969147595319266975 -0.41478759009143595371 -0.12109359611058526096 0.083918374008466162239 0.15274337331629542214 -0.25879008244223666857 0.27887469932659647576 -0.78914204509607166482 0.36998398466117882188 -0.15359233266177779731 0.36527343815638169122 -0.33246864391988889542 -0.59012266386553446917;2.2606288454282110756 0.40303814356190598156 -1.298821170112362644 1.2430918732249216507 -4.5649856918532289995 1.3079715501214801421 3.2838224116123893026 -1.6435116759113299612 -1.4158109904224376319 -0.30331171808521328881 -1.7839184436886368346 0.55314280871878529489 3.1737407579950245307 -2.624028475742916644 -2.3297016888241515176 2.8432321822441197767 -0.21132994445872679834 -0.62463620310632461674 -0.65423612616941628772 -0.99519625325261029669;0.46588569788230144164 -0.9433558701947730718 0.45634388477309689724 -0.50422758546390333834 2.3805385947270516489 -0.27313086490453930555 -0.84061141032866659728 0.50137236266013895936 -0.274780570072214958 -0.27603492092643372446 1.2164134633277836617 -0.32569670199637490438 -1.4541479014433085215 0.021980985191409081053 -0.14537263781246131944 0.56076399565425727456 0.28751143233705805935 0.45926969524876454232 0.25483323318900963361 -0.58475293058099742094];

% Layer 3
b3 = [1.8512785816585592968;1.3765072336342785153;1.4778002687290587858;-1.2727537877874439687;1.1591715569437881506;-0.82119414675675406201;-0.74228222245628239229;0.59531927753671654013;-0.26345095209875291076;-0.42599329002355784679;-0.0025663652345961620801;-0.3394858662570868213;0.4278873328222045358;-0.91126273425205661649;-0.82603184125998230236;1.3500253489312115107;1.3366778052747820826;1.6420282132644377082;-1.7290492077194477005;2.0068111141582853918];
LW3_2 = [0.30257653999689726465 0.71591847804917352338 0.90544047324304788305 -0.97259960978068915605 0.69109890998138401308 0.5833914006369004257 -1.1153222889040510513 0.41452248425767701523 -1.2200268826831222047 0.35211475553565463326;-0.49982033553501303835 -0.13224472807622802972 -0.19681385486127142559 -0.45385975819679796883 -0.82511081266495445163 0.71968330116758894022 0.31580892832290424765 -0.8219140588628655042 -1.9077582800275889596 -0.091981064807502954661;0.21159058300757621618 -0.2801740345105992458 0.87666997626666964827 -0.59956233530110214502 -0.309944990298105294 1.0737743835093966904 0.25029017631860450699 -0.75636453030739969616 -0.12510157169045982295 -0.22122324620908390136;0.43338859375634630755 0.71808885098769081878 0.67887771604870472686 -0.67468904919284400368 -0.083630128440900675102 -0.57799384351626703626 -1.2783550017310163494 0.38041549399530211195 -0.91758374460435043751 0.23199525262021800098;-0.61721450430272084553 -0.045489945986167970582 -1.0251530775598864942 -0.076761864029984999691 0.78495673455335968072 0.473772904219669444 1.4739005995687011197 0.48486615266945781721 -2.7670622287928963168 -0.16364048910103914936;0.072792345851837261805 0.79911317785433777505 0.40355372815845053092 -0.90519403863215852635 -0.62019864622953735367 0.38040701813183702695 -0.19741682288867454242 -0.90392861585644523892 0.50536473053184260973 0.5190005327207707353;-0.38724351485390517968 -0.97756101207674039877 -0.66149533991773157293 -0.27445194194618699468 -0.47974692721704126352 -0.16432912089861273497 0.056958892223605943339 0.58233968060926832866 1.1023599516490760752 -1.8325769796840944981;-0.56447065682608321691 0.45441713906143849089 0.73974113411577990806 0.66958005695943689783 -0.13322525772487148199 -0.18498423160028987233 -0.96447034046434243493 -0.61842576770479462667 0.18470488987622366017 0.59172389527343072224;0.62529359312103616197 0.36310086213813658196 -0.58688354433664180476 0.71257415370297527701 0.84947068391769853246 0.79718563799181973994 -0.20759516715888767791 -0.53736725005924956822 0.52825018448201865873 0.78296088306304323368;0.56827247404344904957 -0.40760875956088821193 0.34896291883212293694 -0.25418566998096964182 0.4755109469659675181 -0.40228898957518427482 0.67725120337702704454 1.0391484023472803422 1.3918226542857612404 0.8251620958830349073;-0.89366469996986619417 -0.13369926823158057028 -1.0798468445128122095 0.81907760576415555853 1.1616213044388281617 -0.13418524489450556203 0.12170733021942564678 -0.58586844609795218908 -1.7068899316320165216 -0.51345660814576232767;0.04986584928660678373 0.15809251232435747592 0.71724617494798237338 -0.037528929300591679086 -0.20900511914711955574 -1.182111097319046733 -0.96958064328387194575 0.79336056293734980027 -0.67964284398288865585 0.22173307670776606915;0.79438575586978288356 0.63585866649941391593 0.28665312195596576172 -0.82146557367599726263 -0.36862039821869763134 0.13507104785817894421 -0.53184157436123491447 -0.75050565924637324677 -0.28589873661118014869 1.1156586665512482348;-0.78565425429002455626 -0.69330671043174907364 -1.0621787012094521252 -0.27310773388894699076 -0.62207475433569614509 -0.56954463983358050161 -0.89035355814159045096 0.48576811241755196713 -0.037942034942161619038 -0.72056688306639271602;-0.015110076813679179653 0.94461263792543215256 -0.90266214848029024953 -0.60907058466915464656 -0.63735456060572936998 -0.79769700048971980966 -0.57457082558880923084 0.2577966984748715773 0.29817243867517717604 0.63728991778868226969;0.76293194930468077875 -0.01163685902976883263 0.20279742647369200514 0.74013034633190522005 -0.77612237845553655458 -0.81178383915116647529 -0.81783159217627710014 -0.836643885264347964 -0.098622901775867563567 0.49477567799003657756;1.075714133695598429 0.13489420597032950044 1.3890069041135515437 0.66432938475041947157 -0.042900453331110539879 0.60675807945436821544 0.1515194119118340732 -0.35817479195215629062 -2.1578794142715982396 1.9207288231359891384;0.11082902178750503319 0.89125462269983235508 -0.41435803508999591305 -0.48565968146814031403 -0.63573174616761962685 -0.16396347342043507411 0.94358601614257053836 -0.81550905455380184872 -1.1719489079470473136 0.83315049414114317194;-0.76708094589760988935 0.40256180514779571489 0.81454626830098619816 0.21915257213053224161 -0.74578554884251502255 -0.40583404502360032051 0.50843296421629879944 0.70813885258289066549 -0.81293626669110019556 0.10012505703840204885;1.3560708348087580077 -1.0069869379728726422 -0.43768375309184304189 -0.20871208460198101275 -0.63729720202618067582 -0.94870338808400489494 0.7453846759945497169 0.73587522652123671385 -4.8814536680480165032 -0.39398412469526172819];

% Layer 4
b4 = -1.017574924642403067;
LW4_3 = [0.58725928243591618561 0.52549732255887127153 -0.709661601106493789 0.38393924554914360403 -1.1083770706298821107 -0.085884882537268905645 1.1129095208696719865 1.2510548166449801943 0.47156200879540122184 0.66983701114440741264 1.1657360915420507119 -0.51586383624088327782 -0.49567786882583669827 -0.51972163081212885416 -0.48656367765692160043 -1.0722852964138265275 1.0148124779669926987 0.7118428554578707379 0.75298886099934603244 0.97701148938703630265];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.499999999999934;
y1_step1.xoffset = -2.00000000000028;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = tansig_apply(repmat(b3,1,Q) + LW3_2*a2);
    
    % Layer 4
    a4 = repmat(b4,1,Q) + LW4_3*a3;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a4,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(4,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
