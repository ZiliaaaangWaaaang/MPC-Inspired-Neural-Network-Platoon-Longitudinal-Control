function [Y,Xf,Af] = nnmove_90(X,~,~)
%NNMOVE_90 neural network simulation function.
%
% Auto-generated by MATLAB, 07-May-2024 19:06:08.
% 
% [Y] = nnmove_90(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 3xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-19.0505965768031;-6.70139767883548;-1.99738196042707];
x1_step1.gain = [0.053913604005474;0.149967019141203;0.500604127399131];
x1_step1.ymin = -1;

% Layer 1
b1 = [3.4658877685194928731;2.9811589202582662317;2.4030737449618109203;3.6101581928870665195;2.6920760856972285602;1.7378450794466377971;2.993683923541769154;0.641511081817501716;-0.73574157305388765415;0.25995499398429289251;0.013959124844269827498;0.006159270124049917583;-0.8780609494320401609;0.084544353444822389898;-1.9965930416303070416;2.8873070488602481376;-2.570039541434980368;2.3539180049044485799;-3.6209000555476635874;-4.3398870534140714383];
IW1_1 = [-3.8903246496920798059 0.13829433446709391009 -3.2228632204394509486;-1.6075536036795012862 -3.3684941469812224035 -1.8829416025053746786;-2.6466132050854609403 2.2524049156481074085 -0.67142569533621609956;-1.7072979832668735423 -2.2573172093378852665 1.3921783428990133213;-1.5003246361566384692 3.0073225556503517808 2.6825165110553479408;-1.0812047003568052705 -2.3035745112964467474 -2.0126984301407762068;0.84453808009074271546 -0.27069587807119116496 -3.614649664667222595;-0.59800830389076853333 -2.53817970548637728 2.6232460064296412305;2.6205862729897866359 -1.960432077549757901 1.7693058722471779465;3.2383026544766093657 -2.3457898965920804812 -0.90366804951839163618;6.3876904428431950933 1.1364583697396333228 -0.72673881780246152307;-0.46578389387659746568 2.2905066840780587967 1.5577557412659455149;-1.8444025747123036219 2.7254035283986919325 -2.1586425500829187207;1.5602076284352754953 -1.1484697976421240906 -3.1529038534933833127;-3.3225191287463027301 2.4517270064881895308 -0.77659720523705377815;0.17929989557852540893 -4.0606896185480678696 2.1092174991325278732;-1.1272697351582303682 2.0542664732682882622 2.8820443842806349188;2.5994728928770935994 3.0011164483569552353 -1.7466496136862910138;-1.298517349316867131 -0.29291099121500180358 -3.3074612122149198434;-1.7070798951249752662 -2.2193042798846183139 -1.7775385438486930312];

% Layer 2
b2 = [1.6040595314248273784;-1.380408521681415035;0.54770726372820366379;0.76162996026481277756;0.51154857711604106996;0.16313457429709021795;0.0040997263710226342082;1.0506207344161966333;-1.4836811017572906213;1.8057816598749789616];
LW2_1 = [-0.22500078646626925361 0.18634062676360607647 -0.088497765459335533955 0.30707963712018199187 0.33271674548064855692 0.57306276411374545976 0.64418405173944359721 0.067531750599939141533 0.064747232453084724302 0.45917276388947414478 -0.24124232225272118635 0.46041086702709038692 0.28553783212969863214 -0.19402284708797343238 -0.43611237353252668703 0.55270786862127685435 0.28579731802536301188 -0.36180135634986432258 -0.098507069632634502998 -0.3098536349616874408;0.08940144456819623664 -0.38878611480967301128 -0.19847734823020873884 -0.37141890786269243785 -0.082246177254565899784 -0.3936993676388967911 -0.24002044312125270231 0.072034858541493038131 -0.87061940724077868659 0.044893120285079905762 -0.29106760724718111488 0.071968057338432450676 -0.38908896337882337146 0.18728015612174447879 -0.15510225441474764785 0.17011471899679619924 0.64672346462269425516 -0.51930825191508223071 -0.16398117098701545102 0.9166122528521194468;-0.75219971270181318346 -1.0049177985973130056 -0.20245675704409946127 -0.38263151839525827436 -0.47520718052099641948 -0.071363034312027617823 0.3878714113208385772 -0.61394590547603122843 -0.58137511394431651279 0.2768745930691763335 -0.31018586821486693328 0.087845613632790642278 0.41166706671959757413 0.14319868712265793054 -0.30034220745340184378 0.15325568892929877785 0.30988420782136461007 -0.17591870629926886771 0.65276054027536534186 0.32066211083328760578;-0.96852275722486536047 1.0049633300394222868 -0.32871894547735552861 0.89228305959289089255 0.11948528443407621658 -0.11584494060291451734 -0.80258253218163466691 -0.53979864247744213657 0.047557699865278954543 0.52219228962715269482 1.5231670913231285525 -0.47081319830487994293 -0.13220704535537811108 -0.50102293592701363512 0.0088516393203976126425 -0.93662881774789064071 -0.20831189631397542539 -0.22198836741980199072 0.20121127408800862368 0.17713546048367614927;-0.018913710549318549226 -0.20314439360438613091 1.1152303457860366365 0.63825402590901358924 -0.18194367060221075527 0.67708467160599117296 -0.74666542846534855737 0.50401996490366696158 0.051073162675592018167 -0.49869404236077774506 -2.9051187374939844155 -0.68372997322075912408 -0.45831299092856719879 -0.090967161577102606529 1.0837553062042644125 -0.18259679393965261296 0.12522335950141696981 -0.95099362604104109575 0.69949606849887846494 -0.36771345279947698081;-0.12095994709987796523 0.68595259600214741891 0.68820229459785942083 -0.035757947256878842845 0.71831572401518395399 0.56004928050004865181 -0.075177898309523677467 0.40478547105975748455 -0.048286926227265887512 -0.53612120763667625578 0.92582514493715595272 0.046295458612753317973 -0.13424196402860166799 0.15254951943266631398 -0.58090918666438728923 -0.38580374285610796736 -0.75615457650749007268 -0.0073582806992289803011 -0.47068211044458996284 -0.029008122452166901911;-2.5696376287205975331 -0.5636318380511700088 -2.4848693184605115114 0.48615574747685091905 -1.1949013560472856454 -1.3380233039940438999 1.9977057683543764099 -0.45478232150387287724 -1.2483710561694514318 1.1583855991644949057 4.3391122437560181169 0.92557001284883622105 0.89274389942713294754 -0.45700239448088064709 -0.79048562893984908317 -1.3918861298074478583 -0.44753772407779673914 0.68671747240348279817 -0.93873321496138917297 -0.80942402794138423872;0.44868236168508252026 0.055134070877368768215 0.20193332583314052564 0.4378756768699042512 1.014503098056836361 -0.8012166075620295036 -0.73580368287897379709 0.27720909875565324931 -0.10260972368800709564 1.1386957493953955289 1.7633403854216003204 0.41175436021015904275 -1.3462871461147958296 -0.34693162021058454592 -0.7996074495724859732 -0.53542267667540943687 -0.0083856257474106497135 0.54322689429182680065 -1.1777249972588723637 0.20286738949449026337;-0.37664086221538556343 -0.12343476603077124798 0.17624489331834372607 -0.48593612588747353565 -0.42658897760486824691 -0.41934949454085146403 -0.25094945411059577101 -0.021239713398474965173 0.45627584153203398776 -0.35552434471673988181 -0.46623102336374611099 0.28465447110681296738 0.43102465263838141141 0.38661872386058249162 -0.25724602705783367051 0.4513390015889380269 0.19463455568247253757 -0.018882141454013411791 0.97213490279678915762 0.25056537990735450183;-1.2138299882553544862 0.12481204692890854324 -0.021691731774658586096 0.66368167925969223653 0.47772767821427114532 -0.093887632534925075101 -1.1601573920400520823 0.13170127058343045201 0.76269587025582785689 -0.24317114544323800707 -1.9739414749305979058 -0.35161534818867690166 0.8627843826776468994 -0.45369532227035791472 1.6991008936719320666 0.25401846002614142384 -0.73265147081973802656 -0.43995100887544835722 0.2171397661372814758 -0.23154147358838048087];

% Layer 3
b3 = [-2.1559382008114780227;-1.8395613329119031576;1.5646748791400730827;1.3575187411011055971;-1.1827118671554430751;-0.83344837966814722119;-0.66114998565413585219;0.92597303073031511644;-0.6199751558799467821;0.089737926559957131856;0.26334808718492336288;-0.84300835786012373596;-0.37076248460453947731;0.94286341456043420983;-0.77448014456097158398;1.0398443433271216119;-1.3074796797118697356;1.5407776843928071564;-1.6518367396929469759;-2.1054288716167866014];
LW3_2 = [0.14865951776041677612 1.1560357257213236259 -0.024018541411102916489 0.44600872953686448996 0.45605959354794411986 0.16851195384010564382 0.23801924327316761887 0.32291614394429563051 1.0660728960684637823 0.45030793801720947478;0.78791627259628860269 -0.55785872014723503209 0.23864568547818582056 0.55297353502603419084 0.43642232891139332018 0.472572122076052481 1.4742321334620167583 0.26566806121659286566 0.58009738007043543107 -0.23910398890207518185;-0.53203615827382300107 -0.065727233763596251692 0.22644482869800555691 -0.50011177270795759142 -2.1723358987072169946 0.11814412623906679622 4.8565867731111724837 2.2383416992062916684 0.4344906254525333078 -0.54777490250534066618;-0.41903160866842986687 -0.082272609595364601387 0.072343876036404408669 -0.79640382953269894806 -0.85883783697209703512 0.98458957206425257169 -0.72517187726610554677 -0.61698513593680626155 -0.52028764947609706937 0.24520949883260254043;0.49785427133022558399 0.64911218762428835038 -0.84077806793877651881 0.44998499394345620184 0.42959307223615122995 -0.52295954919894216406 0.71868824486716542665 -0.36391157853025002389 0.75772776592800272777 -0.27902600799649424079;0.26292463155739986824 0.61566203561263987964 -0.78559540184859510958 -0.3459815416169547686 -0.68771220454321668747 0.76345273541267666406 -0.30753875597516827645 -0.41088366402946263634 -0.77157937502159779086 0.97100807720412385393;0.31905733855257023546 -0.7125992282635863484 0.16937744198608495338 0.67736521440187358323 0.42414360379916060673 0.12160512855237959329 0.2434099015304172775 -0.51364289158433384941 -0.81249238464769568679 0.73025287348795397957;-0.39203335119641602446 -0.14429046897870623223 0.088371040194464192674 0.86143241234072476242 0.54404312182340297532 -0.48812429983979166437 -0.74707373605384608251 -0.39665093485776509175 0.20221613181941230919 0.97130675770518415391;0.58276644831721946538 -0.51262179853817857467 0.17082071178074470508 0.95785273509916768475 0.72480608542320434928 -0.078163573505109315565 0.12481000815372951529 -0.73052106372485703378 0.10191006428134578854 0.46288145812903375154;-0.85667659399789108932 -0.22109695659415648517 0.045551638904222820081 -0.14098457894901506027 0.14790253793801455551 -1.3420208909478745785 0.47522848554127672394 -0.20991886841262535901 0.49448424768733978407 0.1720721789616954378;-1.0536330335841996853 0.50567442168677323444 0.35547423886100404378 0.071570684942516685223 1.0044101197032193618 0.54054813052342698398 -1.789343216013409954 -0.48773573573089656907 -0.69813064404391356188 0.37671915010885737018;-0.45477682086477921874 1.2306951748477232833 0.6503067078613828933 1.2688934192832235226 -1.7103179935579617688 -0.70578220476666186922 -1.9856260682800634942 0.39456138373145172027 0.78874698084164351908 -1.9699748323646626424;0.08888534118529356487 -0.49297660300064488625 -0.42570561342638590929 -0.38738005758309440596 1.0767928774549693216 0.53781904706017835682 0.80026846050175926006 0.1214894092741014564 -0.8968576270842546494 0.52185560502231276292;0.83613845299969191682 -0.010516110902865704463 -1.0395996796416968611 0.33611038231843282098 0.66593883184291746691 -0.5086836986370714131 0.32891519013155606777 0.4317834975463855085 -0.52131305255422888401 0.66809179715488919982;0.19469109035728121571 -0.48517251829649571393 -0.44160398616434093366 -0.50822127404070926993 0.66589282871259569685 0.43020083733184683039 -0.27435370356237787082 0.87794023664323117551 -0.18910275947822932641 1.0798216326770082585;0.12361938694191178245 -0.16965110934226024231 0.21439445882459992609 -1.1202207778586044107 -0.7417555144299534664 0.50551379043149846648 -0.47454477279501744436 -0.034790391738778195241 -0.80170358742477088043 0.86706413133628601475;-0.37033163434406851655 -0.19429527357887660388 0.15419440622940527863 0.2553574761928659731 0.13520261604436212277 -0.19174631703327310595 -1.4059096247809190761 0.66373880631279646991 0.76512703280273586248 0.3489003020350169848;0.42000634937611913688 -0.53104304468185981047 -0.78577643036305033775 -0.84583745070941995792 0.28257926718106757269 -0.41178460355622387157 0.85562868373542777523 0.24422679030284685786 0.6147969086134643657 -0.082852961209506553741;-0.17424055225090606669 -0.57143558248007220168 0.85157201567825790978 -1.1485986901171261199 0.28413697043874930337 0.30127805199254364954 -0.44119491862650911385 0.64426066614224519746 -0.11571112401713801177 -0.97747367039855359572;-0.79437680637065044564 0.36037291163556722795 -0.20751188660435357369 -0.98486306957877145507 0.007135931907756162644 -0.62647917318019219479 -0.41033746579226304529 -0.36468187178318600683 0.94607783283701096799 -0.7616934598627375097];

% Layer 4
b4 = 0.31033779414710321864;
LW4_3 = [0.91855018433710433623 0.060000571320800964725 1.2104011898546749304 0.20525192647071824337 0.1239802365064678058 0.011527572063207529307 -0.038627168343956450047 0.0075303223434218264504 0.01633859048110924625 0.12855216015445478095 0.25104467515186723592 -0.66033572117371375221 -0.47979730113180102391 0.12267091471593936924 0.053017131222026350756 -0.21185700354202469109 0.020555449024875199066 0.063297450155208961897 0.0068947971984145341867 -0.49579928833401387678];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.499999999999934;
y1_step1.xoffset = -2.00000000000028;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = tansig_apply(repmat(b3,1,Q) + LW3_2*a2);
    
    % Layer 4
    a4 = repmat(b4,1,Q) + LW4_3*a3;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a4,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(4,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
