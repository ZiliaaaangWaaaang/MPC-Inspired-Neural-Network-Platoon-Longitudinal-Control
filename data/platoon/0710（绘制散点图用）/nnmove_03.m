function [Y,Xf,Af] = nnmove_03(X,~,~)
%NNMOVE_03 neural network simulation function.
%
% Auto-generated by MATLAB, 09-Jul-2024 21:22:58.
% 
% [Y] = nnmove_03(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 3xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-6.61109325274275;-1.3712548795899;-1.99944277334353];
x1_step1.gain = [0.302567869936841;0.526102528279579;0.663455562981593];
x1_step1.ymin = -1;

% Layer 1
b1 = [3.7982714065637264156;3.3704189792352874377;-3.0763471645612154859;2.472390659563739046;1.8362839618355140114;1.8359092812950676965;-1.3462922883977752608;-1.1556112063861492256;0.47006917406531723014;0.057517447940816250618;-0.75564062586504820995;0.6139972533784372466;1.3203896648000303937;-1.4523337265978331079;1.8780587617234638653;-2.318622348967496638;2.6230781174134438771;2.9576882281813734465;3.4501994014275698675;3.8078923513378821752];
IW1_1 = [-2.2109804408727824487 2.2450587479515347056 2.1234708590728410549;-0.27640084971878825515 0.12646504104412958913 -3.8183839458787578458;1.8157631953602821895 3.2841083944103379721 -0.9958934085775738021;-1.057057301382142489 1.0483150656932094247 -3.5744423055513077081;-3.2155132551450047451 -2.6779938094306809937 -1.2915906256950608899;-0.39309776978260735358 2.2551101875250396667 -3.0024679286386475319;0.75543586607099733055 -2.3701854341807657711 2.8797067893046639497;2.8178324103885308283 2.0449069196470022192 -1.2611983353308475753;-3.4219977928916271992 0.93992091030578339694 -1.3003768380796563164;-1.1223157661063851709 -2.9364966727946359981 2.1410932524115016129;-3.5973154659909192254 0.37264634901672910594 0.4359749062281734755;0.76676997855827755401 2.4002417295683633469 -2.8339358915974712794;0.11710556090770839199 -1.7395827601842308585 -3.2477434160110139061;-2.9779605664409851684 2.2562268863866727919 0.59610721242604303161;3.3964184980227400956 0.9613975246436958777 1.2368528084930590083;-3.5809979649033274463 -0.82696476355443993 0.649281659454802762;0.039496810274680153874 3.2939284599578240176 -1.8642644135277162132;3.3521685375300420695 1.8341620794289934526 0.43469035205800254928;1.8446971027119747344 -2.2346229342974885945 -2.4156905560083421491;3.3873535948046842314 1.696193431055800005 -0.058757824185551719987];

% Layer 2
b2 = [-1.5255536915357843508;1.2522158631808184559;-0.78489819896011725486;0.56944231273155709872;-0.16126598602387376413;0.06099975765337969924;0.59633487170223276053;0.94857502667325999113;-1.394811249889806648;-1.5363381946500462849];
LW2_1 = [0.50148624179401302126 0.39587529026038043023 0.32054588643892018007 -0.45220085075188903856 -0.23778890495994978171 0.14775735805978881809 0.29598061453913687702 -0.55212018885904956544 -0.33015312308954136711 0.048949072444406029059 0.52170326034510494662 -0.3527901287198985103 0.099732387564324065377 -0.3491975543758815137 0.12175051956742037607 0.49379386521565976631 0.44183122247534639682 0.007043672713228673124 -0.0899379183483468847 -0.53956041697849077554;-0.27440107485516163077 0.48289271476709832998 0.016909119734321395589 0.47878759874460474766 -0.6945285990572989121 0.11087043836933266339 -0.21992664721592133925 0.39950380037447896786 -0.55442687230740173021 0.41790914804378398451 0.13969318248154810602 -0.14011238432173686586 0.25438500199236474542 0.083251073785074514166 -0.0060042192187003459031 0.2507199774665494485 -0.4491411572777970207 0.141290678142557663 -0.19462361393685778665 -0.1808097397838769882;0.36309884638883915819 -0.4963321933121607743 0.010196283558763898427 0.21641707373147725524 1.0215393003601445088 0.55354983767885046486 -0.14592880470775115853 -0.10117097481617852439 -0.45481835406891751861 -0.58518859167907033569 0.17349345558283307822 0.60306769211953059617 -0.22607842057079341469 0.25531143984446169615 0.39249316014427138022 -0.17446435840216847901 -0.55014069762557671339 0.013329879816970468046 -0.14452596868699107979 -0.028030369420371663985;-0.038565100678034404391 -0.38644733841977690902 0.1528885752175553614 -0.32403511860872996619 0.082787940093411560571 0.60925854395605982816 -0.018432453619111228982 0.52590569465866709997 0.039208035898562844379 -0.01103658883932738706 -0.14825640528867328749 0.56096622860913047948 -0.26717396520290298545 -0.30739884653828702943 0.42597781643784560224 0.50625978356445866524 -0.25607611866182922178 0.40284199527400210705 0.264277190671565132 -0.53799431281008658345;0.037142627978890535578 -0.16409322207180468411 -0.68734282732535045835 0.021591692708580575294 -0.61795282083762814729 0.019909348261882790082 -0.70110734247876205227 -0.4517806500195057362 -0.61340972722079523116 -0.4956040409826955595 -0.48275478139085131746 0.38524323152320405494 -0.26475101875692041986 0.35757335747618024246 -0.0057447719944806810433 -0.045444333044929133281 -0.49287730526781703411 0.2837318828134317017 0.58536277177857320986 0.38640741560232411134;0.17142987896828920658 0.18513641170895006605 -0.1364440279266478373 -0.047653299877087877678 -0.6399648272931448556 -0.063657297154461556232 -0.02727672375499960028 0.03240977134393091541 0.44298460319748000913 0.53225287997893200309 -0.03968414748466659453 -0.41261047911335829719 0.098959470530139231892 0.43389829618282022006 0.12866836569682149616 -0.092324464511073386919 0.050589135287548034348 -0.72330951111206243098 -0.789910412779667781 -0.41074887109725460865;0.099308301912812035894 0.66775486010401563508 0.29808357847545696728 -0.37041032293228215444 0.67086102292735527719 0.28675578262266332441 -0.19482158718505604433 0.37152907666013773591 -0.41968858257264629597 -0.30903611037142314499 -0.051287508661745528915 0.20000513110026166275 0.085285077347338533738 -0.58499704957229259339 -0.24358053303101270815 0.15744832858121146635 -0.22056975061213957012 0.27299601687065694344 -0.31708218491713452414 -0.53140345692520762899;0.1579118459245756334 -0.1668694743809893688 0.38776297158377859287 0.48951256276584964588 -0.30158825381886505967 0.24554297472670763569 0.069827643515526463536 0.29458051360859799361 0.17838964309417126852 -0.46510765099976003611 0.30147594546228723145 0.49605814065849851424 0.40289033065189344684 -0.51362562056237204278 -0.20616896807767284838 -0.29811208494124630253 -0.40635202307594375792 -0.22305826107032586392 -0.11323574127013816271 0.46950494547636162368;-0.17986413339141524292 -0.46016083196601709204 -0.010182197192146830167 0.2497119374322193941 -0.20945949766792745783 -0.67854323389320536641 0.24670600085001298529 -0.54799942100303533632 -0.62296129820452639247 0.048089761710191795963 0.28312311650914923078 0.32104836603917963345 0.18131496046945549949 0.22726499122677401576 0.02033774652699154098 0.3290000586922664505 0.059877873858162372622 0.29137877689603369769 -0.6149284098133898091 0.31010194643896804578;-0.17127838310821358325 0.20369696439222931272 -0.26485103856993419402 -0.54781080809756665939 0.49948585731534683729 -0.54115817738807092674 0.46406661427941037212 -0.34267932610185647402 -0.072996122130387072757 -0.2430310369181982455 0.49874656093819169644 -0.31832649347003483253 0.14784928704448183079 0.1193547185697443197 0.40116338266187839823 0.39729871018697970886 0.30800918871682381184 -0.2076615452459218969 -0.57975784254569928677 -0.088190806953767311716];

% Layer 3
b3 = [-1.7560192757544064168;1.6878548308075855822;-1.5366841548351055646;-1.2814152632115576314;-1.0961592321499449287;-0.89468445972084886808;0.7238603250845038195;-0.4060937931507631049;0.4642033733288066788;0.092477623536522030046;-0.16380903387571602026;-0.16033793918213379293;0.59787954813776567065;-0.69920539544915327745;-0.64423532715855014175;-1.0143977056373918444;1.2957025541043598604;-1.5072743796689744844;-1.6764339387730919917;1.75138184636855887];
LW3_2 = [0.21091889005693659209 0.087744777970471907191 0.77666566939560743865 -0.21569655884090341291 -1.0166053507388186361 -0.71107895070848536889 0.58943196777590434188 0.0059071676604586249165 -1.0433200929834252069 0.71541340366275418816;-0.36266276444195133521 -0.28959404511650127523 -0.3762459945219532309 -0.1175811847175321917 -0.76442252528063170391 -0.94083961233236268473 0.5012821046576139139 0.82231982610215603735 0.8812810107168337348 -0.17509376914596347374;0.26595558227079957314 0.89086264093670541886 0.34135311915808191907 -0.22270960672330850083 -0.74535139588678811506 0.31235133191866443214 0.6382153148886536842 -0.35198381273140144643 0.72644772689123859877 0.85227879359938241155;0.34500217447071401811 -0.65257984831295390293 -0.5054507880576579737 -1.0524582356478848766 -0.23750788758808027978 0.53969550681839784101 0.77635104607342642069 0.037531684400074469266 0.61231179554226244921 0.5829750378666681554;0.96210045156109913478 -0.40766553090740292875 -0.69165706115802183529 0.18917599782867663971 -0.24400310386841558841 -0.30283179896207201853 -0.1677595036490421021 0.22394546463098435884 0.9115610862964754757 0.97162826747354413826;0.90652880889303277812 0.53835479797728014173 0.06528137047203344534 -0.8157684866725571915 0.67630849059664222001 -0.22964464906309392522 -0.25792562052630857439 -0.38077433284063866292 1.02915176388545615 0.013069836764280664404;-0.8599110668817467884 -0.55830932615288397791 -0.31709680322167815847 0.97684700347132802367 -0.60916007012682271693 -0.43371082161564333823 0.78391083604324296452 0.20741996863184039568 0.58052584225095071879 -0.1984571259900540785;0.33115540896861855868 -0.94561220901984632814 -0.019927839455609580588 0.41876958184977741695 0.22676331973924984675 -0.16564795594771863918 -0.94093266737523939547 -0.50931094857934877673 -1.0320451161059489564 0.23107553561733248926;-0.62332416736969487037 0.17803541973686506927 -0.44173474191305267533 0.12553628703758468177 -0.75999215662111563319 -0.37390263015978575378 0.92533398718717940756 -0.10187591570166558419 -0.96667187455825998033 0.59214221152309776119;-0.81243958792072357156 -0.41207371333590492313 0.15523120121282391048 -0.25539182339757326989 -0.52850414155224079149 -0.59767214670747326188 0.90476924588972651442 0.56527600369347164033 0.87580978343286430832 -0.31989771037906777895;-0.29279937828344099193 -0.13983127019385180323 -0.76993996826866439864 0.62303351977419474395 -0.40015970845564019509 0.80290325884397162337 -0.78497024782926472231 -0.16391116782983775058 0.80756916701368186562 -0.25503265402867586475;-0.865274378868849392 0.70517633513940725098 -0.54706531056893714648 0.55954130405602831022 0.82054746925297539217 0.64831987697284909622 -0.23295932132710575613 0.35466395525622040896 0.23781608013992081019 0.76736761080053950135;0.32444355513133454894 -0.50570656925561974226 0.94249492372020160502 0.48600767924319338009 -0.88247083024965411457 -0.25501988485427184994 0.10439415831820401948 -0.18251249948362502362 0.52183334877830789278 0.16004670561820974473;-0.43658781134068697094 -0.55134193835900913161 -0.098497236352045977603 0.71951367434825486136 -0.96724638561843145901 -0.024657097207257394622 -0.61575600888172232761 -0.74667168033188391352 0.081078583891550592977 0.81705734284159126091;-1.2295200791331475365 -0.94917507392043332093 0.48705682542925754497 0.97743026784397935014 -0.0023696435823373895174 0.39523599198016368117 0.55685541081132916563 0.048432413707573458705 0.25761955129359753736 -0.60481831364027172082;-0.87596570919304561631 0.53803993170837427495 0.050206660870475580682 0.49857576080080051595 -0.59914878419487449523 -0.37776907543505400255 0.68094839492166991946 0.83628399328261449064 0.62931604361092352562 -0.25412964620908479185;0.91122136213675253291 0.53604125786800937981 -0.45641330972696680934 -0.18510984301329397317 -0.49376795967551745381 0.56243209147069839204 0.89299656446778608032 0.80537362109824284229 0.43127155289723795306 -0.10274138193590175161;-0.95357012330051116322 -0.32837087939836351325 -0.31577365059954676241 -0.74366659312657723557 -0.07767271831560124129 0.87092564482130552239 -0.38863371884481251461 0.40400219559886846321 0.89850747788569407248 -0.082356587547930376614;-0.11952267079686446083 0.70625055558775906572 -0.93562522686965210461 -0.47230045089747663134 -0.56799778743069706533 0.30705151510142947302 0.87765968150009321391 0.070830908094457703528 -0.82362317210976454529 -0.33729502459596710784;0.26886479569544347035 1.026553758040559261 0.84755646624891989305 0.47837954202868504527 -0.68945702744915615678 0.34397529786131320062 -0.51309511889645109672 0.24618999570422986367 0.92764649895112449851 -0.31404734096482517236];

% Layer 4
b4 = -0.55982471880973361245;
LW4_3 = [-0.79203179708116477897 0.073873673161482231175 0.81675613244289058112 -0.27119846604066949469 1.1068963294779263773 -0.063050005693649102678 0.48039093332764953859 -0.36710014488183023706 0.6067706172965013911 0.021773534426300866773 0.5507451894643358159 0.5946880683214138541 -0.69518794969253994154 0.048087350381852737857 0.86632431720514413431 -0.369546514380686697 0.16926292534679884816 0.28223341133155588345 0.20730758180787300926 0.22462311563330120134];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.526912312948892;
y1_step1.xoffset = -2.00000000000002;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = tansig_apply(repmat(b3,1,Q) + LW3_2*a2);
    
    % Layer 4
    a4 = repmat(b4,1,Q) + LW4_3*a3;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a4,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(4,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
