function [Y,Xf,Af] = nnmove_04(X,~,~)
%NNMOVE_04 neural network simulation function.
%
% Auto-generated by MATLAB, 09-Jul-2024 21:22:59.
% 
% [Y] = nnmove_04(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 3xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-6.61109325274275;-1.3712548795899;-1.99944277334353];
x1_step1.gain = [0.302567869936841;0.526102528279579;0.663455562981593];
x1_step1.ymin = -1;

% Layer 1
b1 = [3.9624732269367490822;-3.4543115328812246112;3.0186633264251732101;-2.7436001178643998344;2.2609707603160309475;-2.041089341923140843;1.2647944835907185546;0.99203812099326105223;-0.39596159694162241793;0.3558949533251445918;-0.10776385034225437198;-0.48680625037146985079;0.89387251782865551064;-1.5558554662266004254;1.9238158590918510438;2.2392091979276056435;-2.5660450557585607889;2.9717362809631855392;-3.3790205272896671751;-3.796514395304027456];
IW1_1 = [-2.1990619283148129526 2.2374769146746733561 -1.8180455225409797304;1.5262573777934391739 2.6931229091220969529 -2.2162987690933566576;-2.3564104668325041025 2.3857950298861760885 1.7564780370401118503;0.7029338560051788809 1.1577371162700935692 3.4136077538953681909;-2.8645391495085275047 1.0427861588049343045 2.3695081436382392504;2.9813961507823751873 -2.0639337612534451871 -1.27664252734122452;-2.5669030882166326002 2.1588178787583753859 -1.8271780826085095573;-0.57183987405357727951 3.0502383558825201249 -2.1290703596924469565;2.5047093425105697584 1.8544077773848999247 2.2110997449746343513;-0.29963592461265764477 -3.6820332685335408485 -0.41734492979058696038;-1.8878394977834838109 -3.1785467253629233753 -0.98491165834134564161;-1.0436692048497069329 2.8548498983529149164 1.852042864485953233;2.3856765581833982992 -2.9173911798281606522 0.31567104517076705061;-3.2559365011739358486 1.9053775077280783457 -0.67945663513306653325;2.6462107121934406173 2.5419614643825587663 -0.63681606257400003024;2.7824362853147461827 -1.9273795970769671548 1.6814258571380396035;-2.2557419631072366251 1.2273012554981983513 -2.8190953735850285966;3.7347649040737058712 -0.69275236558571662293 0.27536793960447741858;-3.5977421964862630333 -0.8329000307431673189 -0.96401284224459971028;-1.5310781182480044382 2.8690904086303974374 -2.0147032468033430064];

% Layer 2
b2 = [1.6306607314586472057;1.3314303320840750189;-0.90301041630535516802;-0.59508941062599152172;-0.26147929348654103121;-0.28638770998547513624;0.61721317174888612467;0.93060149531235292208;-1.2478087066365342039;-1.5650992637830754006];
LW2_1 = [-0.28919360862251025646 -0.36229592658037806929 0.32179897537768242799 -0.34296544572554177321 0.42422033631363964545 -0.18517625918646582472 -0.26467474703606225228 -0.18262684954084429378 -0.38783838712589790987 0.099041765925208580246 -0.52423209188959529747 0.31866952719701302499 0.054628106863018444095 -0.29897018421169679891 0.36193855480177877793 -0.21453438877853014954 0.47804832158372034812 0.17580506085440977815 0.47740462365383995458 0.50445065329425331502;0.047211814716900023237 0.45258832077528310389 0.53185522128832385391 0.46464061436507841929 0.45964348597287946196 0.10482217033452814747 -0.41689363302679205425 -0.44543307954888805567 -0.093943709898500718514 0.1971774747685393625 -0.076790124280305294135 0.26508694376760794098 0.23306770170343901749 -0.0037191555162147164025 0.62173516151899188564 -0.3325131003094846105 0.33693296337539085927 -0.077091346867580429203 0.087745153103420597818 0.41406988042235043368;0.18936565689340784102 0.012091611255372244557 -0.33549277777619368468 -0.24074600250555142078 0.30167711239238070853 0.25036797783320918764 0.087169290684397257585 0.16792777689532820129 0.35030469510933759381 0.46501467285147379815 0.37724430615440157633 -0.37286473870423170185 -0.3111299836023666554 -0.021021778896863855396 -0.15630240222584146359 0.21257144235298777724 0.7175164674707008583 0.50669662348953470321 0.34317187524073944349 -0.60565771531446843667;0.52181582262751291523 0.25945422763674313993 0.27899548790853107016 0.42826790379645479634 0.47638415888130508646 -0.0082551368053600058389 -0.47128819373876212895 0.43164604662436489857 -0.28757938979196978613 0.2346681762223225276 0.24411386434668813639 -0.013102014111958916465 0.62843338201436693691 0.7231594799143452601 0.054918574952751181284 -0.059960160771047321671 0.27511620052474133891 0.44751306128454487743 -0.27631994708160118046 -0.034891530663353133301;0.44565918930918169139 -0.5590856177086991341 -0.40292599090902347925 -0.36155745134291683573 0.61858997473897781028 -0.6632463934085953694 -0.097226609699824578792 -0.11192104370849038919 0.36375084141757313416 0.29493733203155236833 0.51101835270424167401 0.07058081377771957543 -0.56201325137404345433 0.27860426821973544032 0.086483512323810254885 -0.29398739692393333067 0.08653621276883274871 -0.65280926122883864426 0.20992230568330963458 0.06949858384089335761;-0.43367539926164017094 0.17725844010548810759 0.37970640528175658712 -0.24247076225858171794 -0.83330418494190949819 -0.45524168378818419267 0.48767814491583116876 -0.4054442331341134298 0.38747580279177312734 -0.12265328823912846623 0.093534562784892624765 0.27917920937045276331 0.38333937279725194269 -0.41854593155079289346 0.42667234974681317317 0.33690985525571970349 0.4334047530505178436 -0.49009524312989644068 0.45412087872650380715 0.558223517815929271;0.38497149695901261568 0.18828716958589356012 -0.0044806458658153561561 0.14747802979197421891 0.24976296523875757272 0.30167541430326622054 -0.24854010629722436687 0.56392577950302258394 0.41312025157818954568 -0.21269273955822448618 0.33440837539144835366 -0.12541514647787846415 -0.36732675036975193095 -0.30595587296847465142 -0.41073563813990521254 -0.48083204317450362053 0.54128342050524036466 -0.076589965969539805513 -0.44304776252209393528 -0.64933830573107664819;0.12121450361936211837 0.55093565881221606695 0.4652799561724959565 0.0060018364838442701814 -0.22985543291219232009 -0.10116495440413829365 0.18316658996784215829 0.009050799667532570883 -0.48108555093538318825 0.26567587752407273438 0.082753895326207665972 -0.36985675713803589648 0.15783387206786966828 0.45886812488239875352 0.48751311192828544749 0.14871259912066647768 -0.42499123941896960188 -0.4595708422698174811 0.00014095647901185586652 -0.55321961496858562679;-0.092885254539600045631 0.36010633813394288261 -0.20154869415568293922 0.31607372328074484491 0.36378481555040909079 -0.29124005150957776866 0.1081932913554560366 0.41121928166299998031 -0.046552716595903431696 -0.22045070088833312871 -0.67565429994065007158 -0.13383149258300927609 -0.58587421304524334165 -0.082687860002817803462 -0.35270246956217832235 -0.49198017551502054578 0.13134932321844142167 0.4712458176387648856 0.59445603907854915882 0.45568407841724728469;-0.23023261556269350447 0.35363966714478389797 -0.55550471381582255948 0.14231612417330735676 -0.28375954593339569598 0.42440875716124332184 -0.22934025994183895869 0.37828976956518217678 -0.053532725964892780013 0.016662902032086958359 -0.31906594718788749976 0.1802052684425540785 -0.66835285083055140376 0.04230474427173731844 -0.033558093636716516961 -0.41662186115547339416 0.14582016067837544337 0.60724732107450940521 -0.10552348031067533551 -0.45770825601889386647];

% Layer 3
b3 = [-1.8940972036706580361;-1.693744595755958704;1.4166609584627256613;1.3678060373721789844;1.0775411051976389043;0.89918549678543624459;-0.76488807587505169838;0.37639049991641576609;-0.33887869847401835832;0.11182055218799452634;0.10884543650951369886;0.29408602586718191052;-0.42048408858928743026;-0.69296703945474835695;0.87756632953295921062;-1.2180767939248415832;1.2371923618501783348;1.5075889865996785488;1.6937180902077662026;-1.923747775014119199];
LW3_2 = [0.19372289163312850224 -0.18705471771217005439 0.81169210992427287543 0.63349529624700706698 -0.17427186810343664458 -0.52749524939261549505 0.42714501812634619871 -0.82660079720788171009 0.74542698722989786386 -0.83324172369733318089;0.023358280969960797807 0.24779675758851069101 0.83650403305265685905 -0.014862431382851867129 0.55911510856983914763 -0.32648760726448555758 -0.91628934759233726659 -0.73356423487657640425 0.9871917438651927057 -0.17852954941670465261;-0.6317225771611086893 -0.20059420840071745529 0.90938102760546446479 0.89023203213933832512 -0.58326784962853406302 -0.51357144917741726076 0.66914670598283176872 -0.031501012046960229218 -0.91788598692568978965 0.10245768646746090946;-0.82839189726524797841 0.3809364269537418024 -0.71749757509181655291 0.07547967836936235464 -0.17822795638531699347 0.1432391742446542382 -0.23659421947613468173 1.001740516429458161 0.47290873625040757977 -0.87321396679712837141;-0.42240047533289570847 0.63607567157732203267 -0.4847097329591862902 0.76894721206547400616 -0.45129206673070410005 0.71320652176718335458 -0.022808106394103074693 -0.70027360250961245836 0.44370685653770253198 -0.55626403549905900636;-0.6571422611700176164 0.61008658792862258125 0.096594332989244385823 -0.81427298357901645165 0.34422028440338625632 -0.41955570214938359141 0.63898933800897339541 -0.35351831352483720217 -0.72043641154940507576 0.72288430509547974001;0.95730490293428793791 -0.99640556779330846648 0.0059470270289315747131 -0.76547379842923402027 -0.37259714008955385767 0.14110402757586706923 0.13644665155706964255 -0.89597809118460036704 0.17472969743577365653 0.39925338898184081771;-0.24167521100152161706 0.34651423586306084879 0.6627034312482226186 0.51056429645491663294 0.68134961232319868341 -0.36002647430197137757 -0.76034905892052606635 -0.41516002070133295465 -0.974473164717446938 -0.66544114772316309558;0.74181590791172835608 -0.51365495514156167545 -0.75605225445375767723 0.037765102303657677174 -0.35442418589123858563 1.0969148145021689889 -0.026208195454517045631 -0.8417666701182743294 0.36186154141611370783 0.28356876101541350632;-0.54512669005767122599 -0.45553874677970240814 0.29141848406927534088 -0.38913583376594967911 1.1502401274510143381 1.0292013508657871235 0.68723277422781325896 0.40589282532265286152 0.15521076832382518784 -0.09288360961374117486;0.09591332248320237619 0.098098874034407729239 -0.60250660393808053161 -0.87317597832355420273 0.43540680480547799824 0.66678456830354004836 0.051104393566451855602 0.95830113022539575862 0.6375587047451620748 0.53712689589913842347;0.5943255848559847454 0.22449343224313439427 -0.44139707884261841775 -0.17639626346864056838 1.003874526679661594 0.85968328453619780039 -0.3122547146247780514 0.36116782423260929136 -1.0052135481241144532 -0.6397094000891664356;-0.76574695484993726691 -0.3363429665222018583 0.57769548543351134651 -0.53600760882264997242 -0.86462597256457507378 -0.60400102714110326385 0.64330392092895127831 0.64945560593954199113 -0.38751985559137180903 -0.14849242605391993477;-0.83513264171724699292 0.08447747305295152942 0.4409027858632680319 0.63433001255074661362 0.31666447855583307325 1.119847041625148476 -0.22127019617635776405 -0.48926092415044980521 0.45356642847213723968 -0.65293245060609750308;0.0040307171644318687959 -0.3423952905995389373 0.78490794071546032828 -0.8794559616456708584 -0.52430842514809794519 0.77126770613455608583 -0.49034448230921290346 -0.072869587669920632411 0.57040584579817588118 -0.63292725199679156223;-0.93583264043544289734 0.20729111554409213047 0.011648227738705567783 0.36667049440557680784 -0.7168173423759980345 -0.75790889520836235427 0.3575994989915764477 -1.0523523994038448404 -0.52758371927599445605 -0.51882281740506586143;0.66086125204627810259 -0.87443621341722566065 -0.24812369979297374534 -0.61517496534450710755 0.82283697236716613066 0.34917672332234589438 -0.48587371891775360533 -0.0801648396951309683 0.65911150891061232038 0.7946371947545125547;0.15988336593575622202 -0.41046864255165199653 0.72770762442190706221 0.50458007571968443994 0.61173228886318065101 -0.092911007088859895453 0.89458003956734022388 0.77176790197170896946 -0.60470935025662608808 -0.64756695893919191676;0.67992061158881156313 -0.48180403281989758746 -0.6308961619993409542 0.47922370847209305733 0.97614407118114876472 -0.73882564129868499858 0.52265990711911691768 0.65923959445968838278 0.15592807448810494519 0.018269046363829137547;-0.41087779740249530391 -0.87688825175416185154 -0.58797701764524279433 -0.042339815502534829117 -0.95568884920588625942 -0.2108949739906031684 0.13687492689650115896 0.059349028202085332695 1.0489115564159046112 0.032943460683824851709];

% Layer 4
b4 = 0.11801932425059363796;
LW4_3 = [-0.038555837406411087864 -0.29466117905108291097 -0.72167084193134700687 0.29952997165959155401 0.61811179393255999415 0.63431397769125263952 0.75163631642502015673 -0.4779703995037170583 0.75928121684078453413 0.52570643683593920592 0.0019397210877023459731 0.93965077722244350067 0.40951374905904974755 -0.60612754620987296938 0.29274860052145734723 0.94053322352495893899 0.2265307210699592233 0.35771713327730070286 -0.26902737411985705451 -0.20024737743706469417];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.526912312948892;
y1_step1.xoffset = -2.00000000000002;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = tansig_apply(repmat(b3,1,Q) + LW3_2*a2);
    
    % Layer 4
    a4 = repmat(b4,1,Q) + LW4_3*a3;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a4,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(4,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
