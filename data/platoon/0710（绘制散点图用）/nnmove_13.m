function [Y,Xf,Af] = nnmove_13(X,~,~)
%NNMOVE_13 neural network simulation function.
%
% Auto-generated by MATLAB, 09-Jul-2024 21:23:08.
% 
% [Y] = nnmove_13(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 3xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-9.27187740505682;-3.65799721531803;-1.99999468395731];
x1_step1.gain = [0.104758804509858;0.259072168169289;0.50000722551666];
x1_step1.ymin = -1;

% Layer 1
b1 = [-3.855503540031699039;3.4510493275888043385;2.9092719268732496474;2.9371123084537895664;2.4667279431310222826;-1.6784493391046302335;-0.87187216025839087141;-0.43783002710736879104;-0.31194602278585903399;-0.16913849972878450267;0.12255525562457969535;0.70014124123579446479;-0.98468847062267317316;1.6481936064672089159;-1.9652129689285351422;2.2885733784116766287;-2.6012940424807906581;-2.4445910858344301886;3.5025868481727240322;-3.5377054308412705375];
IW1_1 = [1.4641572212077713644 2.8602532219927723212 -1.7187188762132814546;-1.5261826532485855967 -1.6846762798706065301 3.1186201620036770876;-0.17237861053463660044 1.8773578326551860762 3.1340555698237460014;-2.0155052346312878342 1.0861989462533734319 -2.8056446033526829531;-2.4575493141909623418 -0.59840829646538695741 2.8971446369044144831;2.7261535285967006814 -0.95672502133621195597 2.4640351480515692018;3.034014592108226438 2.723218503730587603 0.39903090323419748708;3.9257912867699769066 0.57129035915539549961 -1.2023850066436281292;2.5868393312476780643 -2.8478571101041216806 -0.33505661457753077581;2.9474026261635986046 0.69247631541586751602 2.5341002863277513057;-3.6116179952967244482 0.27904136037016263883 0.36292566363448625077;2.4290366178118238949 -2.6032000939943862328 1.3095910427820349753;-2.6114059083368847958 2.2899580111819455297 -1.5530079496907900349;0.72475057776430107381 -1.9587849563345880455 3.0062994196996766227;-2.9980057591292901265 2.6762979008970662065 1.1687834253235860338;2.2590955341320544392 -2.0039544079236777385 -2.2616841796510858131;-2.8937432185487792502 -0.72714108450124481653 2.4418403729464901453;-0.78698636356319762175 4.179809701346291817 -0.14037238346057709371;2.2265550389198902614 -2.1502815320348869221 1.9393610186781899962;-1.2221403782413799988 -3.9549360418206429557 -0.19319279036074943345];

% Layer 2
b2 = [1.5530088858829960152;1.1985090895967798197;0.87451193739219057477;-0.40606300511225523753;-0.16587811015857481522;-0.20459635749784418901;0.41083380026818322461;0.98161419350056533517;1.1995874331850642225;1.5237649585828918486];
LW2_1 = [-0.48216332856503163473 -0.37740504551304909775 -0.23929016747521378305 0.36775712416316813647 0.056399777639875969815 0.15663318102909634666 0.67330759463096134798 0.26588831892126729706 0.19985770596764121376 -0.2382468839633999913 0.50725557272621868421 -0.60493343659720233418 0.14845080107933208979 -0.38317990916815403146 -0.37650496272024758238 0.36334847516180862614 -0.64047312835552483445 -0.42842038533195647698 0.15033454678090071854 -0.32725445164159927547;-0.46568619562023028102 -0.034269737386391614653 -0.021404269209344659736 0.46051407485877110526 0.59404433010452484254 -0.3344295281492923877 -0.65893594548537470779 0.35718501604616464951 -0.56554199562598750362 -0.044375743620086151309 -0.28073561951458264607 -0.20635892746576425805 0.40783007947266014526 -0.091201368825593417955 -0.29313533205464320508 0.25934660464583270123 -0.20108853310803201375 -0.30763105427238135459 0.33025660813025370377 0.40494738740442093317;-0.71768599420418788259 -0.011134935289130429986 0.25358820555494560045 0.39986703559426728383 -0.0050394591603343556405 0.22164326667778011526 -0.24993166827591925538 -0.6600267126732849432 0.27578902020886558732 -0.085909186039724944051 -0.46932214686554485361 -0.13229093293517796281 -0.41404461593608776759 -0.54275480033914769162 0.40495831811236943087 0.22396206116339398284 0.046389942198240913251 0.09497187926000344449 -0.14138457322650341275 -0.3190949187561303857;0.03835926579445433221 0.5210464204939970756 -0.023066597520793302029 -0.72283609895785239097 0.46227851170228123623 0.20722881890103336811 0.14764803791602301719 0.50169071498494177686 -0.27920580474216344369 0.050694989654989565386 -0.68338680635213011616 -0.37015531341045732061 0.43515833255404257063 -0.20214373515049721686 0.0027298071919545112071 0.64600585910800556455 0.44920073288299022796 0.39137880790435380929 0.70189932149325640065 0.35645102915551396539;0.29832117098389637766 -0.47773409973298242015 0.18053442367492963938 -0.024852619673064849787 0.79407587286650060943 -0.42996804188592607776 -0.31646513983062535269 -0.22665980736388977035 -0.14692586075381031119 -0.65347152509995132252 0.0035746536507151975559 0.31368490280870875431 0.2800602943258706512 -0.40313878651029250166 -0.2247481546327715074 -0.21679836122899165396 0.49786405195667504664 0.23798991010461920115 -0.18513010804085322514 -0.33425972262946723745;-0.33073719565513742813 0.52396504243166153181 -0.28793191928194911133 -0.050027048994215721212 0.55606397473415447585 -0.30992482536488258349 0.13810427473600903059 0.37832438151233133139 -0.20547067913725525212 0.32798988136685625072 -0.83031667952479792927 -0.2160455313906885777 0.47663781714826453095 -0.36805695886240535897 -0.36375108826110086335 -0.38523652491780691065 0.27902460929080513674 0.63690691585005920761 0.22602141067025599552 0.010685747760331164996;0.11494151427041696123 0.3162784518872923667 -0.53628446277689623134 0.63920267426303356562 -0.11017276617649421344 0.30330394148431161216 0.38975009057073634056 0.073514535759329452391 -0.29598644351152020304 0.32231050298231672668 -0.0083761292557265297487 0.4500202996260204702 -0.17908172833164337501 0.22692417272821299723 -0.48047214983476127514 0.47873498628035998648 0.58863306979266083463 0.42813364958599819943 0.05984885581424544132 1.2819750471939690417;0.55997644877736940661 0.32552430803371118495 0.32147194387662880732 -0.55741186096668138283 -0.18361796924345558102 0.13486196081953463755 1.8427547146700042902 1.5838513291697680074 -0.73850700303469496433 -0.23595713359542852539 -0.60776659875522098808 0.10944577459786028473 0.070016220136450285638 0.203416707575214184 -1.4779271290105320258 -0.45859251782142779197 -0.21906496405414624395 0.26761435074782841115 0.40740460048665949611 -0.36556558221895191219;0.56298617531682970672 -0.61500105195525200941 -0.34864244226992735509 -0.17126853865202920635 -0.24179791772452038923 -0.42487847232750347581 -0.64836230477966505514 0.12606355609201530532 0.057293829519456739019 -0.65547184861648777332 -0.30427746260416088653 0.41895751006337628164 0.34361713961773393544 0.035977335756427690494 0.17728664776099900546 -0.31790660468863746191 0.17558911010979327827 0.58846013873911717784 0.14315671400189980411 0.16446163274773437091;0.29482669541314354689 0.077115630579159946678 -0.24209021975739761223 -0.02040678014094268744 -0.43755930349841820615 0.3104499867260733792 0.30592061645473012099 0.095530644958313176707 0.54818192187705472307 0.40929047389777512 -0.61182053723479989937 -0.54872666788053003906 -0.17614906210059497194 -0.026772563986279508674 -1.1536673400857426763 0.71972250736017684414 -0.095597140206441527654 -0.54678564485542102691 0.48014824098116626327 -0.36296980058097522148];

% Layer 3
b3 = [-1.8124109690449385912;1.6702938732918857223;1.565641940101274443;1.0439070469449309719;1.0206498687204708098;-0.74903996277495099587;0.49001709804695015027;-0.30139976107419091944;0.20035602574822114486;0.17073409669993513949;-0.28101891864847050595;-0.24808742032859817939;-0.52287234087216050149;-0.638177585618755705;-0.87028068063636099261;-1.0746612880431978265;1.3224591161938319406;1.5356742931938922592;1.7558302226126751844;-1.7488292976394694822];
LW3_2 = [0.41787714862821423445 0.8503135969094501867 0.84108450160514025562 -0.91048151755183281963 0.97128374112586013389 -0.69672273667108175488 0.67282925798802750705 -0.19153855169892386456 -0.30534794234904705235 -0.14191381726588339629;-1.1541781034003710804 -0.10592607537869092038 0.8477795781677703868 0.11216462187148035223 -0.57062932922056819329 -0.17565665809873715064 -0.2176133004507104507 1.3431438041846879283 -0.25695827219103933858 0.41386156298331755465;0.059944745860725345832 -0.86452488228538226789 0.63374193904605191641 -0.87332923715532795317 -0.65189693158226447167 0.56803627375433607405 0.72776773114481019267 0.12014691128453995617 -0.21474539352118193758 0.34824841162432979003;-0.9282820946253227401 -0.91592153778067020298 -1.4036545641433681997 0.50008068146874418147 0.71807205272846741373 -0.58318069853338028175 -0.11997383141752292202 0.30125109150026391225 0.31749445507638068831 0.10526675111926363237;-0.8356464248537673889 -0.92657654350227969253 0.8707262481662314535 0.72026790937335205545 -0.079637266192426198197 0.47330316230144175993 -0.31584200944118845378 0.083520210231959698954 0.58385666522875612205 -0.70313748880840765132;0.61543304385846364646 -0.029499789051256084665 0.71262255352008696541 -1.3044293439309029292 0.56517835984038389263 -0.81673010046673744089 -0.13132803288751088155 -0.91391605926026675544 -0.80018118071608068664 0.16223187982547410124;-0.97655845679729191833 0.63443566685805641292 0.08708680028135380724 -0.3677344857949104151 0.49190281803230312407 -0.13572470532737615501 1.2589730252186390747 -1.5921473455595247515 0.40473235476773833375 -0.61879193848518809773;0.97014466890657335973 0.75800291482949155863 -0.07051646104777622992 -0.069882040864399821989 -0.077532372077903588536 0.62513930898368741396 0.54036860928071195342 1.1048599283682631889 -0.87416656597178699073 0.62733159104512192794;-0.83822345904544970363 0.74357569027292147457 -0.69987300510625527483 -0.27778874602682740447 -0.48835887486546553093 0.0098077924798277271029 -0.61311840445612664219 -0.070486500326915141335 0.15605018410977267163 1.0367304045958694036;-0.47750248934851091676 -0.40119193902229993709 -0.59677363916294867696 -0.46794142029500807034 0.69344728420554924142 0.87257565094665967553 -0.2002640339630064048 0.06145559212400544119 -0.47670357760695053484 -1.0167935014073083977;-0.5610890678917038743 -0.90835115726445936346 -0.35045102162629637732 1.0013147813336271685 0.85988328428240279333 0.2500683616520975594 0.36576408643556274081 -0.93548397578826192333 -0.49001852308905013977 0.78614996861444108589;-0.59024050288396057162 -0.20646503406962696259 -0.52916612126750262046 0.69089217537294389526 -0.015679257093339196011 0.68771107278609833191 0.96883362370456249657 0.52293426832952472072 -0.11467644021653475295 -0.80656108397642156671;-0.1521742756271207142 -0.88802314994272879556 0.29899757137592586353 -0.056312100190858159487 -0.92797201661020534136 0.71068005784308518891 0.81556187720124018181 0.56304814975664951859 0.18104157228427997239 0.54364425218197043321;-0.45230375388436383499 0.43690802627143637826 -0.82988394566344469983 0.27118639884302264687 -0.55384941104535534429 -0.93147152517841436126 -0.14721123790290088773 0.046134565421377345118 -0.78951891264167284312 0.80302360305233655424;-1.0654608905205229519 -0.99676773242267291408 -0.3272911095627045186 -0.087449852735579203244 0.15744719740782581185 -0.50030926228950001189 0.45972401778392962823 -0.6773198473642771944 0.29718407881767527901 0.48139031060047893229;-0.68779836068519806247 0.10493379447940526239 -0.19586306884282500551 -0.35792271715568607648 -0.18204233386002471873 0.57055432740000477931 -0.68814873520245245508 1.6030843217207801921 1.2882802430069555388 0.13344493276218349909;0.12729083330383805794 -0.51986311323905987081 0.7414678803658766304 -0.56649420688764517973 0.24628446748033547276 -0.24447785772504235235 -0.83193876925609955286 -0.97764238918820800528 -0.43283481683058516731 -0.75145608807568164966;0.21399264035541618045 0.87326443092986016925 0.74245553555040155747 -0.43428864532579414259 -0.60619096064570354709 -0.79907092393114897977 0.81381278778707499821 -0.27323992759410870024 -0.154624920358222534 0.37715966307396264767;0.7229281429472282916 0.54772587611186906997 -0.61845239886807445995 -0.34114036964726368595 0.48071015555866825064 -0.80106242361834500976 -0.38859038008565605082 0.81918831029657190879 0.36482417894349350451 -0.73034099311814038025;-0.067162706080377360118 0.20117534137745649025 -0.10848992790559829069 -0.71423089934525252342 -0.40451272379926961342 -0.57537573035688827083 -0.47122002031046078541 0.18106810824154689898 1.276788529483591228 -1.1419729093332449121];

% Layer 4
b4 = 0.61558082409145731262;
LW4_3 = [-0.71919411509217201495 -0.89363152159043879319 -0.15261362272068770829 0.59158469530427704175 0.60878544654055821717 0.97539524658852949646 -0.67483040650594705578 0.78314480832947164224 -0.6188515221023426216 -0.61163010287136720944 -0.93602459176661878537 -0.46344902439759300128 -0.14350285735601175929 0.2740768945733990658 0.74775841379816088139 0.75106365426459165135 -0.74428454647236408359 -0.38905453638636372515 0.38924075231250448992 -0.44571488086311772392];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.499999999999991;
y1_step1.xoffset = -2.00000000000003;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = tansig_apply(repmat(b3,1,Q) + LW3_2*a2);
    
    % Layer 4
    a4 = repmat(b4,1,Q) + LW4_3*a3;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a4,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(4,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
