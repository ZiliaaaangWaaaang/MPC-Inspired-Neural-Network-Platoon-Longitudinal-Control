function [Y,Xf,Af] = nnmove_16(X,~,~)
%NNMOVE_16 neural network simulation function.
%
% Auto-generated by MATLAB, 09-Jul-2024 21:23:11.
% 
% [Y] = nnmove_16(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 3xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-9.27187740505682;-3.65799721531803;-1.99999468395731];
x1_step1.gain = [0.104758804509858;0.259072168169289;0.50000722551666];
x1_step1.ymin = -1;

% Layer 1
b1 = [3.7240225918182350284;-3.4919149374880049663;-2.66817178939393429;2.2790566859462129123;-1.4148013806593042752;1.3462562026807489701;-1.8801141164247441306;-2.1637818441182536944;0.13058500295351710419;-0.35834299058308805019;-0.35271735031848538977;0.34857418504895087974;-0.8809331619670567326;-1.0721820223301468111;3.3644974718128839442;-2.3206599092533735096;2.7685950387519548954;3.1702195054455732937;3.6529993662569775204;-3.6627658605629487276];
IW1_1 = [-1.2803944310479216107 1.4588027073348159846 3.3104980196706423889;0.61342907104653765504 -3.6700094637380629159 -0.39762261698344564254;2.6959222931687181202 -0.93256216865203211963 2.8217712669908916467;-2.1063620008086609836 2.4292371483222083839 2.3293247768021090316;3.1674242722165946162 2.4884104257102372948 0.67750154692710251592;-3.6332342372922998841 -1.0534272488692058012 1.6063090799174197798;2.0855751754726874481 -1.7301332804715439107 -2.7854996328849797038;1.5986821510025326365 2.0977741911883067694 2.3634203047804569486;2.4063980974404244328 -2.1676350972334645917 2.1075359547928744774;0.40091796718000088928 -3.7428054666020091901 0.43903627688520596717;1.3106296280339666538 3.2813934651146068333 -0.66512296732747155925;1.3327419306373797792 -1.272741701634068745 3.2026919283566139818;-0.24408614254363195095 -3.7727025456013492111 -0.1376200101996300218;-3.2704376421944427733 0.76955207739102915454 -2.8969685876337245567;2.8376870012253720965 2.0507038370809147487 -0.14671722949543916648;-2.2952962519897384119 -2.2888352018271911348 -2.7075881164435675608;3.9421195719076309594 -1.5248400239604229522 0.15136472412275375765;1.1225402485366784422 2.5407218525149772859 -2.4361659753430653375;2.1802786227959853882 2.9354167593898701227 0.31153240778235835595;-1.356051515592370027 -2.1925845380784760863 3.0389820373601810211];

% Layer 2
b2 = [-1.3859979189700359914;1.1821860368451104772;1.0338030570699221489;-0.69036698526344708604;-0.36126897305437211116;-0.19743761703649517769;-0.59839455298314492282;-0.82378247869767662337;-1.1811305380281256205;-1.7399871850516248628];
LW2_1 = [0.57467252616206887517 -0.31432977523344518556 -0.16574852496463682305 0.52484806945987616533 0.51444415753050254381 -0.015353707604114067223 -0.6585192483020947396 -0.82895696364340165641 0.51225435997383295117 -0.41809016678215193963 0.19243109937178157209 0.0020147067212462170527 -0.37328093203419082657 0.4543871507454716463 -0.084655198228457226306 1.189690639542098971 0.26659397653328648081 0.64751716855964325248 -0.10825425200883413701 0.028767970535278193644;-0.40494887806194151958 -0.083735152122822426035 0.17595318989434885482 0.28824934069294050332 -0.68853602198731223005 0.16582345164406031568 -0.049929081429213040266 -0.72929166760803176839 0.62476564607733175993 -0.23981662525678604236 -0.0094836796019835949839 0.48600905069782146528 -0.041191367017528887629 0.43959522514271504035 -0.27660595382944586085 -0.067045205144656977447 0.54652635275502547962 0.45350076203249439777 -0.48174612531919108749 -0.43414929195050810939;-0.15611989750264176902 -0.42293706082439713745 0.71897196323119150208 -0.16960148168468308638 -0.65012595347281498803 0.60832011531696772444 -0.64062341784368748154 -0.42547101259049446842 0.61563065959757445889 -0.42322784799198520655 -0.82373707062717405059 0.53170331232556833356 0.25755249415224851228 -0.29344389073037263627 0.058363247541303168997 1.0905625525496238648 -0.80484896623365553836 -0.073547939522031563486 0.68163096895379826634 -0.42929248714665019238;0.090039018373748169743 0.10704184749004683197 0.28886446064462456551 -0.74107963898201567599 0.51312294595887109061 0.078598735371900041446 0.33399324817912756647 -0.27532294002043211645 0.97899191965285548012 0.34767531930440037646 0.26466333355164833874 0.12685338634577966732 0.38098272020098550295 -0.39192652792147802954 -0.24045953650448720351 0.23319802923164875685 0.20396811376482509859 0.3171776611006541513 0.4102248025479943716 -0.17653987089108957864;0.22232125471234814862 0.77361274283473235869 0.16991243726292390437 0.17169308633045632373 -0.33131689244514295201 0.25299345810226797626 -1.6431144681576019817 -0.27496020861826980797 -0.89804213050878123337 -0.077817927863875591132 -0.24454359121619861916 0.15855521297939684233 0.33809870244482348456 0.3204555185161137576 0.19627953294131866846 0.90940286707645823228 -0.4079057536542257667 0.41018369057121112364 -0.35256700350590414184 -0.5960095243539580423;-0.33516903037835704682 -0.22980937212428168004 0.21594763824954152365 -0.53865444299418707708 0.062704197199893396686 -0.78386528493816076679 0.52302234801099611872 0.039236612856955344064 0.45157367952853694204 0.44682753389026164115 0.55187805077539442422 0.042091569423480607037 0.69151765968462963752 -0.14972343436270013628 -0.13383123594320028849 -0.35555491332353056366 0.14609362868626593612 -0.18989667936486626099 -0.044865637182740197852 -0.45409589393361382559;-0.20238340104962629362 -0.046350848388182493143 0.20143942072494416817 0.35796364052776064035 -0.14792650789542291512 -0.50687591333167070218 0.45445028982844443144 0.56352328020672093345 -0.17940440329597043267 0.5046027847950982359 -0.21624483539945246746 0.22205688796436140464 0.48898997961756235364 -0.25112490165691164767 0.043061602807185253572 -0.49750554641648114806 0.20787822022136004385 -0.40936358577875897602 -0.2573050416328124812 0.66831853627713855293;-0.34723193963284743058 -0.2069548301347760022 -0.25444604942347098797 0.27542730847096186242 -0.29418092671060069865 -0.019503511825613596004 0.64371069693514904042 -0.27701573199774287559 0.012648236465445661381 0.28353164618760645643 0.85595570509866991671 -0.25951991195895846021 -0.11031459802261978087 -0.23827965594526273607 0.081872380633100413916 -0.50727852908875625815 0.3699009511105497694 -0.25246992411231838904 0.16634519985387513641 -0.37478247013772475471;-0.36774974459347831157 0.013633863179094950213 0.17550250387843449595 0.45062815148903090368 0.14300896746473271137 0.72948171912361980951 0.027122347615325718972 -0.61999730238029771012 -0.4996847802829752494 0.46532677813060119298 -0.732815244949246547 -0.1639996530019459664 0.031905782711922292538 0.35728574615983810236 0.031448396583755089395 0.72047729955985195804 -0.40024276487495702437 0.2973952137280944652 0.37256249336877406142 0.43703543554285556594;-0.16785579695030047875 0.17415726569866926687 0.37841303940730541822 0.27507188455674957961 0.83829213535926105916 -1.2904366478866788892 -0.40447573809181019966 -0.07853226120793085907 -0.58383419674789860387 -0.11457889584756730805 -0.41024017230112680421 -0.40847434560327816611 -0.18114325160160310579 0.19163223310575000502 0.2094789096738559897 -1.4703605387258475989 2.5362196484869654611 0.065688575447066188673 0.17253665077521751492 -0.11675598559905778218];

% Layer 3
b3 = [1.9498604162194219658;1.6911387665148647219;1.6833993505888154019;-1.4527714473361088565;1.2052511331715138887;1.0942309848939475447;-0.49563020411720981606;-0.36820787312270913949;-0.263667026670916127;0.18415066781281011488;0.011036071688519170225;0.22063673419574902912;-0.48480950973274727911;0.5154447528869218198;0.93395876245458109288;1.362908648585847704;1.2031291769347300935;-1.1885437477024942687;-1.4753126499526660886;1.8628479618990523292];
LW3_2 = [-0.41659058640315727029 -0.44475966549676471118 -0.67509736994134039723 -0.77291110870179002834 -0.59774689750769172125 -0.85773962738217179869 0.1991208328634940794 0.71179260262735644105 -0.15106836938287868111 0.16210144724512121073;-0.39863472187341647546 0.75368116792687700478 0.86915689913726723592 -0.42295427192551637852 0.24546187453200932205 0.55143680663236516182 -0.36329055832219969702 0.84906586741863743217 -0.60152712194785984412 -0.57477711986622936902;-0.91625723301255579401 0.050024360958543595546 -0.45698206779728683946 0.30813855523554500859 0.10814047182440029993 0.67639909564019706778 -0.89341042023736438882 -0.59674024916646306593 -0.71013981979130058608 0.30560441431021961867;0.33527605392387455074 -1.0021397000804879163 -0.095698983859624872639 -0.68112907376762099609 0.73507005378659728834 0.31676942092448401311 -0.44850286969555919203 -0.77177124770028715517 0.25560202311740515269 1.561757695817930891;-0.63165751660683866486 -0.7015772281589022219 1.4568379537729496676 -0.3257140085108283234 0.48947734162464379137 0.36066973856129258547 0.355645952304546209 -0.67457616372202988675 -0.31446600304394617398 -2.2457178007022076116;-0.97973156477597422853 0.66674649919662487552 -0.062165606745301645042 -0.42851274748841899909 0.063302629234251367452 -0.86259367753666738032 0.23334503121092317612 0.42060452286443605896 0.22688986587847720378 0.82136833421628951957;0.10263377706089547858 0.58764015383520851188 -0.50918619301320999782 -0.53967117433777755942 -0.50212315924620021246 -0.014795153498091389438 -0.62369510925412219304 0.25243046608884767146 0.64719511542377794466 -1.1394954905829353109;0.76410820798277701016 -0.10023162663429172059 0.036933498396494263138 -1.0107519946422287571 -1.2348742874062279551 0.48304238230061080639 -0.072065256151398943141 0.40773171869358254549 0.4348008951673217326 0.16145853696035772362;0.98995738314573833438 0.92666188195366339109 0.24990271734995717079 -0.050186703906243197715 0.4190812575366428816 -0.060394913381329712321 -0.78865918324527517491 -0.41048458031104739785 -0.52889651199092613254 0.59409534995519674982;-0.50634429458593832596 1.0534729779598637212 -0.012551029629306161006 -0.1912543824641633472 0.53133286637744903125 0.086244005416058269753 -0.35387028451122731765 1.0309866245868837265 0.39930808558655095375 0.51903883456636068505;-0.57647510341615670892 0.90114174642939315341 0.066020141636591617162 -0.67990505627997765981 0.062586439302270258089 0.65898333348145510246 -0.44479265380922561324 0.82316920182113206828 0.7917858081260165104 0.39252280154982588378;0.31655504729165906408 -0.58319809587262150252 -0.24277338707311993393 0.85718493951313168289 -0.81647987920357834035 -0.43120750853402006753 -0.71151625996382239503 0.033550714180269156084 1.0754430514093857862 0.48577489993528938372;-0.48061348823175986666 -0.49072997406448487512 0.89649924422617666142 0.63330029864919734628 -0.6454955165200207956 -0.67550583474127434691 0.37199857691183224606 -0.21049126456129574336 0.05889659528367142266 0.38177724110761512843;0.33585874368535856282 -0.53971497559500369867 0.80491291080671667491 0.64579677824027259536 -0.20394786467277736808 1.396433957229521905 -0.24187503884206923432 -0.47735553358798332724 -0.70323144715476015865 0.19428812256940847236;0.38229501157445483495 0.6891591121971686329 0.075742338077310483735 0.85822493446451919574 0.70009259713159077698 0.12221284883006086619 -0.68189270501694898563 0.59658921849517609903 -0.84893539778071602786 -0.63049943052134571619;0.11983349329754121315 0.94509283866325521917 1.2758926672715487083 0.20232946462176898406 -0.08331494593494440104 0.71911685732650354463 -0.39064430957611956385 -0.68408281869131670749 0.73394922315455179973 -0.30693126007592769211;1.1483769633458547066 0.80678323995849010597 -0.078551720421814366646 -0.4862933657036904167 -0.08208534284990283425 0.090351151116436892452 -0.1405683045815115384 -0.35010857614136853266 0.33793576174043005178 1.3260629874817466689;-0.49846310756198120018 1.0325045810618169728 -0.5470659331324800867 -0.53647562967338058293 0.80853241978066214823 -0.67443915551561972599 -0.69959588041374087819 1.1677748284931424028 -0.17097304236147153889 -0.21373046726257544092;-0.31875801823629412723 -0.325399587182966743 0.24273475617039544372 -0.80814388351127308674 1.6461763170023735459 0.66622281432429220072 0.12720247930484296361 0.20114743513738347902 -0.75219350316671440559 -1.4837694460581358769;0.93908537294423277686 -0.045371706513233002467 0.066177357407922979271 0.18302471817612164795 0.58453235224013599947 0.20834636953413418481 -1.0950274650842397595 0.95200382423439289248 -0.34648257632161255648 -0.049270563044869306046];

% Layer 4
b4 = 0.0096491437702769487783;
LW4_3 = [0.68014596454931997016 -0.24265098135126425549 -0.4391838003316489436 -1.3347729258444065437 -1.1746158566890485542 0.30860207875973183489 0.54364926669811741711 -0.57714043306439100078 -0.12933383869341003036 -0.51533479048005159662 -0.3311655342901591581 -0.306349561982137919 -0.33893084307232251851 0.38064056315364530603 -0.49243256450401245994 -0.63042993011931858227 0.28180737092136881605 -0.081504350228719560367 -0.85045583785821088352 -0.24600443379714140302];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.499999999999991;
y1_step1.xoffset = -2.00000000000003;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = tansig_apply(repmat(b3,1,Q) + LW3_2*a2);
    
    % Layer 4
    a4 = repmat(b4,1,Q) + LW4_3*a3;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a4,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(4,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
