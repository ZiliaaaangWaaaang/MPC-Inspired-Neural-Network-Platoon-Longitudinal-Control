function [Y,Xf,Af] = nnmove_20(X,~,~)
%NNMOVE_20 neural network simulation function.
%
% Auto-generated by MATLAB, 09-Jul-2024 21:23:15.
% 
% [Y] = nnmove_20(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 3xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-9.27187740505682;-3.65799721531803;-1.99999468395731];
x1_step1.gain = [0.104758804509858;0.259072168169289;0.50000722551666];
x1_step1.ymin = -1;

% Layer 1
b1 = [-3.3954964298584213722;-3.0679341644236739484;3.1001933116943192204;2.8159613178481697204;-2.378512437793851575;1.8146504076504732517;1.4919403908118307189;-0.24714875276463071918;0.67704161512470917295;0.55053231741939034904;0.34567135898684087092;-0.91515525659936081126;-0.88374812412696157615;-1.3853629376960225894;-1.8657597951171678297;2.1979166911902661141;-2.7887515678168051103;2.9076266189747159707;3.3030651010969980241;3.9144238744565664767];
IW1_1 = [2.0944388462637459902 2.8144216601562508373 -2.2485230785813898891;1.4512901948122687301 2.2004800741999055447 -3.1916632504906603529;-0.49402502259639924365 2.4946880541982334734 2.6236791136895245558;-2.7459217185952873308 2.1553825330657225834 -1.1075237992951074695;0.057958840923757026786 -2.6440194473071167991 -2.64401070028227414;-3.1497213703034745436 -0.0018938043477069611137 2.1782312752333212735;-2.8007540029785773505 1.980295511909663686 -1.5063368939725152451;3.5091576693180339674 1.4339974948513753983 0.22228349829752497291;-2.6028699081422765893 -1.4176122186824204885 2.2065497790980042048;-2.1675248132180895411 -2.2433684134032625401 -2.0550885934360678675;2.3721769470737852359 2.0629212990582055376 -1.8534250805704726162;-3.1345805260444938867 -1.4678867219442532921 -1.6710569708150011525;-4.0274654673662295679 0.17239504192299956453 0.13698190111770178201;-0.30580473876364422381 3.0275687181637969125 2.2538245030799508584;-3.388847298902943006 0.91589778894605378134 -1.4430715328817178555;1.2935778594669358199 -3.2314703467120229341 -1.4916526499861537669;-2.7561579563729523557 -1.1156419124577978685 -1.9240910207435455437;2.086499724700853875 2.4846328998778379749 2.0534289143528936528;3.2188844087404571148 -1.9158498080010164522 0.79443862902000728088;1.228507737050696047 -0.30243156004423404903 3.4850769556955851769];

% Layer 2
b2 = [1.5925225089574679416;-1.1961456685736919781;-0.89741883192775229183;-0.37961034464415083223;-0.07584490289377789074;0.1197244153956538576;-0.57005672807906138111;0.90196868771164695477;-1.3455556361198173221;-1.7437676448489343173];
LW2_1 = [-0.39515513968617754781 0.34968087495722366409 0.59410811779182026715 -0.036886169449011997623 0.18025809945813220381 0.30949404264394242414 -0.48259584830538654332 0.5416536165085986676 -0.71055642587610179373 -0.30410251676603794468 -0.63131472385449349805 0.00092382603062301019148 -0.34642123933534835212 0.074855346260451760543 0.059115909054734690209 0.072396382442962120551 0.20474203938011861781 0.19400316608137799235 0.096315327838991299236 -0.35404322476646804541;-0.031027556833264892389 0.27462166131033149963 0.3288548644181276126 0.098354174010195929978 -0.26775237705290561019 0.98752263357037040059 -0.015512539021854919452 -0.72969061267516110991 0.27414245628285888179 -0.529727311832216885 0.06966346803078891925 0.71303285073310751496 0.69076659848054500213 -0.032476591514625063883 -0.53417673637325480129 -0.33884395035671993623 -0.51308600493813694143 -0.056954231495044319034 -0.17206117052107439136 -0.23525306813202243039;0.39728201622908204671 0.31938849261320018114 0.17591154896505173388 -0.27312498583857464096 0.096666282761063274109 -0.15747934962244566903 -0.21443788487164985868 -0.47108107178330477227 0.17055241936947895809 -0.47337685076429275588 0.2477599791143834107 -0.31284997007355136445 0.40332186242521922415 0.21431091847906971748 -0.61704915455113729106 -0.60873142922229228624 0.44925065618922033206 0.23978114508563927454 -0.38118843617579017957 0.3446682755015666455;0.64866286708710596542 -0.5401041634416607895 0.35038579361122434985 0.53732120015971984728 -0.21077968953401612917 -0.36124494466658374492 0.19032144271060247309 0.72130112564668980024 0.10607725244944024579 0.40945315898339995631 0.29822248000085094244 0.21619391017714209569 -0.30810999200427607869 0.5999163013210492279 -0.16694569284505844653 0.44149419576804754817 -0.5517005960962100275 0.078032601356980660356 0.074681809667867332658 0.49504072555390360444;0.083268144768888080476 -0.12619544058315862456 0.63668596233550089902 -0.54014251279420755214 0.044926462663795484198 -0.37745944143950160843 -0.565237111497589928 -0.46943096549529178541 0.51784532681228268025 0.098230582421541035032 -0.1022920063584637218 0.10232222265659711435 -0.15097542095402180506 0.1628191038971291138 0.56075300119131488152 0.013896938704799459419 0.61931263152108584347 -0.098125459508288909172 0.12581646062801665753 -0.41102129401406933829;0.62847283434076295361 -0.38218618389976810601 -0.29019692246840328442 -0.1331217452228305731 -0.36588297888043075368 -0.22653568442052274268 -0.61122249041474829845 -0.039655721895345233396 0.12285170692258649827 0.32368266066424689065 -0.035862657829945521204 0.144927140309838276 -0.67508191680589335615 -0.0043038045483762988469 0.01462821011858906825 0.58376938713384018964 0.15353289341137060786 0.28791977953765629517 0.52865085859159799409 0.31219571897085196532;-0.31360988988918414577 -0.6299296119347826961 0.1104709056486112978 -0.34647007002659463426 -0.26660998303843241874 -0.34335347037415908655 -0.083041462511868918694 -0.71621415914252606338 0.40513355322918781498 -0.27984029484634398433 -0.14604070545464556408 0.1480013194373385188 0.092319300096106379772 0.2225556210294581394 -0.8123838788969630631 0.40961889420545816165 0.061087405498351378397 0.25230244167190335469 0.032852593523615358784 0.24335777235814048947;0.59193571283664847549 0.33099446501996526715 0.058011157081235102673 0.18063051150647010945 -0.47259186540853065361 0.39863129876144326458 -0.090423806110406915182 0.36960265970726935425 0.2678005833871106578 -0.29778383339685698949 0.44146238622804701013 0.50901832376465205865 0.46293115179226002054 -0.0033682776887347005979 0.062248492773041966264 -0.34762888850974543731 -0.077598502125972107502 -0.27340002041770783414 -0.11027822213835752896 0.45119404238556282127;-0.65713070862441502751 0.088325697977574044173 -0.2461246564915011148 -0.66384433226184236254 -0.081027735243178827806 0.27479753855394045692 0.0087003638133164168389 -0.34956503535602823085 -0.61736880973131125216 0.51992734710940291532 0.2848363176141398001 0.82261611177907112413 0.35604752420730301221 0.19144417028006274761 0.05372554926251511126 -0.71335411030943041144 -0.32878488495756258425 0.0084461266984316579753 -0.1308267097265592982 -0.071509017085183104734;-0.14641216525359326828 -0.45514092660546129343 -0.4109138844251882805 -0.75438095631352997117 -0.051125541972453392159 0.22837926369072072963 -0.29099875967397725862 -0.75067309525715897323 -0.15440634460472685285 0.78248391820265217333 0.047642383007890552749 -0.069631595915115154782 0.3566922644646765006 -0.23981967825400832273 0.38300561488757961515 0.25357692507450191322 -0.15095541010273760829 -0.036798097582376065873 0.008066719043081115037 0.31197606156256535437];

% Layer 3
b3 = [-1.9606227282659842714;-1.7005801658988626279;1.4573327571299714567;1.2963496222055423956;1.2459021519434898551;-0.89648999801580209201;-0.73692165501779216541;0.53650865890550336612;-0.11785869831089547388;0.17893282466600538005;0.22485038518408095864;-0.20928430102276768254;-0.63896356562992706607;-0.66645285666361309129;0.92811529180282592577;-1.0944748671231856463;1.2504328090803684681;-1.4778185193975268419;-1.634224698920969443;1.9112532645223301309];
LW3_2 = [0.27128825633312536603 -0.013150292629915530385 0.99897225699841685209 -0.29303045455978643519 -0.45515074280866774092 -0.87536707834982685483 -0.73777431156416362068 0.39565271846642896536 0.45437949233824626027 -0.66499515661641594999;0.49293869411622842636 0.47218421218542394602 0.66457414887956733907 0.5322908128029860686 -0.70542622866784687741 -0.24976183572789567577 0.63908599335505522632 -0.78391446063973535541 0.30478828694827969636 -0.80635775335660930807;-0.12980628193901133649 0.39790113178632213753 -0.36946737852830380255 0.83214391449203772844 1.0098555301521523475 0.470451616368133263 0.67359894225129679501 0.57941244035332872819 0.26485243035574335124 0.63403244139515402278;-0.55561849012785524682 -0.8102677498163076697 0.82457655392371209668 -0.89014411905809176506 0.41222546383360730848 0.1206630001788285278 -0.44968803681287489171 -0.64075928515856261924 -0.4540432062218085485 0.37691079378821734647;-0.48928114514027915005 0.93333080589605899036 0.39908110810767483123 -1.0119631721094186627 -0.77928395809009898265 -0.15327844870813450706 -0.085472612096620964595 -0.69442367920265613002 0.59540996561553638511 -0.075165236513573763233;0.86911381702766798973 -0.081713028163496639888 0.47194599388862595868 0.052270589897929563283 1.0282822726493288101 0.67571302094124940929 -0.90181009614268647923 -0.55259811723197749256 -0.42595039100084242101 -0.1852078200142046327;-0.0076595472043935151907 0.14775464136862129227 -0.062171201969388800723 -0.92415873912209678398 0.89578560560510500643 -0.09512700579724389649 -0.37271484608858768128 -1.1027498044658374798 -0.15682434976842174468 1.5606208258225391372;-0.38677072070758278244 -0.24649631292141360728 0.80413304804524432523 0.31714679281142882372 -0.71785554251414840365 -0.96712762244826777636 0.79656268898556525926 0.037143805074936891986 -0.48618214343251447973 0.50797897057128471587;0.54918260087266057567 0.081818741653000348624 -0.43360927464687915034 -0.56859262129988463741 -0.5528401574961128162 -0.76549223711830172157 -0.75327016313049066643 -0.12889038685798026584 -0.35298898209205098464 -1.0379900715263248312;-0.8736609933297021513 -0.032788044954479886317 1.0645981916633708853 -0.10609768880116092482 0.15914032049206416897 -1.0657676404339417875 -0.031904336351909118319 0.090183061463608382713 -0.036259936608779609613 -0.43732773031344074344;0.97076704545521708134 0.11455506412890623102 -0.019139359365848797323 -0.946432235434457092 -0.71222672366515960007 0.42503900677913608597 -0.22398156614067718517 -0.052546792209500266246 -0.39457259173222480886 0.49090303323798750723;-0.055676613549629286326 -1.0171011395903046814 0.093390620373735827586 -0.5018484726052829803 1.1399576623323754987 -0.14861073311218475634 -0.83576265005803496155 -0.20323495784902725902 -0.38081729501568167828 -0.27135034841249194848;-0.38842408485983942468 -0.70990515719962687946 -0.62705625727530600599 0.78883957120934600216 -0.0028051399632517889926 0.26026566291128788722 0.70121256824789179873 0.61293291065706845266 -1.2064682183411428174 0.036366428844870374304;-0.53568991002821841896 -0.60769862194479551398 -0.39536758801213012227 0.43332720289287740556 -0.67759228905085633343 -0.46730585654107176241 0.24055627318122910219 0.94012465033293013406 0.031951347973004917691 0.58119038153213620213;0.70209455492507477636 0.034129968500231692985 -0.62689815203175613956 -0.19801087959032109831 -0.78991877795709164456 0.30453882015903360747 0.77460898496266350488 -0.54690811376132253407 0.69925633583532964543 -0.72732290758965156829;-0.61574444948700213232 -0.47139708477590813729 -0.40342590382423304529 -0.72813962056673864343 -0.42700335803882943919 -0.76617664793133088974 -0.58925861674311919014 -0.61673125871153422484 -0.39966609056370300257 0.59857745887130509033;-0.023275776542061317465 0.97785178040368703201 -0.29489651677915135197 -0.35307281036775778338 -0.51343638721272910619 -0.75898954637082360897 -0.34938170091020454011 0.76976322993468582201 0.65591184898809939963 -0.79490479153486559571;-0.383098775657786772 -0.47952193625087674578 0.047066471521612730788 -0.40787871912953121978 -0.8498739201615986838 -0.1135726425560337205 0.94427772663647224771 0.67128516721780973064 0.26455190788551052883 0.97133217953193895511;-0.61941681803828241293 0.73785760230238273127 0.57474959653537660564 -0.19116531784093276913 -0.84006693628682227448 -0.79002317263788646162 0.29245555087938485128 -0.13203541282972167115 0.84231790381095328346 -0.1426401937358178218;0.62145711658913815878 0.16856743809117205601 -0.50475891462248012598 -0.67622144038167331104 -0.25884321044853492166 0.46924429802745326601 -0.79464299970685747798 -0.83350324005138798356 0.77455849985026936633 0.58421298861524006973];

% Layer 4
b4 = 0.28825823980184483997;
LW4_3 = [-0.32050700769661472078 -0.37818072145793069083 -0.086010377977170565655 0.10686823411157547747 -0.88505333862116986055 0.87832271933566763433 -1.2168544363824096433 -0.35867341809869562885 0.5801717665477978958 0.67019902713546475326 0.54206487675190551112 0.37583854239475739112 0.48093106584735534348 0.55356242844511482915 -0.18447124417622692838 0.32738883927183598521 0.12787899271874636487 -0.30864947438792833534 0.86814393890125618469 -0.59069398553841134802];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.499999999999991;
y1_step1.xoffset = -2.00000000000003;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = tansig_apply(repmat(b3,1,Q) + LW3_2*a2);
    
    % Layer 4
    a4 = repmat(b4,1,Q) + LW4_3*a3;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a4,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(4,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
