function [Y,Xf,Af] = nnmove_22(X,~,~)
%NNMOVE_22 neural network simulation function.
%
% Auto-generated by MATLAB, 09-Jul-2024 21:23:16.
% 
% [Y] = nnmove_22(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 3xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-9.27187740505682;-3.65799721531803;-1.99999468395731];
x1_step1.gain = [0.104758804509858;0.259072168169289;0.50000722551666];
x1_step1.ymin = -1;

% Layer 1
b1 = [3.6862737272546586276;-2.8054457636371461504;-3.8514368004273515922;3.3685586771558875263;4.0720555216641391993;-2.3826944292592524555;-3.1144162902715439856;2.7649614508083812936;-1.4453189625533919838;0.10141669330015967709;0.77974560189262354104;-2.1171349539868020706;1.4412327767064323503;1.3080693445729647539;-1.9732285063321544083;2.4762667158478457452;1.620411016658442005;-3.8142127367934697268;-3.8870272002724011173;3.6705814048293028407];
IW1_1 = [-3.8046466839309749375 -0.69868915606396853057 0.58032863484017338518;2.1701393343111763379 -3.3534166838974619473 -2.565113780933624188;0.28290909591354912456 -1.6591477105632090883 -2.596177528297894721;-3.21740617419267938 -0.69791770251242413181 -1.9305098967655092146;-2.9397535412654343112 -1.2121259664705161807 -2.8268078456110341534;0.88240681439896739846 -3.3428342114231841542 -0.77453396009487029961;1.9567681398669369841 3.2421592206727853913 3.3750134561594928861;-2.701307491723635934 1.3819257808940454968 0.72219194426900201744;4.8741931559533639984 0.81740246209743694372 -2.1449524612095189902;-2.9298998245633107729 -2.2410730675200505324 0.25064880155376473292;3.9500513390079277087 -0.25864288522992456842 1.4081940968482737908;-5.1037462835921321158 -2.0850879310940282352 2.105359712953736917;3.9430338551262154034 3.3148409148442414818 0.42710524180526776572;1.0334541207513576744 -2.0661521958684567757 2.0527743183047624242;-0.853750707855914448 -3.0285540476177938984 1.2653243948731365265;1.8719796898287270892 -1.6261633862718085641 -3.9535779576361265164;3.2342811483270446082 -0.71962734168617659147 -2.1170826897428303148;-3.2490436336041024212 0.56802953638634845479 -2.3764435193386672651;-2.1027323446569807786 -0.95341195256367805566 2.4503625187410240649;2.7723067628998374623 -0.077262663032412942643 -2.7298653900511986592];

% Layer 2
b2 = [1.889543175572113487;1.6791440821153897911;-0.44126404217630055271;0.085887250189121341903;0.27142015128939411817;-0.17564835849426088665;0.33101167194350500367;-0.51215255636965806296;0.66448717125542478001;-1.194055090585801171];
LW2_1 = [-0.3029300004941775093 -0.18960320411697362264 -0.84766652090999616842 -0.2038862039481537658 -0.37724386374727325588 -0.25513119659351418678 -0.33795276004129953806 0.29528106419095284663 0.74105939497535033844 -0.20316551610062177913 -0.13450795972901263831 -0.48970642632327854304 -0.20591559196939879239 -0.039162290084456721773 -0.1875563251026966527 0.45187490207913105777 0.3777920861524713958 -0.51499320971521389545 -0.28186104219633018042 0.96378614377504712163;0.35433718342210479557 -0.69346921201078615127 -0.36129537885797208263 0.51412097566760228684 0.32954933799947910833 -0.24248678168581264125 -0.75626255789135288232 0.44054208367123487422 0.36916274336731746963 -0.59750756158621642911 0.14025289511409408383 0.97469799302369974914 0.20686157333487376064 -0.36518548342828599518 -0.91569258751425419707 0.84834043119708568703 -0.12678381011953701596 -0.16514159492507299309 -0.80691215041766140015 0.20745587829232603472;1.1411279578812936197 0.30947377547782278784 0.20025851466474275941 1.0033162701792910365 0.080054296590372012177 0.32507253209149267192 -0.70171799931751388524 0.39120204612934883492 1.1625785141288460522 0.33530671444506782164 -1.0792021783793743772 -0.83770912915761563955 -1.0800842853007786015 0.21853748226832692136 1.2008617245825070619 -1.8841509223556824892 -0.071034090470485880542 0.23993219456408357293 -0.31791585909823011358 1.0029472519778470652;-0.10058718873494569557 0.19580887523945941786 0.43916336390290167113 2.3475025758476952831 -2.0033967308546536401 -0.79392882315000723459 -1.1761261311637571936 -0.022666488417927125459 -0.08857286976303672954 -1.9417647636996293592 0.16179333900707049132 -0.7786149072388744985 -1.2726789903544966087 0.24986649117890524785 -0.32871739764298568698 0.40363052413133920782 0.11474499465292560541 0.43860663088216406136 0.066976475782188474306 -0.64270616850285378074;-0.061597535047901594285 0.72662472032813918421 -0.078769486018223214274 0.58493270011930420527 -0.47746713744734425866 -0.18048716357790606235 -0.42695557076499646154 0.52888457845101954913 -0.71738996890240591675 -0.61761817560809495475 -1.1727569615979154261 0.61188476673785563431 0.82254031804321969812 -0.46857584750702840903 -0.35622839470956724206 -0.014904136852103410521 0.25733100682836806961 0.15580899135475784201 -0.7646490169388134861 -0.35169989096393533545;-0.49830867755294144805 -0.56292183655623362348 -0.43047251632907879149 0.62195717137296924193 0.09786806067783256069 -1.6655606944373293477 -0.59039203863499123415 0.78704471996564218106 1.7852426415346513977 -1.6199391538725735895 0.48317458493322684721 -0.84952075092487089325 0.53405818508303026793 -1.8253542703434062489 0.69972574256909703116 -0.90698048668657771376 0.17835052694506353665 0.74081961435598142618 -0.066416078757952815015 0.067278510701240176739;0.81388263518513148664 1.7328239732723564881 0.40734629117678983201 0.28130692654626737736 -0.042035268412773552082 0.22958881124195523737 -0.10672336699228565648 -0.37645366460736040537 -0.28326319846336667219 -2.3273029218969183418 -0.3061224326113807237 -0.48442278753805212421 -0.96622842577121148544 0.45850966508166651758 0.35315383335201055992 -0.29727716305454787715 0.070813893829061586027 -0.2442796519366223218 -0.31158671785695041256 0.30209599211836690724;-0.053947876451582249535 -0.29730755347316972781 -0.85917569830121975905 -0.48663065970042790331 -2.1775657255086984243 -0.4392361941555976701 -0.61607546048916872472 0.14484099399995431501 1.7048693097993616874 2.2293283172869240438 0.7279677368864166942 -0.20003324964574661915 2.2611172243686357142 -1.1472616767839163288 -0.36138734551813683771 -1.1409651982472883702 -0.24027083398903029132 0.76778482307634299264 -0.15064275331210139064 0.42523229720580441038;-0.2627617216427708402 -0.13931036627547913054 -0.62402861872319659309 -0.026563814513942927975 -0.25665034844566170236 -1.054036378971624055 0.93895433522154292394 0.36903296542453528639 3.875815764414504816 -0.41279761173888435133 1.3812376506489874028 -0.69909903128259254235 1.0095939407691738587 -0.68033480777464783174 1.4604300372178793399 1.340718416040464156 0.36192327832360970952 -3.2292449097860025375 0.44773504626899385261 -0.53792272653704364949;0.28192092760784098759 -0.21068486039775871643 -0.80797329789037541925 -0.38335948145110720908 -2.2726637444533341892 -0.82392169973872853017 0.31556242906920611846 1.1177367300637868208 -0.15077883978593828451 0.32872172309224412245 -1.1019680322512266368 0.59170633437828479284 0.55396983888796191842 1.3900351050115515861 -0.23439547953328587759 0.85644837050763644726 0.6894152667792116107 1.4506650429641880784 -0.16864070416417389908 0.011862975970772269424];

% Layer 3
b3 = [2.1501453041596492177;-1.217907753110697211;-1.1657738958829735321;1.2947910386155601081;2.133635448656644229;-0.85437698185937183126;0.38812650058400116615;0.19656302592225474712;0.33819167652733139739;-0.38724131148400403601;0.18213429284977236677;1.0366083430047643432;1.0508166096773907672;0.98335457616211785492;-0.95938209122109641136;0.70231909659858759998;-0.93076457274530688402;0.3860478485929800252;-1.1590182012913914367;2.0956730594450103666];
LW3_2 = [-0.17992042884476838749 0.60823345485573820923 1.6065988154832888668 -0.20392349262613232441 0.1876142904761841923 -1.0882843362639469387 0.2493038993140756221 -1.3984221744507896457 -0.77661092313056434566 -1.168965975566736315;1.1348095109997533569 1.2106559520474899916 0.92031652827962895369 0.34465250202053743234 -0.71246731741317514963 -1.1741383966220477753 -0.075224222068097826299 0.79800572921464385523 -0.80616279385475342334 0.5865481683031779081;0.46796161190650670259 0.30050436472974167978 1.4911436718662585132 -1.3870469762124779667 0.69121567266471251045 0.0036676879904764293772 -0.70026630958211089073 1.3701729909734201573 -0.84142022237712965627 0.20968918976762457307;-0.075931336443413086079 0.60656115719146153076 -0.65256093071718901388 0.11322630030219582586 0.29245714866307481739 0.7086570387116436498 -0.22269928297062974165 0.19720348073891075247 0.99481020531794372985 -0.18745273833471168268;0.12692329336550892127 1.8700278747370977506 0.20708560443590115496 1.5051921869981632618 0.79439815900783050662 0.7512649022728279391 0.80905606643026428682 -1.654104727611257486 -3.5048692892819075517 0.26768930413131952761;0.70395983972310161025 0.082242691014397434346 0.31869390228726546255 0.26641983745965891472 0.37234644366555669226 0.73621574188474470102 0.46843620114280676292 -0.51170728751822369684 1.6123676856501412136 -0.69483532493773669803;-1.0095499201387467814 0.40117168403603947757 0.34649196662667497426 -0.77282445757423212651 -0.95202769016775334876 -0.86090398708871695987 1.0476550107396924716 0.42885080043586104592 -1.8202938316050709666 -0.3928498928335448781;-0.43350775126279716964 -0.90207180990900348583 0.49026011017231130307 1.112696249864840059 -0.6685072547582134872 0.46021942908012997142 0.26183123036803979122 -0.20001652060080060691 0.39016118254824350142 0.97350866910730926573;1.4848826400719929985 0.03194563926751382843 1.9479768876377308029 -0.39039326669535179271 0.86662725212518998408 0.79628524789168397824 -0.38600772852113807154 1.7312271761192459252 -0.82857600281893739602 -0.47661915562939266566;0.52338330125512944058 -0.90320306576588338388 1.2676345320212545342 0.83191739888323457119 -0.71145257691783514442 -0.33758370040546747948 1.3650638067195901559 0.67080278879299104489 3.2501116138490195873 -0.17326111384431372442;0.58707866301680333709 -0.2785068269192805257 -1.6385874070767934008 -1.6970140869189587196 0.20765192635439566615 -0.26860631164408599325 1.5271869264175881309 -1.9367306392075043231 -1.6825993441354347713 0.99807970690564917771;1.3879739079711075345 0.30535209613958946839 -1.2247378833428852474 -0.35125018242960703851 1.020208378322788656 1.0605349743537348939 -0.032795401074942186204 1.7074658929509261007 0.27308525151936596798 0.65650783735604023583;1.290533421719191054 1.3437316544043715894 0.55038430475360267113 -0.071817339935205865009 1.2020040826197821993 0.67896438148413740254 -0.3606103462746944599 -0.35498118628094788019 -0.074815994255483866948 0.22103122775699232672;0.61236137316483818527 1.1571838008799875119 0.070895583523756355859 0.013902283279087235615 0.89292080149942787415 -0.3044528494087088144 -0.24187816167795897493 -0.0170477937856352256 0.38164157973064449791 -0.49700287735660270139;-0.92216526410736110453 0.62220509006270907637 2.2943673451000621277 2.365898590003377322 0.74136836830151786604 0.40348550284807860322 0.88349496629980306395 -1.0683910553939079957 -0.84750262476892157526 -1.796306052406695386;0.0032459316208633907236 -0.6944325188220725753 -0.26305583147297839641 0.026179635846326938797 -1.4393343247861953849 -0.94464935441204045397 0.047238589819896842359 -0.29415314346120102762 0.5875068744258222786 -0.51424652465858344819;-0.14038714690762679749 1.1267286297428384945 0.10339939218148679057 0.077968797037957171536 -0.32729045541883711179 0.45318480081060574793 -0.67497787311295176504 1.746511804726182282 -0.85929574571126554616 0.76544761897536883755;-0.26000018637723171233 -1.4688687221680711836 -0.52972204043058590539 1.8242779194723073299 -1.1741901798414271507 -1.4299478971567405328 1.3220224813581737955 -2.0248658283848883777 -0.84833188825974970015 -0.52358320437269589842;0.042401097864207051846 1.0998339236498364535 -0.4573587880744838241 0.026118718958972986927 0.32979645362433368527 -1.5462420880370522092 0.15170538353893106565 -0.82496968140404980385 -1.1760632907699639649 0.56605837134044068026;0.41681843198804274797 1.2020175778443455972 -0.23964556611728021762 -0.04737950722997900932 -0.16352791391666898768 0.10913068094601187374 -0.85167287495256016605 -0.36282958022821715227 0.44434373455017123211 -0.83478954422808637759];

% Layer 4
b4 = 0.57969156232550167474;
LW4_3 = [0.074695528109153225271 -0.74472956474930140924 0.15301481139111788865 -0.15416413110515606033 -0.56450211556964502435 -0.4226525827230453447 -0.26105751860884618409 0.13134738608274237892 -0.086879137993369909276 0.69456288615870009906 -0.034178515220196672986 -0.088844172180308308984 -0.42978054451356451082 0.41898113788992202844 -0.038499108695793600454 -0.11306764117067920339 -0.27722062991950296995 -0.12539374870192399047 -0.047465212913079458945 -0.1197126062291496984];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.499999999999991;
y1_step1.xoffset = -2.00000000000003;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = tansig_apply(repmat(b3,1,Q) + LW3_2*a2);
    
    % Layer 4
    a4 = repmat(b4,1,Q) + LW4_3*a3;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a4,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(4,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
