function [Y,Xf,Af] = nnmove_27(X,~,~)
%NNMOVE_27 neural network simulation function.
%
% Auto-generated by MATLAB, 09-Jul-2024 21:23:21.
% 
% [Y] = nnmove_27(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 3xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-9.27187740505682;-3.65799721531803;-1.99999468395731];
x1_step1.gain = [0.104758804509858;0.259072168169289;0.50000722551666];
x1_step1.ymin = -1;

% Layer 1
b1 = [-4.2185124633999162569;-3.183339017002299709;-3.7706121770076084232;-3.8546425384440303752;2.9152559783044900144;1.4099645991840525916;1.6225552661662794307;-0.083628951061546899504;0.02877516392236729309;-0.93335912782043495284;-0.74435355907113565088;-0.24196301600938513454;-2.5556615197796204164;-1.8478011985561346719;-1.778735078667546432;2.7598640591416110368;3.2927495248052407462;-2.57618207712463132;3.9969346968389309893;2.8051588706781052096];
IW1_1 = [3.1684197869713526252 0.94544930766490131724 -0.59946814404211867799;3.810597444515094967 -2.2031005291843386296 0.33497596189172518244;0.48891924720531776405 1.2395885079358555103 -3.887626258907898702;1.2032051187351211485 2.4311759138290911508 1.9925873938971696564;-0.71643588905597199723 2.479739694176586795 2.5292523168852683035;0.029593519231563201327 0.11851683056792593207 -3.5867148741465255668;-0.47283061613424182124 3.8252612360125928248 0.69180699368267595251;-2.6946195429868295967 3.1022668481940289809 0.1390598152282934985;-1.9247255741263371576 3.6010466669090104297 0.80130384824510159092;-1.7867044236645084343 -1.9471467490575264936 2.8025349766537619445;-3.886069841329693908 1.3747802745077217779 1.6323900105738144983;-4.4490287008255320345 -1.3968781141737312002 0.41240984542733927221;-1.8137439317093431157 2.8783764151637658557 -0.91912094429236013138;-1.7664191762492056359 -2.0257120180074088545 2.9597829519278846533;-2.60008513131336505 -0.34218514100435171166 2.2234237551210509487;1.1744163710001405132 2.417814927559791105 2.2507728000918927336;0.28432113388758883943 3.0300792098891915494 0.6034299649259623477;-0.98088102902836160624 2.2496559677586089876 2.5297861339456768626;1.7899862491910469853 2.6445994650616837518 0.1019779864744355391;3.7187531690370096982 -2.2387860787412408037 2.1951287528485301515];

% Layer 2
b2 = [-1.6828911606128067469;0.9629679199586637095;0.23132165388743833323;0.34199972189523408783;0.57165371443095513992;0.059754667231003345818;-1.0811968269937222153;-1.2985451686487379241;-0.51196968375255269557;-1.6544157874577523071];
LW2_1 = [0.2710147023535808275 -0.26531353318154043963 0.38093752875178882311 0.44373955664188058368 -0.52153624612122906345 -0.097390212277308971234 -0.41879172982359602617 0.87014203928570210689 0.68193543504410658596 0.71638276274948009537 -1.4485617117189579783 -1.8622025001382120912 -0.12376317614770930564 0.18177616401375829014 -0.14234133212187918827 0.49136851281242782674 0.20307679544239753966 -0.61091577880533232126 -0.48928310040950273585 -1.1407996822645203316;-0.2485410333401893157 0.12219261222372079789 -1.0043267776068227626 0.37964165372577668434 -0.028842921191193443553 -0.60443128774871623943 0.18231843073940853794 0.9829966347218805911 0.10393375296501004834 -0.20573540803704692959 -1.3206892425034093552 -2.5858439411695179899 0.19225218853116765594 0.020616683395109948462 0.59411915938103321277 -0.10032273119702050934 0.38692130594388363107 0.62084435908063462239 -0.74538964979855892867 -0.10512812030833412758;0.38620312397646899827 0.67286405161563267452 -0.89521320334199139257 1.4544749226873550096 -0.60914527905447735101 -0.1286523970405086259 -0.20199050679370345041 0.82600047218686067918 -1.0190212180747599824 -0.62075649985030900702 1.4247367497716045825 -0.69999974462848979506 -1.7800107182814401963 -2.0076933656943243278 0.25625838298003139615 -0.55319850839461981451 0.34570429383327400119 0.29708607891907229392 0.32965194723342966521 -0.1703109482182076917;-0.16921462823042573986 0.82966839895617028322 1.5804974606708428464 -0.049433368675560793171 -0.65097580829420687021 -0.0048881033773575423285 -1.1680122606500524807 -0.26811090722091684979 -0.41668666155397604545 -0.078143435554118720332 0.50740836007241818528 0.97312262464275989249 0.032593733495738679007 0.41815009559395749372 -0.12143320301698483366 1.6562693842091880114 -0.21126372155855105417 0.23431844677504776175 -1.0904913757001790664 1.6889169816372222588;-0.80611212676958765577 0.100785763218301197 0.59328546350652278107 -0.41500603290606374873 0.7980953708926847856 -0.14291763145154934289 -0.56116833028764290248 0.0093066969847518891262 0.11326192895436695829 0.31101468092701378687 -1.096248647853749647 -0.0094251688362579945368 -0.049400983748880085422 0.3619822035140696781 -0.84835636360081312368 0.48272939886048293889 0.82655129862301435217 -0.53911455733333246698 0.11848407363867287379 0.72514677344887723542;-0.7497619580275786122 -0.25806687719874338294 0.4476319914388094956 0.83121780430079150737 0.63629137671985835922 -0.47064262645927351647 0.3442935455893177954 -0.30742101956493084192 -0.11110120815909427239 -0.41123156761490231581 0.75751135791415014076 -1.7972770360105447818 0.0065592494249305391754 -0.6060150835655426782 -0.16200533768277630697 0.41345963809142904921 0.29223886629347534116 0.075784472434603428193 -0.20657766371988059428 -2.5550716215935729281;0.64843651829995385683 2.0799898852773739399 -1.9711811475600791166 -0.76072750302347935669 -0.17961773491847346507 -0.081775685078199017441 -0.37444807364716659048 0.029033329699325594042 0.52387283982988552822 -0.068401519936945848199 0.18302698432973607545 -1.9916876984299642928 0.19410924170485141516 0.4130032561493977572 -0.44417773621079537083 0.087124052458010664557 -0.40297969951073336903 0.039874790647167625279 0.35816895439738372087 -0.3513078863621100778;-0.036846902458798423685 -1.184743768464771918 0.51692735825040214692 0.44184428458197860801 -0.35933749595316960557 -0.23975267610217618208 0.038622413645466723009 0.41803870506981438693 -0.74127031501309847972 -0.51135644623596598901 0.57565769940990652032 -0.47721399471538211712 0.25613461348030014397 0.72810032568769289529 0.25521850336126350456 -0.22905311213356702171 0.21860315458277171374 0.69528042478725549103 -0.35934087666458525145 0.07482090725632781214;-0.88381588011722622689 -1.0554593190205023845 3.0497662204630286986 0.61795447396512159788 0.015227518469542620713 0.59041751132009112624 0.20512644419887454683 -0.063247298438288065969 0.10316279163835322119 0.45864690622313020185 -0.6915380212114285996 -1.6406890834089278286 0.43141986724835384992 -0.70636848455601120023 -0.23858028843396922314 0.6653830293372424709 0.37160231662199239011 0.42593003906588133844 1.2554652830827954801 0.73513007389056106433;0.15867448687943441765 0.20576062118893295727 -0.52096042830374944543 0.18338763171278557595 0.31873841270777647505 0.9765560140941028644 0.14422536968180676986 0.25992295713130447732 -0.61573619414086222523 -1.0359229371829921096 0.67663752877329508273 -0.34518301089955183425 -1.1348871514431697616 -1.3938921358468805423 1.04003011611368823 -0.49241300677981164613 -0.30822232532772741997 0.87193678862113332961 0.30241250499095251314 -0.16189234928369544697];

% Layer 3
b3 = [-1.8896529428090360625;-1.2617639137956853101;-1.8113964464438634394;1.7354865827692167457;1.1993321916954193807;-0.7143143762633221705;-0.39478800243776240864;-0.5665346164869972112;0.25715230932569943523;-0.082993101904311486483;0.43308321863332899238;-0.090398827747597526594;0.27350909187890304342;1.0358180765117959155;0.61738434528841390492;-0.65977057484036760737;-1.4238195437119844922;-1.4538056676918473809;1.8078724768050034033;1.8278937288148813245];
LW3_2 = [0.30793054998476160344 -0.89430658803813500857 -0.11509455200266582864 0.50171265388782348982 -0.57471156740162421261 -0.66092819699205795914 0.74268522979283746466 -0.44177709893921202067 -0.31885043745039148844 0.36959738949152731724;0.083909556545293931262 0.053823713104917972339 -0.037299991369736718028 -1.3829293691438464542 0.68702568844916744872 0.96719411040837710569 1.1460234172839767197 -1.236252113641765682 -0.58078280716114438764 0.43016936987643206169;0.32464941255644891305 -0.88914728399175924078 -0.32428174832449402354 -1.2930530204774128844 -0.21893247330643553217 0.27175845282097998989 0.30374577012194536874 0.20650989957093371374 0.69421428247547134482 -0.15979925661744207033;-1.4341665566230747952 0.055911998635757735598 -1.0497390934040109478 -0.35910011430422522638 0.10035648748102934946 -0.18361096515017052977 -0.18085704160013965636 0.17317280396206435888 0.452875989687678282 0.41735380279173683871;-2.3365253106761789681 -2.1851670776861911172 0.32981291197461759523 -1.2714162545739089438 0.12419696190143447723 0.054897065863352224879 0.91970028279532933801 -0.29156881812426638234 -1.5315425045268773463 -0.21168803113561349138;1.1371358764495569371 0.76783748565349085879 -0.0095548809060822699479 0.15088675966565420761 -0.12409632266631320796 -1.1746964947222329201 -0.59272882540492710657 -0.76571796531402114283 0.047852174336450829795 -0.044897119919738139038;-0.20274365110418168801 -0.4589880221343738409 -0.77097235346454362492 -0.38892009008903472012 0.75833216403780401293 0.33642992387985443115 -0.58240429550492101018 -0.55343098865496953565 0.28330460712798355427 -1.6770756228942040877;0.57216624980463492989 0.6311006224730955072 0.80950018451822958188 -0.46867928774166350836 0.8611781233397391988 -0.8038533407808068354 -0.096968425772858690692 0.018577106265299941218 -1.4805915490189562878 0.26099149936578397435;-0.14073959234169378107 0.15868706788338335367 0.20422057218576833426 -1.4146988808205809285 0.71796724491144603419 1.4176309217489719838 -0.54957093577631566106 0.67381704178781953729 1.2756999019836070541 0.36908732774952462963;0.76381795794972418001 -0.020627552471807648893 0.060883410704776194655 -0.49766875059134135784 0.61766278060877155553 0.55324028745419839836 0.91570696486018599014 0.77761126820564441253 0.30517116649252201688 0.13698458214210587625;-0.93898789539654803349 -0.77338200150590918902 -0.71781736775819515728 1.4878578196915648313 0.89964138350851530213 -1.017292363595522442 0.74011164202262935685 -1.1872168563103284722 0.49667920532804360478 -0.02421303015384486737;-0.31754212983282392724 -0.58168226472018635942 -0.66487036379907604733 0.1899937381155627214 0.13868122674256885829 -0.11027660015784386538 -1.1033488772557988877 0.79203531985839248364 0.66002952843562290308 -0.22928360328859090367;-0.30843478812263980249 -0.97807740330500125836 -0.85000710998724582357 0.85402427305969008664 -0.96941467547452520037 0.4791066909406253016 -2.6043981969618874572 0.62411845922976683099 -0.75087423517150442276 0.44112544714990176153;0.32331709058940133472 -0.31544120660590552196 -1.2858209968125910994 -0.16369665639731437179 0.79747563616142114196 0.64102472783336039708 -0.85814949748490176873 0.51161837001073495745 0.44813293125691217034 -0.21066617640260262845;1.1118059709127008361 0.16361533499233354982 0.19360487868154385716 -0.1985752734075768855 -1.0810287600562586974 0.054905587244760988008 0.30534385215097314958 0.81463541828914709519 -0.56889172829032919054 -0.78594824459342116363;-1.4035903020102034056 0.35090354612965957148 -0.98259563689267692688 0.58338076210045841652 -0.75992784583023409439 0.83743879322291336909 -0.22069686494540860511 -0.2505308637385227355 1.028557776286624259 -0.1435459253330966245;-0.51049732411723591774 -0.24987366492242774063 -1.1094869067233414928 0.50025092764591638783 -0.88553532561065928519 -0.70153740533486919073 -0.064182140070325022219 -0.49990870543459869912 -0.54927651187902593044 0.14641400071723414955;-0.28935820459478628353 -0.80530163999888426662 -1.5586221085191203084 -0.11706004904969126434 1.382914971573024232 0.84422068661011540058 -0.061317403349853291661 -1.4800627959142136358 0.96852437307781558129 -0.27028057291513674087;-0.30178066270810344207 -0.5226591647329246193 0.45773379866403735017 -0.60855992328569297189 0.34814225129785836277 -0.49010341930050072001 0.5889366888932471289 0.7109013310857043022 -0.20798322180566905515 -0.39248353129704305342;0.64419381820726950849 -0.90082188610672564444 -1.8445637018092668757 -0.22417318051636200837 0.27748811569175951819 0.00408615942513135353 -0.21911859091973745484 -0.34090877966120364251 0.73829868211589078086 0.85917933290001935465];

% Layer 4
b4 = -0.98430563054041153581;
LW4_3 = [-0.51496631505310186405 -0.15342024100280809984 0.012123552541712698249 0.87362876605679862241 -1.2195749861821023607 -0.75930354086725670992 0.0066288069528670848229 -0.11138053564693428665 -0.20092229002868888799 -0.29633074684911187013 0.0088918852254520220485 -0.19516533322447171539 -1.058985980101962765 -0.15293032598077493933 0.12206774464942136971 0.00397232512577828413 0.04473834915793063749 0.096349529043749632118 0.45204356148233454382 0.054946792971990787713];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.499999999999991;
y1_step1.xoffset = -2.00000000000003;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = tansig_apply(repmat(b3,1,Q) + LW3_2*a2);
    
    % Layer 4
    a4 = repmat(b4,1,Q) + LW4_3*a3;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a4,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(4,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
