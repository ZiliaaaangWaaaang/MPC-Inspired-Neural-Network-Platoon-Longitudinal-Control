function [Y,Xf,Af] = nnmove_28(X,~,~)
%NNMOVE_28 neural network simulation function.
%
% Auto-generated by MATLAB, 09-Jul-2024 21:23:22.
% 
% [Y] = nnmove_28(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 3xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-9.27187740505682;-3.65799721531803;-1.99999468395731];
x1_step1.gain = [0.104758804509858;0.259072168169289;0.50000722551666];
x1_step1.ymin = -1;

% Layer 1
b1 = [-3.5829097605591329057;3.3662850899697875917;3.4329553295453463235;2.4795772028224161154;2.2404684327769803787;0.99465699967972687201;1.7025732604353702726;-1.0273820577967098799;-0.59221871489686050971;-0.03636526672098961549;0.72238535378344370663;0.084108849298702548225;1.6635351205774748795;1.6265895120742013269;-2.3936490784141573052;2.0562763577102352031;2.5960520902821517808;3.3750033904163521115;3.4440394330155510438;-4.303680095817413509];
IW1_1 = [0.19101268563923501365 3.0752139043227879611 -2.6149514324762757056;-1.2751196565793774251 0.16690226092593890561 -3.7549283231090488933;-3.1252754299294598361 1.5894069832619917015 0.67083651242394004566;-2.5144923184473992883 2.3951721296316970111 1.6844889030531571272;-1.5281130149409176688 -2.5114406580854922169 2.2374945625033677565;-3.3720352471016172835 -2.4660263168650877752 0.16949672929769635243;-0.90221333591971675236 -3.0571879132304209392 -2.2891776956736560322;2.2701631278194982499 2.0708110744347325571 -2.2656385862345227444;1.0707600727140385022 1.9296526012926009663 -2.9797743113973647056;-2.5938480836640258609 -0.50552723710686908731 -2.8437428841779075483;2.63529696994113527 -0.052667557011801591216 -2.9387331492160519986;2.2059140374733030576 1.6063831226060953927 2.5037651305166614968;3.2950324403932595985 0.46772858274896084163 -1.971670293054600176;1.7247563499418743227 -0.8018960907742177513 -3.1440695369652544855;-2.8822394522101508763 -0.32941710156668002618 -2.4182050511862778208;0.59118661101032532468 -2.7933994791785998757 2.3119775474309518515;0.64107289015032198343 -2.5068254140561316845 2.9062975266604733626;1.1281944042830316377 0.28789676923007639919 -3.2335489805918213868;2.375454684420322593 -0.21596982480432821982 -2.8587015767108612252;-0.54139605776587607089 -1.6781929457367854575 -2.8204590143295376059];

% Layer 2
b2 = [-1.4777506913730487081;1.1657044006036565431;0.97818668183851986697;0.44287196357314162487;0.093037186270257421494;-0.44458437201159872743;-0.38897775793216687878;-0.50494247948218928812;-1.2382937972177603392;1.5619038665691971079];
LW2_1 = [-0.11541328579689996703 -0.046571272355834969492 0.27108322394657036192 0.31396803887962826396 0.76469083961552408724 0.13480757628868469955 -0.38954699854530372427 -0.62617661877760200095 0.28058342083922788168 -0.27107884572969365156 -0.38334277008217498839 0.73796019003238766398 -0.097398095596655950845 -0.15175255902227360871 -0.17703311715141084592 -0.30217605978939793276 0.1088643122628404486 -0.46936245163161788296 -0.61021260387394449243 0.028635106564548457042;-0.17295357504638075863 0.35059338004792861554 -0.15257970089963809879 -0.16710631684620386173 -0.3240534080531516925 0.50199738136494198582 0.1634104326045547062 0.32681246179658851592 -0.056162537363267199531 0.21207879349222852339 0.61658347109591682411 -0.20942453209158304328 -0.5806314131170811077 -0.15583342560185942105 0.59748764554611477617 -0.28535047414954578526 0.29586166707538269494 0.36259028052726710589 0.34578798448437964019 0.37408111843529467944;0.090145506618080545325 -0.25981210769388352055 -0.2629679678619259442 0.63019756811650506911 -0.14976157790890501365 -0.36816549612434695815 0.978038781127043233 -0.20790248365102828587 -0.36590666207106531393 0.73143936341595228168 0.13411398313266489901 0.1218597003510003135 0.40530297668104015019 -0.70742271146295054862 0.14679943042347459725 -0.55800924159559694981 -0.43454817318177213492 -0.011014940112923032878 -0.00095939371114744237401 -0.098927989877019117948;0.099572709153066346621 0.42323034806318893253 -0.3417899734207525686 0.64712600737856906807 0.263121834395624421 0.24224531263072052178 -0.49598536206914078939 0.19820267076234104886 -0.15079749522660779171 -0.32857652473540505111 -0.022968230281266377446 0.11628171245509241749 0.37121247183321909313 -0.17605582705917685593 1.1889002812907989437 -0.22032982238687462417 0.18482386350855400936 -0.31282574453559247596 -0.41771211379105582795 -0.048279901511796827207;0.23189221830000261715 -0.7250991891585092386 0.011800835068267373495 -0.10209848066296425828 0.25142160834670285174 -1.1352577274320674316 -0.36916012818888055413 -0.11835524342684661248 0.046047469583498770729 0.050242608182664294514 0.28349144896911337987 0.62668630403682390462 0.91050666129423141193 0.27192456598290298819 0.29551002514058510862 0.30001298191564534923 0.46207224004706487497 0.65944487256098205386 0.15187751364749019212 -0.28104741804234989466;-0.37680195136479144313 0.39148283844240816531 -0.35298656826775670625 -1.2634088201279640717 -0.78039153059016697078 0.58748201574848435413 -0.59665216871705217816 0.35946749175358971851 -0.20782002170881797021 -1.0979008233175095999 0.29879362822729538252 0.41644867412492320158 0.13602579903006301043 0.5690623266277712311 0.90727454840148880066 0.3071257906953758221 0.80438707966871025867 -0.50139310865774289194 0.20782929593498292165 -0.32011265141130967882;-0.1921262329741450503 -0.082752362464893924887 0.62856829091838894996 -0.086168223893775527933 0.23440880966536462027 -0.069683139010479122621 -0.21247283682222606327 -0.39659173114809603833 -0.2455664073898893851 -0.39820082446457605307 -0.47219021751118217534 -0.90349716580701810997 -0.12301266631971526089 -0.12674577207278028834 -0.035267151657678123822 0.18050605495563332159 0.40854925627651444975 -0.31865275360672046245 -0.375503596379848259 0.15756740341051780896;0.21774411385954473008 -0.10167343502854336856 0.35812955960890291429 -0.019224806810907074661 0.49668295742711782159 0.94462353198176962632 -0.47062556414950384998 0.70144259287421784066 0.33912995027772302459 0.56877850558498510569 -0.46643453949934193803 -0.0093633668659025073855 0.27825865084296186325 0.3843949406538587632 0.73692167343996473061 -0.1911831158083402149 -0.29353555914938922466 -0.02737738077032973727 -0.10332602398890951279 -0.48392263386050149432;-0.25570953867250273417 -0.47098853629770159879 -0.26118167706557132712 0.40533825068153633842 0.31830259103739444448 0.23644431853393918508 0.38426942814676368076 -0.93664281525676484907 -0.11014986279813730741 -0.11317660128172785106 -0.015457700868971385733 -0.0069300853457327782348 0.047149809760622454768 -0.13195171089903398598 -0.14847777621068850018 0.2181039390539094569 0.46866453217970382994 -0.055771702566704120518 -0.11330176830457366899 0.073506689248630893707;0.58646121853523480727 0.3153531200883715746 0.3189082191715648662 0.18883962641383736369 -0.33684760244624845082 -0.16460629573462096098 0.36273568153263213709 0.3398038487679324593 0.33600207968638340361 0.3410939922510718425 0.21054673685156588547 -0.0048805617612136713637 0.063677662968515388875 0.24455225378239936473 -0.67621261651593522757 -0.46266427117236380573 -0.49937875711309437365 -0.14476548149351273209 -0.31315938928832054433 -0.3382034641410903153];

% Layer 3
b3 = [-1.8696390882276410217;1.7418203642886271876;-1.4632877426532753251;-1.3709359999269117303;-0.9479352761720902798;0.83691680292842962618;-0.55253889433001779352;-0.86930169375239152441;-0.58292858486758691861;0.23514411232424603515;0.18944648023691598726;0.26688124874804408648;0.56344159714801256289;-0.98059040583414525116;-0.8489659187739367896;1.5093902767738340831;0.91100840299242202835;1.6943303108893199571;1.9314600336120588686;-1.8852335503897776903];
LW3_2 = [0.78856438727319078108 1.0257039651930033308 -0.19832502659867518036 0.027707217170840903187 0.054686818354218923177 0.56293207904697739608 -0.55407187678830505106 0.16757964529768301642 -0.88205299003906234567 0.66451630816100948351;-0.25648131990261829882 -0.84972363530324979131 0.75624519162663961236 -0.15844267039409609676 -0.14846077396958104466 -0.68712066221373724328 -0.52045210214224035816 -0.44106218245891803953 -1.191482669031106667 0.22335967149940252896;0.77582176000652702808 -0.40551270618790463685 0.15669230043926313245 0.40826675640517978705 0.17861375876215612735 1.3114443547667813394 0.029912833267670191351 0.50917781964324604349 -0.53389679086989394463 -0.76403415551890785373;-0.12829840601289568824 0.32093467062364444686 -0.6108512500916352117 -0.90422534275365051837 0.18712749567374453719 -1.1096430901652274414 -0.3567522739900954587 0.98753206470432808306 -0.16273476743063208794 -0.15818175632908404449;0.72759964295388535049 -0.6386330929872874318 -0.11834454869854754699 -0.67010184436622732829 -1.2028864704072155245 -0.10667613850895324434 -0.68590591140485246413 -0.46104312189163226821 -0.24933872732838827102 -0.80292116977136152034;-0.50531672879888889227 -0.049174662479161815321 0.75993430819087182115 -0.11963063706119114737 -1.1984936240796166818 -0.68419775760380541207 -0.41617875663066805636 -0.42831700231866215445 -0.5498934777675896779 -0.62244247024464560702;0.11822108693051731898 0.28618211112302871513 0.63301809857035962192 -0.11311641920709189502 -0.66997237443109669552 -0.88946769949042592263 0.74301576013413284105 0.29554996310913367319 -0.29479869444171191706 -0.75551965211767424524;0.70670224917938762044 0.72572690478793000501 -1.2620743972322445714 0.53556553045691124293 -0.37489994049742542126 0.028123238087566906906 -0.054997166386574411479 0.59205042434475851909 -0.49996704730788515958 -0.040930667522018744642;0.55280285964961162204 -0.53421560097532139189 0.65039721199291622433 -0.19998616683721620602 0.33150820274003012234 0.71034516708284300979 -0.31954874212743505923 0.55781345774315838071 0.69328994030002544235 -0.7490541164354109771;-0.72770595614104849336 0.86696372488587358784 0.66971999344909238783 0.56910731356981070217 -0.75542711491544767277 -0.38426882467577549995 0.71081978105493526243 0.51003854242813007058 0.25110224472202324897 0.47553502045564488565;-0.09062344669212478443 0.69304798537067824338 -0.073993980373370682457 0.95281479007629654721 -0.34041131974366928281 0.054701145763840511305 -0.030492483431719879378 -0.90113458208855845566 -1.315217372626785064 -0.06952169996500369431;0.067824946943600597504 -0.42119465599911992681 -0.89053688385709162123 -0.82295300836225881991 -0.90535678937130448229 -0.54879471604797425144 -0.37219556451277707732 -0.68206319520764213671 -0.45565119076554921884 -0.24372896858900244821;0.14957525749029812467 0.63301624937041567343 -0.89058912504614451411 0.52697835016773286743 0.48202514275854813075 0.97012964942124968459 -0.23364775214001748393 0.47892359612443058392 -0.6578147681634916033 0.61161006663955153062;0.22539752765332704554 -0.65899072689745874509 0.2962464773929280315 -0.90918041387063408543 1.2468121333334976075 -0.0026224519426344961026 -0.57958390448575791698 -0.078280761168929485772 -0.26181049611681272982 -0.19207152807868313471;-0.87561721199859243736 -0.77800435749371343874 0.50597354578001441094 -0.084930802201634708615 -0.53857120163429383908 0.41674932018302157655 -0.76227611136744699571 -0.034360718417535823788 -1.1089078629809023813 0.48395434432698514193;0.099300516489551599042 0.00012303056217582509016 1.1242929866556763407 -0.15573727771183773494 -0.35929896803308142283 -0.23807614629071499612 0.06399011506471719013 1.1058576654586711463 -0.66557265909722007624 -0.60956810045543063925;0.047603197993349818939 -1.3235554970896032945 -0.75922287101565888445 -0.088490513103033893727 -0.79002613705062696425 0.49529727267203227381 0.73435523605975538963 0.040990144285114188394 -0.74794918374861896204 -0.12447351073240381369;0.322492007020076632 0.51255453366948511285 -0.23311714692534604709 -0.035901710201026060254 -1.0197827006332769173 0.9434484696193958797 0.71435367736028954067 0.2001086246195828422 -1.0379702115305851073 0.14696351423284351179;-0.17213222398453351114 0.53617636909440158366 1.0063632460908724653 -0.15892283239955898311 -0.36528162509822748039 0.87191136619906983718 0.48954908602453472977 -0.49475079386358550293 0.61039488214492509943 -0.41635583149732213748;-0.45579337159218685782 -0.32364424223735582808 -0.4810584624018499067 -0.5194000003293826051 -0.62527049902379117086 0.74418357173161786555 0.78691340813813093202 0.64300344897605454797 -0.80308966679050886039 -0.40461867584179067592];

% Layer 4
b4 = 0.74579950941552441979;
LW4_3 = [0.10883382530203083993 0.15595625448423583448 0.6285212931849725182 0.52625959510908160155 -0.69861588615170744365 -0.4245935707080034649 0.27580093476647499218 -0.33976473442358978705 -0.026060619135783308353 -0.14528201454424288785 0.65939777609304606187 0.15140183894625805494 -0.33954868298131313242 0.90701129729104645882 -0.20625600908219934859 -0.44002730017575375498 -0.10282581148571734442 -0.40826717013807001244 -0.30488437056402523107 -0.046517886901836377755];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.499999999999991;
y1_step1.xoffset = -2.00000000000003;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = tansig_apply(repmat(b3,1,Q) + LW3_2*a2);
    
    % Layer 4
    a4 = repmat(b4,1,Q) + LW4_3*a3;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a4,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(4,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
