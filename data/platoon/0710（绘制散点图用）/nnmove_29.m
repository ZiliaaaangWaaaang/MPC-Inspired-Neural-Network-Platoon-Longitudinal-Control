function [Y,Xf,Af] = nnmove_29(X,~,~)
%NNMOVE_29 neural network simulation function.
%
% Auto-generated by MATLAB, 09-Jul-2024 21:23:23.
% 
% [Y] = nnmove_29(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 3xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-9.27187740505682;-3.65799721531803;-1.99999468395731];
x1_step1.gain = [0.104758804509858;0.259072168169289;0.50000722551666];
x1_step1.ymin = -1;

% Layer 1
b1 = [-3.7895975616208144032;3.1803284370120810109;3.2190477686871110663;-2.5553121952047002097;-2.8108519316917957021;1.6782560515673401458;1.3318613180904899096;-1.1094279961095803166;0.18578622294793051273;-0.0060454435759071311826;-0.21070336520728596974;-0.73155535118679659856;1.0035204478014787544;-1.7241882639163972346;1.9513374280549811157;2.3495290080581852088;-2.4527292642042599624;3.399238791647182456;3.4812601480357767691;3.7091443565068442645];
IW1_1 = [2.7714307423451871593 2.3223888699048953477 1.1178137477655831766;-1.4558355520023178453 -3.0069121442324311388 2.1786824042477692664;-1.9103069848077671722 -3.0589432680307337975 0.5068331166492716644;2.7067244617268833018 -1.6891165722175915942 -2.1238085043960048814;0.74408871753363448054 0.860851560760139356 3.3156014578905299572;-1.6487885630104066603 2.9321615598777204248 1.719624758036329526;-0.13446052315276529887 2.6060608348890155206 -2.750010102335119111;2.2292348424239243343 -1.9501708181125514407 2.4678721705377952844;2.2758642817846315154 0.86701281113540651369 3.0522438887932490381;2.4845215048354627463 1.0011596976102132839 2.3110598134141806526;3.6799882433911674795 -0.49447196922903363658 -1.6373964879183757759;-2.9394559473655030857 1.628681619120357249 -1.2368942701124578942;0.10085785536876851198 -1.0342913358959993086 -3.87682221416516537;-2.7493513236104210051 -0.18597498629643599566 -2.6403032485953663588;3.0377326191427109769 0.16142173428279876779 -2.5818640181214629337;1.4648964033058411438 2.3255400476799152898 -2.4074259405491997832;-2.2503677264716159812 2.0536776324402166161 -2.5183288286103873155;3.3273434975619009535 -0.060503780293679219893 2.2803882117303824195;2.0220147493843043662 -1.3793181461658399201 -2.8430451434458050564;0.42450231739446242507 -2.0393085139454365518 3.375955823923455501];

% Layer 2
b2 = [1.5949357702874025211;-1.2816688704148144762;-0.83061918141954249606;-0.52132757262466689063;0.035176520698333046955;-0.050746976615216501938;0.41299188132609687685;-1.111822750916535707;1.490158400895059243;1.3578079128085063232];
LW2_1 = [-0.094329567078263593105 -0.48869735620620624594 0.24714921485855351202 -0.6013297639815178286 -0.042394835370490532855 0.52841411742600619128 0.31108366754331473469 0.22652993865982462562 0.73263027005202285835 -0.16683870308734277677 -0.019203213915485635443 0.29006657620252462859 0.51726830558081782208 0.23165019495173447273 0.59651603057035695876 0.10942943864003383536 0.044068440533096157885 -0.36177657139938046438 -0.42637586983294634146 0.28026056798025733574;0.25800225352373590271 -0.36152590705736620258 -0.12589806864304783907 -0.17615890977647630233 -0.44688608584641370536 0.049227071570115299437 0.1195148368396487526 -0.069844335122197162558 0.49820523870036520497 -0.31895974098861179513 0.35540683713854354098 -0.01027202916889038975 0.25760888608956311607 0.19855391907344457914 0.039121068259816087209 -0.4009782018770004508 0.73864278385338977273 0.014864814950762965384 0.60004622877011060122 -0.70225191342863790833;0.57774048695116653196 0.32717701301537238656 -0.11014839638450314718 0.045785395047867362417 -1.2510310971134219749 -0.22548932394751067254 -0.75008214346039492337 0.48158887377010423103 0.6667079293581171795 0.32786548069479859446 0.41061261869644327671 0.20531613954428951097 -0.42252563745563148645 -0.057870883005154347134 0.66348961934511130334 -0.12290958512646212031 -0.7885708563154526507 -0.34127629533098041703 -0.07266963135248263872 0.31747247865714195436;-0.20267699635794708679 0.59137273985348182137 0.35293044038617366054 -0.20191994090176548782 1.2715086123012782071 0.84198122748293369177 0.1431847800669540649 -0.13952465251678086711 0.15278532302801611786 -0.19471846307269488618 1.2089527065681751061 -0.49057417834162125869 -0.59820128660448712576 1.2801338483283351 0.50508481687205342148 0.48348519443375476135 0.1923354911118074495 -0.05625035457718902121 0.14437872892409409076 0.16069689187882363335;-0.19767871329296896055 0.086840485542290485332 -0.34263527179124908528 0.046058957472481620865 0.13238174013007347751 0.1277889314866349213 0.095058002531235072374 0.048819247992272350734 -0.40230733863963691332 -0.43662602383806214945 0.69638547784038440369 -0.2139648163187134744 0.29522264447076818072 -0.14985905998916893012 0.75124149723393285338 0.89260872423222104022 0.76422982990328613973 -0.32588355559779869086 0.12293218378905027 -0.70477485790183080905;-0.34194572019194369172 0.41379529909149653788 0.44454687003920495547 -0.5951773421942038178 -0.078529443234593154788 0.28132263508234317539 0.68076774914812054895 0.070678907700422122229 -0.68696053474797891258 0.22752232786445186763 -0.19354597642287041381 0.607456226895564666 0.14084142635802285315 -0.31872734450434514475 -0.2798825586647714081 0.43575105742398456687 0.0078168538198531804795 -0.6554689215006863634 0.55542919213761954289 0.015502850623171129593;0.44114993464396928813 -0.71985693728590427476 -0.11731987338727382919 -0.42518877553341261066 0.01604325277277262457 1.4384165348865973755 -0.020354440047814573167 -0.97903777602566488536 -0.22559586734234282623 -0.11726653461353669927 0.92878539700352291675 0.6807288951368668517 0.65212229282565103983 0.18847099847840464992 0.078229304233482122033 0.540866061469382986 0.92401151269479786521 0.24626988204671351745 -0.47846538358735213325 0.032566384428013454844;-0.1934459419770631905 0.15859906591159694811 -0.12451050484505676863 0.32777352343481347408 1.1081985245389991412 -0.2613342617319512895 0.83496163862765138131 -0.11318297498106656696 0.50468155332694331072 0.88268209520414575575 -0.087309158519524837638 0.5990397948714710763 -0.17101474425475868268 -0.66969702463145475146 1.0977762363939755907 -0.015000417495463659948 -0.11457966330185399839 0.22457347757837770041 -0.19773127944037655057 0.32346363567811181605;-0.15563872542799578325 0.56075857934415118677 0.053532308941361829435 -0.59158573242500889222 -0.22474500488853005331 0.020740091898946856619 -0.42276690685616669096 -0.44830933917770926511 0.41487584330030563562 -0.10891779121047052981 -0.0051018474333040190333 -0.39092140008520842587 0.28145115077473703558 0.65688924322306729842 0.24726800709079360674 -0.52000003556069041011 0.4629748601663857821 0.1766379691256002582 0.35202112016508974035 -0.075674260006796945088;0.66636566499510541117 -1.111591963634690039 -0.66273580189615965974 0.39853757360580516211 0.28816169102698518945 0.30313496428579422837 -0.082285542192102267833 0.37499480097629073194 0.44219366722619746213 0.29606241640192665354 1.6950174088244038817 0.9518093149262055741 -0.2458334111504968944 -0.28102330951608966991 0.70323115396291513424 -0.063151587273314852 0.45617293145951998135 2.1981215218708936021 -0.78911319275642222149 0.33169300210449176314];

% Layer 3
b3 = [1.8109973630685471946;1.7073548417129740251;1.6654674472098041083;-1.2978941978746785235;-1.4822275553442343377;-0.46619709890374316785;-0.71360058893955069514;0.93497695322810692176;0.52272534880942611579;0.13855682223867227254;0.13155560052895381995;-0.32766408254625395413;0.59174688729845004165;-0.62350947663660027942;0.97259297126254073973;0.98163114085169800305;0.96803286015874456805;-1.5111299295104154705;1.8482945905123824293;-1.822521038677857641];
LW3_2 = [-0.64578125591716772913 -0.5767832537852484176 0.68976884769241619821 -0.91369917863450622608 -0.1653032337582482636 -0.43244021150265643527 -0.331188074738652527 -0.1766791193435373053 1.0756607397316282348 0.30802776013511296016;-0.63357885659832025027 0.50608377728089937175 -0.74181682817405314445 -1.0499241337206854929 0.22473995836664195647 0.78620683222959131253 -0.40022521152593792948 -0.9347729669061528579 -0.29621839651924936065 0.04609550962517690309;0.19552863818156052123 -0.93004171095435150818 0.9115128668123616551 -0.80153848886601075652 0.32085713012777322684 0.10560345002256964209 0.68228095733797133882 0.20890400142297416153 0.026807432805530537201 -0.86590603336442018012;0.7831530784820469604 -0.19149012313698993148 0.4453458324826028436 0.97009618554801835266 0.74801114244553457144 -0.68284183717311863759 -0.49779135469787089141 -0.022541364346668698454 -0.18338635975308270609 -0.67247066630731588965;0.48364270236809059345 -0.065771459273883739471 -0.17162452806507411118 0.28128865346133552494 0.65922513443246211207 0.41963793480538180702 0.78450445066179641529 -0.59096790578070768074 -0.33492782555030642389 -0.15309970927642393979;0.76705603876228989346 0.067654168530681874083 0.073927575086504382362 -0.74146639093674471255 -0.69232540791499941335 0.57298740742551301786 0.072121195162900761377 -0.022457297686959906691 1.027614427071118719 1.7342590005729336955;0.54545773465576607997 0.74249922226810172177 -0.022371272091941545729 0.16066407536714852333 -0.13212631363742102786 0.69734428778744084187 -0.70535563117585675652 -0.46981703000539765114 -0.97742346651472611363 -0.60379670772243088095;-0.2900788202568768126 0.39075857534630237256 -0.97179406153714953387 -1.2749681207730032551 0.30720253972077654625 0.98152847795230124817 0.2407981841719428473 0.040604427743176144117 -0.41327172637909820319 1.0380469856322755984;0.096015115134052420043 -0.90515165996224811185 -0.69042599575751550933 -1.1143509141592593537 -0.68223654173146841551 1.0796137922518374008 -0.32911359587199479071 0.035313328942308007397 -0.46425758951956758169 0.23599980680515805775;-0.63428255653555709603 0.077747104254996493578 -0.48162188503829700403 -0.79089685012010524368 0.10295804090031578093 0.70604653616230617086 -0.74855724930240141735 -0.81863884773164297126 0.672902062087797459 0.43015029920329123092;0.91362414005927050642 -0.74437141239757020905 -0.79412689307991946031 0.72956515749438777263 -0.71088050209485309505 0.11063225818527334943 0.41646724105686205863 -0.55806933617030252126 -0.099127542922987380014 -0.11761892996264906863;-0.84855110630050933906 0.74177824923630064635 0.18297034464910166829 -1.1625278994890091422 -0.48034103843350900442 0.44110591296286988383 -0.44150955714452561063 -1.1900842095202444071 0.66957155403499368784 -0.60994697173812284507;0.40030685322349568445 0.10087347340133179241 -0.9983037376234720206 -0.99121201129029923305 -0.33341313823162399554 0.02521254152096087317 -0.52812426297773296113 0.73917099806156605357 0.83894556686708976478 0.66307168644503200472;-0.69605862952942698652 0.18825948043807444465 -0.68394679820668524695 0.93810586499201931154 -1.1010223448226419407 -0.30718156477667590831 0.57026635728689545335 0.24409306601463001685 0.065881943227748998582 -0.53870890195007670176;0.8797032015760679613 0.13994259700847588856 -0.93319783985412196881 -0.91001749546333798868 -0.31542304387948072453 0.24397174704711332982 -0.40511333714529507155 -0.55657210025764480843 -0.74119987811785992271 0.015859154614209163003;0.9380829595400558274 -0.68010399418869305066 0.61833052017007827938 0.048304327610533187576 -0.29317579851725561468 0.010871314490891965943 -1.0688893187625498893 0.66619643718385490594 -0.46581689893316441387 0.31084803764634927337;0.19506607644983492422 0.77169108375167683178 -0.37887060347336454225 -0.7720820682268052515 0.23375738330404402521 -0.99253356409372894831 -0.25290521795394343973 -1.2535698555994430059 0.47194029290576461344 0.17835323843779754549;-0.7984329514350609891 -0.3056942895346366762 0.76922953338512822796 0.86178550889183025419 -0.2120986184666814045 -0.27514120142404274727 0.90710308165466257968 -0.36122093078063755023 -0.38407093580777673658 0.50075928794993218585;0.30234078370953615389 0.11298491030959169346 0.45220035310535200423 -0.30061388116491394307 -1.1816329423992131264 0.4321559945169740069 -0.70407698110840299943 -1.2036962773053543341 0.57435289878450890289 -0.19642695759230746622;-0.84533586560112494723 0.88452321067937400567 0.32880371927644991281 0.49368103388279910293 0.55033414391490165229 0.13554219354618016191 -0.90644968683845716928 -0.79788353348936924547 0.13084392782224843477 0.30810366068911732018];

% Layer 4
b4 = -0.96397994990038315954;
LW4_3 = [-0.2179326949270709024 -0.2860000761660751456 -0.43333995259414048729 -0.00647071136426541349 0.051008303479542327352 0.90856370143154419061 0.41167938341717613682 0.1080734591657001864 -0.1070184366015527605 0.012854402065296963165 -0.059912254076686467796 -1.1561104075788930512 0.87636044820834424485 -0.31215317652001484117 0.2616979591040327624 -0.41833946583694986421 0.024966880593375512243 -0.084874374841220151522 0.64534861883866423415 0.32280359927133656095];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.499999999999991;
y1_step1.xoffset = -2.00000000000003;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = tansig_apply(repmat(b3,1,Q) + LW3_2*a2);
    
    % Layer 4
    a4 = repmat(b4,1,Q) + LW4_3*a3;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a4,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(4,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
