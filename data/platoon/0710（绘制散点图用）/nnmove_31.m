function [Y,Xf,Af] = nnmove_31(X,~,~)
%NNMOVE_31 neural network simulation function.
%
% Auto-generated by MATLAB, 09-Jul-2024 21:23:25.
% 
% [Y] = nnmove_31(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 3xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-9.27187740505682;-3.65799721531803;-1.99999468395731];
x1_step1.gain = [0.104758804509858;0.255650892831276;0.50000722551666];
x1_step1.ymin = -1;

% Layer 1
b1 = [3.6513843448553040538;3.9686232622639963097;-3.0783060349237465481;3.0862395989709838773;-2.5111806677754984207;-1.9782458270734850636;-2.7768531214346259262;0.13035213946416113195;-0.2572521630301202733;-0.45222725919562672958;-0.24508507100659604472;-1.4568432249302407655;-1.2718631890422986697;2.0585389218306886505;-1.4621291525417319246;2.7236415420312303226;-2.9501747786195613443;4.3492252826062403059;-3.3399200801869866062;-3.9404749675059691505];
IW1_1 = [-3.4284466033138394359 2.7745992917634407782 -0.20135564352785828568;-2.9431654304515109111 0.19363465353593742324 -3.2609321700284912282;3.5124477663866504606 0.53188243335719220806 -1.3726281841876368794;-3.2923057231409305068 -0.51170716606619703892 1.4013967298462448596;0.66309186393432451023 -3.684798341372492736 0.077666346408519937317;1.1495960493548151859 2.7562351898226653546 2.1449785040697042504;2.4357850352619996315 -1.2207218106047870165 1.5661865122677318674;1.9554792228330579729 2.759937554565640383 1.2071448811802512058;5.2219852110942435175 0.91968040587791832774 -1.2422838797511392972;2.648930549300866133 -1.9018610043697445899 -2.6050087652266737948;-0.47855508525692463939 -3.5273645456136777376 0.57603330962622334432;-1.384539378375891916 -2.5723702525017122511 -1.8948895336502262765;-2.0336592561855466599 -1.5223739653537462502 2.7754483607862452388;3.450132109168678074 1.479615730278839969 -0.87054013686996090104;-0.56019303182682611553 1.8155728921236411466 3.2740709341497518103;2.3226176470049675338 2.648451209231887038 1.067696064654626964;-1.5558940358595700904 3.4657570593665236736 1.1526840111690701551;1.8388461531521080872 -1.3656883934654944213 3.0002456254556166826;-2.0399982852325915239 3.2093454037175637161 0.037475922223500657271;-2.3530850679450412422 -2.0490094333093624712 -1.9550089502592693513];

% Layer 2
b2 = [-1.8286579373896583167;1.4919965004652115947;0.91622342313034621508;-0.46890476272649372902;-0.0050077137753727430161;0.2811350899549114879;-1.0424634386013142962;-1.043062361134541538;1.2793267095306639636;-1.7476833645414762142];
LW2_1 = [1.3943023356991133266 0.64800673203693581748 -0.12474388347255656317 -0.4498809759906383654 0.60056119514818617766 -0.13730965368769865176 -0.097800558076092447557 -1.7019245074875999357 -3.4203828633475232834 -1.909728173376715521 0.38524037937644650675 0.18370877583015804424 -0.72607267260205377024 -0.31296488469184041703 -0.45897594477978193028 -0.52957415389448014853 -0.41508209067229073774 -1.1938773012780419247 0.56267693574689559011 -0.12914276637737628906;-0.29457089576537642817 -0.074404621740869994473 -0.28162320273829843931 0.32430350775536065377 -0.51561756269046354895 -0.24009921040747111975 0.54333271129854165959 0.42897195152460698697 1.6230028700547143305 -0.45824233760629889955 1.2300096681889540751 -0.42789618208395924226 0.42982993624182463943 -0.45995217064255961015 0.36644801028282919519 -0.45336769567535195602 -0.77433991176576322246 1.3480683757175331294 0.60864772635391251043 -0.076952370604754821715;-1.2441404077227071756 -2.3208723711741150453 -0.44259631663236853605 -0.021790510210762500248 -0.50052910221397917123 -0.013805395136522919525 0.45837739538047184151 0.62057742189402120836 1.227121748157655956 -0.22140712749689711591 -0.60268538044582109503 0.087952503002228871187 -1.0385803109973044123 0.68692311511427495141 -0.444906305218732534 -0.6967902818065117021 -0.16841424018284639752 0.90605881052279513277 -0.27928969006182108314 -0.18662839635627967438;0.41670829546057486237 1.1162104637616012681 -0.069730279416589630026 -0.55971789907441105161 1.0240969988216399589 -0.71085026377852977841 0.53977013781890204047 -0.2833034448742022815 0.11930529917196132372 -0.22037885703460236009 -0.48726701015950601992 -0.32242282504294322854 0.24047654128209763891 1.0305789628254313772 0.52616638747773480933 1.0412930929669299562 0.81884327348196583873 -1.8670507914475267253 -0.37913168938532787466 0.32050127611447026821;0.59369362964303218355 0.71523383617586788752 0.01429580991238866422 1.0170041378739749227 0.10141783556913655517 -0.040161647132414587946 0.11760399210161560923 0.22764550970729224844 0.35097358556183372302 -0.091189283894362010985 -0.45206568974037619757 -0.20960545842385613913 -0.11033835777378991905 0.50495546661881518524 -0.40487409640324323323 -0.069119200569533217893 -0.071531187528729112124 0.50321752085577342584 -0.97987342059741822098 -0.36914484892050863918;-0.035353572171306149596 -0.64360625109619129525 -0.68089243187703496485 0.29136704071752139722 -0.36428933503454064002 0.10557488383196669823 0.82719796364954123469 0.81079565037271339456 0.84629110915784711011 0.62137073155572553063 -0.12791403136050735756 -0.68443230758194661956 0.10222814416117767533 0.07869547099789014899 0.22081706993581437515 0.13562734565641176854 0.085955596811442436245 0.88015529251010826695 0.43742064860253748737 -0.090321862205586425643;-0.51844443221240910091 0.32897828872945317213 0.8364708867189575292 -0.46365300229243272545 -0.45591762853112943743 -0.36517234354950162123 0.39849174155941741171 -0.11633359860841824274 -0.40859309395185394731 -0.11927404061282149972 0.2460696250591365708 -0.19354327082961284012 -0.3173514606608306976 -0.72159980435524317954 0.63018994704708442001 -0.14784485543751560432 0.14323330630186584256 -0.20556329787820537547 -0.10045789708097768722 -0.26397132485762703213;-0.26024096487719139414 -0.43728145450412753137 0.0043513268363150614526 -0.51245196696294914585 -0.65104406817603965862 -0.5825252353887552248 -0.63105122049096007419 -0.55992373519979399266 -0.12153964502657102487 0.12884403053911411274 0.97356015428499498299 0.054744159347432458373 -0.02069910093702384199 -0.10528434359719826552 -0.17555376166760180978 -0.72053329197781590398 -0.27463787095774488956 0.4970130692823895302 -0.0022902810814030265946 0.53798032312578447645;0.21754291516602783374 0.47765494733217817025 0.52263839424642455356 -0.56852994229892306333 -0.52988797189481018357 0.488894589919217748 -0.64494421358299702796 0.3634906919979648543 0.55036183615015155102 -0.38241539223983561646 -0.56163285180854871648 0.91906332614236474488 -0.55767986410672654163 0.42370840410872862014 0.061947604045044450671 0.14478083050512585706 0.46031378737664307987 -0.73924899107550612332 0.36137635015050295628 0.16241948822486093618;-0.57740564984244324709 -0.20957873541223481784 0.54918074334648225854 0.092657437124795849481 -0.49099362771849264231 0.2275420881953112151 0.14124723023307309 0.49889695688262925 -0.63890611541233188753 -0.52948081528614743263 -0.064774173515469574136 0.36259416046908399256 0.62590765302390138913 0.24511768130212902017 0.32201009845697442513 -0.13500182794923326624 0.087032791017155997082 -0.45972406061398196631 -0.57780152393642414399 0.38874825817879132828];

% Layer 3
b3 = [-2.0517373728719863202;2.0135142064852704635;-1.4927701964141975033;1.0754836493240209627;-1.2192651608384263984;-1.3452059275980527975;0.85667297116846863325;-0.39803713090695397314;0.45202543788825017002;0.36445706114315340463;-0.15602805704732278236;-0.43900962352984440606;-0.72506908297465855195;0.83670193434955242306;-1.1440558322423086679;1.2921149479088807066;1.4462211544440599642;1.7101252023048658657;1.5274329330765266111;1.9479933091591388195];
LW3_2 = [0.60895175086652952867 -0.65745934009495177186 0.78577302252471681321 -0.59175972384672703708 0.55351173593504232606 0.66900491298399744622 -0.41412916214270156789 -0.076386415248701683423 -0.29972825117146939533 0.6162042829625955509;-0.44819003980573624002 -0.41567252701439788565 -0.50487216360157438633 -1.0428863676642670111 -0.20586955211365987051 0.052427949820517689983 0.55797752874649053645 -0.72784956902165998116 0.43102834227307318393 -0.80764056511717075004;-0.060660636681497605294 0.92225497531965516806 0.76190306014561737236 -1.071948698563168989 -0.69746929160285042748 0.67518170200933647074 -0.017568854543521632283 0.095890465952962883334 0.34202550519612479052 0.45571627745338749715;-0.98850909595339597757 -0.6801536515012545081 -0.59309146583536387354 -0.86355596112984434054 -0.29065901031507002106 0.13598227640176885345 0.38009100100337694927 0.68348848833689768156 0.74506348538016142768 0.22517254485773535722;1.1134501091245625481 -0.69400564550827881227 -0.3441861769016010264 0.24746165834302136233 -0.86318617790085361285 0.46001230936234738245 -0.95419253920109758926 0.55472991803775528741 0.24358513250210694912 0.46155837606723182365;1.2667145462826108204 -0.62616947281315571416 -1.0125183509996267261 0.67478538162596302108 -0.77909278703296114266 1.0820992841397671924 -0.7305989367733098927 -0.27029650347033695734 -0.8150539909476779421 0.091107021816139083237;-0.80224787308619593951 0.31502782583214217205 -0.75151671573628597844 0.44994408653147660582 0.70222332208315241253 0.29504390215431003375 -0.41488336003592451995 -0.27434450284459088731 -0.10799837293842128039 -1.1037071682201999856;1.0483166209442995598 -0.35922936191700122199 -0.75542074830742711455 0.24182010723611641057 -0.93935797315715052758 0.26494709657757842258 0.25843977110886628967 -0.20218799817631269433 0.62563638329982729225 -0.50813411879933789717;-2.1583652654191451958 0.30547672178562707002 0.87452618990325947657 -1.2728023368755914113 -0.038272482771920066091 0.41224815397514336102 -0.79630830146832543015 0.54559614510484211181 -0.77329344387634124658 -0.8088604128940719562;-0.39505622449143379393 0.12135201504273625261 -0.37229816361290657412 -0.38742270647529075678 0.74815878668084090375 0.48200243543471893437 0.45672869559539430728 -1.104441190716649146 1.1090741744471364072 0.54613342671681919249;0.18856177329264972586 -0.5505168198295298243 -0.91199831414876653124 -0.32659702981042670888 0.081196860867016121266 0.48104082721695540226 1.0492088150116236633 0.088795040945032543966 -0.60376832322000084652 0.92969441375354411328;-1.0195496340712508765 -1.4791887574472906142 -0.73129911831169525094 0.51546434289851017496 -0.53467512421170104719 0.65321429828488064562 0.50633600574444714848 0.38369105515727569555 0.23161021605152812275 1.1694910684020205505;-0.71373030599362929927 -0.17839734533475812284 0.22540038500167319802 -0.18498909333647661768 -1.006970281061717154 -1.0424257471641824591 1.1704754794228573456 -0.0526412044216763228 -0.044668240876750746338 0.13207929449392535881;0.2505342743705030184 -0.49606104479590645839 -0.12740926310490374718 -0.35128899272161817624 0.49936489115582205489 0.44617149978213621608 -0.76540457653178584074 0.3564876354956896809 -0.94595406990848263096 -0.88837749982549618633;0.13014297459935031398 0.64023184212786610203 -0.77875972234450274723 0.18892395126117847437 -0.21958610590414340269 0.50651110916647890114 -0.71266484057938106478 0.29633690516699501272 0.60025008478877428519 0.97191680501512778267;0.66457225039670486666 -0.59661671771275803788 1.0585021088162989145 -0.3059662258765040721 1.0169375425303306404 -0.67261079195844419854 0.39597329147434640051 0.13416757065224130252 0.34849834736994944606 -0.48050364063645512047;0.94020097246523537393 -1.0441687112757276346 -0.099203631764288202621 1.0356846560184871375 -0.49229630906935845092 -0.55025483880506675938 0.27093691441040218537 -0.26658471623920937388 0.43472116887367956428 -1.0835546465225904811;0.60886832147661684722 0.67713523360228689008 -0.065829244306154721667 0.31206209268600176854 -0.58149605862091213737 0.50393873285611756607 0.67561867361607574889 -0.69077204166526151585 -0.415071233830482611 -0.6373201427594988866;2.1586215806401845008 0.84766790455862084386 -1.779021545356402223 0.077834403075052613352 0.22740067420252130237 -0.88910256329722414659 0.78418875252754172145 0.92248949770448118723 0.39802624930275171122 -0.026661584580390945698;1.1500248502319718735 -0.84419668003971159997 -0.11487007422667222523 0.12355268692070295322 -0.30233144464424227538 0.59625803122514808852 -0.24802898448365079398 0.78520973450747921785 0.55001293828261010876 -0.62552141193341337377];

% Layer 4
b4 = 0.021972811665400687753;
LW4_3 = [0.55482401179801965618 0.62736834661431073457 -0.24810873772754341027 -0.21034334031064613746 0.38559917311634184234 -0.49241402207245804634 -0.22840035586607590479 1.0257833922089067968 1.1123813287423565122 0.40525090555903914291 0.20723965012571940458 1.0461772257045487411 -0.7590485436835735511 -0.53919446577949425858 0.23815504473892762372 0.46444345859463331827 -0.50345679373548046787 0.24445747780674620397 -0.64759342610627279591 0.41336930251414555348];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.499999999999991;
y1_step1.xoffset = -2.00000000000003;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = tansig_apply(repmat(b3,1,Q) + LW3_2*a2);
    
    % Layer 4
    a4 = repmat(b4,1,Q) + LW4_3*a3;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a4,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(4,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
