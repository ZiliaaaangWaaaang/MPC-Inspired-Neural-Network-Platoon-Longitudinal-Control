function [Y,Xf,Af] = nnmove_33(X,~,~)
%NNMOVE_33 neural network simulation function.
%
% Auto-generated by MATLAB, 09-Jul-2024 21:23:27.
% 
% [Y] = nnmove_33(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 3xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-9.8820989364874;-3.65799721531803;-1.99999468395731];
x1_step1.gain = [0.10151410520026;0.255650892831276;0.50000722551666];
x1_step1.ymin = -1;

% Layer 1
b1 = [3.8691432778532330872;-2.8941679199547873935;-2.638415288357431443;2.9775518230084712101;2.2655879199629413989;1.8485936034221652768;-0.19682482105321202903;-1.0034724568487300989;-0.83344727204668922482;0.3084701533266379081;0.56095082046553834676;-0.53391376226328790544;-0.89773702446051617532;2.0125600330485271527;-1.6379494884377634456;-2.1012104780177001118;-2.8609278473393460196;3.4105852427545162442;3.0792914847656436272;3.8251532696458019345];
IW1_1 = [-2.6355452333955993183 2.0165678387168450847 -1.7692598902617362455;3.2319145620316502843 0.29531485238989740871 -2.8226266644246682525;0.085396995684910187441 -3.9213628050012667714 0.061657528299822968176;-2.35078853416596667 1.3869510244561420453 2.3896301221482709742;-1.544013642894927596 -1.1953999842527260888 -3.1603515814316924804;-0.70403116904980878044 -1.0360733356264730798 -3.4798947559783934835;-4.2147844043752753507 -0.98786644565478454183 0.21202661567852520985;0.76640313004507931716 3.387526141763056664 0.57881761923775243428;1.7449970530079499387 2.631426152828788112 2.4409716898121800455;-0.70150774703626805895 3.6034558191826211448 -0.95238070596777246735;1.5227540611837975248 -3.4941373166222708946 0.34876653693738235429;-0.4652514730833303136 0.62463860864077824786 3.7501222932479350014;-1.4001659367444401205 3.5110034396356866182 0.17698171581808080921;3.0456155521116561324 -1.6353015443533909234 -0.018601460182986351982;-2.14018475118924556 2.7380612640540187286 -1.7709411752430033182;-0.45559939928139309151 -3.2138118049292265788 1.9984921975232490254;-0.69457505623094240033 2.9944768357237969703 1.908846037594573497;2.8646061409173646517 0.61859561557996367576 -2.0138707224893499514;3.9874549902631484244 -0.063744421451294636105 -0.34865962090205659951;1.6824850022587662934 2.7267960027816724455 -2.0838847769022126322];

% Layer 2
b2 = [1.3557584943533353972;-1.2379072980969820783;-0.91217158663726771728;-0.39378526435684491069;-0.22633871514888717624;0.083006492678382670647;0.60317794532835478094;-0.93163660245844071017;1.1814261783874677736;-1.5934825586234819816];
LW2_1 = [-1.0103618330760379962 0.19165726795592116782 -0.36547053610479851571 0.17918193416990774169 -0.52359036068939956987 0.22393482485714771846 -1.9210184246726218493 0.25852626242130927192 -0.0035889145902911093015 0.20885884963164819128 -0.51100676013316759239 -0.042529624242637127651 -0.13429142816236708247 1.1696101465934301 0.095491035921357880767 -0.50442352521566147239 0.13815013749326049419 -0.20393745154459075319 -1.3722438861240915386 0.41462879131885210793;0.41385815720850421817 -0.29997263653051237098 -0.010479958519205401918 0.3076603942124931379 -0.50264742277510654489 -0.4176326932494640598 0.50030459425789508554 -0.59965584536804206195 0.068425323984860605964 0.7047992944508715274 0.2959537810114626355 -0.42273305357013918337 -0.1805962301618407595 -0.016902382779315446026 -0.62672129345271698764 -0.42385196908958844286 -0.23734030348961829282 -0.32241638911939279888 0.15875985031849429441 0.51567661825752719729;0.24082976631927721645 0.26892074472020383036 -0.45055209910829591147 -0.44462931065575539424 -0.34595149383359957707 -0.17976798181276862354 -0.46604570796141059352 0.045819359355290252556 0.40611206343766287352 0.3751198246024425309 0.030558340669925031924 0.47270777609502317995 0.402272501180963582 0.48841634842772818637 0.21874468896303453369 0.30587481745973188474 0.29542839414598570658 0.38960002314974662152 -0.13724530648515070874 -0.35991587100607708161;0.33071091553346865233 0.28116727060936819171 0.24455782394626715548 0.015018826031959683909 0.75318595454906511755 0.31690257559009482602 -0.2370958218086330338 0.53004622381527399799 -0.79238736776972107378 -0.11532985982095078636 0.077601171800068965978 0.5138926463660937749 0.11271571854138741353 0.067591121236130896621 -0.42900826862550850427 -0.18478791895367760456 0.36139236938647845143 0.11442630536411063646 0.75028607996426943672 0.1038695580871475399;0.14381327104452262811 -0.4433975875741004713 -0.28514304031047399413 -0.93136405624147444726 0.42681438586932485268 0.14958140291267268962 0.43560584803796964515 0.55751875402824246919 -0.19544319650557306911 0.41865581639306576056 0.24929990437908122747 0.32064159284364412983 -0.25808446228626708008 0.9066559824443780613 -0.65925666564986806772 0.012964896304363131979 -0.15262033473823913288 -0.36379507046548892335 0.099863315475700764612 -0.30074599552652719892;0.24095437729762841927 0.10727745129582737238 -0.43157217017687116156 -0.22824296583560674256 0.11019723554750782135 0.70805951311016801508 0.62659730797562573912 -0.14150780656597494733 -0.0064656340449258291672 -0.60716761391277029869 -0.032706291856092389869 0.033875165777681570667 -0.35357440527847905365 -0.32973518921351435695 0.48945925347062352317 -0.46687328574083436505 -0.42949371067297192894 0.067571293944960142408 0.21071758037446333689 0.17073524749845719883;0.52963339710789480996 0.45403710691363552421 -0.65493763100936353005 -0.25733442123472616281 0.072159757739505336893 -0.096265096259571067416 -0.3787492990554321981 0.29451055213406301947 0.14659183694403063458 -0.26569332252058508459 -0.4360139174528463446 0.588275338164573669 -0.31990065529415934176 0.40891597940590951321 -0.49250999964328506797 0.43685794086392681912 -0.52626294454125277511 0.44379450143236398585 -0.14044365090059390822 -0.27183875766618037506;-0.56933871458208606953 -0.9119902532245675042 -0.0464458281920615626 -0.06829814648211894601 0.12974261329833436385 -0.50623174351755750866 1.6916245246915662115 -0.022441893990863208408 -0.38798517480872624086 0.38438578166280934489 0.025542128954887517028 -0.027567864810352029487 0.14212280659767531632 -1.3518447592356173104 -0.036575271756852968663 -0.48770195017747247634 -0.026443779076904955216 -0.36216757660918980077 0.32892516411327921144 -0.4207969377435327174;0.16156309921787559425 0.0058082098126537124935 0.62981298734183321919 0.22924443458495105674 -0.33046196918997777781 -0.18100920805608161634 0.68140858766389034162 0.070671812572340481085 0.099759996277445264767 0.46827980379432959657 0.28688426863927940502 0.29885396068816960646 -0.65709049112742101695 -0.13406774436660351402 0.2442992901515337878 -0.58728176674508181243 0.36240320645880302886 0.39307109308455018271 0.20126182156088043285 -0.53351262558759127153;-0.18839330691124578365 -0.2866823222351315148 -0.02085255342512714466 -0.37746265464148281987 -0.45574334985911452156 -0.59480175040018246069 -0.70058654219522953355 -0.21768153267449735777 0.46650409488980626449 0.42406143130229922988 0.70432484986694054996 0.074219894012907614012 -0.048465637789275664571 -0.18247964548868139678 0.01872985287005997021 -0.038005301302922116224 -0.21000628522911379825 -0.096869980047141923674 0.57726133671984802831 -0.46716999547555954075];

% Layer 3
b3 = [1.7973393648135203016;1.7079035064915659703;-1.4621130145957461632;-1.3594734345871588577;-1.1056605720486727407;0.72983094100859546849;-0.86049964967325776044;0.6499831942710105892;-0.3398686906312786693;-0.15182969912663593637;-0.17801723404009506257;-0.2967351768529668532;0.33212135861090424926;-0.68140052538817164063;0.98051108930053065826;1.096641244514432012;-1.2675574988205868809;-1.5275888568502637987;-1.7353286822352123053;1.9036355459264697743];
LW3_2 = [-0.51873454569575228046 0.68167479751228499119 -0.1269595195040968405 0.9490031608596186663 -0.19777525864255626753 0.26603097268119862973 -0.56969159802571889273 0.45317520073723255303 -0.18145286019219822315 -0.91536264568820679965;-0.6470171962141157973 -0.22760553403331970634 0.2851611109152523138 -1.1500959953620648601 0.39793452277987284571 0.29848524943646764784 -0.017336095325345045326 -0.43448365312399628291 -1.1151990293250881869 0.35980016096912692536;0.92263982978263037182 -0.70284344513870633531 0.039094156847460231896 -1.2009953199034428817 0.60897222944613138562 0.17554627230656086323 0.14001209001646180985 0.12677202095817802219 0.15252758502224872394 -0.39805562603396449362;1.6427831496359421859 -0.79880327789593663645 0.15091274647874264314 0.80409178609502685031 -1.1649708532926481563 -0.28764911636523515792 0.46716487927520783385 -1.4597278642718833908 -0.6953703739972889597 0.63927016416495174855;0.32752127073424064374 -0.25431826243797217568 -1.0068438235478991416 0.56214906010497645017 -0.35606739116274421786 -0.75686802951550014029 -0.021327964297614940975 0.14462100125332222333 0.53658482153935926906 -0.79887071462861192206;-0.73296389626897207048 0.27387736754820279916 0.27288391105510051426 0.24065893261360832289 0.32715560440764812622 0.91209372485310225009 0.16674318798536180708 0.59791777998469397559 -1.0504723568521068255 0.84799274916343414521;0.76283303604336816228 -0.5441490595960213339 0.64726694430661191326 0.56687257993590900451 -0.19927638337260422663 0.58959181441606001162 -0.51144385299378691823 -0.59952317475815208869 -0.78155443280616088142 -0.380201502699054672;0.24708132665278409457 -0.87283875173472202924 -0.1702055036921499287 -0.12852829481455427252 -0.046297194484214675148 -0.73999311802147693662 0.62547343333554383804 -0.98257693449238048267 0.90572248331800664367 0.54451439792711242571;0.77957700516386352341 0.10464394563423104478 -0.37651697945972251169 0.96086441353878759841 -0.5418701524894820043 -0.27630297445212631535 -0.23935486734295402522 0.21937099559706332852 0.49767136617710472368 0.84957194595745011423;0.20076324679717166832 1.1669838799984673106 -0.069655106695581753273 -0.10671464760287902029 0.87386725942336085371 -0.063804347985691692302 -1.1477125334299829174 0.34188064456075722974 -0.45685518886810816408 -0.13422076716348940728;-0.31130114387624840955 0.8590847374939449832 0.52433918871107987325 0.72684813169498796448 -0.26427722195556979656 -0.65556761789272299801 -0.63647066989801825976 -0.17188082230292475727 -0.76233706709732673712 -0.58646792427483906973;-0.5439170926819565377 -0.57904873928008104844 0.31077826415388415393 0.22434093037369129409 0.29190573807030650855 0.47492879592691428225 -1.0332697327114026553 1.0029246347452898114 0.25065097665389673987 0.23340732212867135176;1.0110664814095911002 0.15862327559593300541 1.0442831389527509334 -0.5646886138089062257 -0.35022921098699050235 0.18474719150874041596 0.036434113463275685785 -1.0206140314150833337 -0.5010306178020050849 -0.54199586663235654882;-0.69206522302155892845 -0.80269875438707072313 -0.82550241936712442925 -0.097968025929237895211 0.53163863755514984 -0.34295346849702768033 -0.77475294015331963582 -0.014951083952385322076 -0.50952987117340342582 -0.70637144147294173013;0.64348342194564056573 -0.47245645989052292846 0.20571056445667951218 0.16598943808133884148 0.59519233190100795383 -0.54017905649893638298 0.79556259611665591791 -0.92226368678869607987 -0.87487575416587393118 0.16005309875994033764;0.28918725790083998906 0.2037783382240662966 0.54550261528361521091 -0.1253286901537277731 -1.0072727869483553143 0.46052783797275131938 1.1527002020094658796 0.88222806473130233051 -0.36635632387162214707 0.47164452447627996934;-1.0363338622654070242 0.084408105280687928396 -0.21289580061165908065 0.94638546311332760741 0.17925772509335505256 -0.35510993498115384082 -0.1742575969361161714 -0.07304811856737636333 0.85615065263070955215 0.75466949740009237058;-0.79820430648666340634 0.06758391558356761919 0.68700220033034287148 -0.5682875998267324924 0.10696201891181669752 0.15086243835174234507 0.14269497596881924872 1.0839505221373788579 -0.38380079853803950041 -0.83476638092144062053;-0.5325611639078143833 -0.12576226851835931031 0.45489914134903541854 0.50194698938112192188 0.85787524739359255488 0.50933049024081034073 -0.79181089889437461515 0.41187136861705697655 0.92214914373996204056 0.5584105555815859212;1.3584957112716191663 0.55583197907573267393 -0.23567617821831732261 0.5007622638488073985 -0.031863489699710666192 -0.55242460255620939868 -0.51416272061530554627 -0.32626359870677518193 -0.61133669734690065933 0.18584980187167732257];

% Layer 4
b4 = -0.43468961322278204529;
LW4_3 = [0.020772024446354848959 -0.70481465482596450389 -0.10113509817940211089 1.3332336150177932499 -0.16772134889144213465 0.37435608693210870035 -0.40784050865887078174 -0.56188349056824116179 0.31309823256578206419 0.3186004656162323978 -0.4578947339568009145 -0.077042777958921199177 0.3517632057816275637 0.30557176246744638393 0.36336416063182247482 -0.68989279085824661841 -0.24441680381581779025 0.048522930494632014742 -1.0547408747942652596 -0.22399732027723021077];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.499999999999991;
y1_step1.xoffset = -2.00000000000004;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = tansig_apply(repmat(b3,1,Q) + LW3_2*a2);
    
    % Layer 4
    a4 = repmat(b4,1,Q) + LW4_3*a3;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a4,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(4,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
