function [Y,Xf,Af] = nnmove_39(X,~,~)
%NNMOVE_39 neural network simulation function.
%
% Auto-generated by MATLAB, 09-Jul-2024 21:23:34.
% 
% [Y] = nnmove_39(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 3xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-9.8820989364874;-4.17631009264064;-1.99999468395731];
x1_step1.gain = [0.10151410520026;0.23976556688107;0.50000722551666];
x1_step1.ymin = -1;

% Layer 1
b1 = [-3.7749377454502783813;3.2117674253305867893;3.1627524550082504184;2.4028200022410253212;-2.0134437522878187998;1.6430984171446538777;-1.2236187459743930184;0.22373510481900910074;-0.67976527590757374053;-0.08841852132978783585;0.35196557869711475597;0.46423569610385384543;1.2518222528536664395;-1.9045158961058332725;2.2495377777013798593;-2.6996784429431888164;-1.948447949993759476;-3.2356884389791003009;3.2846920060817286213;4.1098326936067435255];
IW1_1 = [2.1325556820929207902 0.4533485850751581836 3.5122256707258183717;-0.15019252637621596791 2.9757648523824080655 -2.7312307153428134754;-2.0472709932542541011 -3.2446192436673668702 -0.026399325493102150653;-3.1380250723517013611 -2.0583926407445476414 1.5967718828642558648;2.1028230055417962419 2.8745476852295155368 1.5470473387154661804;-3.0989738939877766732 -1.2584158240278311425 -1.9556533600052830035;2.6839597748268841926 -2.8803466217872362165 -1.3990742066531034471;-4.2343184543653373808 -1.5411641348242082206 -0.075658061787262809172;3.8566624998157599258 -0.66118144937441414299 -1.3622049571384369226;-1.2930523147100958514 1.3287967484034413079 3.4407219246519189504;-2.5275982959641005721 2.4670647509041128131 -0.16545566617661999764;0.36384500475000286501 1.7448960845829035726 -3.0655521849334297357;1.4232947805206397351 -3.1343238335438070585 1.7686731314580939056;-1.8182998811102333292 2.710730963895204404 -0.16303954702514039665;1.9748254192587100242 3.3191758076505419872 0.67069743793135794263;-2.7233943658661194931 -2.4899830300538297045 -0.90413427165270687791;-0.58566317256545796788 3.4870999817625834005 2.0883170590981698922;-2.2017563850582289042 -1.6527973942931082352 -2.6916555227045493304;3.5724546182747842771 -0.69455057441166301313 1.7183415622494704333;2.4487216779248881515 -2.3066999998379693615 -1.2649336196887615014];

% Layer 2
b2 = [-1.5965487251533461155;-1.3808814178782577997;-0.88499376448683952923;0.51710109860705433249;-0.1530997857107923299;0.0027822984315242684644;0.24547846602669726179;0.71585850587886068475;0.71003238084807462904;1.7090797120619403149];
LW2_1 = [0.31702785128985383478 -0.44372556608015023549 -0.44429132736073223553 -0.034590844792212693815 -0.47285986167199944852 -0.39479327539297071059 0.37692904261882437256 0.21345576509584401892 0.19117595655131230936 0.39531970312776149035 -0.54638053105037920343 -0.14880901671651028395 -0.4860411179150463945 0.32404221134342953148 -0.15429111043017834648 -0.049374149754777531263 0.1386947854985736972 -0.4955711148773683794 -0.60578863987025177718 0.048802031860605402103;0.52691941971599165484 0.34956585872697548689 0.49138724245372039645 -0.27791756127446004543 0.026434337459012420546 -0.58528826490987262421 -0.069501833320990982767 -0.35814339594006888712 -0.44273466739935340986 0.15462003905006782567 -0.16864204027865548063 -0.20483972322727486692 0.17178720367263497493 0.18965312661857167131 -0.70846882788680543008 -0.18090764656829974588 0.38433001587904891405 0.06707510823620678464 -0.37491292475183363164 -0.39959624580374086822;0.52268362203192386684 0.013910020163840006169 0.13213857504990372815 -0.14336571324149052775 -0.42123692544894736356 -0.40970844718306209664 0.020572390080774095172 0.28816908303021276927 0.37582930827029575882 0.0024629588736626989443 0.058118768146620036763 0.20699849542617948517 0.27946543270541041037 0.059375475547579131819 0.0095590741310682611487 -0.83752505567250667973 0.36467638281576952863 0.39634461331683790153 0.48287007915078417053 -0.078578889843262292314;0.46177551803849919976 0.3996335948481510858 0.74263932405720134433 -0.26934544490713885345 -0.034528808583824996403 -0.42257744319742862604 0.8587881611023361339 -1.0678628089518888977 1.7735911785291627041 0.40985469678596647691 0.81916233390018622362 0.52522350294758757272 -0.29109891331284021287 -0.05082151938958960613 -0.24701249708048039766 0.17405857859349840866 -0.34219805205172759699 -0.18843441877020214448 0.63075736987504993358 0.40063378795507420538;0.8631811892636226391 -0.076174930806025720198 0.34424542138562380655 0.18915483373884123264 -0.42351001354521505826 0.26536632921939129481 -0.75207300017124434355 0.074753488161557468672 -0.23790782992478751168 -0.23592660229562034679 -0.27841188766607327665 -1.0673715029312060842 0.67435217909944222825 -0.08621963469996596352 -0.55439835641416213008 -0.20625110775314425826 -0.1947224377126052508 0.31672483489184488636 0.45362072768721101168 0.15444011094453444222;-0.34799235626043745206 -0.50318659769967044593 0.54812356963631381213 1.4949516274582204112 -0.3093231868581488575 -0.10410747859303789986 0.65259238178848133494 0.67120296138849777634 0.59219270698304071754 0.2153377916105932155 0.29395757614004863756 0.019087145616066957671 -0.32917291949477539559 0.273427281730943883 -0.70759643793510562659 -0.083910434652268967026 -0.34886742891514982423 -0.096694252658154372648 0.080218482110924360651 0.32762289615250966834;0.41793015452443965652 -0.24396262360050277596 -0.55235907767457592676 0.60960841400837018078 -0.88698675006214577898 -0.32777234470792343535 0.05790189880373587672 -0.19943992568061336135 -0.71281886830203022853 0.28866778053620711919 0.28270356199585150447 0.013947502394538442358 0.12085237629282746807 -0.1191309216520891473 0.0091128742891878646015 0.38677611165343384059 -0.38748241209331663049 0.16593198461389052634 -0.075435617533940541035 0.23670599753140134092;0.078684067753409678292 1.110128837711646943 -0.51653140456344981413 1.1665090205533721335 0.20848140460428885024 0.42143898916359079365 0.28196776471425377686 -0.59968458161174509335 0.33410538362421149383 0.026962710404382160545 0.10738390553972465558 0.12455115399799705778 0.22789438394485742045 -0.38716249888194265161 -0.2205800681161637633 -0.2204122912834388659 0.25585259856635245157 0.94299774624225385367 -0.94599096488261291693 -0.0060854732307927175;0.95770230045209547853 0.56509782843878841874 -0.52748220465180772898 0.74222255968480710386 -0.29559623026215631203 -0.41923928140265670494 1.2165911864239566942 -0.28603736335240981248 -0.48829094330809752478 0.71788692784034713323 0.30872083168857988866 -0.16792048621607261194 0.46507409173976771433 0.25805201738123034749 1.1026096847503981113 0.30809107357168064034 0.6148148354315176034 0.012719122612856688381 -0.80410471801622884769 -1.0387872416722454538;0.70276923655317069528 -0.0046223632620317062214 0.45839945750127714108 0.007574626123646316378 0.55550077436730993519 -0.75648916417032996407 0.80680604141113765326 1.9587222052137600592 -1.0167049350045780365 -0.049709402211724221243 -0.60901754936001839535 -0.11294271554474076547 0.28682526053876344907 0.46490987455043147891 -0.28093316072164364883 -0.42695079609272362786 0.2444780535937973176 0.21552962146089901796 -0.52524240255946408329 -0.18921070854844390663];

% Layer 3
b3 = [-1.8712714100004248508;1.7039926660546727;1.4030166232762162348;-0.97987779767425553512;-1.2182622386050889762;-0.9733206632780406764;0.72215919310105713969;-0.4487286269596071353;-0.59650543709473846654;-0.0097415546254051212788;0.16340016730210449314;-0.73577722895355934796;-0.22547355772091862147;-0.47246550743877102629;0.97680068382809015493;1.133782471808350456;1.5452239937140859194;1.7067650777154077524;-1.5976620398353964525;-2.0834286999639890503];
LW3_2 = [0.47980727240528553423 -0.58552528647238122339 -1.0797207796636374422 -0.37504436159459259015 -0.13434952568645477933 0.0028238686891240011301 -0.091443730462032357664 -0.22544006373773861629 1.1075120355624199497 0.6701902452265517951;-0.56194618844616739395 -0.68325548997767460158 -0.56277377857646215809 0.39756567536214360015 -1.1930376717329664871 0.40859779686334263271 0.19313241910105469201 0.1007043979739362799 -0.68407246134391685999 0.42498212660662393336;0.080166666138836037425 -0.73969604692881507635 -0.45427884052281525262 0.59244057100505687075 -0.83797591776803437291 0.41524999139443358187 0.55079519727970460696 0.76146925767923334671 -0.79108586367060762523 -0.54520330814950190845;0.011016257345053964353 -0.40101269192483435244 -0.22795184252496433763 -1.4170437745911255156 0.068770349501755506649 -0.2507176698848174734 0.79455251358897238667 1.2069668011425973564 -1.497269596228086419 1.4773169131398784515;0.29601757997317190707 -0.71196661321073939632 -0.12691997427418127975 0.093927892188494246928 0.76039055392929899568 -0.27137878109985363873 0.48332090001663380319 0.47382573664460797547 0.80565124491120609918 -1.1248073588039890769;0.38010574338167357755 0.54322784621366393409 0.071915096265398298359 0.32669340547107073025 -0.10666207870592971096 0.15143485638944148564 0.63148904101225356023 0.059170056494360051547 1.0391936120548148637 0.64702109629411996838;-0.68186091584521102416 -0.42853584613154205307 0.75185916892055815186 0.72404647729763693675 -0.72369616909560285922 -0.20131592775063716916 0.54258297361172547202 0.80667621261809330235 0.29029604686557175519 0.80620695359737926111;0.84419767109768484303 0.40555606962836648899 0.49205903656802457702 1.0658804579501861554 1.0247166928491338034 0.27303464599400073531 -0.12034051636430768972 0.42505813402669750944 0.070856201915163896654 -0.65938274682345299205;0.693990337129126722 0.2360690613092567558 -0.20888044802614455508 -0.49689303918269117633 0.690710869796329896 0.78245269021886520999 0.43358389262165947242 0.050623384067850205059 1.0148907867776129077 0.7478967463237617963;-0.8151125353952091146 -0.40680948025845820037 -0.050128437819556975752 0.54183035206868834788 -0.16342538556968555508 0.34560404298036095927 -0.75586508737521140855 -0.68811887283566963713 0.41803565815859089483 -0.069291070517702862963;0.4267554648322419153 -0.076884774909136352483 0.63758364220337704342 -0.51947157806587140882 -0.63429636725888260962 -0.61691038149062327189 0.028290952749146308642 0.70224282727993370123 0.50181968358415895981 -0.97977540990000344667;0.31797012233811611237 -0.38054924275051082994 0.02070274706789343791 -0.37173763960446853938 0.30202321150277011697 0.31128360705106977724 0.49173679553988691726 0.73286682270221592539 -0.32756915681198151002 -1.2438797140870485602;-0.98581695097828203611 -0.43600742533473002549 0.90771514586499280064 0.86706869850358947449 0.27870531077304799839 -0.27855364446182812044 0.65716421966951577005 0.8296553257160996786 0.48517536203901812097 -0.67450642907983271446;-0.36271458291103786387 0.31863123557139311215 -0.45433634043170034733 1.3972762615070397629 -0.18401117151591928067 0.89225227778994231631 0.33425859611351188549 -0.28716379224917792934 1.1984380236353724403 0.31789012833622537491;0.26807412026206345335 0.78741153673251129685 0.07266920940506646498 -0.4706655157090835484 0.66946196057041440497 -0.29604069152491335748 -0.82211095578632775727 0.26977616418193617331 0.86272169366017015246 -0.54771615280552332639;0.05534727387292393691 -0.50654839875683099759 -0.8882594285962303049 -0.27866557300888400439 0.23004304318765017578 0.53211906302567968385 -0.60913239695606458124 0.72889886788478097657 0.81815217781740512404 0.8017464048432099144;0.53738624262111756025 -0.67844273361376550291 -0.069952962633241938528 -1.0779669098541977412 -0.1607919268954444425 -0.5172813670604087255 0.21014065787651345363 -0.48922686142765586803 0.10532591778182220921 -0.68851844406954865185;0.49876861947791673035 -1.1442452545470191971 -0.77742445180486152712 -0.66102074947956757089 0.25626320844823530232 -0.4984598479448978936 -0.094763792818561676246 0.55261186837865583499 -0.18667881202845945654 -0.46735666415590243483;-0.90122559500448029546 -0.99108696675521779085 -0.92727897935773917482 0.52534587711065450222 -0.57230162087287106409 0.51855612504438342025 -0.87931870664802913584 0.27327828189467301412 -0.22815863172543668358 -0.57457895602304431826;-0.27443210019726438365 -0.6310873366055640421 0.065420610805316192771 -0.38819895923882596911 -0.78230096163367857098 -0.8991401625079986637 -0.5142372134726508337 0.032628732056929656002 0.40055490789392422801 0.79345142258127765444];

% Layer 4
b4 = 0.58022387022929888811;
LW4_3 = [0.4522605116393427771 -0.27079154131202792799 -0.8122707639421290482 -1.2790286052404085115 0.43978582680408057071 0.19190522532725989846 -0.44469586589975002022 -0.42103899590452625867 -0.047184389356527176029 -0.12866228376468369365 -0.4225791758703342782 -0.2733781640293421189 0.36180780049199856574 -0.38325496241336498571 -0.15059029643763030548 0.28404885171847399361 -0.090054595151538949227 0.30367040812210738254 0.35463634286137152296 -0.4666079117013244848];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.499999999999991;
y1_step1.xoffset = -2.00000000000004;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = tansig_apply(repmat(b3,1,Q) + LW3_2*a2);
    
    % Layer 4
    a4 = repmat(b4,1,Q) + LW4_3*a3;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a4,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(4,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
