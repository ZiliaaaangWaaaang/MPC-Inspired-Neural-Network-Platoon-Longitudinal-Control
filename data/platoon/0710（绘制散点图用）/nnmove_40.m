function [Y,Xf,Af] = nnmove_40(X,~,~)
%NNMOVE_40 neural network simulation function.
%
% Auto-generated by MATLAB, 09-Jul-2024 21:23:35.
% 
% [Y] = nnmove_40(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 3xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-9.8820989364874;-4.17631009264064;-1.99999468395731];
x1_step1.gain = [0.10151410520026;0.23976556688107;0.50000722551666];
x1_step1.ymin = -1;

% Layer 1
b1 = [3.1579309260956218708;-3.6686041300405443089;-3.0008484789041132146;2.6181645219785729672;-2.7723416103026443658;1.5320471931506187691;2.0461376910441231303;-0.80850722392413054695;-0.85792262003256247738;-0.44163691520964576398;0.62289775301120509088;0.72906655012337084898;0.89626729016675033002;1.4161086350117539912;-1.5477519875531022819;-2.1368121553504511034;-2.4812703903732642452;-3.0567521719642827271;-3.5012978061947790387;-3.8163491946498524499];
IW1_1 = [-0.45603006146440083768 3.6459066288279191603 1.8677530870128025153;2.2255768386369565448 -2.128374372304021378 -1.9767674566377828604;0.92165458879154904537 -2.7588778139367611253 2.2702750494808099369;-1.7930801822422854919 -2.4078810403744959068 -2.2376204724965629289;2.4131588522400329033 -2.3512861537883349428 0.44114287099990168173;-1.7064727142564544149 -3.2272955141045054361 0.58843034368316571303;-3.1812212477142254308 -0.98775000832590709177 2.1165070968272523544;1.9804524297897128093 2.7027907878300814204 1.7895674839599868822;2.1932252688895030879 -0.61762254443812136806 2.7669358004236448423;1.4727207858190130008 0.43025013800934802655 -3.4793792960400780068;1.7348548551240745574 1.6265472721801215172 -2.8050994691151305283;2.2535713738220120028 2.0435825920358077212 -2.2604669119726783499;1.0486329155469984453 1.2292442665282869996 -3.506390472286842197;4.0266808898110602044 -0.56805129728334735617 -0.25463225788597509958;-2.9287838142915720852 -0.80406181116876718207 2.4728848900897286711;-3.5679667423018814887 1.755122683725964805 0.26021296859084491748;-2.809477174176142622 -1.8026801540771906218 1.855228056720665597;-1.5136347041945827918 0.24892546186835659561 -3.3692409945723675868;-2.9371636997105783351 -0.041339084905174711126 -2.5780879762778821096;-2.6902737775391742936 -0.22803211117954655385 2.6343860771591773862];

% Layer 2
b2 = [1.4690264222906181946;-1.3174460976851309901;-0.79857381015478368091;-0.26505593620948819655;0.024163008357493277745;-0.46551432776979850825;-0.83357012263538254881;-0.74742524986098402007;1.2287714897117267832;1.6492101035915023299];
LW2_1 = [-0.092647912322591979839 -0.12553429387365852565 0.69267422733614625319 -0.2943691044633596765 0.30064818779007934646 0.30271923404325196127 1.3135051945107218963 -0.0553755731776374438 1.0243616680022455956 -0.19911233966623909097 0.077041971558623606464 0.52335597105966080722 0.11620213917361646438 -1.2121479623128645908 -0.58396428997509319814 0.51769698029080080115 0.63940617402737909281 0.32313710794236499835 0.73698884127541208766 -0.3755211298096054473;0.81946997170404423105 0.20205676184811793838 0.69668508114613070248 -0.32467686648598920174 0.47648289388976117209 -0.50250955063274693746 0.27800999135982434884 0.73786436923657827691 0.75745258515723012938 0.17249378580566313013 0.81476518897677951969 0.28723757944797534414 0.11841070614243852377 1.2519849623680883166 -0.22066236393865359955 0.17917232236215371866 -0.91208055005991106601 -0.32931909101405110185 0.16950405319655398317 -0.43206039411413021956;-0.24467184056037749595 0.53847030101193982254 -0.37710596311547400772 0.5793075658185303789 -0.067198409212632592702 0.45281676319387637042 0.49124481733213798407 -0.4723560685297169548 0.51879505766396616373 0.28934049815155687968 0.1303887010567253979 0.045377015968465175821 0.21437342135506237684 0.3220331685917464104 0.39081533450127370344 0.19789668430992504722 0.14998643575600673072 -0.15599477852578963466 0.08325196877450517785 0.10273352688052710124;-0.084907992666752724054 -0.29111824729470892059 0.42710660805366140735 -0.097754315523950557898 0.14770693056127406906 0.29934619698515119168 -0.21493399838941731894 -0.96578899857628819348 0.56900869246101160037 -0.61494750614233606445 -0.40969967152187769521 0.1364205273063494317 0.27514235043945639569 -0.05982275196650111565 -0.60255839965775037648 0.52445848007962536652 -0.53122065504507143263 -0.28256946869849891568 0.60827554257090132861 -0.73398998550337679614;0.71647734538982477126 -0.33469724633365277588 -0.030500614762318436352 -0.10393409833959332822 0.05063985138616172027 -0.054649176696692308708 -0.8000163687254434608 0.32424443202371577843 -0.35350078451806138391 -0.66640642836535479709 -0.0017231199833203903436 -0.78283493484072075308 0.254288946531518123 0.68913038929227099505 -0.10649864009352173755 0.081138274117459524559 -0.34153016871100649876 -0.43477641618013718183 -0.078368284435912968777 -0.058558046436529960499;-0.20168945715593228352 0.09510036689868678339 0.29305096102289079907 0.019920737351641730484 -1.0395165791400442501 -0.69980917435031952945 -0.04558607381230488087 -0.1524573300354079286 -0.45544328762739816341 -0.384736863307333532 -0.27279214723095435158 -0.45509244759701689143 -0.061567082463657357705 0.83155381256093718889 -0.072487863145270198251 0.30336084664893903096 0.43514824410794733511 -0.12045856849078016848 -0.4037239825202809107 0.28100204540180279134;-0.62077197017986973648 0.85234941415947051979 -0.45601118757961905947 0.44988593229008971841 -0.33822218008987303683 -1.0256303340130514812 -0.35830001278468120995 -0.36943813842115108548 0.67094092271110905568 -0.18247591804574897489 0.26608898707805017647 0.44074795146218215258 0.092828662590627677997 0.35385922024080557202 0.14249090266952749162 -0.46087139954951533705 -0.30221166700375245995 0.11519759944123802997 -0.81273221229963987788 -0.099544952775870207407;-0.26611842270246882647 -0.45778753107164887881 -0.62946757836841082945 -0.22938881058947771518 -0.71302770086859601495 -0.52577614885493839658 -0.62896860841310420209 0.31208987271528010332 0.24592836016301772295 -0.1439638849742887472 0.23169465033767241979 -0.22870446994772483662 0.04371748833473486362 -0.58161248362690354252 0.59456137163874045459 -0.25456762212860561956 -0.028687756354591399666 -0.49800595799989239021 -0.58978129615496255322 -0.23718520166800211024;0.68431754953289702925 -0.10715928194627429015 0.047345115843325485949 0.1637803352084611086 -0.75159325684351685481 -0.33993710991012038303 -0.1200356005980156987 -0.34042627715853396309 -0.25597791335825675896 -0.34070181634732266129 -0.42985405479538685292 0.58430995658991424779 0.34052917347951722205 -0.36863724248133628025 -0.038125031647135002033 0.26474104192629299703 -0.26386950222456906356 0.31749101778170096821 -0.17074970936154734713 -0.42785103973131727306;0.60340451811609163713 -0.051020309688534742909 -0.44385399099370820286 -0.2001560399058879558 0.4200020887039915829 0.095912591863868149056 -0.032033675386173181276 0.18464896484367945839 0.37776998992163934865 0.49445453957229851261 0.086110256036361298992 0.18861988379563854323 0.12132167586794244396 -0.028145709340456476905 0.47595182825300308416 -0.21053156330884648106 0.11142606191147690076 0.41648130939833000186 -0.43053615973651199189 -0.35673848986970668751];

% Layer 3
b3 = [1.8160874567299920557;-1.7011044995148729697;-1.4659120010554171909;-1.2195802846710406264;1.3016182633654429512;-0.99849522561144576915;0.98091540985586511692;0.56737210289851547351;0.49290358683922236294;-0.22151509778494088421;0.13804110875275255044;0.16451042675485655353;0.43668637843566404655;0.66866306689288224074;-1.1849584595726132541;0.97391544987224931695;-1.2500006178024281045;1.4153357497960949996;-1.6177536573239170714;-2.019858902418985469];
LW3_2 = [-0.49238279728921735545 -0.34453534436591543022 0.084602291943796925633 -0.29290286891997990848 0.49925437033520669861 0.55301201522394127785 1.1670486636204033815 0.50125415780789805975 1.0478194542837768743 -0.29626146106852735418;0.22044574829998556109 1.418400601325761734 0.36570819880611432628 -0.2023489927828585333 0.60826165070898430276 -0.12917950580610138012 -0.99046334852201789456 -0.17785514046195169402 -0.78686264636822988994 0.58636306163731610752;0.064931802254887302506 1.0083827979347044224 -0.79757457367248030256 -0.093360135785357775684 -0.51882964915482732149 0.32371874467835165534 -0.40129011792885388443 -0.78021571322040417229 -0.57400313494162813477 0.71409715644706328597;0.54486872868958224903 0.628546663485945456 -0.94406961536394118362 0.25464080724754473151 0.29234809296502939358 0.40704855532399480955 0.28515108749925538456 -0.75130133429706125181 -0.56667364058739166932 -0.63986150171175459889;-0.65520046091435790725 -0.63981861544362450545 -0.038329946303641115879 0.63415266445403295492 0.62502675684907293974 -0.73084326667197241356 0.033195021088323437009 0.16296177838664688275 0.68851853898375392493 -0.58232022150603757193;0.72915034601987582796 0.089112639105338994905 0.62981435089080972656 0.83138499991095193842 0.37266770625316003596 0.0087028055579852232199 0.81161071130884687719 0.85188986832650770431 -0.65737507794965166497 0.12786570622853943302;-0.22247120333592151908 -1.4864598434672002814 0.075625439561692098245 0.042998095186976233173 -0.63599970994777499378 1.4161827339652093283 -0.030816335352111791368 0.35618475460992327086 -0.091235371174129997751 0.049895102820548285771;-0.50959875127653608828 0.6603483385740310796 0.58939676841883470448 0.23713005939284445556 0.4599068260776806305 -0.7605431060529309617 -0.27434803887260200694 -0.8112160767416424223 -0.80633976278060637277 -0.23888295804205086914;-1.2634137604823705292 0.71759859622820532099 -0.063437842098269914271 -0.89459867996223463305 0.70575716718284287055 0.17150241368367419303 0.34253777830131854065 -0.64775712705198906782 -0.67693968187938036163 0.0013653166962415419494;0.81151990017148589729 0.49986357256821101203 0.037000794398384211081 1.0748241388058461521 -0.17577021511493268191 0.17336709987350309992 -1.0689605981146361735 -0.26455823502141412318 -0.16019932397485239783 -0.26528112042439461193;0.96095711934315675151 -0.50362439106663270394 -0.15248521317998667279 -0.056370380537018656419 -0.96293571168241209879 0.59823039277802736446 0.25606924649940510097 -0.59260070659242858326 0.60254924298366419055 0.77433664779085698004;0.82747575575866383346 -0.28334540559674298299 1.1289455947986133388 -0.65376867466450239164 -0.92623617610283137669 -0.35569525956836783864 -0.84644698134049167759 -0.10919898014870402236 0.0051605787819395659149 0.73875039104327644424;-0.21645028930899615216 0.24838412031913789657 1.0781796133024028617 -0.98862037897001797671 -0.063079030846495742768 -0.83558395798430362689 0.85774684708072301831 -0.15241458215480749305 -0.65534915645040270338 0.29855281987375870134;0.738691330361662013 0.66936455621848356401 0.85987057697083202346 0.32627316216739227217 -0.13247780279120574543 -0.53066301190426734546 -0.67460805039882698608 -0.5422926363368195668 0.69146124167493450141 -0.98701814104544804973;-0.01470652567051087059 0.15699426859992271499 -0.68448444330138735747 -0.84692018076844499674 0.46555263864036855459 0.73892570273716895457 -1.10634206577173555 -0.5270496765054776267 -0.61244090428526387626 -0.58508716895535073377;1.0235343571737189894 0.52983003210900103674 -0.92457550706508262461 -0.22393608684854038327 -0.35924999041838151514 0.26412572221672930839 -0.65182446532848303811 1.011217585674623054 -0.17114096260582217779 0.15026037774765735322;-0.39325114049995651966 -0.63962652569577427286 0.74139916689619300705 0.72873911460389351191 -0.56892827399354906071 0.790948813922200622 -0.65780508326600140023 -0.95764455095424538822 0.46834908481502512956 -0.31681209438457441641;0.74867810293014025458 -0.79796426383915486369 -0.56794964765053113087 0.47476505223252513099 -0.39069982149751580902 0.22208033924110026636 0.77912467961431608465 0.21956156747757901715 0.92804913027513524781 0.3473479921463858977;-0.63273383742913191785 0.23653015250244216472 -0.46404064653109738936 -0.05352384924848180292 -0.85034280982605470189 -0.20855155194579660938 0.99937901198394296642 0.45311915192673724029 -0.31081285126172852884 0.98082897265640689444;-0.30460939617346827202 0.2911081616150572593 0.61892232547643466489 -0.59029219757449880035 0.63372508311100550493 -0.36187404165980419091 -0.41204107861551880765 0.14972437653000875146 0.68977504114075238739 -1.0888186881500612202];

% Layer 4
b4 = -0.61213976094224453739;
LW4_3 = [-0.613096050521739655 0.59999478768714509247 -0.17505757453590362061 -1.1705808768971721623 0.48640077403187192973 0.42768167617014762882 -0.64609991454225468299 0.061735274813876667155 0.45964767077934698403 0.70148366079174329091 0.90555757256041569114 -0.66503361410079864235 0.31255137000071309128 -0.68228979422523405862 0.58405304853925543718 -0.2549346770811034002 -0.518520271791043319 0.99725392450062355643 -0.11543937121225361642 0.36296193445812424683];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.499999999999991;
y1_step1.xoffset = -2.00000000000004;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = tansig_apply(repmat(b3,1,Q) + LW3_2*a2);
    
    % Layer 4
    a4 = repmat(b4,1,Q) + LW4_3*a3;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a4,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(4,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
