function [Y,Xf,Af] = nnmove_43(X,~,~)
%NNMOVE_43 neural network simulation function.
%
% Auto-generated by MATLAB, 09-Jul-2024 21:23:38.
% 
% [Y] = nnmove_43(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 3xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-9.8820989364874;-4.17631009264064;-1.99999468395731];
x1_step1.gain = [0.10151410520026;0.23976556688107;0.50000722551666];
x1_step1.ymin = -1;

% Layer 1
b1 = [4.0924709612583418661;-1.9278369631576006693;3.4268266727773672997;-2.6432276830081544716;2.5450498785073074615;2.1854914862723537894;1.1075428884023241771;1.0383715878747690198;-1.4277833227394731708;-0.4040861607320502813;-0.025125941295185146018;0.99556137241095088442;0.90172182558913482886;1.029736719220879948;2.0594355096498562219;-2.3405163280773360057;-2.7559931073649024391;3.0953086983470181615;3.1149836045931897921;4.1791366213261600393];
IW1_1 = [-1.1528892756102391282 -0.88920354708605797711 3.1345502761650139156;1.7361832959802974141 -0.0082426337710758516841 3.7475984997843476698;-0.49212983857006314947 -3.5151074022467727609 0.72582474801507046447;0.65872734580150771322 1.44175290219388752 -3.4106069160115448646;-2.3559384224709098987 1.4503811989273007743 -1.0901618365524210486;-3.3469428341421396667 -0.85560107450290989739 1.951501303782842367;-1.9404398450652371455 -2.599866736364232267 2.4961770114361052642;-1.2100959601812442124 -1.7229955473419511502 2.8872261433980068723;2.6725807329527691003 -0.8664824835839360917 1.6449709702698305236;1.0303649804877506035 3.754562863048667154 -0.41431436424083051273;2.9605995799274804625 -1.9099973578556015408 0.30355426466483959036;2.8006564040893908718 -2.3482426625028720579 0.20238938883172763461;2.899726847376529193 2.2151960656554483542 -1.7058070886913638819;3.0248881112449019781 2.6361548886584551532 -0.393542025987182853;-0.023460908585906003337 -3.5784112814446507045 0.012037491304144727622;-2.8591120593107612891 1.251898776998538132 1.9422864197514839724;-3.1521238760008327695 0.59802333693747433685 -1.8325779960855350659;2.503234611813109467 -0.56241434121947919689 2.369977913793547053;1.4895334593052076411 -3.4644015304978394987 1.1721074319660722551;0.89139008478582970607 -1.4332390897402704777 -3.2167818552480893501];

% Layer 2
b2 = [1.2378760247333684408;1.2953584051467914584;-1.1906155321181259854;-1.0447017397933857641;0.12409811956031296942;0.53255205910802017044;0.11086672473355727031;0.89641517687089966593;1.2250794719801478827;-1.5460141502960362825];
LW2_1 = [-0.63894441209245367297 -0.88595045626822133134 -0.68337969988008828714 0.52159446475234438889 0.85171488305938503061 -0.025247292773337953742 -0.43477739436984880195 0.73824966177679396395 0.014564624149595598035 0.17648643646397704776 -0.46209389668138678431 0.10835105360534479091 -0.32716660726673846282 0.49572255201411863368 -0.38036643262841129953 -0.39918624835607063872 0.38316153217533222008 -0.36581081833298934036 -0.28991595517022922257 -1.1870014224230256428;-0.52832554359066008498 -0.48132545168764978571 -0.20195733748072017266 -0.5015124019211715245 0.46467641248962093803 -0.2001915026584981383 0.11171144279486294737 0.43885835149732133065 0.15196057218785180565 -0.17844426211930061732 0.55208189411985286732 -0.59049380855549737923 0.25239833625261043348 -0.58741432174206054118 -0.088492101451922836053 0.055469034406422812467 0.25261152845712825377 0.068602121834212922979 0.49308360316842370086 0.13781409351046894352;-0.22676971775624954475 -0.30277145260625271117 -0.082441279232105715846 0.27940041140102606088 1.4176864181001846976 0.3982174884701193962 0.40496237577638399818 -0.1541299054714597716 -0.27037861869446516705 -0.0042414489598680011478 -0.30199981375544027173 -0.11444658456136602709 -1.0233217924764537177 -0.065541219798228800286 -0.37659688024012677454 0.17787552372368062303 -0.35406588007455880307 -0.062347745861557300751 0.01622387405551391909 0.65970358391105421436;0.094757332960802950761 0.26547347279511435136 -0.25750201403148942347 -0.19700573070868157566 0.10283038378254452661 0.11737570820210413425 0.30950523472669649871 -0.48483033325715657602 -0.18005575999305045709 0.64666363882819954956 -0.67562464322133830574 -0.21124206869343251092 -0.10989896683535607669 0.75385439964250455791 0.043272042469810506615 0.46659244623023382603 0.30685829411647191911 0.29311060509930891849 0.022291100281062153909 -0.54487251857124108234;0.70431408069289380691 -0.39005677214760348104 0.28145267417346686578 0.1309342112597911556 -1.4091309572074788292 0.034739779540154745729 0.43863541220192536763 -0.078705879368567183141 0.52972775376962244476 0.11775004774276490171 -0.34030078192067719778 -0.089607489359378317273 0.49719555138940646488 1.0125710021611002976 -0.67120513628451083932 -0.59744414274005863685 -0.39995968412416366133 -0.12840255169351244557 -0.021744370184428395143 -0.065514084789684762233;-0.31603097903221277765 -0.40793884066375157849 0.28845929209573539787 0.0046704824989844545557 0.29738053078950299479 -2.6796738097815886448 -0.075207490832974357997 -0.082704929908134147687 0.67890410780633636545 0.76764082055433691121 0.30319758221167358858 0.53697335328737505478 0.49372860456871925372 0.40866707339287428047 -0.39294910709478608757 0.4589785742419758563 -1.0739344519597837646 0.4682134252780204009 0.19409788348463385965 0.83455859430221857043;0.10436841704608045001 0.38281514993540188829 0.58503038492091008482 -0.55930462607336284275 -0.20273930385389735132 0.11387141549454408984 -0.30410840054509707953 -0.0080979738684789706604 0.39364433549241301113 0.50765370241255014516 0.14385921631684653321 0.1923463130496006479 -0.42590646999835102271 0.23243872073380247856 0.77470792965345358638 0.40990781181479363227 0.39131695106801933637 0.29574058508292905278 -0.070061889405641009088 -0.70525473569558638776;0.091668881529051421397 0.035589630194073941516 -0.18166777680385634564 -0.60204866821466107574 -0.19415243758532868545 -0.60991550718913067897 -0.31169865011909653196 1.0269881603220176736 -0.53210104668767421732 -0.19596214872131098583 -0.24926765055179445074 -0.36028128427226624453 -0.48665668655445598612 -0.28542574847847368424 0.038936804705773715718 0.21932761083967133864 -0.22137671481551635111 -0.28010926168779715084 -0.34977203511297205729 -0.20455691508084788977;0.39519123172001019428 0.6352384234754978598 0.16433545357367215778 0.39388491905171807428 1.5601818423645676948 0.44993689084989008098 -0.75733598116920131105 0.15838231413527836811 -0.47753695807601426182 -0.18066831612234748872 -0.22176447054735495823 -0.015969628798339872977 -0.33257574627345765084 -1.3582335393050477546 -0.68188289510987076802 -0.36102580449028953691 -0.029883817691744325035 -0.46702034688162297194 -0.71943121319538527736 -0.27813251951123385552;-0.57642192383147694557 0.13486970726681138388 -0.13614526234169224694 0.19778988323612256561 -0.052682505718113739612 -0.45121363528611990734 -0.13873753795601365124 -0.076614502933611841606 -0.39865716415441315723 0.48065957227694794396 0.061208651025032222159 -0.33947817363952859093 0.60631867245785797671 0.55082772432315918465 -0.78639069957485674411 -0.50362664939359447214 -0.20337660095073123445 0.025307865193275817794 -0.25201021721467226078 0.57881018406919126917];

% Layer 3
b3 = [-1.8523936082203689146;-1.8734934850149429497;1.2318108099261015909;1.4311743069448437105;1.9041839546290297847;0.70999736351537479084;0.37953784768815401751;0.69385936982084950309;0.15731661359873105877;-0.025358222019438450556;0.016551141691526244371;0.36730243714965871149;0.39418290868158728513;-0.61736570988373473678;0.93905459162951065988;0.83448397183786593434;-1.2298388398820017109;1.8822529610723186533;1.6623581874512074474;-1.9874899346264707223];
LW3_2 = [0.97935850208982377918 -0.62526939972077533181 -0.1085771059973664604 0.20245906608071323474 0.46999143253819336552 -0.58799024945393585373 -0.57992680685049335931 -0.49345679679655701788 -0.89491357875248678244 -0.5372475762816262268;-0.18348791494249855338 -0.10825320054444141638 -0.13031611552940558507 0.43393459874551199018 0.4018296590773461352 0.52630469764161424973 0.39431565866174755897 -0.82045672001751857039 0.53966835212293040591 -0.20991486386443605761;0.037988917460418533678 0.83904923121871954894 0.97360817812627264978 -0.28548242293484255017 -1.0530380913360684048 0.055801609376853696098 -0.26058292528270055044 0.3123230593267594668 -0.71473839887830692419 0.6833223564174638609;-0.37998125891497486206 -0.66386360278247713573 -0.1103216987654206116 0.41710076116705674387 -0.070546601110132722834 0.80802128692552332989 -0.81610043182115765692 0.11739911657247943666 -0.18941268399349855955 0.77932752507457647706;-0.29167986753945440714 0.79588463472220261075 -0.57053437313728772029 0.064304967468880327996 0.26290612572262822555 -2.1815802397861627782 0.1146613938750423306 0.78998847964483120965 0.20599256322814277209 -0.90848450546964010233;-0.51690132018487389143 -0.022610926652872866821 -1.0097764507203104145 0.54826554951072925537 0.73943663557489658356 -0.31175475458007528839 0.1782064722387233513 -0.54812098020077137939 -1.0571519290885946774 -0.35849791658300039776;-1.1624855140415371046 -0.5433473453816396459 0.34269717924869025349 0.41745199300138668974 -0.064590480754603551983 -0.68013832781880412259 -1.098053040794071844 0.66379841582285259438 0.40741317069150528862 0.42412776046435946009;-0.15984920522244300267 -0.80942071800147064042 -0.7831633383231494383 -0.12096039725765263262 -0.11437511257048792179 -0.29552876787540888204 -0.41749458974465480932 -1.082326861081950975 -0.58774966244205018029 0.77369480547737334852;0.26066244482069228505 0.667777147414777561 0.9540981785021453998 -1.0284876355614018806 0.4271641704610745216 -0.11931712069482938721 -0.16359170291290076049 0.12607604923219808968 1.3465581480892643285 -0.46518717173196355574;0.16111525823333067153 -0.5759290323359322894 -0.90624497342786147769 0.097449319877997375716 -0.42431250493755834352 -0.11024741268388610349 0.69257220486240222979 -0.6987366335216268487 1.1204964901868630367 0.82388163748872789149;0.4610539660745576751 0.31709221571232965031 -0.98509811895674981308 0.046625315320068451419 -0.4234750857353278275 -0.74493754812458157222 0.43111255336853537834 0.87421786264062006921 -0.65950924522714460263 -0.45071418882039010478;-0.018098770016967573315 0.75647742946947393872 0.11003735183733434622 -0.087119384154689713529 0.85467891721296784802 -1.0020931237225989552 -0.62485236839230495764 -0.34288687665774214564 -0.79764950097300590937 0.72436516590796862225;0.36414095725626105526 -0.74396344698894478764 -0.31933026840610484465 -0.19691046735635156506 -0.54163779623583330203 -0.90626328863038241312 0.065602500560979590261 -0.53550490027547681393 -0.16250445497254589755 -0.91721667851478760891;-0.62662639912195972069 0.67536885156224912841 0.089793895132924100855 -0.24701377374773580975 -0.34127877845265280898 0.83506028582256686121 0.79978428047089789032 0.50543467596745106363 0.58847305063112753665 0.37830346527154612435;0.81586217134641181303 -0.68510643742233390263 -0.65354980847535049104 0.39663604035119592872 -0.52488849913939206182 -0.74028159044066443872 0.29077474393956453946 0.62228891354209181497 0.13587650810791782052 0.7409454797793505465;0.55367594772767392275 0.76737859653590578812 0.68102063774517174188 0.040867881151912234527 -1.0923220830472986087 -1.0548815832325817432 -0.080138514511782193983 -0.88141535794653469438 -0.044653682291534907423 0.51934361601538514552;-0.028147870432055070722 -0.96075814028470818418 -0.74938914962797975594 0.6078073997789985583 -0.095685440068472585318 -0.59827969226490496091 0.33218081165724649972 0.74102500061893872285 -0.1040084272120254949 -0.6970714038684009406;-0.16264626941715451536 0.34039372593228661712 0.68104653532605641253 -0.635968641039213467 -0.102693054826270877 -0.9004567857863499114 -0.92229453444995768141 0.69148749409480181338 -0.71649317327359651753 -1.0596838114984148405;0.79609617526778286845 -0.014623827585865542544 -0.60155765302400832084 0.31562180728584049438 -0.33474610583168884492 1.1828738544354133744 0.84502693070903223127 0.01486657444016562836 0.079758078400276669062 -0.1465377216415142958;-0.71486420773166703402 0.55026232862535595647 0.50019852161424194215 -0.36838326428382206501 0.46650671631073059586 0.61633910706087713383 -0.84580393962449440526 0.51832731000967646739 -0.5673821930776112854 -0.82615258499590904506];

% Layer 4
b4 = 0.40973610513492686458;
LW4_3 = [0.2504124985607620868 -0.36351960241558328724 -0.54786071917314449475 0.39206088069796168893 -1.2920359411871074062 -0.38123694450974887626 -0.14426366781319924226 0.38047097777695482179 0.71278112255486081317 -0.96761038544963284824 0.11698001674074873235 0.30394455762467320614 -0.070409977160899223092 0.23780403793635612741 -0.05620963556213387502 -0.98869142974649071309 0.0011207821927580602361 -0.17795401303062854947 -0.051961870262508938478 -0.43473194130361086929];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.499999999999991;
y1_step1.xoffset = -2.00000000000004;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = tansig_apply(repmat(b3,1,Q) + LW3_2*a2);
    
    % Layer 4
    a4 = repmat(b4,1,Q) + LW4_3*a3;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a4,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(4,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
