function [Y,Xf,Af] = nnmove_46(X,~,~)
%NNMOVE_46 neural network simulation function.
%
% Auto-generated by MATLAB, 09-Jul-2024 21:23:41.
% 
% [Y] = nnmove_46(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 3xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-9.8820989364874;-4.17631009264064;-1.99999468395731];
x1_step1.gain = [0.10151410520026;0.23976556688107;0.50000722551666];
x1_step1.ymin = -1;

% Layer 1
b1 = [-3.7914142753229329585;-3.6203518985179523604;-3.0984074558499830054;2.8722653971223013336;-2.206454210220704315;-2.0974909576524249921;0.54514845889307983473;1.37610271389332528;-0.33019176542159567322;0.55718434258390714398;-0.46319636863353785827;0.81390430240110367421;-0.87255186341518620186;1.734381707506787329;1.6000545796036846902;2.191406969465269583;-2.4020389140383300308;-3.2549754986506398424;-3.3014378551504095505;-3.8746923979564096285];
IW1_1 = [-0.039135812229860317268 -3.5037128862866526724 -1.5482663954826978436;2.612304509769216132 1.4838558980578877566 2.0053816814671234781;0.10335538854170706058 2.5875279075272770157 -2.8365733236584871335;-0.55141489696496548412 -2.6821854384196570642 2.3245820261914862392;3.2865161960384203788 1.5838345158828224246 -0.96379714696079710201;0.64689833691304621244 -1.9680686720325455408 -3.0215630897177541137;-0.95232224734145332068 -3.2113531398546424356 -1.8064001463784911117;-2.1568790456771318453 0.47149469359378259892 2.817945483902373649;4.0184091395468692909 1.1822976013566051101 -0.21561393126956651667;-3.26863113410598638 1.4903208008747232949 -0.8333806055748491648;-2.3070022077680434336 -2.5178863425741426774 -0.99956173566138772912;1.0881463492844756225 -3.5002780532679338421 1.3602878490753713692;-2.7881219493072744164 -0.30028547072259198503 -2.7010666726601471055;2.7738902544873029754 1.4952998834075488244 -2.2369406996339669114;2.7069225743000555617 -1.9197043827932511739 2.0669021345445592885;4.2714928817562540786 0.2829177253613915366 1.1250551653052951462;-0.6637635066530386263 1.816137132222259698 -3.2232379952767198361;-2.802232695853004607 -1.0298779928403409833 -2.0366262769590188775;-2.2371653976687886356 -1.4808555817846928981 -2.7916140980417831763;-2.6530607105473760221 1.258211224930515737 2.3483612816506913568];

% Layer 2
b2 = [1.5761235712554535482;1.2531133293929253014;-0.96939825092850540056;0.55606369216814743872;0.32510985954818788501;-0.27983935130361159427;0.61548330428949737936;0.80848070164685148509;-1.0535065841143846921;-1.4595138820898114762];
LW2_1 = [-0.22340909130688274553 -0.56695177804636964769 -0.24645321526545124757 0.30499199154529343936 0.043738209771972187678 -0.21892499530672532293 -0.15881157524354183597 -0.51883893341284204048 -0.45594963164882357232 0.30769011782004523914 -0.18877120678615136318 -0.46483319859473343216 -0.52864884444543047692 -0.20905328780107990116 0.099189372727080685199 0.19698361497820846 -0.21958733013175169013 -0.64897798263480566128 0.46563761859234248375 -0.34976283373658428877;-0.35807723255973045173 -0.42344793855403495275 -0.35564887433058384181 -0.32746452998735353646 0.42086130360871043532 0.08832025686274577736 0.39062086681576851932 -0.43129652809201562969 -0.042009907823052389242 0.26564612878925797368 -0.30011737069169108771 -0.40071981096426889657 -0.49215131484513968685 0.52346183594604400735 0.58141583221960657646 0.26054724326530404044 0.15163157610629601768 0.024800388245243408514 -0.10909073490097623282 0.1785138192919347444;0.45364654937711457183 0.27364691814191532959 -0.070534259717223379837 -0.10859914172519244402 0.22613966348843772547 -0.42876981803230623802 0.55740890782466578912 -0.46506118551009922868 0.027754631920456192262 -0.49097308675846074166 0.26246950033273114267 0.30354717212447479557 0.076144205657883323735 -0.8267127322735671191 0.55563356736627389498 -0.09978801707257778375 0.026224724377519513518 0.27520773322822689178 0.55101052503480374423 -0.46806288243400140381;-0.47746390259309667847 0.031550878281929761737 -0.011108163889520062534 0.26399531082784682967 0.21173693609619950728 0.22733175437092761895 0.78099836844534165081 -0.014271859882961049348 1.0026262192167871845 0.44113404295051700243 -0.099356253408351746792 0.18503851728223491557 0.076123094871164864728 -0.076964432975597948938 -0.39410409178564098642 2.0791380220067856577 -0.16558319912365776494 0.25215455307484624381 0.30063588882509956202 0.47444535220249506313;-0.13081705734406015584 0.22016881198616156112 -0.50093563675296881588 -0.049930208331180975234 0.30250454029945472723 -0.37787682667023969607 0.37189531548000687167 -0.10027215044907114572 1.7939571464160384284 1.0044776126228525115 -0.37491739662539608213 0.12677361914964818679 -0.1371061715201263298 0.05005376045896271775 -0.51134910933685806533 1.0008239959091098648 0.086312959614417594789 0.56607675624840303463 -0.27590770232892725122 0.17885504065096780035;-0.1376852723493093289 -0.13458131791879046624 0.46587833273678097568 -0.47633169538004638266 0.18758571126487985636 -0.2302377246600791072 -0.069233041746553564133 0.35033868322149763763 0.86078266321820984253 -0.034131524779550156956 0.074370581473030467068 -0.67363024848933128474 0.17332841305720592118 0.60742219175538325615 0.4593458399770973255 0.080037202917194766316 0.14617660448890418268 0.32872185006293291876 0.027244634896477808866 0.3620179051574565765;0.44971572266135051432 -0.61863847661223614338 -0.52629348124918196028 0.47489012855846679528 0.20580777700119751161 -0.031943167194529581421 -0.16253870201712522503 0.15785815076116974098 -0.044322957684401351197 0.19022849229510158109 0.057906074570940907487 0.12566799468530698292 0.16664805001883448154 -0.1617431335551560434 -0.17509477186933491977 0.56129836022935775119 0.0060391801201298113758 -0.11128660218824228123 -0.78515578084987913687 0.33637716773349646271;0.22506604778472841244 -0.28954012830319664218 0.5082637188507835857 -0.05612199869736712865 0.15575214220251099029 -0.031670498967973116644 0.5256918195330502197 0.4186106613192031034 -0.4787383596282521192 0.31113994036363201712 -0.39559401445080094595 0.16177827229137928255 0.09782652555998044841 0.18294263670578894687 0.058366938180953731319 -0.42135305549098689415 -0.5397901985624528054 0.17804074398685626468 0.23394953754808667234 0.61973222576984532406;-0.73723637542232800524 -0.219201163632588375 -0.02088213831387152053 -0.25129926084238352058 0.18046079085780974971 -0.092923557334286560616 0.77591473405797473095 -0.63874329451276701253 0.27193821960957503814 0.091982413141577623605 0.49131168733421481942 0.24213277282643372312 -0.3044966338911800352 -0.24068834790997006845 -0.040885477447644757998 -0.38426543938869839323 0.526986795340995684 0.34050891885348899546 -0.7583515867333132654 -0.6632181041410405431;-0.4132825061738251704 -0.60845437969371085618 -0.40268373062237933224 0.47660462559381017167 -0.21822244424544695596 -0.44734570960861907984 -0.18768926705033595059 0.44053334075211014742 -0.87431374333343225835 0.50972911573879398084 0.043756210831508969561 -0.48763547050566280472 -0.41917054069000952987 0.27165547869450401564 -0.50132910465242219722 0.10526377650869486735 -0.07040516184533564259 -0.36187549922546047299 0.32000621032245618602 0.18128021719700670999];

% Layer 3
b3 = [1.9618070523858448517;1.6497081728131055556;1.4612441857852154214;-1.3171436946915902055;-1.0271065939577261883;0.91259842338720442712;-0.77106563851384102293;0.61410002130151852828;0.19593647517635331967;0.11123295114081803436;-0.032787083212021700396;0.69377004754595350544;0.58901135695404382986;0.72609438907337153779;0.84127283031538624414;-1.162234278569703072;-1.3438974070777687242;-1.5376149583543006205;-1.6895416457296064117;-1.9428050503951916905];
LW3_2 = [-0.63916941544405270204 0.15305852825964011421 0.21994666770856172167 -1.3185094864127706593 1.2600764992074917625 -0.57381809196011623886 -0.4778698372734555555 -0.11947687493640936351 0.17523205689317630784 -0.66733038075186978944;-0.25458504194188941172 0.027492245298100938256 -0.94058958584321383789 -0.65572072196658015564 0.50911109649381569575 0.47964166516804351836 -0.38616124608280927299 0.38982126511432813043 -1.0394692041648996295 0.55968485451126703811;-0.033848351045723611141 0.026639119148527758835 -1.1195186982726643699 0.57869037302758163932 0.37947613941306845842 0.93775610088848526669 0.18902294958872067898 0.62151731810253785238 -0.9540520303118672496 0.27953505226517039173;0.029095464885087272272 -0.98735438822756527166 0.4728531805292114365 0.31813564588186471482 0.30236289181709335994 -0.20268899772302123585 -0.94363352676804568286 -0.54829009730126454514 -0.63085829388363134917 0.74007796199324071829;0.23871839985196907641 1.1091923562862355812 -0.41394908084475301457 -0.34907962861281710554 -0.6657602576488336199 0.92729584210965554369 0.14789105790765508242 -0.09732295636301578623 -0.84489910595628670009 0.30760955641247933467;-0.50460268509921646363 0.96669093099981040496 -0.58687640000401120055 0.87778657171776741652 -0.81124076098335629048 -0.48636861482482485197 0.53030784213110471192 0.30328780931587129288 -0.19652611194639715841 -0.013954730641320562887;0.86654975921115862114 -0.90512279916946747349 -0.49983168248436493641 -0.60293618998322839886 0.79060262756812360596 -0.20917471798440243069 0.33211721878180655576 -0.4178836270075982906 0.19585834806758101179 -0.013173729097625090645;-0.3823114449652961766 0.00084361706772658265341 -0.93292935635793272642 -0.60161787257223575676 1.1242145996594663515 0.11673340963027704908 -0.51742116146428862589 0.61016599855091668836 0.26750079174156027317 -0.77586929426706696677;-0.30462074006950662364 0.27860406534485943064 0.81465791437451851031 1.4745020996113111789 1.5327310941262486388 1.0444815981793857951 -0.39562894474547849466 -0.81045172373202989391 0.061918352290251568726 -0.54145562557233983814;-0.60599531073553025706 0.62231045164018450322 0.87830423379122568583 -0.60544185635456826411 0.28508359706064639871 0.037079206640615827717 0.48545694203321754223 0.55602101104975487633 -0.69831326984852981621 -0.73641055654807241471;0.37763831716714008069 -0.58822089411234934619 -0.30225394683015410768 1.3650206333150149973 0.58033095930772582438 -0.2665642141751428662 -0.046736394229380674725 -0.92822101475715845798 -0.071513908997713634963 0.39106772992943905631;0.63079620713557271738 -0.31408430446256230262 -0.95126714278752022569 0.312138222012531108 -0.50753371608299679973 -0.64996068361952963333 -0.36894528497638495734 -0.54877343927819566272 1.1451061580612691415 -0.0099467353027229629681;0.98583759931780967634 -0.028381449474272305022 0.18028669987350989801 -0.33658006178231186789 0.51804306579711034697 -0.73776186933179266347 -0.50392070530179322585 -0.022574181095232896677 -0.79398045742560197091 -0.77579600304817752932;0.12848819178500980875 -1.0365642632654090693 -0.95542928277617600319 -0.74549438478167451283 0.35548848331753463148 0.56879746767316730072 -0.6004128130891198678 -0.0036231142923086653157 -0.42405898656177914985 0.052726623611255664381;0.19889962856199969177 -0.8425465580200162119 0.76393982627496115345 0.13628880115524164007 0.16835332501006963768 -0.5308980035795883845 -0.30235214519015718437 -0.93743422154075772834 0.64960179250145932972 0.52425081974154896791;-0.94073866007096196284 -0.63091565010902006527 -0.5304702490115071889 0.1687667693802436808 0.71804437631647621831 0.094598806981079613942 0.22737178936465696211 -0.72296204300852373592 0.52743575377923401781 0.71979717670736531598;-0.83336613563533390447 -0.76069744282468532148 0.14900911323217660986 0.37374120721175213555 0.81413408633962702776 0.39524028360268276261 -0.03071940374108014099 0.7038173349609728735 0.70638928647308518727 -0.54708090720808888463;-0.34772483175958329715 0.834528432299377676 0.74263471063866004496 -0.25768153284861355923 -0.34155215945354772122 0.75895290020208139303 -0.015102740606346153757 -0.76935876256659774253 -0.77781790415970364361 0.41285456265319825375;-0.39823334275037614027 0.35416394724150690454 0.20983378755547552053 -0.43057765997313668382 0.52528568353669791158 -0.2589958512632642984 0.56931838297978809571 0.89397424231806532635 -0.6232534600255598134 0.47122258487182205888;-0.36317170105703744376 -0.6926514722321479578 -0.048800519121293413349 0.59186985926521451518 -0.29692904896781113777 0.98633640330318839151 0.081786000239411113522 0.39546635386826017866 -1.1019389297777260062 0.20096198355652120093];

% Layer 4
b4 = -0.23843007155701567701;
LW4_3 = [0.84392415325235758949 -0.090599295428463816338 0.68008117813812418717 0.017158892858126474634 -0.27877284820865039228 0.53916975981753045843 -0.41947381277167272717 -0.59013357833962254428 1.0520042462655403437 -0.033031771368165437075 0.26032990635161745718 -0.45256484825117099247 -0.38636683171113972435 0.23646394296987036099 -0.093886066714348348494 0.32701723745935429299 0.50627468353806170942 -0.54905795533180623558 0.28186057952165710638 0.001222814176820970428];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.499999999999991;
y1_step1.xoffset = -2.00000000000004;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = tansig_apply(repmat(b3,1,Q) + LW3_2*a2);
    
    % Layer 4
    a4 = repmat(b4,1,Q) + LW4_3*a3;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a4,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(4,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
