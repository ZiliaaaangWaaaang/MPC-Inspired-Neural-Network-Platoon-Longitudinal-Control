function [Y,Xf,Af] = nnmove_47(X,~,~)
%NNMOVE_47 neural network simulation function.
%
% Auto-generated by MATLAB, 09-Jul-2024 21:23:43.
% 
% [Y] = nnmove_47(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 3xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-9.8820989364874;-4.17631009264064;-1.99999468395731];
x1_step1.gain = [0.10151410520026;0.23976556688107;0.50000722551666];
x1_step1.ymin = -1;

% Layer 1
b1 = [-3.9700757827986974391;3.4468930496887959514;3.1222363419181977662;-3.5168539339668294375;2.6168676203099368038;1.7573359200550866532;-1.0712192626670644646;-0.1334581174918221258;-0.3453325435670213106;-1.1886794364366326526;-0.15261223620165273451;-0.61846445033602470698;-0.28397053514397346818;0.98173872657836747102;-2.1508544561177149745;-2.2188794851372080075;2.5889291832505274549;-2.758473432721174845;-3.5271782869785881509;-3.9327233597416184629];
IW1_1 = [1.394009369430227574 -2.1158670744414846965 -2.5794541592289244036;-3.7638804914386536637 -0.38646535092781353349 -0.35945696295580187307;-0.55203308376352322462 -3.3167675636434346131 -1.2740978257197150825;3.3089368492601569649 -0.13504052897692722657 2.2681410911507891015;-3.5695730744125722111 0.12627748441965949699 1.1014453415702194494;-1.7878374620822663488 3.1514616160228428043 1.2851186752365986177;2.0640308576749202274 -2.7550433841618211517 -1.6177413447084700859;-2.5430369627917568387 -3.0887900207184233459 -1.1783050370242782456;-2.7253459446014529632 -1.7587189814970991542 2.4257703837965256533;3.813231949493984807 2.5447669250776194794 -0.51992902132273755011;-2.1939492922609518111 -2.4159025157061466693 1.476381791682144895;0.082344704990778075371 -1.7152023793827797515 3.1510399174733181304;-2.8571248441647347782 2.3352908929559226259 1.9962201161123158677;1.2685325998368894851 -2.5207564612084181199 1.4006273987238975209;-0.30395910424078020906 -2.9443846532547706119 2.5854862411858019478;-4.615821615488639118 1.6551182618700912563 0.0067088250809574923039;3.5853273906314040431 -0.42767748740733346757 -1.2778383513359021784;-0.75536417172600822667 -3.4292163502745136583 -1.6522654976934767479;-1.441793688318319111 1.8653966447635528247 2.8486425799062988773;-3.5357971432530135303 -0.56095209700243964246 -0.76297661465089861021];

% Layer 2
b2 = [-1.5661304609846995461;1.2565713045963360361;0.84428371308265148798;0.56445273457078148915;-0.023845740660899086144;-0.088682265956121983375;0.56928114234754512157;0.47875976293078853496;1.1705272290624957332;1.6307581248237597027];
LW2_1 = [0.49585820998450036434 -0.011397534889061391311 0.03659150218414534278 0.62123570752553236574 0.035234453377877512914 0.53463688353787353069 -0.077227220776954347281 0.3343490621086426251 -0.055283798429961977794 0.36280427668504605654 0.36563917924668914994 -0.63978057680089683856 0.053537401840328686931 -0.2952602713079848229 0.32665437211474124268 -0.25755781291103185815 -0.025208602854761424927 0.5414438458212529337 0.19798678179416340228 0.48925211428270165559;-0.32326934396034673336 0.11910791683642324434 -0.45661471981354673222 0.42837945744197092335 -0.42825745208960597221 0.16068683772176969859 -0.34161969462283547916 0.32080549980222305972 0.1950766172402461085 0.95726059708863975306 -0.30359488085025143622 -0.36196649306435962901 -0.33287947109320470407 0.37601859599113773847 0.29659232282854142149 0.2329792159932772555 -0.06318685348505083399 -0.15656671470502209198 -0.3091698464449003092 -0.32202967100256041366;0.12925406342212011901 -0.49470701044862835927 -0.18641341453104676162 -0.13324958031915942747 -0.35954661232431872619 -0.66694030325497644096 0.39853726645657266969 0.38688133028443361106 -0.20059738325500947598 0.72256377774724733776 -0.040826311342932269932 0.61595093859910488021 0.11002094275228302411 0.3589730835187632807 -0.35713263520824706232 -0.22140763236280885939 -0.48040062306178721308 -0.24776920019497833403 0.39799671374113726463 0.45207759955523224571;0.026210227578485026378 0.91498446018575529948 0.12501055223286955398 -1.9101261938790123907 -0.37289347607378114935 0.83444106185645883222 -0.30662150238583102402 -0.25863287402726747866 -0.074362070377419486888 0.031951705155073631404 -0.43370672484436606497 0.13140544263136280656 0.38944285268589090565 -0.35980393554141471002 0.10895426400843945258 0.51293832407112405214 0.081611442558656543955 0.24291343292077632876 0.4359495259995230243 -0.15376345103554917015;-0.099632954274067708766 -0.34244373962287216751 -0.39825698890604543934 0.094176431809888980218 0.59311717398067698159 -0.022684779927342017813 0.59872856132677509944 -0.022281878625686438178 -0.40616273965883165076 -0.3031102976646469771 0.12198938205729260853 0.039028046785921713391 0.63522787793560964165 0.72707007589388783497 -0.29612272119546195759 -0.34500138924847922883 0.56082928726450154144 0.1594501283486408072 0.33524705459145398567 -0.32618717992772544578;-0.43225313009399912723 0.2192837811150537275 0.35596574178856454918 1.4200930855744802184 -0.17486398885128875968 0.31381346512652796843 0.48552082601089380232 0.34962492093339447852 -0.57949580347676099557 -1.0347197278316837554 0.058358490548624492034 -0.31703713692793328294 0.38054878604716840806 0.047675989087156873947 0.48396744063909447053 1.2865433768756850963 -0.033907752929180967616 0.38832892195372020749 0.3328955592680059028 -0.69297848606391398985;-0.073149116229751232066 -0.028628980495657214977 0.51887541429546590876 0.08504299565130007954 0.022505619992008549235 0.84478392768161114645 0.1209442633771980885 -0.035501197364694203618 -0.18666879118774817869 -0.018558909741477513239 -0.095956548177073316963 -0.36298264988341200077 -0.29379729937955034735 0.61063416933986025548 0.69874495556544924391 0.55084844291574086572 0.46356137311808531809 -0.59671107412799551106 0.59448605830544432038 0.18853320620829208676;0.051626220707198758331 -0.1403646227510695621 0.3259706278311044203 -1.5204489712699620352 -0.10398149739045241258 0.30129048173714956249 -0.133573019129877818 2.064117737084233184 -0.12163815524496146558 -1.9220129571165462945 0.39806925537920367919 -0.058651970356086491343 1.4098806896136788502 0.99941491507230562075 0.79164455270502065432 3.3121370483898706638 0.57337904088392355195 0.21031944298380006453 0.38207910168274727969 0.56096478279412165246;0.44608009217019189974 -0.14864440860895444807 -0.2498237268220547258 0.75989045629480589383 0.11120910259511283813 0.15110261612605507819 0.4472731597178963292 -0.59553773204431448285 -0.033565441298624418276 -0.60592246952617967448 0.3307046094971476391 0.16068181528903957567 0.46251473747596610897 -0.30325081372302237215 0.39355780415749735957 -0.25638873710445797549 -0.16381466128374000402 0.11199149098111950418 0.095588615098570528517 -0.073038489043388193922;0.20160629875641558617 -0.26323732846206288061 -0.24540155087486614782 0.53893153536873417142 0.93071873477930822105 0.15062685866205127727 -0.61208273853551431465 0.51490235603737877224 0.82363182913930010898 -0.48061267357012821266 -0.11001930172622871595 -0.16902737095865350003 -0.36789481815282248922 -0.71734342239746828884 0.40113328621810734331 0.9906004008678050976 0.21463033989655058709 0.27804421506843246537 -0.30801622702916536811 -0.3080080868385108861];

% Layer 3
b3 = [-2.1924379370727091754;-1.7375873749131987012;1.4530394892481099944;-1.3253153286665388944;1.0897613821364215969;0.89452890840608534351;0.68758683403427511838;0.49862533843157608171;-0.13828496204509496681;-0.051487336168429514993;0.16381619849287476498;0.10453319871532008867;-0.2005806624109952585;-0.66612569124853904245;-0.9841046931601524772;-1.1833284956043252922;1.4264849072290897158;1.5422811089164911724;-1.7476258834724229807;1.8815500252407091342];
LW3_2 = [1.1235453234460084371 0.15063484365033383283 -0.089779612648678550069 0.67659425814438256541 0.066300170562975130339 -0.82921585582742618481 0.29216451967506057441 0.039602537130735825099 -0.49609050484255595714 -0.54470957627882088392;0.41837357381736678397 -0.80234885972318092939 0.49715039512202907623 0.6374004355787026288 -0.58421865111683335403 -0.80003863820654186334 -0.94856842001032271039 0.42863480087532351837 0.087628077777913787605 -0.21858614036172308026;-0.82830783836629695571 -0.24408271825792701715 0.31927892884688752195 0.73585965164453581711 0.52207616161442516045 0.88403784445384769874 -0.17429523155687617897 -0.85365901741189509355 0.76581467406686776211 -1.0589793256351129891;0.91831277900983854234 -0.33959566724935280613 -0.4794487734026928738 1.0730661008778830112 0.14691319060620550152 -0.5697441682892031567 -0.10366498545034200096 2.2696529972109300566 0.45551180137444480245 1.0752729962958356147;-0.7445324569686559979 -0.79589821354534462383 0.67160029387118491684 0.71063149919792789611 -0.91275048335363218044 -0.31256037715678208766 0.63031806764270104093 0.040784608085491211305 -0.13173103248348899674 0.47158347705261260963;-0.161923775535868536 0.73983085644930568492 -0.4088464137677936816 -1.1264070763270768172 -0.75163576728130809812 0.68541781486945518864 -0.49365490956295488001 -1.5925483754259472935 0.66309691907937318156 -1.0066675394514235098;-0.57815803920897923529 0.70538866873797223533 -0.73902605225251782883 -0.46161483353143478725 -0.11199660442509590252 0.17075206854284560865 -0.62672949877308858913 -0.81075188187297564379 -0.49813143993929520636 0.8262952807227398333;-0.5778599314216602556 0.78427190530674917301 -0.82994411909884868717 0.6805665064757945304 0.0072854683839308799487 0.67724358505844517442 0.51085615649107374292 0.34067448265399813412 0.71568986208868001775 -0.38148070216125101739;0.11872514165096442751 0.34283500933538219035 -0.2043888018103990345 0.95123444222956476946 -0.79658642750685915157 -0.47331190412547990976 -0.56131182482896957442 2.0853823765441985572 0.99224894268818941701 0.44591754028248548058;0.47797881844070977397 0.063534617629193268495 -0.79916853814597821337 -0.70373260082115918213 -0.8750535518887337938 -0.68972706503800285116 0.077193287916362665624 -1.0009501500866453405 0.4284616108646400745 0.69031392808998182087;0.013372970595892357676 -0.31244459029039228781 -0.9889632740385941867 0.15189995667003283741 -0.11509803431394888262 -0.51472047419378275102 0.93130488769933483795 -0.78331223793955861989 -0.64854910512218155727 0.10296944806959203167;0.6933315438894139815 -1.120700482021906863 -1.0969467204802927363 -0.66602972260763493306 -0.55333848198409163466 0.35545796145776969999 -0.25883496708798597874 1.2512292743994799515 -0.43379055548795297792 0.72403734502038596954;-1.2876565467141556365 -0.53571411386431611046 -0.66296740934175191207 0.57451793178101306925 0.20855875912753335522 0.12830328322035347566 0.27181773577740753201 0.77657949446706109331 0.036487961158502342507 0.55871337658520370262;-0.22488844367757548914 -0.11980761781689097667 0.30068077762598294234 1.1458200694031392963 0.69533918461144472722 -1.276823673989754715 0.18938662053275823194 -0.67122160311816980727 0.2212566591679735184 0.22656921467711160778;-0.15971634932741213264 0.59663689162346422723 0.18457555576304629508 -0.76991486958348298586 0.18562874173221605156 -0.031906344593537215582 0.76924759561381617079 0.35486063433675418821 0.33589970072557306935 -1.0799823245498556545;-0.45726388271912643546 0.62851260776899386951 -0.00090120428583382108934 0.26294678738782389926 -0.92250396071302898093 -1.2573691303779743755 -0.51686045611865982785 0.21328037713370534556 0.30914807854704334789 -0.820146809735587623;0.6660472509979454836 -0.0066349585979974465277 0.67552614981636827096 1.0096780976196062518 0.177481828638310829 -0.87460726058329096855 -0.37835907905079185776 0.36682414557552445178 -1.1337569136392227076 0.27732310242661240007;0.6527854541632628349 -0.33686353797265905508 0.60865889042166054779 1.4026997373405205582 -0.37473273580033900076 -1.1322783356216798989 0.62688349292845058081 0.82401068828259604881 -0.49609681545021783178 0.027661218983438325136;-0.7815342584327530373 -0.46520220773923925961 -0.23779761559257639458 0.31236646689635477747 -0.3718022581172391039 -1.5411230456235920361 0.034521167475790585921 0.23025577473120056871 -0.268166309739007791 0.65803551188046016662;0.30295641743577600424 -0.19123356853288525636 0.19004165178254095458 0.014118500825873415636 -1.0274407411001198476 -0.45285708489125031662 1.0224081541243470461 -0.19295082158015774976 0.97910421791442969752 0.3968462260067749936];

% Layer 4
b4 = -0.57039248725284696917;
LW4_3 = [0.22295883325745485815 0.75860205269952529772 0.44139487858496551098 -1.3420321726081294589 0.43090685038557030584 1.2273085353911088458 0.52680623010363802905 0.082466400069505715886 1.4137816239121505646 -0.46307824951428117055 0.029739632946017821591 -0.71431304308686061066 -0.38271307973929313828 -0.4255904463325436704 -0.17165266258507291819 -0.72421598519696606111 0.78559110105467311325 -0.71223128923168077531 0.67076638681081113269 0.17156034636183084552];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.499999999999991;
y1_step1.xoffset = -2.00000000000004;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = tansig_apply(repmat(b3,1,Q) + LW3_2*a2);
    
    % Layer 4
    a4 = repmat(b4,1,Q) + LW4_3*a3;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a4,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(4,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
