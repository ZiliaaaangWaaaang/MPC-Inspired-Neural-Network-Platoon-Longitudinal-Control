function [Y,Xf,Af] = nnmove_51(X,~,~)
%NNMOVE_51 neural network simulation function.
%
% Auto-generated by MATLAB, 09-Jul-2024 21:23:48.
% 
% [Y] = nnmove_51(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 3xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-9.8820989364874;-4.17631009264064;-1.99999468395731];
x1_step1.gain = [0.10151410520026;0.23976556688107;0.50000722551666];
x1_step1.ymin = -1;

% Layer 1
b1 = [-3.7333840894223553342;3.669085672254067898;-3.2967465495358623251;1.9666096523029172882;-2.1828137977806854053;-2.1527873409538433869;-1.755248518289550308;-1.0512588731569063594;0.036584462671716923288;-0.46155978081497822663;-0.62814231797046760075;-0.7793249507236302831;-1.3895099748499342152;1.2498332965407719097;1.5528452672025390147;-2.2820346359693362004;2.8320912573277450264;-3.1210365101891812678;-3.0778260615418711055;-4.2505788829289166131];
IW1_1 = [3.7415371733709501534 -1.5444646595055226967 1.8832336801445144214;-4.1559622673168776785 0.37865950055617425551 -2.0580210021415097366;2.4390196084591724279 2.5456937538461086312 -0.81791223164951598612;-2.7626496231363182332 0.63570067322021373002 2.8471724683841954651;1.613316364431004013 1.8091741144563533439 2.3806933420721798633;2.837774328982234362 -2.9415152479581689882 0.74343164254697413629;0.87206834722636183965 -3.4290951110500706989 -1.6821326166431698201;2.2999819390695672716 -0.59917918807456016506 2.694877240419291109;5.2614798915950782288 2.7176665733783749168 0.35006947785152481289;1.8939625983455812275 -2.2418110000109847668 -2.8249921271090592256;2.700906231830856985 1.9076558682952093893 -1.0505675670748308992;-3.3090574536983963227 -1.5561217037265162588 1.3507214266126050806;-1.3820106021338904867 1.6642436491442171853 -2.8057521833795520116;0.10041865834025384685 -3.0501391805501301135 -1.0995016707703411107;0.70950042402704416311 3.7147449493932489517 0.28514519185477482655;-3.0940731698588899157 1.8582664328590521308 -1.5730384376316786099;0.037333424422526587105 2.9441749912686629997 -1.9326882681246462248;-2.4264764888315206726 -2.9305466039917660304 -0.86232071220005679368;-0.38141904095845829969 0.23351863754274454488 3.9249164197191106496;-2.3854636011368341997 -0.87256467498703693675 -2.307629156668279613];

% Layer 2
b2 = [-1.7923162220866764027;1.4277677894819074123;-0.96810300480123967493;-0.063809185903290918662;-0.26727783184533954186;-0.18366047112463576574;-0.0085135879705559303066;1.1795955732208418532;1.4675097871463882448;-1.6798058757063898394];
LW2_1 = [0.52020281550707125895 -0.37369526341651920776 0.50780463711736156807 0.45739165138506737707 0.39183736320584461321 -0.13122693095331461333 -0.16978706870098114745 -0.1690061249144177713 -2.2430985756419405952 0.24826574478010124403 1.1182294540671422478 -0.27722838747628103517 -0.029429374914844173838 -0.93000226857013879034 0.37638620577457032601 1.1534319893506741472 0.083554753740796544603 -0.26413586263588778591 -0.17658021846779156649 -0.23052623177717762593;-0.53968904006109297278 -0.13740136304006422829 -0.39827005698387529797 0.89641809978446673757 -0.5018551042341410362 0.53951920126699126623 0.80864727451120277379 0.15866223815536142916 -1.6692658234014996488 -1.0177635941931824082 0.29817111832783765868 -0.18230140362289953826 -0.73676628718737036117 -0.67618021533856520477 -0.44290908856998650878 -0.5026398866839896229 -0.078967756539134209559 0.29178558593442965874 -0.55326389259086483641 0.13782709326876646516;0.1697545606283009656 0.47614735753771891824 0.23839030424199297853 0.35816328696422006228 0.4509478261004448707 0.7429848141150297014 -0.4676867743430235258 0.007953744778860002973 -1.9073424177166475868 -0.91606668601681595643 0.88596349404211094392 -1.0253835874880055101 0.60431965271801602047 -0.28443844838847037737 -0.84078292094813300572 0.51741409419798245484 -0.79204600596844831895 -0.55654140356037462567 -0.04341217819161341529 -0.091164142611195875254;0.96026270450819739555 -1.4409846389594049842 -1.1301223325678495524 0.5172491428377261613 0.51633809173260458714 0.24747866978906832292 -0.18479326179946400921 -0.44537601933046094826 0.49213840376658274378 -0.30220406968004986936 0.23143429372129792343 -0.45598266563442896304 0.25773104176548428113 -0.53288301099507595637 -0.12445538506257138034 0.93065961652310869034 0.060805259612644456391 -0.46181826391836472423 -0.65795364946586942789 -0.27676345300557270157;0.48254764584275039452 0.25953592761484228779 0.20012811391697077346 0.13238894358195618661 -0.44913823375774375446 -0.57449884551592123039 -0.75040924047464829805 -0.51098156970757546702 -0.38240416194910692438 -0.1922947626120259379 0.28505310235018987974 -0.10566868701728718283 0.081486603730094309128 -0.21237402527934978735 -0.19387354253631766676 -0.66594171865644469221 -0.025347168086903720113 -0.34458425110042101291 -0.27842603586086206446 0.65407030552247891197;-0.43967120278688032187 -0.50394420114384264053 -0.71387517069204620146 0.74306029149795971289 -0.48328310812417585307 0.28071759671962487337 -0.14761492324932018461 0.018493840800966884069 -1.7295270089987149209 -2.0551819529852228818 -0.57748596316285105701 0.51346580909422590011 0.25173380638900760831 0.34271947447467859815 -0.33054215543705939284 0.11979698417719743253 0.49506911500381645119 0.04786105469922897343 -0.15423610141318744304 0.15578949862747376587;-0.54490769766170954469 -0.3735294128115033141 -0.76598243878930472039 0.54418641190470451452 0.53009997656858931503 0.34817740877465069849 0.71385539223609273396 0.34928406431154884748 -0.81797020938268893975 -0.36428776346875685332 0.25741656116479694205 0.43538674598554910622 -0.26778296692451714067 0.31072233114647973551 0.61596525188356932023 -0.058061631035599060857 0.58833256011237489158 0.34119044344460519591 0.39957232711256052138 -0.22374587703583917464;0.52905893481513843746 -0.99866149303014351002 -0.7789552665128662845 0.13558637733568848494 0.30048559914951145089 -0.69673138496172293266 -0.8344333557518166522 -1.0279527088838416038 0.34400430033613232927 -0.11488710584687639171 0.20801995789553778815 -0.44616860272811298405 -0.074985705715406539285 -0.52839631432035893965 -0.52128280315433306313 -0.063744291444328665674 -0.33404770506055497803 0.16852879396360614939 -0.54140715818045503926 -0.011060513463903642178;1.2238595425168377062 -1.2175832245727060688 -0.37232140653999246105 -0.032299511762114756219 0.090460983690397483992 0.42635297913233588529 -0.27725375470763352626 0.10778236120575906964 0.85095021591105701741 0.20434364329095919266 0.77527653522362949268 -1.4573364190294124665 -0.10382370759781800462 -0.34237078768167195086 0.022088127711016959653 0.27050235494813179571 0.33010607897617755269 0.55465565946914352491 -0.48011299516934113907 -0.20776445793177614196;-0.29304914414731703109 -0.23695151726603116971 0.10318056159697719387 0.41903637481418914978 -0.07402421249021796934 0.45032831704151343732 0.28639933942538420286 -0.15924878805480477406 0.31891876211896641458 -0.15076312444277600866 -0.060149121673732854065 -0.59690289922004602374 0.17045347374205699342 0.16098078347063179971 -0.097115717125702161194 0.54373712799185835998 0.17982833673760317827 -0.37819870266342597853 0.39169938703204126851 0.60693164003112554106];

% Layer 3
b3 = [1.8928031286833679747;-1.8010331682997771097;-1.4384715197202975201;-1.2921679415686391224;-1.2407230797062525074;0.8842153410450057649;-0.68001509113231661807;0.2830501247263599307;0.36478730818019489135;0.022887356433462291427;-0.50185475901515230746;-0.68804602067188103121;0.40447957259148864528;-0.92680720143963257751;1.0938854459558517984;-1.0755440584115527614;1.3596941844620307194;-1.6407139977747251525;-1.9412621236393441393;1.6829614150367468994];
LW3_2 = [-0.79962849218366516268 0.67342011824834124845 0.64725967723051025526 0.35275298559015827449 -0.74222788590626476157 0.70482009444998072745 -0.03465450964908614595 -0.77962855073172676601 0.21554428481683857166 -0.48244783194540530324;0.5657176057668162894 -0.076063295426226765206 0.50877543938198777074 -1.3093683718151039042 -0.31844955255120649396 0.66608049387107959305 0.80420522189440946104 -1.2730900832850113868 -1.7114936232347024436 -0.20052906343402371325;0.43919257617289819695 0.65857867390503721516 -0.13133640390324685665 -0.38142367456528225578 1.1697265224117037175 1.1293175661251932951 -0.45543285264907618082 0.51689647124642212894 -1.4988153339902949845 -0.45343781566417618034;1.0996172131015009565 -0.63239949589397670415 0.68982070829765163023 -0.64714868397051683591 -0.085444752076613283975 0.37638330106186529411 -0.28508484848963422387 -0.72849114504682255244 0.32953487293858763074 0.43103539371528287738;-0.25228342601027881065 0.81083205054908658038 -1.2049348097295553561 -0.55099926898670936737 -0.41297500588839669566 0.2674952250521566155 -0.51657033877576041814 -0.26287053672197774334 0.14976500757187100055 -0.53875158637520503824;-0.10781878409297487864 1.0041934303946951079 0.57924206336391548255 -0.52878383388411953625 0.77421704024355963991 1.1587874334972032564 0.62839694310205862493 0.21465647913858235118 -0.278090546693573748 -0.16233589130307876647;0.55157711818112464819 0.56121317179035778988 -0.40288132361171569151 -0.88205966069768315663 0.47918814811791426989 -1.0698588795073658009 -0.80626310356531905033 -0.28103850905943100758 0.27758746744820650409 -0.64569361037689410043;-1.8263219291200682992 -2.4456472208388531087 -1.8791035776818050262 0.047880345626033805895 -0.90536273497673991351 -1.4316364860187495989 0.56855897717096326449 -0.073321036771227393603 0.43900853294567088181 -0.34230318836466444576;-0.1656550722681915111 1.1120499226682050153 0.77171643697625469382 -0.29217829972245112913 0.39914824507251667196 1.1056505024333660447 -0.38647151572573379408 -0.45879618171710656593 0.32741635278711456181 0.25167103080029107343;0.80801729306374192596 0.22123850736468597677 -1.2291427567136137267 0.68855560320774178429 -0.47172528383135614582 -0.50496766724004815696 0.80583839992608741198 0.48623308222722066985 -0.74802497634975295693 -0.23588419510680966318;0.062980771756648401549 -0.48834428757620440553 0.7407711882463146047 -0.00072723333840432613506 -0.23871952548573791009 -1.1657351153652102393 -0.95578255973793757594 0.53370321937275644331 -1.0275939248276333426 0.083569578723728804581;-0.46705555014773919575 -0.92446232679549089628 -0.22352243455716219733 0.099834687109329620092 0.79978284996496185055 1.2281345930626275109 -0.32226272557671559182 0.69087070710414766328 -0.63455924624965132086 1.1091527494444461954;0.34957881262150641843 -0.43764904992027081621 0.49525069519482117775 0.057759535566941369589 0.10136027221545881871 0.75925691307396803165 -0.23024427174931141882 1.8709618895982906839 0.59283487007545176972 -0.17628245073127152276;-0.89961276662673295146 -0.83251231566016625774 1.0446793466158541541 0.96695098834059134418 -0.40223178338628279294 0.39559548747477307762 -0.6123451755877233893 -0.09072552046748467991 -0.6873887207237227015 0.48949201065527808696;0.088255956330117915631 0.16157233880592600239 -0.46419904990136645617 0.6378658371755656642 0.93221288958688464099 0.99965484543913862847 -0.77965108447833642025 0.056363040581113188487 -0.21111542105129371683 -0.74656684091179725815;-0.305780916760873267 1.0116869168328104234 -0.21925461089349074228 0.021727917188078298832 -0.68046472674095725974 -0.63356238971860678877 -0.50388817266135033091 -0.7439380081656221666 0.40439142358482810247 0.73125000067050549557;0.066169367095251521715 0.65610968628102672717 0.5340438278306852693 -0.70143404722726354628 1.0830160423851682427 -0.36239080540169482658 0.68097657271270883861 0.54976612378776379408 -0.17019861730313490256 0.14679189032407410909;-1.2103789094257579873 -0.50080591715260869279 -0.26728480756187766865 -0.53619261832408371404 0.73045651844274317455 -0.96227077670468141868 -0.37086589238624523279 0.60724595296247807497 0.38030467335747175639 0.34723219675412336782;0.18780421556341936329 -0.50821774883413661783 -0.60633003237516402972 -0.73773259061072815612 -1.257447514291282209 0.13472847702547938176 0.51566216054061797536 -0.62942079790758420632 -0.061888283454974789277 -0.56754936298299818453;1.1502802244444911839 -0.57178648091941941534 0.2896545451408343852 -0.3477598278849061697 -0.42326154156706546905 -0.50012296217977714186 1.2943675571436494831 -1.143205444833172546 -0.43856037616788606792 0.25714417752240942283];

% Layer 4
b4 = -0.42793961284814180379;
LW4_3 = [-0.10247680569383668669 -1.0478172298804859786 -0.51306984326808680041 0.067164934687140395719 0.18263579729748585789 -0.084763984826340593726 -1.020075350907249323 1.1730888194950050973 -0.026053515229425432825 -1.0259919521170499657 -1.1323152739827402335 1.0432437782636014845 -0.80106019485899493393 0.84284949597734337701 0.69909804533205299748 -0.050344492746691990592 -0.032324178179424810364 0.67815610817962779233 -0.85172734384304438215 0.66723902095208453833];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.499999999999991;
y1_step1.xoffset = -2.00000000000004;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = tansig_apply(repmat(b3,1,Q) + LW3_2*a2);
    
    % Layer 4
    a4 = repmat(b4,1,Q) + LW4_3*a3;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a4,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(4,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
