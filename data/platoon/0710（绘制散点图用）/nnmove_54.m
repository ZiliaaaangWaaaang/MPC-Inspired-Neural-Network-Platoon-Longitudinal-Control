function [Y,Xf,Af] = nnmove_54(X,~,~)
%NNMOVE_54 neural network simulation function.
%
% Auto-generated by MATLAB, 09-Jul-2024 21:23:53.
% 
% [Y] = nnmove_54(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 3xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-9.8820989364874;-4.17631009264064;-1.99999468395731];
x1_step1.gain = [0.10151410520026;0.23976556688107;0.50000722551666];
x1_step1.ymin = -1;

% Layer 1
b1 = [-3.8122457299752809945;-2.9789393380809676692;-2.6544765475423046652;-2.3038974871108357512;-2.2433808955649978678;-1.9566359285739716167;-1.9425294543427717997;-2.2881921530709816714;0.17034965698075141272;-0.64299460973409638953;-0.044177163119582835149;0.016025401460817420562;-0.53749025773467951073;-1.3735185154543267938;2.343966690920480378;2.0511231660516426878;-2.2741043142824226564;-3.2644686290114299787;-3.1496655568523372892;-3.822715935041358648];
IW1_1 = [2.0900781033447821677 3.1349379484648070004 0.30342499920136228875;3.7194570621864135873 -1.7905477934695228637 0.2208010866025129082;2.9329046389585267107 2.3947909742110793374 -1.246691577253888461;1.9139443214591851383 2.7920273840731262283 -1.566738235065938456;2.376361713861658842 1.8995044205064570697 -2.4177166068618536343;2.0924467949300131764 -2.9773586753839200725 -1.1393681733790324007;3.3947252349870318255 -0.45887007834171289478 0.89795136800046304604;3.5191718810514664995 0.010103604460100732224 1.3991233894230692414;-4.4145770351817299471 0.6409347535335182533 1.866251521983652184;-0.20522795796783657729 1.368314342990853083 3.54632913328986632;3.3208224710227196574 -1.9721285554375163063 -0.38066434442205437927;-2.6006245791561375391 -2.8458475065693455974 -1.0301294978555055604;-0.99678663508117526515 1.3581814377675802685 -3.4028904458891777729;-1.4031783182565984447 -3.0262439330323260833 1.9810252022404151173;3.7369313273385231788 0.15999724729368719478 1.2660266574457390565;2.5330052884281739622 -0.62019781821189912119 -2.7821059935270189278;-3.0526773633158712506 -2.503723622117705272 -0.86990732189025588017;-1.7766968003716432367 2.6474186923608500344 1.540254735932564234;-0.64459545364131554113 3.966891549544261597 -0.037331813062565048777;-2.421089086708732907 0.26060758866569039283 -3.0353674793211005145];

% Layer 2
b2 = [1.4417930235832603358;1.2188149597005764058;-1.0634697636870709125;-0.76343903248563416142;0.098871345329801657575;-0.25552061083977001266;0.5134622053625799154;0.9317052549006701323;-1.4034145853104276203;-1.353174625204082604];
LW2_1 = [-0.27340750423443715977 0.66512623674404280916 1.0923771889139990421 0.44408599013398791788 0.25910173347142118061 0.10188271146840621739 0.54361476540760744758 1.3746984599238534219 -2.8128781341854782738 -0.69881160886844184699 -0.78875864539984996693 -1.4668750541787971553 -0.42685713263300151254 -0.02326912647059754119 1.2085271525146592531 -0.0053660298161371782627 0.3258128348772092453 0.3551880187089611618 -0.99514061988372481959 -0.54402432477225659557;-0.37835500786671255602 -0.41002361645492690911 -0.32766076431123952739 -0.53097442534133165726 0.56608240636387596734 -0.11799883023817642203 0.37060256834191640518 0.1671241243004582544 0.19349167902627092963 0.26458015560032432933 -0.24534344466077478986 -0.0049251746744689373428 0.23730263783810495726 0.73954916988274577161 -0.32521512909596478336 -0.38107746326419722482 0.33770820395723250007 -0.30284759620436796368 0.035948790307984597459 0.54507284056661375882;0.64889172333857347841 -0.45830621282553352103 -0.18118314830608411858 0.28684131694062087181 -0.097404545400421774226 -0.23254030596497873851 -0.2443278988475817981 -0.4420043916672665163 -0.48568845905328822399 0.46481305696816094253 0.42208912847021429204 0.89044594556602163493 -0.10651167018250927432 0.39429571684234804296 0.95643843945927131678 -0.092838891825089725485 0.7358505328908858667 -0.078502887386160666305 0.46031685955943973942 0.054918551942988724779;0.68390448554120708557 -0.094772338971206834812 0.39126501102325506043 0.025614836973646880336 0.10947178603243899742 -0.58342615840287070927 -0.43797054734084389649 -0.49814646761210962245 -1.1101716866219355495 0.085924231205501605535 -0.57858609433556140722 -0.25171888274429976562 0.18521627552612177081 0.51984793045279176216 0.5517479412680409423 -0.19395175191733540765 0.31673265610721734742 -0.021367277164642754783 -0.03470083344107169343 -0.7612695231695486564;-0.30448096705047655863 -0.037032656836345725915 0.35415077072763112565 -0.21695342300792772039 0.34252820246140081029 -0.90111537587765411228 0.012851629674126893027 -1.0639500312425413941 -0.34355858072550632398 -0.055067188694071039778 -0.14667251096675812394 0.44957815068893641763 0.084879425715912379391 -0.069204113977578543548 -0.2094030589827401978 0.047870249451454821576 0.55943953359874531994 -0.12217975852363742451 -0.34977241082248283766 0.60445724549170076756;-0.13585392281785543811 0.48522671063630706811 -0.093288434004435413782 -0.99655243937494464301 0.26850721215026235322 0.016569699923984139434 0.42883075460204345131 0.77517427650135628525 -0.38196258991651227399 0.11504870608734313331 0.99138105254524844234 -0.23918224695521350665 0.24437818172446518217 0.47883915932001813731 0.5745329037259280236 -0.31925917946630494315 -0.36237606192650678727 0.30220724353679351282 -0.28809700683660777187 0.36939284017843598829;0.35818723750826864105 -0.36978833101148600448 -0.28609127340993184552 0.39714043011727262478 0.47347596338146030748 -0.036914024121547900359 -0.1128561016593809252 -0.093632650049951957061 0.68371823018720667697 0.22514072884533087304 0.06458063173724262751 1.1865274568239245756 -0.37050793086766503626 0.34457074216752964224 -1.0979253570383777916 -0.043250031882652653636 -0.5133668691461422684 0.51040046942346517511 -0.057301217497257563027 0.2780841896702525573;0.37014246816978146892 -0.19376861678522647181 0.25003025524398309054 0.41017051094652035026 -0.46293311116682411832 0.15940747036242572388 0.15350940029003926068 0.65829630862677901426 -0.20819417157176958733 -0.10426916339900277331 -0.13115945966975159354 -0.85397962265886551148 0.59126383352648315128 -0.43987556935964861049 -0.2051356863405797426 0.35151001604285220248 -0.65111076949426549554 -0.44649403302322399067 0.17700591221408845666 -0.24996864483404321322;0.16331758205512003634 0.82513354776385328115 -0.12413135505645123136 0.3189623401707411543 -0.31609355595149740692 0.24319365340010826171 -0.66269293438508958261 -0.59753393673504717754 -0.63456062185606665338 -0.079015260813458887412 -0.028743895850490818605 0.27529535005810623627 -0.25562797993052027712 0.069770714035355299587 -0.40607361358925336825 -0.048073400103364152813 -0.14610307455833701495 -0.26421931543090015904 0.72552148179146247475 -0.28677477367567166811;-0.73484880529563567642 -0.32766935018523551948 -0.60437051698400001687 0.21375309563914235422 0.30842697533728063997 -0.082482510124876950997 -0.21172815870217079337 -0.38561396601295405695 -0.034061783152984206891 0.088141259784852279968 -0.041364745156039633978 -0.20164312705027784278 0.27359908430398882651 -0.72599791222758558451 -0.78717968610045441213 0.2272646613857193798 0.48894869637277560415 0.038813864786890993341 0.95094784338352322806 0.033738871269906843542];

% Layer 3
b3 = [1.8889574781277707061;1.7681965866017441691;1.5814982034791758014;1.126891021112054192;0.79107517645745817347;-0.90784140200619900529;-1.1141108509282624528;0.72138647096068575504;0.15887546076243216908;-0.28602714853679578333;-0.1290807549875590543;-0.3091888393928959311;0.54186318054193038929;-0.73031214455116044704;-0.83161260104726353326;-1.0022355454202553915;1.0932386136291778467;-1.481770033624815408;1.519425882763336233;-1.6980575995410234214];
LW3_2 = [-0.10467913937200606922 0.71805378262076213769 -0.30655786864577660999 -0.82711756159139881994 0.21749582469645872829 -0.75540312312555035756 -0.084531782517804590626 0.13466376985614003647 -1.158254569815458046 -0.52949676503495302082;-0.9895482976402431019 0.16137190739471771184 -0.9059460589106635986 0.18871880394547738136 -0.38792897475619808612 -0.4475637256281294607 -0.99790444111577270014 0.36588420923252940042 -0.19091690061562605063 -0.44034455529106275584;-0.92830823917286520164 0.17676357916634766188 -0.0453178165265904348 0.086415579887958560157 -1.0718551466056682742 0.34458318547090821538 -0.24733583334212241867 -0.2212627724746007718 -1.011028143151813552 0.70904372939245496887;-0.63275764549951896143 0.22790695429309548725 0.028864433640024986238 0.10233255124403872749 0.28145951943847707932 0.67328425779647360638 -1.264082070397786417 -0.033710379437970193484 1.2214503107058276576 0.32787574769126326402;-0.36108070461000452145 -1.0532541689026815313 1.5978298743061987164 0.46705587451881519501 -0.49997115895101701399 0.66293680926386155949 0.52192478995549651533 0.0050671497727551445545 0.45236544114743232337 0.4191622294002833593;0.87873742075791039241 0.63970457362761279363 -0.23421135652968239071 -0.54047613320024989747 0.38337309373706579541 -0.31736184841302317317 0.53122628332009580454 0.58216972465088867583 0.72788679795899424718 -0.66915531956718032891;0.53364687964361556816 -0.95065378113691234585 0.65800692147217798578 0.54220447993066478443 -0.3132637254557306683 -0.3350039137585947846 -0.59144799170910933306 0.52858441384588294998 0.13925538181346902578 0.22511454293331642496;-0.62958939988627649065 -0.34451598069936173463 -0.81327423290448996873 -0.70758625271048924965 -0.68575914309701668792 -0.74604876541449038907 -0.41066017420034717222 0.16201112228334871301 -0.30851762201876925529 0.82324225791377503292;-0.27907370738624898143 -0.13303854485571089961 1.273866418475175788 -0.87855250182708910511 0.48191082582841676674 -0.78373360027127869643 -0.25001288669070476089 -0.709213168073267064 0.36638298910257205421 -0.69304370627203593092;0.80316744534031303537 -0.11814400385121621995 0.8909900953688153491 0.45161839094384864657 0.62595173869225384511 0.41979354410600011605 -0.7262463263432709093 0.81589894541951368812 -0.45700047121875309042 -0.61863466631425845232;-0.26588740666340648922 -0.84730286084679595771 -0.34571606836487966952 0.82791814168290667197 0.44887474982088654274 0.8822939483802748617 0.14874365236307618421 -0.24185333587377499942 0.81789783078353983647 -0.6646256057428927555;-0.57332249657161915568 0.89726052318058180379 0.0050198465839914451631 -0.28134851400325489035 0.90549718847069227134 0.21939603636260510133 0.48243365531626430931 0.50281665876816139527 -0.49301667433648271865 -0.8589920177061707296;0.57741973531594770197 0.82403041456212844373 0.94663726108137336013 0.1089649042392545758 -0.37670173838949916334 -0.88596084823462362134 0.22769029806359289414 0.24341248718019775632 -0.15427501000884938365 0.72950342572937176833;-2.8480929449784126994 0.81945931855087050799 0.19379041309415220851 -0.97923140668978381207 0.60235765764125437371 0.80509943676731399176 1.294581295888955319 -0.54272562181172367968 0.62438408353786878369 0.44994906939351547726;0.37933548420140150714 0.48453589103540445349 0.37571639191054978513 0.93252594975924896215 -0.68209444827583065596 0.84641307760644013403 0.58958775244447358954 0.77497619121355809657 -0.90769701391677548585 -0.68871267856002926777;-0.5400462885391307255 0.35219222895642254834 -0.71273556063709708752 -0.99932907196918907555 1.1910345324751596685 0.47537662896105892241 0.81611420711155979735 -0.98957644742235240098 0.22149106538070068018 -0.2397585774807367287;0.93542667116912459058 -0.59239100926804000302 0.026036805388879407513 -0.17266955833576644319 -0.74241374824360295559 -0.056184057522955341279 0.62005593636278277803 -0.92461737275324640262 -0.71480911811356617758 -0.13762822711974850853;-0.3021389497002160418 -0.50965733700247728422 0.79100179980661200485 0.77843326692417280643 -0.99334797472875435709 -0.27624169571954904079 -0.62140348591242422494 0.10022207618423999154 -0.69635171309524657168 0.27563845284555149595;0.57046043420362857468 0.20831521127082272549 -0.67223875076078232205 -0.63033893964310727664 -0.72157683897542135298 0.13537793532869937807 -0.9541082668338698447 -0.65865738684296348815 0.098662665323310333454 -0.80758335880175868837;0.15454965417840599295 0.83072129780853898318 0.00088718819520476502154 0.01727946620130221822 -1.4152113495515463715 -0.42391918884884000063 -0.21497525044627907587 0.75440446499775259959 -1.3445302121032163267 0.15655603169959242393];

% Layer 4
b4 = -0.89612964666454753004;
LW4_3 = [-0.44407834860580275294 -0.67270070525423286689 0.57295533130344022954 0.34639800673726584002 -1.1119886955787199323 0.14920609032622517143 0.7238916500428099754 -0.74075558597853397025 -0.96315040058919099142 -0.54573392283899446742 0.18379905900658871643 0.058512319346961154387 -0.24525777207861337859 -1.3705631286017250225 -0.98638701860215238781 0.95800017174941798359 0.62014933371965874631 -0.66706234716830081766 0.67220783157931973673 0.63606339652789167793];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.499999999999991;
y1_step1.xoffset = -2.00000000000004;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = tansig_apply(repmat(b3,1,Q) + LW3_2*a2);
    
    % Layer 4
    a4 = repmat(b4,1,Q) + LW4_3*a3;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a4,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(4,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
