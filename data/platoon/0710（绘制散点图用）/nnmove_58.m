function [Y,Xf,Af] = nnmove_58(X,~,~)
%NNMOVE_58 neural network simulation function.
%
% Auto-generated by MATLAB, 09-Jul-2024 21:24:00.
% 
% [Y] = nnmove_58(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 3xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-9.8820989364874;-4.17631009264064;-1.99999468395731];
x1_step1.gain = [0.10151410520026;0.23976556688107;0.50000722551666];
x1_step1.ymin = -1;

% Layer 1
b1 = [3.873970208299203577;3.704008288804680582;-2.6056868618477251331;-1.9401544643818107172;-2.5663006306503035603;-1.9232308919891190069;-0.65036039233700659867;-0.74557174349881671915;1.3584735181773941459;2.0638348594731343866;0.093190680607491388487;0.54012017816327062558;-0.97673712339256246739;2.0858700227313762277;-1.4957451251304627604;2.7306441367072231685;2.4379934718756945955;3.0992059446570898729;-2.9581739986999653347;3.8816069586700909788];
IW1_1 = [-2.0243196561302654324 -1.6259446129056607244 2.9213468293428705991;-2.325273256613106021 0.36113824552556139658 2.6958002146910118313;0.42981599157063388184 -3.1127885224459346247 2.8380482583334472046;1.7855099024268077379 2.7556820503778989284 -2.7815221421438947047;1.9577600693619237049 -0.95835442350436816916 2.5322919136270338747;2.2394716606910836099 1.1135305328649462986 -2.8912214361540011787;2.188765786952100445 3.0598212846889225602 -1.4653980661895900095;0.14387696108203198997 2.844796837532872491 -2.4482921418403846836;-1.5763283018206830643 3.4134074723326079948 -0.66959059294774581073;-5.409405161582745869 0.40656484445533869199 -0.073967100575967836829;3.9684939171339972397 1.828814177878772762 0.13894282905415475393;1.5277286781592704923 -1.7822542859085086508 2.6202907908579038398;-0.38145393897329726851 -1.0756420840412403983 3.4871107197215347462;4.8844242631825656176 -0.55115142604668898585 0.18243264043435725164;-1.1949603964860691097 -3.0307694977665033953 2.6322144538196581287;1.878903045112451986 -3.4271089779402572617 -0.010637000818935872862;3.6557859651859816452 1.4047260568169321893 0.77123961155033293746;1.824288166227048924 -2.1451489511682755307 2.46729259192954542;-0.1163290516935516633 3.7335196933286645127 -1.9039630917012191347;2.4351770455028249884 2.5432209411033923629 -1.2031747974236033372];

% Layer 2
b2 = [1.7343501243942773815;1.3700105908919797404;-0.76425030369211810477;0.99820722983475529411;0.2357663200744327392;0.05529730694957257775;-0.64440578931121539341;-1.2522538063304613498;1.124001741852531211;-1.6486470008177858126];
LW2_1 = [-0.27595095812455988638 0.48494476667278824111 -0.012192700314461676209 0.15574487964564315279 -0.20136131614027746872 -0.98078766723630617097 0.38107566656204749922 -0.46284542750096746566 -0.28351553885733876692 0.67270389529708574106 -1.1441135055909303908 0.22289279740119816164 0.20204504544776566433 0.85008307238115887738 0.31034175970702365666 -0.17392920064309355666 0.42055726609241911307 0.030003691138995841614 -0.32910879023017519662 -0.33837025737162940153;0.2630712717520456434 0.59208249573529614374 0.46237880138345505143 -0.18751761926257082269 -0.39018048318036141486 -0.076102364482960149772 0.38631592204978953964 -0.32655274404062040183 -0.69585424403569251517 -0.36035408807602359316 -1.6389272605359770374 0.2223947846353069302 -0.052772093182825163815 -0.32670332654505762626 0.47063962217614313532 -0.92574256699729473574 -0.39790120066017958811 0.35157899946056703211 0.39958086555753891123 0.44335214439066361614;0.11053419996181908236 -0.55452915564724858388 -0.088058077241550999914 -0.31994763443744306253 0.033203485542920477269 -0.30274894125360096719 0.19823017945813684038 -0.31290090667666331514 -0.60276054444594839854 -0.22853740573929773316 0.056247407571884636135 0.058225488817195525382 -0.15368980545198068777 0.19076057068571372621 0.48981792271342516898 0.85401450341742590755 0.36134179996504556254 0.19274960148978501073 -0.68819467461429895128 -0.37314745371305257926;0.29712709633138489895 0.63093522195524431861 -0.42028710388218137872 0.60850507347847770934 0.936578036642072842 0.12610140878649303553 0.20636702681992966091 0.19995558121731477064 0.92181243296881165694 -3.6916098735421152277 0.68566190154697903569 -0.0420867364384983067 0.024259500086612005576 -0.18116877221049082491 -0.71680486010665744878 -0.1895017490776382818 -0.38366191048191194968 0.0010901150551402439409 -0.55507588854463607575 1.162120652994750758;-0.62473268505046086752 0.45776422340325489957 -0.5110970299324186783 -0.76418039714943197804 -0.30649249799019606666 -0.75509857030207472306 -0.32933464678018964378 -0.045640276815472481664 1.0659233499341211893 -0.82058920129581136571 0.16514942065532078885 -1.0168148752557442105 0.27271708636983232887 0.53655488274495144463 -0.10301794099440680919 0.063435446072959061903 -0.41662351905279815245 0.64404356394497075389 0.32376831397614547203 0.2919001523776804663;0.065205349247424243542 0.17459451280211676916 0.49445288154206801234 -0.20557097170239560513 0.47637001807905826611 -0.64889311720145392837 -0.052661980366730046232 0.18643347903752305328 -0.37398923252802690476 -0.48470348750206082578 -0.60028410834306344945 0.250098057282681141 -0.08098940640464218077 0.094087313077940909478 -0.33059490031087052087 0.58248489998067487505 -0.0061579371549181265502 0.080582284249530164444 0.15191402486595162458 0.12206213224937993711;-1.40095325864271536 0.26104555343435248416 0.59739761043329653312 -0.23552453064221182122 -0.276452352859027084 0.13213798673836260611 0.40730498176765067564 -0.7756194719359701395 -0.81993661462048972322 0.48580631229037679608 0.19540305635812918461 -0.50496833140022345798 0.003005657956452887497 1.5737933375116384127 -0.088614903439900014059 0.73719186332660524563 0.48516681692253116331 -0.73875495758923315215 -0.18739784430475617261 0.27926870375780527;-1.1403865209404051573 -0.62300971647560132727 -0.37069592701371284482 0.76612886671542446138 0.11538839065608219592 0.51843535101298388046 0.039394024029463674264 -0.2118124118152565627 0.28960143308698882425 0.18181590415218584766 1.288532521994048663 -0.79525680818558830421 0.44588106918435493897 1.8617579600230256265 0.30277868091436460629 0.83355147768382686913 -0.49003648403393812449 -0.36188758742980414729 0.97550851900142432349 -0.093741746439042816785;0.15833745556454228987 -0.54124469267361630109 -0.05880106252730148142 0.21330213789573557182 0.091416088646002258145 -0.23436934142615076238 0.55380037095771839084 -0.5899151841959971998 1.1363657838595311311 -1.9113859492386082728 1.7371733804492057729 -0.50143728777076801428 -0.23069298921987718698 2.1561858282518264751 -0.4791273654653553371 -0.25758647356851721577 -1.0533117407032042134 0.99471308948239500758 0.1720347086126094438 0.16685110356336016468;-0.24698715029872753135 -0.14151340794180100602 -0.35981023781424398278 0.31195379433416547954 -0.25680818466706090142 0.64476480012864867408 -0.4901698565461829471 -0.26503038358343078418 -0.16684879805579000411 0.027515627482416402799 -0.35978242116020203722 0.16648361327586891356 0.43661821552937812863 -0.3590615021724705147 -0.48150236366098181362 -0.3283678213372740462 0.14892552646912354808 0.55773528782254822023 -0.16767687264712671791 -0.54242355383664664359];

% Layer 3
b3 = [1.982725984831421373;1.8026486584448844219;1.3660840554436721739;-1.478979208722460692;1.4909547888682157524;0.52519184307154631597;0.90771875525958778397;-0.0058869304194823675325;-0.48635291529068508387;-0.049374217339017950623;0.060021756495820234589;-0.044565898107056259314;0.46263690898706483212;0.8724097569319642087;-0.85238045475988055699;-0.99755265887856270357;-0.7143932052965072943;1.6430362028360361304;-1.8110306032882956817;-2.0027221977477420722];
LW3_2 = [-1.1320775180153486161 -0.54394035175897215151 -0.79677917266628306425 0.61425639897801864731 0.28172966801217480537 -1.0161186095148724284 0.50890885673559427271 -0.74149562262104640187 -0.098159971815802216089 -0.35846816209682519361;0.016349907662496034055 -0.34369190619348571891 -0.54803346712201206348 1.2374807777792551367 0.67805686036857026888 -0.776906853233808814 0.0043235571333171849903 0.44339462119977790522 0.25135296986907795791 -0.96541060557968394473;-0.82149717557184631644 -0.0090344667842553096765 0.062719712451728332203 -0.74798245083303738223 -0.78500393667325352176 -0.097577107405611679392 0.10409049891536560628 0.041516346455214916955 -1.7772936931823777318 -0.23076038249632077615;0.58255228630338118379 -1.0187204324431335944 -0.12521184741081226033 -1.1401156264617242631 -0.49727065328145991785 -0.44050349290961343662 -0.49206978677994167581 -0.60845420705450103949 0.74885210925100820223 0.15528374782535808718;-0.88440172948912043616 0.51997216562856374278 -0.1594027816303153211 -0.76924784024341796851 0.045326050867342849993 0.37024533964089839655 -0.84613700105735256685 -1.8060937167946611304 -1.052801694607926164 0.2286771961772131323;-0.69245798871181529766 -0.13890594384032708963 -0.15108378316212961456 0.093215039383209033486 0.61154097193770839969 -0.58311361309899745198 -0.87915556573932185369 0.74388683513083653231 -1.1838976021855431853 0.085626411719586417726;-0.084568618040830517701 0.054087622917787819832 0.62455525029902525525 -1.3966415950123123313 -1.2920875998745884328 -0.45652601531630276899 -1.4892256711128069036 -0.7093263081746498111 -1.9858949469354088002 -0.37794135101887582628;-1.1982220183717438022 0.16200700702261480735 0.33607841309780317474 -2.4386943688104727457 -1.5093936932749789648 0.84762986069973522696 0.83773518926436807419 0.68550753468655789558 -0.99314581228198861584 -0.27359304237655091008;0.2109340831744946354 -0.62253600224614402681 -0.76410825812679417091 -1.2662736889649075511 -0.57382355513653815482 0.27903544214055792105 -0.46041617160784004126 -0.20936611433529742077 0.43785877389662936077 0.82592238183843302846;0.039309819744166862865 -0.28093014018807838106 0.66596089059278651412 -0.70267349116629940209 -0.7270578009849656409 0.77661992377158595158 -0.086635025140070820449 -0.71088301871927472853 0.39717491197583604245 -0.93565254816450471598;1.1756843640617267166 -0.96449961069149203752 0.16274081871735110449 0.33392158931206578076 0.45299342685420890264 0.37095051307248178007 0.77405820089343735368 -0.020938093749843289526 -0.14801815449895022736 0.57352464086950860622;-0.33826755658721285869 0.70755977891190857676 -0.092660467971199395043 1.2085213813445034869 -1.1123098355020262229 -0.12070173814423224012 0.12924271599522357823 -1.8523599371979262429 -1.2434495069455735461 0.1758835333874526341;0.50011943134535896682 1.133653311914663453 0.13035490243260944299 0.28478990082807320583 0.34090095149906746164 0.56526028091619717753 -1.1442826863336517107 -0.55556026045943973646 0.68033735146620433198 -0.28096446073950720468;0.58434937764182681708 -0.67632090170948677699 -0.73411426250511357949 -0.51445831978264844331 0.50997222665634367456 -0.10059848238450971869 -0.74236905448427781273 -0.67102301017211152256 -0.38651328697748010832 0.58267320585482873518;-0.088196742584845694291 0.050206269762388650024 -0.66570557789740658627 0.9278189754004200207 -0.4002657941215596038 0.43958597901287044252 0.87403993812069669112 -0.55292136875998154633 0.70065502469738794034 -0.083669118368433770261;-0.53027132241149599334 0.70942614752182364679 0.474499023422740418 -0.61217857174883572036 -0.14355086654048862527 -0.31132780493061085192 1.3227784629403800398 0.81713162023510277354 -1.0750619034033985777 -0.46808561891376310182;-0.35482078406455097586 -0.8747385126058246918 -1.0196067891957516505 -0.68866412306430846435 0.78217512340277950411 0.39170814962385241964 0.90085221711167950964 1.8711420147794151081 1.1312147260606402188 -1.0817766611370394081;0.16125183582079824496 -0.2517385410067364826 -0.98371368590308305713 0.46927830513691837222 0.26625378847885172728 0.64008521310632704449 0.7994496110751750928 -0.73777133928733285018 0.46388138842740012091 -0.16907327384538667348;-0.49893734867643102504 -0.42570591790674294774 -0.72632647970616537325 0.044984976862039234569 0.045195784345881728772 -0.51559013840530554251 0.64113477394668805243 0.1917288367738090582 -1.298252807103833284 -0.28877990017536070422;-0.40617269996555105394 0.13517991514656169105 -0.35833340418443665465 0.75030027242879748783 0.22301857780635314654 -0.094475723906085051773 0.73321750943615460194 -0.69480995500790276864 0.80176152980699089134 -0.70112321175429548337];

% Layer 4
b4 = -0.19246836270533612678;
LW4_3 = [-0.75242551246527433761 0.14876644057585203251 0.81493556332675365361 0.95545173408849459751 -0.63921554300961935802 0.58694382562376878898 -1.2941179290333566509 -1.0244969528288740968 -0.40986404861587832915 -0.031061684132105055189 0.079665780405318450952 -0.7784185092982879306 0.56820794922967143847 -0.17345312038446220049 0.19897614374462255227 1.08483298406935047 -1.1034505630016395727 0.5004654255166447463 -0.32393996816696046803 0.28201111482931323637];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.499999999999991;
y1_step1.xoffset = -2.00000000000004;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = tansig_apply(repmat(b3,1,Q) + LW3_2*a2);
    
    % Layer 4
    a4 = repmat(b4,1,Q) + LW4_3*a3;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a4,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(4,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
