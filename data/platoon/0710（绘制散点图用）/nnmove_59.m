function [Y,Xf,Af] = nnmove_59(X,~,~)
%NNMOVE_59 neural network simulation function.
%
% Auto-generated by MATLAB, 09-Jul-2024 21:24:02.
% 
% [Y] = nnmove_59(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 3xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-9.8820989364874;-4.17631009264064;-1.99999468395731];
x1_step1.gain = [0.10151410520026;0.23976556688107;0.50000722551666];
x1_step1.ymin = -1;

% Layer 1
b1 = [-3.8952267863850025265;3.6442847692608140164;-3.2301757222382700974;2.671685524133790679;-2.2464216281122815211;-1.0935199143947809119;-1.7203521454095034304;0.075942674929849920962;-0.94198632138571869454;-0.60370869245252278823;-0.74283364875898461044;0.28045186037698793813;-0.66785796829438048849;-1.4616561110477181984;2.692880298059641575;2.6269494952596188497;2.6545425682201457818;-3.172766921643157545;3.3253119811455040811;4.1131518183123736421];
IW1_1 = [2.7879549725156866913 2.4249424085278010743 -0.34832048675233839852;-2.2606481735682151246 1.7056254572827915794 2.2631086622100489159;3.4263608090526971317 -0.50733464152421325899 1.9520741193110913159;-2.1775188293253688876 3.0484482554578837821 0.34690386809186324335;1.8510688653609836951 -2.4633813615719377665 -2.116207779985201487;2.338776960957718476 2.2638611128442494014 -1.4145959795923224167;3.2784483448443797471 -1.8795072789165077065 -0.58206617365643154027;-4.1387364792231773336 -2.1953927851390488968 -0.33858857453332730225;3.4101549140532556592 -0.39051159043714156471 1.8795090416078061857;1.4418189200130451244 -3.3566242774725196796 0.94709395937568108259;-2.454509662915932644 -1.642745948035080783 -2.4643430453466454999;2.9769157281040148355 -0.20874246972982141157 2.3315866500019288843;-0.96675400160544200379 -2.0877235117028507538 2.5684509296272781675;-2.6186204239032453422 0.32984135789967500285 2.6693647324369962348;2.2327731613474273153 2.3675225145496536783 1.7704935757631483639;5.2307935202297661803 -1.1584023099864555473 0.31151793547610129309;1.1499356459625051929 -3.0785647110117295711 2.1216712556493955155;-1.5622779630055008138 2.3073768881317398005 2.0896946124184037075;2.4029661599976375186 2.9646501449713555942 -0.72797686823710805459;2.0109576167521523438 1.8567533661277253465 -2.0478056333589655935];

% Layer 2
b2 = [-1.5888632676477794092;-1.4320693104275135088;-0.85257350814424714969;-0.18054591621125323786;0.44103655088454479793;0.41691357796631040022;-0.26353212176123991251;0.59152989918452392182;-1.349072248321135481;-1.4219429201240416649];
LW2_1 = [0.32080570369515332141 -0.028845926542776453155 -0.28143763032642277189 -0.10636757969023091785 -0.18517443711993883393 -0.3842787294050249991 0.49056427224230420014 -0.48563812336953010584 -0.38872089008726201653 -0.18095825719840000212 -0.039790791884316098481 0.28777782805088641949 -0.079692492138834752913 0.32191224361931231046 0.18033000872128845948 0.47515840437182932376 -0.14544909799283700647 -0.44875177003212363136 -0.51986916033026842054 -0.76361233223225954969;0.39679240741834420625 -0.40029473184774783112 0.2851212841121128494 -0.58520401000448563078 0.41242333103227568625 -0.072105152128668692502 -0.055024384412873356132 0.088603249175477891142 0.2962532329964740474 0.27939223208129182474 0.32673595187903420323 0.41930784493182404749 0.46769582120169123085 0.48141457269258497442 -0.73316462224372591638 -0.40929599304149777428 -0.40287445445986708181 0.015896731486237890979 -0.19027460697167858372 -0.18693916514619773883;0.30666889090215387892 0.5397935878602291293 -0.22743506426967316503 -0.076272139515867393156 -0.55096040722870553985 -0.058655310990552440853 0.34754995722057019369 -0.17112858395914279375 0.1511840395080265298 0.99555482404815964781 -0.039231530177923149005 -0.20170765313417282627 0.39397717319201708275 -0.2354727701233985393 -0.11631588438137582808 -0.24580740955175356399 -0.25423125063906126808 0.35590609368754616559 -0.10361190050173724186 -0.5082087896618163736;-0.11943507636220072887 -0.21093024245997979427 -1.154172383191291118 0.46019447140488151105 -0.25423723372041046042 -2.1682487482044874305 -1.4415699199924039142 2.4177442945108289507 -0.19578210354003333649 0.17908538254926412159 -0.65854611588987477244 0.32632324147684216298 0.10357616440553386872 0.25413257174155085005 0.03341753216233877416 -3.2018345673749131208 0.052079435701496548661 -0.14060140102849116861 -0.068169061742615458255 -0.16824678268901954725;-0.69773975292789225389 -0.14492039965546438252 0.38997586871866851688 -0.030724784294918251054 0.48635827864226877093 0.51158673020965095279 -0.20181251297725727456 1.0897805748184277164 0.39544651204596098504 0.32630266411083186373 -0.51539734747699006423 -0.10561327598086500679 -0.20992260486394714869 0.055251151045780225179 0.18256407600716628714 -1.2333691675110933783 -0.40289848627553759286 -0.14463249426459556801 -0.26473017876895477141 -0.29946391447359177462;-0.01109162032180287423 0.78833873647650376526 0.37670166950823769092 0.11901682372040336966 0.37612599934330520624 -0.44819559377869022665 -0.011492781038908645927 1.3736135418380794881 -0.11068304495384020947 -0.2727000628196362686 0.7342892928556029597 0.047483161527127379364 0.42278152358900211727 0.14618410369289924766 -0.15011025252686210907 -0.31534322645144075015 -0.18096738774862469734 0.1257955141796129328 0.075502849418448175767 0.53566336114847712402;-0.82034123794444846478 0.30140462918956273386 0.50266565437518984094 0.75919941311575789289 0.088119444125394796874 0.13620083698291496344 0.43651611269091161738 -0.7108922111712173697 0.18034200061684291239 -0.30632728394223590618 0.0093621342462347906244 0.10231923949689855635 -0.029931262715423276322 -0.30396180651234383507 0.14588521201956558548 -0.99354136017996685926 -0.25699967165824927351 -0.11241829538976365332 0.23810330104527485662 0.99333337580905678443;0.535066943063021494 -0.55016185433555830908 0.81059640986503656013 -0.40601366465321492294 0.072009900336444207514 0.051148950907668903898 0.44268866672316581345 -1.094174907364310334 -1.0178446062724939569 0.37962968918545775265 0.42809478623704749767 -0.43979631129867807759 0.51139388300868549031 -0.64533097202223166367 0.15082822856274549772 0.84849113120814056987 0.1467239530669731673 0.3058376082489664971 0.50450752931477160779 0.40089703162621814769;-0.31880271823643158147 0.26449285038510866874 -0.36027145614393596418 0.3256340092421938226 0.20636170234311337901 0.069084624546854642158 0.11117153697619494568 -0.5844070725015040324 -0.24646862642192504667 0.51853566188563904316 -0.069508326157448105387 0.79879428316817269184 0.3676541595626431902 0.56062951451875464581 0.39404594173875728824 -0.38046735496634087603 -0.89023484600294988667 -0.26170830403844647094 0.21035757343258787433 0.14956041934520702963;-0.51488440666766077669 0.02357639135754699064 0.072657559247497616184 0.53117821970521039709 -0.56435815220459883967 0.60203781652981946948 -0.34218387234151770304 0.60641434694122731131 0.39090379174520883954 0.80345244868911580571 -0.49845670918480783351 0.64950047710769942544 0.014225697123846983705 0.022195979450056899096 0.34217608318931236333 -0.58281057937022939797 -0.62957849174058555519 -0.058358732362430054685 -0.49180502574852452691 -0.35733927885206134833];

% Layer 3
b3 = [2.066111472123163928;1.5310029836463294739;1.570669314332900468;-1.5761743742383611533;-1.1607083040352015324;0.86374355779692724155;0.39975949747524636146;-0.5614774702751559321;0.25439704316175437704;-0.20755198497050680873;0.19107775359211634503;0.2678041711760387189;0.34465512873078174572;0.64279647165596132119;0.87163750464972866716;0.86299886552890736624;-1.312944774020966765;-1.3579074510966011591;-1.5872283835349587644;-2.0560305873540865029];
LW3_2 = [-0.36937365452036680091 -0.8302415154088833571 -0.57371814615298344364 -0.39883109990441178994 0.76084241008080155666 0.39011541769121577117 -0.82974549758297644342 0.12888389137137712392 0.28844076138567287249 -0.65924886036483565377;-0.0099544453141608667257 -0.46325576808065827006 -0.1604046256658009928 -0.20913039749158335301 1.2280541778765396987 0.2346552858654264162 -0.28012822279637256129 -0.52366920782417269997 -0.98209409949781578675 0.20516460343296119562;-0.45538134967187865465 -0.18706465241685202305 0.53809465932771693986 0.29725860138910065178 -0.65370071711383137547 -0.16030487064083065452 0.33247984919245215929 0.62201143829635252569 1.2421233002625065023 0.53915904221832633425;0.55168478014204891391 0.45829297608511848638 0.60831719159368746741 -0.5770276852527863598 0.36240311548650433471 0.37120659539614020428 0.37549334796643912826 0.57651912399378890672 -0.1865949428713849223 -0.048411800452812438211;0.78613232988549108793 -0.14710713071605099889 0.57553014041930117273 0.30126246002271606095 0.16848827672846378167 -0.60518707627086820722 -1.2070217519116019922 -0.72133020891237120686 0.60748694769593691856 -0.66781259639192669386;-1.046388836892287344 -0.10403374555936220625 -0.27613178168195495754 0.59867609932613352619 0.39539433763157266766 -0.70205917508904669422 -0.56209396002777478607 -0.66668458624150073177 -0.11330337686245360584 0.48061603424352872249;-0.15811692262112120311 0.23550009055168927286 -0.32410479485717125225 0.89856023547356700387 -0.33633673941620706449 -1.1365878642586964009 0.80516902033709525366 -0.37719131345592749049 -0.75972438455019353221 0.32762721950395978787;0.47738799432910028475 0.75886810185753983404 0.26114336017295047832 -0.59721263659195467088 -0.2553468261576665177 -0.11711486020953246201 -0.92885328031398950444 -0.89048940146952237917 -0.46680516479496242388 0.75422044042425617771;-0.51414616510405453109 -0.25526284895870993141 -0.32194475408013950579 -0.54680217887339277461 0.060829261609681578582 -1.2475571994226624106 1.421323391623189103 0.19428241479388697055 -0.93539734700270704693 0.95456977301086631815;-0.48258278402090210024 0.76575931582154954658 -0.2420851218201931776 1.7315482289887462741 0.17161180154184280111 -0.41267508035137034916 -1.4145015727521623727 -0.54344175072149136785 0.67338685178824941868 0.19160364155073111858;0.66888469858579435723 -0.40230601274333849249 -1.1886882802747125165 -2.2762291262218079524 -0.55138121108742954579 -0.701082789527730732 -0.36618735688111681004 1.1642099673988099973 -0.77067630704770451189 -0.558440500567847109;0.48513338545151152292 1.0276812214653425759 0.26840347717268986383 -0.62615027211651819172 0.71167590952494785839 -0.44379110597551857387 0.16012538134081186203 -0.56069318136427337418 -0.17520103923281629688 -0.75519202014689679192;0.3900400564042107443 0.5176027976507042716 -0.23429307784681935312 1.6282551974886796398 -0.32063852426053951472 0.20989400648981981767 0.12941248270980607038 0.60678324131338334801 -0.24428703913190163988 0.61726622270393549652;0.55562566920574285589 0.95217629468368025769 0.21870079840838943519 1.2404825784847173242 0.5283605340488025659 0.65326909373985364571 0.1635111178173175861 0.6425062214948166206 0.62205787840042447989 1.0950084548176530763;1.2476481972535833354 -0.13848727993493045729 0.63998297522661762304 -2.4163595367711168116 -1.4261158275757006564 -0.33158249576943060744 0.4458603371011850558 1.1865452550521473629 -0.62021617885414237481 -1.1628164010622119573;0.2573541685708710669 1.0604849791529602498 0.4606047138264859897 0.25667654539603368402 0.085650608799488978096 -1.2187223898819952161 0.15885278904814267853 -0.31434301256531244073 1.4898023851387272032 -0.029139628240942794246;-1.0582515864317914023 0.57062065046478072095 0.24361625180633988963 1.0800032048187639955 -0.41553716118583583494 -0.29145936819195500389 -1.0652942244079848244 -0.51378561415151646763 -0.22355596892997395275 -0.17556120125940083421;-0.8988289325539099428 -0.6192114030024866711 -0.57508684919873176433 -0.14331279457041551373 -1.0315691105274915618 0.023713971423474835415 -0.82804246604197784265 -0.31795363196523940275 1.0572487754618105082 0.28754514321959800949;-0.50027403228624911513 -0.00073961404935455037774 0.16650815878233041212 0.46703099230465688896 0.634245151496374171 0.90103622873453292907 0.86603491324384196393 0.54200752688608977437 -0.45693601991135779361 0.78148018734930269069;-0.23318479642842435129 0.75801402281396468297 -0.49519127698661480341 0.43742746323182063461 0.97610557129692165912 0.51417135927807677831 0.4522473385258738432 0.37707978422961035969 0.48371913337913391429 0.0092159015444130375216];

% Layer 4
b4 = -0.53399999188497193625;
LW4_3 = [-0.92507879624325295431 -0.28050906326631042109 0.61466893709851588845 0.26914345778452541946 -0.37695116845156567686 0.29108248909577932872 -0.1078470859507598828 -0.53668379641446573025 1.0043985669582118359 0.78628355387907478136 -1.1184709478563239493 0.14259668871344574614 -0.57950777855502566549 -0.68438869474325247921 1.7703038022854831191 -0.15832448689259592811 0.58546510692502473638 -0.03633721365071472531 0.62374778226948712767 -0.41847122112319667941];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.499999999999991;
y1_step1.xoffset = -2.00000000000004;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = tansig_apply(repmat(b3,1,Q) + LW3_2*a2);
    
    % Layer 4
    a4 = repmat(b4,1,Q) + LW4_3*a3;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a4,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(4,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
