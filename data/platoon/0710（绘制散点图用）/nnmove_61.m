function [Y,Xf,Af] = nnmove_61(X,~,~)
%NNMOVE_61 neural network simulation function.
%
% Auto-generated by MATLAB, 09-Jul-2024 21:24:05.
% 
% [Y] = nnmove_61(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 3xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-9.8820989364874;-4.17631009264064;-1.99999468395731];
x1_step1.gain = [0.10151410520026;0.23976556688107;0.50000722551666];
x1_step1.ymin = -1;

% Layer 1
b1 = [-2.946648731703654267;3.3675282199907412561;3.417471646212482117;-2.7901160466391785597;2.4173057143332319363;-2.8006956426923079739;1.5095768750591291862;-0.53581200077636337298;1.3295158666695616745;1.1489060960761234842;-0.26655034168635399761;-0.83806157415385151843;1.1387741569941045583;1.8243384847120973635;-2.0438963713741782335;-1.4469907683512914787;3.8309252586051578682;-3.5629827070885000673;3.538078781787397098;-4.1652092514948870772];
IW1_1 = [3.1738740876212192532 2.4881548495086449613 -2.3170864410000353573;-2.8899877591542262323 -0.65557737101200541652 -2.7208853417057601298;-3.635934697433945928 2.0116772603815094023 -0.98168883809085039083;0.25927004663740360613 -3.1509872912808289946 1.6670484687729067996;-3.0180986538485718995 -1.2007046641307055346 2.2939040155521062125;1.3459714249282883625 -3.2369666860075403392 1.6807875739626414457;-2.6335111126489425537 2.6391278445721106927 0.99381829807787935849;-0.0027863500054148976348 3.671406599634062129 1.4054903236764682006;-1.3625187751025567007 -3.299004949449006574 1.1425453262439972946;4.3635057376080830238 1.9351288603720333548 -0.93972307539086996631;-0.5736774902454355729 3.004311623328153491 -2.3386874899752996271;-2.6858064994763757305 -2.3120363672335004779 -1.6590169463632942204;2.7271225021827647517 2.3981298199437786067 -0.61247220519818756923;0.64044623399153566279 2.6133289486184105854 -2.3454227644305785105;-1.0218163486637998894 -1.0176314970888467037 3.1989624585201812401;-1.6764866058978653562 -3.4645722041977125016 -0.28331726270162749248;2.513506285912327165 -0.40814496873767464047 2.8759506214949523972;-1.1968946885924180989 2.0688538842919053096 -1.9934065803120493143;0.28866727192659535906 3.6473137399710182649 -0.61053342227895945893;-1.1331170863491870637 3.0366379378993313409 -1.7368009951445015915];

% Layer 2
b2 = [-1.5971223687624833687;1.3004281175173155738;1.0143389776853597439;-0.70191708850981648915;-0.043173597947910154204;-0.019769110488719595503;-0.33583338771386522792;0.31989510262841508448;1.4795011916889595494;1.4182624508870835811];
LW2_1 = [0.058640126029827217835 0.076191758375772827838 -0.29657401102422997763 -0.56363335792466362495 0.08741289256690738807 0.11915471045992799548 0.12964786048787485528 0.042747035621805429262 -0.25718323715447310995 0.44042871951954881693 0.49462475388093352091 -0.29432427944126304808 -0.4038883901956727418 0.089971787816796308657 0.47324996645927353001 -0.24877722587096631757 -0.42346423946862410403 -0.8236909874051653313 -0.34574249519316274659 -0.42466297613930020782;-0.47193066930671151438 0.50197229233340279198 -1.1690949363949658668 -0.14573711281927312355 0.65319989077725670867 0.54572029394085808107 -0.50001936286777215468 0.31937651957113954992 0.25726557579957387567 1.6017116988557997814 0.69333651691734110578 0.6605618635130592331 0.93500968436054510136 0.1936215428852489373 -0.13874058958240514938 0.18592089157686780831 -0.56285848012239958482 0.50272618955049974687 -0.081498260495280638871 0.17785528439875802897;-0.39078106090917352766 0.24561277397147590618 0.16517637399567969281 -0.056640257236672250651 -0.17645074688808029539 0.89342637378414480054 -0.32905680813936338813 0.05325670329981219836 -0.07480486326365692884 -0.12335803233865352824 0.3229765917744580328 0.29507186078366537396 0.41240274488406591935 -0.39799428030237143927 -0.26616839656821006388 0.26071612137173377777 0.3510603150492094815 0.013916423941395233282 -0.21713176599257402732 0.24076594702599471431;1.9086483881941891383 0.39206800608207437175 -0.37534242618291768778 0.50824373785376342205 -2.0504301787994507755 -0.17142865494729164766 0.023630526570293207411 -0.26367355600018299588 -0.36207425721885949654 0.60178568962189804559 0.23781005478593536528 -0.61561138463990805469 -0.16399685716626843934 0.080924753801884491411 -0.17325291899119318884 -0.28843929919281352525 2.2860867478085027393 -0.45359934682243696624 -0.19527449402998467431 -1.7791153637612107108;-0.16936373036039459317 1.0906016815367369777 0.5882651012363345755 0.25532871813882895839 -0.67325649309691004696 -0.10174105756395263045 0.55084244092505718626 -0.26948893304593396492 -0.88247390906550526868 -0.27119431102023489055 -0.23916109498409018896 0.32641284515011231848 -0.10714016691980031426 -0.3006144530744519483 0.013905930856532525836 -0.40061036606971744956 -0.73229411995821702686 0.56933653473650147614 -0.21763680084961994909 -0.34586759976976017006;-0.72045334135031491307 0.40210839025645683797 0.2352262588043462499 -0.033191178007662261451 0.091439373957663119818 0.61959152253409066624 -0.51866908940573619446 0.55373773841068363311 0.40142387253536770952 0.59077252505665889259 -0.016920161948166208277 0.012049387557222020206 -0.2937220256714047073 -0.29405887907080852095 -0.54451486541990312684 0.17727360679859077708 0.2200244940385949477 -0.33082165233257598835 -0.12425574696632446514 -0.45287964339112618539;-0.60255056196705114591 -0.84112095108176854197 0.40968577567942904283 -0.16138062353500881585 1.2142948777494051438 -0.185783302268238526 -0.19418823304444060573 0.48062391011037336463 0.090700186644595087726 -0.16093027812673499355 -0.19407485332631804753 1.3064647107941675941 0.20329806987450435574 -0.18623249276623377035 0.17144764112897448172 -0.18932740339568826515 -1.1946166849853439018 0.86980492991089497501 0.44512894445861317383 0.84170651181837197186;0.63983749766290265448 0.33348877867084641968 0.18277284642011501492 0.39600096257783323761 -0.1620191076526507068 0.57321315398928229801 0.018804962223877043359 0.53656435963120585608 -0.15904370303100925921 0.02060765350661320286 0.12762631440229882385 0.068963663853159787309 0.39765984495639944418 0.063372674621173061271 0.268155421367665181 0.064353071713723758451 0.25243936169989650287 0.29211056835275017729 -0.21840592295240629506 -0.35663333607554437155;0.30748483221698208467 1.3728423343084521502 2.7369100051744559288 -0.025477932663380400968 -0.4294375841459920351 -0.81360554247277971918 0.91489210414483435052 0.11003134172113428202 -0.29951670408605418627 -3.1229013632335331785 -0.19687567615476694871 0.034047474690788705198 -1.7671337497127737048 -0.50191596817844774669 0.10188305017007243114 0.84850793577350469565 -0.53341705298392194656 0.31262006328760355567 0.5874344149632961809 0.23351394772438499592;0.68296110486521299787 -0.24291683071255115722 -0.55873539846104669504 -0.70619615487389153508 -0.61959820548976296539 -0.098625653611522673403 0.53250153416038981113 -0.46476778956026570944 -0.2930849627984100092 7.7898708006961074612e-05 0.22110850324866743177 1.2304498784962059066 0.2324187575879089751 0.38253896499361583761 -0.51780132421574087687 -0.3939262902366377217 -0.034166125508070778471 0.13621529953747119057 -0.040800935172304833576 0.26248325625695406726];

% Layer 3
b3 = [-1.9583621139168267966;1.7363416922255658914;-1.4907463248239500864;-1.284573245467600433;-1.1226155667737958144;-0.85114439926784069002;-0.76948997018155274041;0.65176750831946173026;0.31054623362997485492;-0.54440010555159157324;-0.1439899319675105871;0.12844727318963872209;0.43713567053636270821;-0.7933535649471054052;-1.0524615891445381344;1.5880466682401066514;-1.3004903740776816434;-2.3411875005726003884;1.8928008460628622522;-1.8584041649776690264];
LW3_2 = [0.40125625703079542683 -0.25079529578112697008 -0.382129292954582922 0.73761658130120921761 1.4814985375903415576 0.076111839901342515091 -0.89616886705676446212 0.86680696130744439021 -0.3598646222224473612 0.81890911595055693173;-0.32721186123590695338 -0.077024685123837796641 0.7342025663805453739 -0.86382640496463469759 -1.0794684638599221227 -0.016840344476762428294 0.7414517560153469633 0.5992321093498977902 0.11985443437108045384 0.86228346587949933344;0.57871371480332178816 0.57896753964514668933 -0.73629742372030870801 -0.46048946650829730709 0.65421682358297017501 -0.30767852693698760635 -0.50074479264957127977 -0.27399022701323333395 1.0987187023936917374 0.29913333996921964708;0.11487932379708629127 0.8105796198672843289 -0.66537627242144603557 0.22978480678100171586 -0.98941712650297863885 0.58687511027274330555 0.16797570568093381227 0.82729813245333883032 -0.096111224940781309067 -0.65162745558220680486;0.1198196323274691999 1.1703371647405629297 -0.54330579639444875895 -0.48078552688632286705 -0.61947220572738048716 0.98889943138518332511 -0.41705642734722192522 -0.57244204989244518167 -2.2289145305466555591 0.11388916315919420108;0.34141367922125315237 -0.56259981120188273795 0.47801366076691692575 -0.31699602300509327479 -0.3869883461084046572 0.44578372235274699165 0.19091302964293399569 -0.064927553108433372353 -1.2172009117707223158 0.91149564463378496271;0.10446013429370301639 -0.18371573148997735747 -0.51212210784856226908 0.89598078916287970941 0.80828460133322077574 0.5560833571613595927 -0.71299639039123074991 0.63651978299095135494 -0.53944933149689855423 0.68668750763952768335;-1.0636119064053546346 -0.25330126631731403331 0.8957799193400842741 -0.13505800592663688708 -0.018030166662358262236 0.35118319867091551956 0.0041394614201437432421 -0.017218062643826064634 -0.96288571061238770188 0.97504132111899788349;-0.61785018818969450471 1.8292322031225862755 0.42259662613795734298 0.58985956225693525479 0.42629404218139355098 0.89980823012026822649 -0.023682795020503740607 -0.82015105790171871636 1.058848399918475458 0.0016148365327079451659;1.2505377844301670542 -1.0668268794741206928 -0.28084300956402891147 -0.14049281525622647759 -0.35952373685562721839 0.29136148940484918324 0.017504408028896672328 -0.019639101362725910893 -0.12880046220972490856 -0.56845906780027788407;-0.85660174337586247884 0.7903739609628024354 1.2453642198635965777 0.33448305457953136921 -0.23211545158737176275 0.13761822337306311992 -0.23984419026456565982 0.23246787298790227982 0.44303872780951841781 0.096995196482565659846;0.99088189934675796611 0.99055868926174717171 -0.72195652782988295471 0.38083218195306911547 0.031317169576554115817 0.23543214531589329308 -0.67868850386179235823 0.98455413595279439587 -0.42945114249423266273 -0.9437754170731563752;0.57253136226848544421 1.1107204518294677698 0.23007893905258192113 -0.22443062469285499083 0.38114599661304388034 -0.59456741302553339779 0.30919338179876043604 0.40548318549087836171 0.45980442625772410814 -1.0643784560620088708;-0.70746133913487707634 -0.1918293376733569422 -0.66498711227936224688 -0.74898301903544728386 0.97107311691820996646 0.65213135387868437221 -0.41299641864932645774 0.053684377201236338495 0.48119796782167145732 0.89122982983586496175;-0.30790608436975969164 0.82878345672110642628 -0.036561562587125825963 0.47520580909849141626 -1.3247102610500653963 0.44215665857188163335 0.35959175739141630013 0.12325898742754959336 -0.55294460287242530594 0.36152687621998064182;0.51953252531716709317 -1.2438256544743719889 -0.16429981406457713766 -1.1753939376561937102 0.23572265571419101504 0.23802616502699897039 -0.30124234569200092348 -0.34234524040304026293 2.1493118756069424791 1.3727704060591827684;-0.83137118311788027469 0.12027252363500048893 0.59896859289638415547 -0.75095747053971084739 0.43594293149630425344 0.43226239007013461668 -0.2181261981490724422 0.39157770847247647117 -0.024025914892383100352 0.11117801878276131755;-0.16637981728815193216 -0.36898599251641117647 -0.43304588823057621472 3.0117589507648681035 1.3019866958186678829 -0.85048598806092490232 -1.3502649807192947939 0.41392103453721856843 1.4298171147952740689 -0.82230290625136870375;-0.15445381290532783636 0.33868813334883057786 0.60397498540125382771 -0.13819000128522204718 0.73335796779262529821 -0.52598072688658137341 0.67141462431697096491 -0.23046429088355036008 -0.66322676033164196241 -1.0173491664011735658;-0.6744791147034651102 -0.55276361322040035162 -0.63414812317656255036 -1.0070184182278798524 -0.40019127288852679447 -0.076918905499747031174 0.99790112956583199022 -0.062745105060873454517 0.33354761278856770446 -0.54940383832799066788];

% Layer 4
b4 = 0.19945972574231424224;
LW4_3 = [-0.8806832739025813872 0.81843691079160629798 -0.27581738410691680752 -0.28841159861475856863 0.77888462743648700926 -0.11718138255297574912 0.073060653163891542405 -0.46610366704288808126 -0.93161358226569412899 -0.68151518233239438693 0.015483986413305023816 0.3867412246637019213 0.081021006422956953763 0.30169679862074283427 -0.53116175110657481984 -0.70607466959904463533 -0.21111839983072916427 1.4031581911649071426 0.050541663391979192721 -0.073680695384039041063];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.499999999999991;
y1_step1.xoffset = -2.00000000000004;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = tansig_apply(repmat(b3,1,Q) + LW3_2*a2);
    
    % Layer 4
    a4 = repmat(b4,1,Q) + LW4_3*a3;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a4,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(4,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
