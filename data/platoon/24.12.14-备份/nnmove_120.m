function [Y,Xf,Af] = nnmove_120(X,~,~)
%NNMOVE_120 neural network simulation function.
%
% Auto-generated by MATLAB, 07-May-2024 19:07:24.
% 
% [Y] = nnmove_120(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 3xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-19.0505965768031;-6.85918092085871;-1.99763696099884];
x1_step1.gain = [0.0522252737181727;0.148213484472979;0.500572177293996];
x1_step1.ymin = -1;

% Layer 1
b1 = [4.0673796839065259334;-3.7981006892474202807;1.4277672750713668037;-2.9607277263824958169;2.2713157757301338791;1.9932828369157660209;1.7367279894451779221;-0.2184586466385799175;1.0871134617585278548;-0.93458292469562209703;-0.012947859761900330083;-0.13680669910770021369;0.33963910832901395009;-1.0427530722749327463;-1.442665277642396493;-1.0556556719832757008;-3.2096154140748085482;3.2737680722713911052;2.4226819007229463132;-3.8784003593110925046];
IW1_1 = [-2.420938188304548877 0.63627844483564999223 2.5497577029805502669;0.47165875597530110275 -2.6755984791597287042 -2.4154176875037771666;-5.1240774579722243587 -0.85197478547881866362 1.2294346220089613642;3.3366301123594324096 -0.40408060079064472836 -0.74600287106486673494;-2.1243207980480991459 2.7184208496423227785 2.5552665412027320002;0.30441756030411365463 0.55425067875976830045 2.9717979759790824623;-4.7482615671914789601 1.3033930276305782936 -0.88294861814436120806;-4.2138921095028116781 0.1768985732082765383 0.48927618904548397794;0.0065907311901540572771 -3.7594812253931126911 0.27682808995426644305;-3.1978445512370945458 -1.4501744570756156527 -1.0883209298362652717;-0.49861950302124685708 2.0422480708448111919 -2.2213489349914370408;-2.9157082710446124985 -2.0573210690374970078 2.3609680195196967034;4.8097023251612824879 -0.97233639116152503767 -0.78716757155382133249;-4.0559145868183428263 -1.2365408355741949187 1.1704735879141512367;0.23190841905523734701 3.5642682256491728943 0.80264712450214104056;-0.74201909256824005734 -3.8507402791702389777 0.90798394449199304468;2.054440441116335947 0.13330005940892092342 3.2644703974688336068;3.3350811582042632075 1.397402054182474318 0.13812292372518839012;3.4806911111946536863 2.4257242753364240961 -2.178066602590881029;-1.1431889417837095557 -2.315157404235421712 2.2708679699931022533];

% Layer 2
b2 = [1.4970619438685262015;-1.058578499056390454;0.9397182574145047651;0.13979556684887131657;-0.17085780466923791709;0.07877263193949239628;-0.50979558650316214585;0.85940927536879152537;1.5657375012891665556;1.5107660548047776583];
LW2_1 = [-0.20210896171392697673 -0.058505130808075941906 -0.1978755350101255861 -0.37113522582022567819 0.070734432997070037508 -0.74874811812615738038 -0.54978923126970280499 -0.23555778182029815659 -0.01820106906608267433 -0.16335467033385758784 0.26546203014722136171 -0.55017465341151972069 0.78127505866459601158 0.42284485951712652563 -0.32696211836968919195 -0.55769574812567312971 -1.7121048853590528083 -0.24111092615010087936 -0.00091333047832454529458 -0.065198378109802362923;0.38953521440853156044 0.18999751197185943408 0.063266009791660998696 -0.28923130082170372956 -0.0032086217186130666645 -0.15838415532867572422 0.49776823279582588233 0.25044606812702163712 -0.13966304726607497999 0.088973432070717423104 0.032328665372469131412 0.15879501635098808299 0.52138912623111455247 -1.57627555647129447 0.94233992923985732126 0.29836929712330689801 -0.29831720025272290275 -0.21548873803762791379 -0.42416573826889403254 -0.27382632584271909826;-0.20231260061397177141 0.67521153904199338047 -2.2084729898885839816 0.25435662063172448377 0.095417355299971348681 -0.46930208576814580468 -0.43793617213106994512 0.045858366312446281754 0.17684982966425469297 0.46901929969007005727 -0.063666422357600338522 0.34779006790161598461 -0.64553496784754882398 0.016575443117623076678 -0.31887852793998400225 0.38661607166766809307 0.40179663974248114311 0.64730026034157983617 0.48830271558642046603 0.69106971030568153935;-0.50756342317483871263 0.53750916281173544142 -1.4652213178140798266 0.72221665479725216663 0.58621287927775678206 0.51250544749701765213 0.26089844826345903739 0.043217390023832846779 0.1662963639249511183 -0.036619073500643736785 -0.84646087864196284389 -0.23991660750624480003 -0.021493117315821482632 0.81050729441587821 -0.21183193579452899713 0.085603766277149453967 -0.44111625518905961396 -0.64848783442940971522 0.18945740967327429072 -0.61250109816149800324;0.11281715939691387696 -0.05135054636569175851 0.52749264028527609316 0.59879284139875055271 -0.48867995655368390295 0.44584409668812191585 0.58360234698361923567 -0.070940702180788531295 0.71759604810112798123 -0.89420701891160081498 0.49748737521624458724 -0.24031037587485579166 1.0193805383532117403 0.59874641621294588667 0.21546194419118330776 -0.42635305461194111798 0.7989798769722216143 0.051245124270679759393 0.36758513484407040472 0.20790063975330438928;0.58759633352762397074 0.77600996217792461707 0.50482074197235005109 -0.42045241419359041801 -1.1518705017516648326 -1.0236988372127815428 -4.2787184978490362397 -2.0449152562072674399 -1.671198052757750574 -1.9672064486505131953 1.5322111519867496199 -0.12323190780353747431 1.7533833793433299952 -1.5687516543838626593 0.76409019586343007724 -0.84249394494038709613 2.389246265856312057 -0.3900246049862378106 2.6670245641696652683 -0.047046634928950864518;-0.017614514571728162595 0.39812009490315330984 0.25953285279435850397 -0.040771144579656588836 0.63587164142147822865 0.56329177562165322346 -0.53472373490418001474 0.80556798186848876941 0.33903361278325966355 -0.62163677897450919652 0.63792070170994674694 -0.086921333240876974546 -0.71975202414409233942 -0.29126817926246090229 -0.14131814447720417172 -1.4499025934977012309 -0.6600080560500913851 0.15401382686669184974 0.1300051613986041299 -0.062121902649553077669;0.060441429764570626937 0.066882518918589220491 -0.63024529500123060988 0.060172782729369954369 -0.37650842204812140501 0.3515786443497134206 0.65518087608146657885 0.61179227441063321891 1.0402803513933973623 0.19998173059076954083 -0.072973128420828314855 -0.0028875340246916087611 -0.03350370960298575812 0.46715907899865111164 0.1373142890674984018 0.44606035765839691098 -0.083594049432870631833 -0.033993039436206601289 -0.54068169646369179659 0.48626312296747020714;0.4467670872074395727 -0.10934190831725747184 -0.77231043574913749161 -0.13835133772161611887 0.706634471566369049 -1.214687681432341515 0.061372962926428430153 0.1351499922932603015 0.30996614255546200978 0.44455559903626307161 0.56659969910217977684 0.29445251908171171662 0.33725194570675220973 0.039887561558537794337 -0.52502335230778807151 0.025415067044544787517 0.41860279416397522256 0.0078803882492142780097 0.080825079100523000708 -0.31501573429295626205;0.47068482218993545896 0.22872176644538416701 -1.3141810210258195735 0.38842110127262075014 1.1911714902287040552 0.60000469947748391597 0.73167887901531381001 -2.6418333857598179648 0.49662948614576646333 -3.7037455146414268725 0.67455181995163215891 0.18807127284262611933 3.7736656996279061005 0.92878402720806596538 0.094720588151737242222 -0.20577941556085588282 0.039921898294385076145 -0.15767836315328709329 -0.18253116008340150578 -0.31229817884488336732];

% Layer 3
b3 = [2.407021327652481002;-1.6043118725679679226;-1.0527799972219171742;-0.97165118051694443491;-1.1293605787176199673;1.0743401117678603729;-0.27124483812208233235;0.91638959042801260146;1.1793016598886711943;-0.16351258514997030202;0.060001067154858110653;0.3330310127038298984;-1.0037878865703988573;-0.53537307705260328561;0.71869499179644102949;0.88116729585289188531;-1.3459344950677087915;1.4922977256394962531;1.9961715978067644528;1.9205123319029802076];
LW3_2 = [-0.52291677603160524601 0.22252318242905660961 -0.58318733375563014398 -0.51996405679257806653 -0.78035614124873309283 0.57420291051088578893 -0.34875547818531582589 0.37436176071520788078 0.9569505558470499107 -0.087474810155794821553;0.95180283481875360696 -0.59430312126132267547 0.90532710203770005997 -1.0174694637038008693 0.15506197006005895123 -0.32030069363689939177 -1.0372562341195012969 0.0069266315627464422611 0.53689434349718345718 -0.61744687700257483431;0.35462139653260948968 0.16454509683018053723 -0.52849596398147880016 0.25077916760018731379 1.0320242773199759245 0.26554902440055028201 -0.095444147880648755322 -0.1723287651154829514 -0.99126065822447784193 0.76644972016451506924;0.61264344191511876936 0.030110984013910980367 0.61286249179079432814 -0.46552615595408497473 0.70002337900572864093 -1.1598208808957233273 -1.258311225210988038 0.37410580240306129385 0.55674398093844601476 0.39306167812211517676;0.47686904313136874167 -0.27693019362710386 0.10722642722984399022 0.30585574071873039559 -1.0247758836890592526 -0.49207492340511627127 -0.42076174881777600456 -0.022630420437770238512 0.81842647445682703555 1.2620349028014445913;-0.2296344315750729892 0.74745622161129665617 0.84742654824662233537 -0.067271403206495716809 0.21494449684354760555 0.10772351737479753109 0.17331551850812487725 0.75800382095448026742 0.10230549433119953684 1.5520988501628234513;0.64094369538047335499 0.7580172051881046702 0.43754747798558307759 -0.48699020408592835762 0.26767351603409794691 -0.84427112322947628353 0.80940558413463825627 -0.95616532255060437961 0.48038139928566830905 0.78652039361415571062;-0.39109524468826634136 -0.21835809063304453814 -0.5708829439507554504 0.3286095885162075847 -0.33014771662895125992 -1.0203440055879586801 -0.83781942205564785553 0.25798092989527066088 0.4756664196072101225 0.6477643082245894135;0.18625559732596241869 -0.88127559438509517342 1.1490903487923769255 0.45605045889212886268 0.69961798605090241843 -0.82203143454461435891 -0.49637710992348749173 -0.65058852440411041318 0.76319426301051529471 2.4562438116127087717;0.68006184161746052741 0.73732096322476370354 0.090299178626606357856 -1.1217782045217192799 1.0101578038421767936 0.067786511928178722064 0.33648559009640865991 -0.34286677017367972464 0.79280162944579712914 -0.092010784430482092655;-0.52407034294185161905 0.76673747504315714618 -0.63327287868625237177 0.34717621334649556575 0.51886473427022827831 -0.16088320909783865309 0.63805085135997241519 -0.19722211360552627246 0.94177122697214499247 -0.5699646111724161468;-1.0579952730376003256 0.31930468961893332391 -1.0589055813059782274 0.072023811473550164441 -0.15560067921746245645 -4.4564332496803444883 -0.98817404543848641474 1.4243418222080466151 1.299058142317280895 -4.0472979521630438882;-0.55234677282340371995 0.29199387096616580273 0.22601088414910869284 0.071921713586976382393 -0.83533746740016112664 -1.0037759244326245334 0.68614671094487633685 -0.31693541935938557286 -0.25645040648450406762 -0.42469612405286011336;-0.65331483836208825711 0.68230259916751068161 1.2052581789805258961 -1.1457925936797515032 0.36509062909054196266 -0.082322304520759725932 0.9618854571851260804 -0.094279571400305572926 0.89986237908386212947 -0.094047470599508520284;-0.07959371925972115458 0.60605426684391727754 -0.51511778639277738812 -0.54770035658484972352 -0.43604040310151737092 0.0030673319603767815363 0.73567062120991266738 0.43106518939250315636 0.49482460929451782539 -0.35067255890320403466;-0.35795584720050049876 0.60531823890887703765 0.38166894225934633322 1.1508132412611820072 0.083669454517699845542 -0.52900809882317001431 -0.53299693902911160492 -0.50375208433198315205 -0.6428480124614309732 -0.4931675580644601653;-0.54194063633314726314 -0.57158110229667091762 0.20815887409732947155 -0.096299928789641886517 1.6898167911681589715 0.59210701909468188564 0.18923632000651133267 -0.10987601816057565585 -0.96591522236457183492 -1.2741937619175400798;0.20511563727363496534 -0.069755351300787957203 -0.90581567809059260199 -0.19166613485628095082 -0.91232702561989753587 2.0532008483451087422 -0.18447043696659970458 -1.0937681826151341991 0.13949085279872658338 -1.2318130188313076712;0.97301652597396559585 0.1499442792593499163 0.45500735216530935334 0.54475032588813865342 0.4980841826405855155 0.01980772932153115895 0.088087126097346105102 -0.77089147709146443876 0.66909243137156693138 0.30930027440669033423;1.1376533492714993034 -0.046223140989045376215 -0.35338001692898424189 -0.044702643566128977271 -0.034763532676553202116 1.0123040837031718198 -0.32363284431529942831 0.31502096735149465179 0.44802182302602588937 -0.77836801350739526217];

% Layer 4
b4 = 0.3903852107714052555;
LW4_3 = [-0.091480658462618699711 0.0049361706557271541398 -0.078368913193004791085 0.032005628482648672273 -0.073725083452136089268 -0.13524008261806100273 0.024966600212129385489 -0.034385660489470691592 0.099878908906507815613 0.0039643014908253906836 0.0024202397172942142871 -1.1218407341237861541 0.045923951400967340242 -0.029592282427199981254 0.011263094564842571557 0.0137528387474347355 -0.1582875056759896204 -0.10716573608276960816 -0.3675182096633626827 -0.014960131796501068002];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.499999999999931;
y1_step1.xoffset = -2.00000000000028;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = tansig_apply(repmat(b3,1,Q) + LW3_2*a2);
    
    % Layer 4
    a4 = repmat(b4,1,Q) + LW4_3*a3;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a4,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(4,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
