function [Y,Xf,Af] = nnmove_137(X,~,~)
%NNMOVE_137 neural network simulation function.
%
% Auto-generated by MATLAB, 07-May-2024 19:08:17.
% 
% [Y] = nnmove_137(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 3xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-19.0505965768031;-6.85918092085871;-1.99763696099884];
x1_step1.gain = [0.0522252737181727;0.148213484472979;0.500572177293996];
x1_step1.ymin = -1;

% Layer 1
b1 = [3.6275247815669606766;3.7437247085506952793;2.7593764068041024551;1.3162235362504897118;-2.0811095223535480692;-1.5442011159340292004;2.8460853643478696284;0.7194334891096326734;0.48120669784714303896;-0.10839238499427571172;-0.18206043808368985171;-0.34980923936812780006;-1.6000899145127440715;-1.1718174216273915533;3.0665041070609575513;-3.1832268337337508157;-3.0563192074721396985;3.2036316641775202108;-3.6236530578200483177;-4.0206740926699833238];
IW1_1 = [-0.82508343622104374226 -1.6047604984337549006 4.2781103723854334575;-2.8050319112595158977 1.9831216735983383526 -0.47697603127217369501;-3.6953205940067186397 1.5489575077569770478 0.39668406479337120496;-1.701196281557714407 3.2197667269598397866 0.79124321179282697258;1.181069314077444421 1.9156984955713041163 -3.2507244860708426337;2.5875969021713074447 -3.0058075898575782325 2.0097340134183121485;-0.56196390493822001577 1.3666175498860455573 3.7158749406924478365;-3.7358798223152143159 -3.5011389852209382489 0.41500383779255417549;-1.7989950912804129057 3.174025986359703122 1.907135180562378407;-8.507093986602164648 -1.3494924212687815501 1.0759532223200087842;-1.3259097399366572834 -2.7820579465661037233 -2.0291614351078681722;1.6311674124181636536 4.5060558353972961498 -2.1123519763244655856;-3.6990146055841623962 1.1892638870923804006 2.6267716753160552656;-3.6463106108048610743 -1.3511153437322689363 1.3237126056807719809;0.16225984706043564132 1.598392173646978387 -3.5976802718589970809;-4.1040122560926457496 1.0193520041806030108 -2.8159197282379615501;-0.38756510339242211671 -3.3448234968844494652 1.9194524652528850428;3.1708441046131565777 1.3807168144733397153 0.88253883426250978594;-2.2234772570838905459 2.3793448887265187253 -2.3488815073948559053;-2.0697917887292560657 -2.8365513665295574164 -0.69596447372034309087];

% Layer 2
b2 = [1.4581381835485032195;-1.2114313471051894044;-1.1765221761602298045;0.50753124427156781628;0.083514335551186397177;-0.05987882857834951611;-0.19112683209125588824;-0.7777455996795842319;1.3704421017331389621;1.8436360053126716885];
LW2_1 = [-0.97920771295710207216 0.022696401819702942404 -0.92849832668369658428 0.54694949663265246542 -0.83364322985884287132 -0.23512863374224723945 0.17998980247076709627 1.0570823558744448789 0.81787414040933448245 5.9767717974477125864 1.3148102790286482211 -2.168341892443211627 0.8930859606801091477 1.7273194837113938771 2.2131432453315649234 1.2308023576064694993 -0.85896518006259892086 -0.060270114537617110184 0.89943027228700234144 -0.2027686944192888252;-0.3910020573965902746 -0.32043177429204544593 0.56063955072195503782 0.80955028463678158079 -0.032997881309838036912 0.54142478269881477715 -0.24790678363963020159 0.10812715227986971489 -0.142766970277335703 -0.41697130634375884073 0.50649715735975830988 -0.16247531772271012196 1.5192143533552004975 -0.34619146343993234538 -0.11087944625836762547 -0.12105264132060114535 1.090025531243778989 0.2358360125680741548 -0.095990884293684033968 -0.22038471716119692467;0.41386767974595967123 -0.5903875573579150382 0.29079028495346631589 -0.19620008385912932058 0.52258833454075237501 -0.22317062071950230506 -1.8779619499009405637 -2.1329130937962434977 -0.10015274368920855375 -1.7652387250837542343 -0.0034011037817220143159 0.12373850584485436566 -0.51875756440268783187 0.044212521556818588919 0.54582712719367987297 -0.80174603269999333843 -0.14985159617106272312 -0.46464302065968277056 -1.0889123501176449782 0.13821501857990159401;-0.43894632287807017201 -0.21779527499703363325 -0.86784829282457287558 0.36531346001941777946 0.24642115734645561598 0.015963022680965905514 -0.35102042520563014882 0.5008495565948681838 -0.11593199434593486064 -1.1174848859198245332 -0.16444999855109093678 -0.092234132258097720203 -0.61804649396900601666 -0.32189423503950309602 -1.0192539523217101216 -0.72404286358929481615 -0.21194839822121017137 0.13825988402723790593 0.72340016414299623815 -0.030318740433693865816;0.026142883945143854246 0.32235650938998777759 -0.22944595989322719154 -0.36274545286609632955 0.069796604999053796226 0.3152233492199998377 0.77979436454483830321 -1.5608034766209737398 -0.041439243314308413235 1.8577328723191501858 -0.71490241106069585264 -0.15199439662200750489 -0.80459281128949911022 0.24160106131092523585 0.97840240782071785652 0.57844987913867040863 -0.31601891509432417093 0.11619854458725210888 -0.88487059771051912449 -0.11893920686226545913;0.29488754545633744097 0.050673076917679721332 0.10323495026982111578 0.58652810268697608276 -0.50467752386140518617 0.29050135798738208059 0.1547982081138724042 0.17925076429170810899 0.06789024889852036948 0.45171638492945881405 -0.3037213070901036982 0.70327038813460507338 0.25818870328526172253 -0.66345235023580739764 -0.05877706045787576411 -0.41086886822971252498 -0.021182951063586495655 -0.40521249045697221858 -0.60029745406120871287 0.15794939715884781517;0.12751537209547927909 0.27277596312251572996 0.13085433552556891001 -0.17689991041990404952 0.1344317195066596915 -0.46876727078612606681 -0.22854618809269003354 0.56337261388417969599 0.26624658935338318955 -1.452059473608957596 0.2598273997345578179 0.26610352229883815767 -1.0689755700606031752 -0.41625542846468627234 0.75618200209627373098 -0.0085124373233309898884 0.60687917883903719218 0.15034481838537622211 -0.42914805896677449271 -0.75953774236052173929;1.1952761000321650009 -0.24542395993355492489 0.68257198271150631985 0.91345319897390986341 -0.35038847865652450464 -0.25836919006688513489 -0.5848926830941817423 -1.863482758726631161 -0.63042999888387829532 -1.6662050550673539462 -0.34294232577474731416 0.93054828497897268402 0.36310916053166858442 0.17855827928073214617 0.021639524846398174029 -1.8909933546912029989 0.34298210504831988521 -0.2607306870949040456 -0.26763714224800244645 -0.62391610446343503948;0.45960994710337338409 -0.42487863253952390385 0.26248066947227222112 0.3399862199754944414 -0.21496040200123983643 -1.1713302277488335523 0.57183024528351300564 -1.466774718479439521 -0.66047913942533043041 0.54176477486299168262 0.36060182407490626311 0.054933399308093738833 -0.053794230406518012133 0.35192116592544409048 0.39641795963005016512 -0.40175001810271587788 0.12969981368232627594 0.14759724144627348053 0.42384708449927399609 0.41427263710139805575;0.51241545807931809797 -0.050683337500728606329 -0.38881385356816894339 -0.429194552916311034 -0.47083591210490738366 -0.021859339939834663419 0.15939998030847196686 -0.4739777636836093877 -0.13222542789430941079 0.36561329130622405303 0.11729278298261260061 1.0370847306313060177 -3.4704749408465511706 -0.60142359874594542024 0.55627922703512189262 0.36823287076290878161 0.030609652729248117836 0.21105332291968820213 -0.43042035325527522316 -0.26558058525958899709];

% Layer 3
b3 = [-2.0038144415217775673;-1.7365570844839184339;-1.1757096477475503793;1.9369536320353852865;1.0214301897901350014;0.69164633917240236904;-0.82120667243616929376;0.50134818234266242953;-0.097606491521912849829;-0.25198282803177224354;-0.13185588766719530396;0.18037535796753290107;-0.4626408909601775199;-0.7063828826684336315;-1.1393650701155804139;1.1018206484674373247;-1.379200380456567121;1.7470890009668635923;1.379966191854283375;1.8622317403880053188];
LW3_2 = [0.95920872344869767545 0.99720428040624031762 -0.56381465877171610401 0.09931471299005339981 -0.22394052004579906301 -0.71036378379504883096 -0.16100242947640797109 0.82415641310110343554 0.32497161963684190189 0.11613376880568654359;1.2107482102750304342 0.32283202501839558529 0.96952539758464417741 0.36497505308617822495 0.26323514076287524155 -0.35880495850676602521 -0.4687430260576905261 0.34523117663431085456 -1.0818417654447332055 0.077410229043590336739;2.877304294411108021 -0.17710342121557134942 -1.0218964314386744796 -1.2529060473575936996 0.79251095402095395048 -0.55158450577217488231 -0.65317128377893485247 -0.97432872354890198707 -0.48354915457637492882 0.33516805557127388182;-0.17070217443847782168 -0.52720499105745965984 -1.1831205490415419579 -0.064431867938495340775 -0.98925217931641373781 -0.61997460667803339085 1.1231089084215313267 -1.6962803093212592831 -0.53403582824537187967 -0.372309738569189419;0.37159973267478535464 -0.078240443771527418138 -1.4603833956743412781 -0.45732616641054685269 1.215790342292942583 -0.68119493588221669 0.068982744177354823889 0.60319402752558415326 -0.98356298103502137753 -0.30734639554223081026;-2.1476321828446396367 0.84094324223504124394 0.87265112201881200882 0.85114863382698524585 -1.0869556873926253804 0.080441386745319851115 0.72842164608701798212 1.4668212240309708161 0.57342669497710552218 0.29573357544130290941;0.89065431159635222169 0.52769924430473635901 0.95295174350647338102 -0.47167751247191408437 -0.8206998177383559856 0.11208238254509927945 -0.50343508297925942951 0.51732682844134159073 0.74172261773784609051 -0.49913331286139606124;-1.6527638689265800043 0.94000693217853514838 -0.63016659407980391006 -0.16125618507013836367 -0.66512875995477760416 -0.76941619019584062134 1.7462856469085246136 0.19420310095059323263 -0.61498472493716827003 -1.9370438337368289794;0.280582042397234388 0.50699490809619596199 0.61359755196317788961 -0.66094679878195172762 -0.74861561792635988866 -0.68260467475905184376 0.6424532055968140698 -0.35019473888857377553 -0.12759269697076219829 0.095211394650427008668;-0.78918333528821826839 0.91941324451649408811 -0.18881969614942056834 0.000903340961129276733 0.06760524282723487377 0.22055296895066162088 -1.1489926384040476393 -0.29426814697325681669 -0.91208499658351793737 0.20653792733300593842;-0.18817327863920643716 0.066203203576550906373 -0.27659728127858529412 0.57335162540918371832 0.17336394011846611996 -1.0380372260028853937 0.67008419626932136381 0.90472943157475116394 0.24775167277977389046 -0.25140808471266729018;1.2776240623033814359 0.63842389856625370026 0.60891961677383144025 -0.52462591563412541706 1.7494819603083144877 -0.28997432291579977592 0.49223696888802964677 -0.81927034293050404745 -0.63648128895946043393 0.11081098809858959398;-0.84342342575072493105 0.58695997835476387827 1.1695224872880349842 -0.50272772894599759841 0.79749402769567789839 -0.32476615951659837389 0.41432949075456898536 -0.16444436871603101968 -0.67859552206746176495 -1.1715642058056690011;-0.02288084820526288532 -0.9122400737111668878 -1.7239989041288199534 1.1755323176941929741 0.18530942757922508335 0.064336125599626148297 0.11532575787780011134 -2.5077435221331572102 0.057254673490470156527 -0.046023731786796924503;-0.7324687861396280697 0.34138396450654462377 -0.2257123513775931567 -0.12841182726982433571 -0.31123781812775369593 0.023922713780945785433 0.2577338680604780996 -0.13789737814778943448 -0.45145293508568379304 -1.0957710415419972261;-0.10381343437669404706 -0.83536307990136970947 -0.73053636482066697244 -0.0066279635763444831598 -0.45397061360451934631 -0.34661737825972688265 0.85424443704449071202 0.21029200598454544924 0.963851011285239756 -0.49636521599353344847;-1.2446583625086913294 0.5291869110135787313 -0.44401336664349333461 0.51450377995230678341 -0.084832615474239550513 0.3726132058073029496 -0.57071645326507258744 1.0195847850742896235 0.63913761169759208958 -0.91575355183356987876;0.42314496880541441204 0.11451069090002599649 0.63535621005867692901 -0.71012094397264668988 -0.76044650440578331896 -0.017636634645831372747 0.013999270712957923024 -0.10153388495598904273 0.70846177548049638073 0.91684209879257827502;0.34604456338819644667 0.54606926231280616957 1.5323110507847252926 -0.073846584873420301198 -1.1894669176174119674 0.11153076328956448848 -0.30691024834203106675 0.68040353980586576466 0.61305396545964052635 -0.71925286496751550391;0.80554030484734251427 -0.81307135639813066241 -0.18075456366148676124 -0.99947980982389916793 -0.49496443126022920955 0.21402088565998464431 0.7210126851793936531 0.20342139369022180229 -0.021201446425243689747 0.60107104802703437141];

% Layer 4
b4 = 0.41012533458422278931;
LW4_3 = [-0.17452255647391989868 -0.86489788620580387857 1.1829449031629841738 -0.76426451830360586648 -0.49020774791721377639 2.1824098730584258199 0.45540151092586744763 1.0724061571808298776 0.0047712302735791736405 -0.13556614092286681239 0.005895317703166319187 1.0690937247233429641 -1.1182649536167230675 -0.42923972171019075805 0.54122250536649341157 -0.31502692963633865952 -0.55113307013889589747 -0.22716109810977450079 -0.29547200427566516767 -0.32331933235406729032];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.499999999999931;
y1_step1.xoffset = -2.00000000000028;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = tansig_apply(repmat(b3,1,Q) + LW3_2*a2);
    
    % Layer 4
    a4 = repmat(b4,1,Q) + LW4_3*a3;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a4,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(4,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
