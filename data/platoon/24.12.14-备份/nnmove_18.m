function [Y,Xf,Af] = nnmove_18(X,~,~)
%NNMOVE_18 neural network simulation function.
%
% Auto-generated by MATLAB, 07-May-2024 19:04:10.
% 
% [Y] = nnmove_18(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 3xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-13.2925490923537;-6.70139767883548;-1.99738196042707];
x1_step1.gain = [0.0638195875959219;0.168202204644631;0.502170423671263];
x1_step1.ymin = -1;

% Layer 1
b1 = [4.1037699212752967171;3.6196787313793956642;-2.8514435466290866117;-2.8719350079142995646;-2.4536491626312177949;-1.8085639369819743738;0.70909965255229112646;-0.65153587500354792628;-0.46565294861622918976;0.021536325636690587665;-0.56471244133385112285;0.049932760964406519566;-1.0713351922532703409;0.44550337194105454897;-2.2171314589575223941;2.8400679972137981011;-2.6190465606783859265;3.3223331885915894368;-3.4202623777390557258;3.9914540402753688753];
IW1_1 = [-0.22844595824996424827 -0.6092706301294983362 -3.4201723468979476905;-2.4977544765972696794 2.4115861144085282142 1.1687525798576237079;2.0311318720222488743 -0.41310311704382879361 -3.3052446436823190723;3.7208449591464911599 -0.26306842590832407724 -0.24650211439669039715;3.7886669296658026518 0.075329766848034857007 2.1622344079273538853;3.3063902513710226039 0.69901622290362863676 2.2401505319208769862;-2.3299306347254389316 -3.779123148414823774 0.68715775833117764826;2.7520955346551039256 -2.799866538031842822 0.71535560850163992797;0.65155827256517850898 -3.3880908195648786752 1.3130720518809948505;-2.3878255842811526577 2.3405223265328078952 1.6103448408544871473;-2.7063644455345086115 -1.9400882307505551427 0.72471524870324199874;3.6224522808695946985 2.6690769659504463007 0.81226418149236523369;-3.2490464291422411769 -3.2315557835261818909 0.15846876666374620779;2.9566960835522664297 -2.1944632332414517606 -1.6488919138959816646;-3.3904318825179209362 -1.5149391188419325527 -2.126803246694862537;1.9833392452111993087 0.11104842738237773181 2.6112589281087670301;-2.1921837534746697607 2.4532949140891271433 -2.3974381450371344826;0.61170052244886796711 0.30959592721583278907 3.9876268604755860103;-0.89030392601262609009 -3.6340513292932881129 0.14559576164014317867;0.568871465783800212 -1.7367739104100967662 -3.0961807207695151156];

% Layer 2
b2 = [1.29398006400323351;-1.2331687497613637028;-0.86575105927903706071;0.13842259743228696456;-0.30135924279755271771;0.1156139698092554513;0.77272094848476680085;-1.2090450631830544914;1.3129277902923732757;-1.6297636765452863106];
LW2_1 = [0.70971184390567831901 -0.013104009702312562069 0.078056694834240658576 0.69679216507917629553 -0.34641707019336775986 0.32908289215467839695 -0.24571477482546871807 -0.12230349772527690511 -0.10983788179042594524 0.62283297226751488385 0.44533298537751830892 0.67383666690032295588 -0.0090092217254392134573 0.49255873297317653847 0.31685910874073236476 0.31544911251724172541 0.41939486606422771153 0.53782040110605811023 0.19578231467641676877 0.25587952893791954256;0.48771826011306385062 -0.31044440639326564835 0.011232980094909071969 -0.70405754655223640182 0.29390937852292997601 -0.27493169682052881475 -0.079619198983672159753 0.86309446337807049776 -0.17179467510873558389 -0.11151040707463419355 0.21728997887135051426 0.50851867974365849712 -0.17360274666393821219 0.71643671597299074527 -0.12859556890885584512 -0.018123959697402752117 -0.58352837025219406186 0.049924925026331390399 -0.18369404543071665703 0.51801730384521627037;0.20588256247205244387 -0.49178486879434735179 0.33526093884186425331 0.22598376095039071632 -0.70839150482081902904 -0.073378133885232663114 -0.012437519734402765342 -0.068164112857386507938 0.74142072632935840382 0.025695387535648872568 -0.039416794038295080438 -0.18626770376721821232 1.0588937281187129624 -0.86360826740706342353 -0.14149579099200379484 -0.070193639237351029836 0.1413286178478590227 0.56449326040027503204 -0.029141826064511464761 0.43287687101404215273;-0.55695915685133545736 -0.6785922380524845865 -0.017449053455481641078 -0.071699202133490319566 -0.40239050747037996558 -0.19416940995873877007 -1.1819969708778548245 -0.72635067973533218311 -0.68200094998482574393 -0.64411937211646752566 0.11369905610625247183 -0.34834624510313844103 0.051389722418859355713 -0.27955322186618986047 -0.80583003529009566979 0.13747164179308307697 -0.52863740292897776207 -0.17246339317818459858 -0.1784973976228040049 -0.42854721283456820302;0.59300424261695305894 -0.11340692721122960784 0.89985084698910111634 -0.46955124847766310792 1.6617575263474644309 0.17015766050386593733 -0.49628551919211394416 0.92497080530342734583 -0.17037909491067987355 -1.603157668867686958 -0.93250151278650794673 1.8632706920918236104 -2.0482457949918013718 2.369701005998622545 -2.5620277830323510138 -0.010163817519123301975 0.87604283495656498637 -0.54570571098164999402 -0.74352869485038286523 0.019265090057865034284;0.28301592329766112055 0.40959461416490178243 0.33940743540707707382 0.57486428679135248565 0.21385363984049493569 -0.6420964420565584696 0.43611295904284835823 0.52634901372686626608 -0.26752263396649084148 -0.19997766852726883702 0.068473608766691965166 0.58200977138980103387 -0.055543760391754889993 0.53752098993441177477 -0.13911341279382377634 -0.15446073841425356221 -0.95502365762202801047 -0.80593151808236207501 -0.2289990068786452726 0.14978048752405637156;0.70887660076728364889 0.2494915223186973674 -0.14800471559794695087 -0.039206402942083454222 -0.15094266940515341235 -0.32207283562211797001 0.43472150686001626019 -0.41100856568049304318 -0.48893710180732469217 -0.015698952709705990549 0.11090594312628938856 -0.48244169598714337077 -0.2489703423427691853 -0.27568330008124425357 -0.034334132307780602933 0.37261443064861521357 0.25789696123371175229 0.74546015875129001405 -0.13194131433813915955 0.43265510169490906112;-0.21631382070961160946 -0.20770251765865516136 0.14892743001316655072 -0.2718276602605546044 0.77040641228596229428 0.92363027481949044883 0.25349376411835206069 0.031198577698255826329 -0.12562867040425190757 -0.73203304063062568652 0.23631862124043548357 -0.68681602577591238656 0.63280030367785689016 0.41830168753776514334 -0.19737391610166188372 -0.30633061556926338698 0.20977361272876510201 -0.0071191016708769608301 -0.23700142013952985032 -0.028348310548629337968;0.58227035155817519207 0.29076237882943550828 0.54439616350030095582 -0.062825885663666591885 0.93550350622901223829 1.5623761960818387529 -0.13795403327182417796 0.33676605036944845528 0.38742011835536516173 -0.30012335808840429063 0.11280391735150252508 0.84066237135932420088 -0.78323554071478984628 0.52712189450981927763 0.66282593866266215077 -0.43902759590561296621 0.38110062446683673487 -0.88272230946051899458 -0.48964183057425691992 0.072616959253283708264;-0.52688955896264277889 -0.56712476768210473566 -0.36366042694012046255 0.47909296406710455418 0.20682433485502138559 0.33837972360493479007 -0.055099443940422418442 0.33300394841032149307 0.33972720319412114121 0.17069990575158511259 -0.4075338231077800244 -0.24018409381392077928 -0.2293167264879916456 0.11948369439181660834 0.36530424927652238587 -0.28481085049095739015 -0.11039589236027698427 -0.54289339096488586911 -0.10469117073186873235 -0.52905414302285380668];

% Layer 3
b3 = [-1.9160152854727743321;1.676271736253460265;-1.4855823201841846792;-1.3177198391423168289;0.98427433098953287516;-1.0719637688270435838;0.82709004446706146929;-0.23106063188811748477;-0.018037501876285555458;0.1486098159956505127;-0.29878851164453479328;0.5614680379797174492;0.35110458842027197912;0.85562524479947610345;-0.74872044587935127069;1.12256039634518201;-0.99993733613172719465;1.3021015731372289626;-1.7284285905425065266;2.2827255345888533];
LW3_2 = [0.12401522292629019173 -0.4165618027321170147 0.79348250099746786557 -0.90232500658523429049 -0.076294968117389713735 -0.0012962636738872881752 0.66471822986010165035 -0.76184501464872056431 -0.2402237462142794433 -0.8795519002020690813;0.074902584766864441224 0.18965594556152293171 0.92873467334269543816 0.70266745110634820648 -0.93680560545949975726 -1.1210802168835476422 0.79239202837038424931 0.11184823095516996383 0.42492966001788651242 0.73678242141447292113;0.5608765417966576905 0.35924775151370280657 0.48220099128863425086 0.97006282883715488907 0.54907728595281113382 -0.69790189151470738427 0.12079563282985890382 -0.82928646745812140129 -0.15496106089334241163 -0.12412885584713316545;0.83329685225868888043 0.67908518120454719469 -0.46820104110818350218 0.35849646334998724884 -1.2521982085675888996 -0.17119692209838954788 -0.60457389297576458187 0.4354524447421759259 0.13884689680458134342 -0.81151916855951655716;-0.5310315329461037237 0.28732957904902917123 0.25804429111350191128 0.90197603714171148415 -0.40454414274363970083 -0.94013853708848682533 0.22314583892484612937 -0.84352324752053853274 -1.0918317097041025932 -0.44987824763010020312;0.43560494902677016071 -0.65822658178336235224 -0.29756094559152246326 -0.78113369368445229046 -0.68248054505210675735 -0.70616786949900911541 0.34822358409021231251 -0.14639717731410126222 -0.98548497546517210832 -0.42466592353617604871;-0.208984793028558824 -0.56824204508889886167 0.02614542798004837465 0.92833907345268262823 1.5628225634686290224 -0.090658567297738704149 0.53354096952335983151 -0.17453302881826807114 -0.56148072256605063846 -0.90340515741474469724;0.70421361909017876624 0.42050917377288254961 -0.88220158014313976302 -0.69316578754216373603 -0.58922442994267265615 -0.41094566002764892909 -0.14309725673504689047 -0.86218207892203757581 -0.34427736216572918382 -1.0736243892532086885;-0.065337353901085110097 -0.6483066012708308401 1.4197443256185890981 -0.041714552256685480391 -1.7151233332560313904 -0.13551564309845967604 0.45453525303728736784 -0.84167789072466059341 -1.4509419819240565452 0.11082744105133320034;-0.94471746619179364224 -0.99869930497080627863 -0.21412472517996677945 0.67703379335972657671 -0.14951596271026756924 -0.14430456325845916754 -0.16528760220218161048 0.94341649953427952902 0.18066029588956686314 -0.61049160275386049612;-0.21844385572740426804 0.99283779203417843462 0.11020576667108639146 0.62543112661676869557 -0.81394385072405250892 0.33981470027501453623 -0.89773312813323091763 0.24848030733018675043 -0.8668277789097937891 0.2774035343164539813;0.74210311566224551605 0.9505048291878208655 0.38649700410646675719 1.7138178981844778281 2.867178528207904975 1.19918039031217738 -0.42057428172237720787 -0.69975443421764926821 -1.0928706350233357014 -0.091828631571394328525;0.59740098999521917822 -0.60709063844163591028 0.86934452436690079491 0.079452692386831558213 -1.5670803844962108986 -0.82049655588834569109 0.72368306215906952339 0.34554363543819799354 -1.0575865816983982537 0.025943109139074882474;0.35351843395351306709 0.76104250217137747736 -0.39879915004204813389 0.538314895216429945 -0.46135368770087858969 0.17423975627510446262 0.72795980963584316914 0.341908597852610463 -0.74943824827832128399 -1.0382384448847929992;-0.23036600996673328723 0.81794713162584198329 -0.83195962747755403122 -0.51284192180703924713 -1.2566408080780613332 0.70220267369242106437 -0.19504098839266295617 -0.23671928246678866636 0.10296064002472289645 -0.035923602687882430495;1.0280261658260376745 -0.45424033525677848244 0.69185692397917586405 -0.40277212025133268813 0.91485389747333556443 0.19195693150764070456 -0.2277567150608446056 -1.3505962589375877236 0.24060628781858051095 0.5786699694755289558;-0.57846196273288119638 1.0541655294218970074 -0.38730245200645996295 -0.44610192015785421482 1.0907595910537823958 -0.18496234742380537885 -0.31538771156780542881 -1.3207602584438227211 0.84039565482556011222 -0.86840082442943367091;0.58759057249290003178 0.50125723043300496329 0.054778640657276313208 0.38857330969571540757 1.4595783208476105219 -0.60748532732324866945 -0.95928924483816757629 0.47389223488346327029 0.81905173869627301286 0.99078110902644378477;-0.70780111723629990372 -0.22656306443257276384 0.44009625173334621095 0.93236740544828189403 0.67889161786371243767 0.74753810357073013915 -0.14650610592637952623 -0.59894572183572281077 -1.1495244959391279771 -0.29146742324428420723;0.39529667677501650891 -1.3795000842146158959 0.44097549720733320022 -0.10645355514100235395 0.19924602657080039969 0.19358941173982180395 -0.59341316741641325638 0.56996708910179860741 1.2762222394695328376 -0.63185886331477758571];

% Layer 4
b4 = -0.39875051401414540742;
LW4_3 = [0.0099050844200294363429 -0.72816912519140108984 -0.23658896299185078194 0.52461053898103626736 0.69006423538549455099 0.12246000900458811622 -1.0343327326561597701 -0.57318461762411077043 -0.95712108558260988733 0.04003868720764955369 -0.79594127387063229317 1.3763720286568763562 -0.4621239079865500643 0.14307215912305989991 -0.34400837206929368861 0.86084671248361921414 -0.61631153450493525447 -0.79478139641465950227 1.0073402946262330904 1.2465334529026124155];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.499999999999945;
y1_step1.xoffset = -2.00000000000019;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = tansig_apply(repmat(b3,1,Q) + LW3_2*a2);
    
    % Layer 4
    a4 = repmat(b4,1,Q) + LW4_3*a3;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a4,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(4,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
