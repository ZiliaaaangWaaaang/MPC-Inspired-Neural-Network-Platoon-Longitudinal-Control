function [Y,Xf,Af] = nnmove_28(X,~,~)
%NNMOVE_28 neural network simulation function.
%
% Auto-generated by MATLAB, 07-May-2024 19:04:23.
% 
% [Y] = nnmove_28(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 3xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-13.2925490923537;-6.70139767883548;-1.99738196042707];
x1_step1.gain = [0.0638195875959219;0.168202204644631;0.502170423671263];
x1_step1.ymin = -1;

% Layer 1
b1 = [4.0612268836559257679;-3.4456852681732805799;3.3792411903528023487;-2.0634913803151291312;2.3980261676979885976;2.5788586769030135137;2.1448256368963729557;1.5038716525166189175;-1.8635005858393958178;0.51812736475725018614;0.33662162896973807369;-1.0150112671453119795;1.0776904696961997487;-2.3391110917081676668;0.68601713286602716835;3.0358646089289815784;2.3104344702410148926;3.5584615107946024892;-3.4610286764035542717;3.8041457910469644865];
IW1_1 = [-0.26042697697888483876 2.1461474012124113209 2.8293725538154439469;1.9904353435050563537 3.0165957629690871578 1.1091129634671104132;-1.1712741005003453054 -3.7848235553484075311 0.74542103374997092935;4.0271434236431389309 -1.6083522136842782757 1.8305378570674311067;-2.6915351358100219059 0.54637835701332582161 -2.8561611250297556097;-0.173549050856970144 0.29622514460485560583 3.515747646531553805;-2.1006423607010491494 -1.2357366833362490866 -2.3621786481038018479;-3.126056658327857285 1.0058971076941980449 1.6135986630978045309;3.4259656793083386184 1.2125900421090267667 0.17150182039924119493;-1.7649283939392845788 -2.4315282036927499121 -2.2898652983499543367;-3.345560534902213945 -3.5222542139593886468 0.081271952378695000441;-1.370122986708260493 3.0567582824300085775 1.1162691578830887806;1.2096925651991352613 3.7851271696687387447 -0.33255220594016382529;0.029290224602665757697 -0.55886621880860676281 3.2953525036717286056;4.8108683977610455784 -0.038402963132396598922 -1.0064743434273111244;1.886324899037637115 -2.8040966891110956638 0.3680444074343989791;2.7868541059248519431 2.4904693999047049502 1.6969576781283537414;3.4973386181288277363 -0.68521954908090632053 2.4328612527956781086;-0.22967989662904511605 -2.3251870453914298409 -3.3231100887972977453;2.6310060400815951098 -2.1857539740884894819 1.9002104694463282097];

% Layer 2
b2 = [-1.8389573391265383595;-0.93344133616840296863;-1.2914970839748920461;0.061199472215108866036;0.029023480594275403999;0.16601362394305219095;0.43600565748743508321;-1.0683289180725923373;1.4648829280488713245;-1.3521685614293847966];
LW2_1 = [0.3641650408324194621 -0.12150327249048632761 -0.57271456297775247268 -0.027534787053383077277 -0.13266541847564000678 0.27014501944310548298 -0.62243840590921672984 -0.05651151337722873369 0.42314045637415359513 -0.075611258359179617239 0.43704324238865405183 0.56547317133910812714 0.039915989652616584715 -0.22481019866294399412 0.086221336224269334858 -0.5357819239234673514 -0.18358649644623178943 -0.22598509605742603257 0.074210777411178277529 -0.045933462065875785285;0.83531304031847275482 -0.16731589487624143331 -1.4214625264011937489 2.4684741981170694736 -0.12637800400790799582 -1.0134072637903468461 -1.0552476291707442169 -0.14307102801602838982 -0.20656441709657022421 -0.023764274121940043294 -2.6859658584680903282 -1.6543235281129415881 1.0857132502536295249 -1.5736893225971502197 2.0107251304105040468 0.10240091089078677544 0.16434405986813060974 1.754849894528859755 -1.0891017238989952887 0.75284955559426181004;0.12811266367863613502 -0.010074200881743163027 -1.0011616551942545961 0.0078267665404886423153 -0.48080369442996823137 0.041810764304362826871 -0.18944487284989577902 -0.29284418128672395909 0.2145829183470076007 0.94622165612378494881 -0.88375573606269708371 0.45678190450308159276 0.73227014652519728521 -0.27787908844624403804 -0.023258356926465450359 -0.022371825876919528009 0.095473404442060816333 -0.32937871321999773189 -0.24375463363884466994 -0.46322197073570969827;-0.55054226322154420359 -0.31493087823255810909 -0.23812745166110899087 -0.55858460961705969083 0.52979354239790332759 0.24664286090737136403 -0.18547367189149091549 -0.058705961963844158213 0.18018627772822895516 0.12288269698972498212 -0.46179061408864707783 -0.27905750086836234036 -0.28329545321968119254 -0.008169362196896269579 -0.7125510455933924403 0.64206474453439166261 -1.2190546984449543988 -0.30358535295904981455 -0.19879400742145614256 -0.46296758468841803236;0.28297282095841697069 0.25785644484859410186 -1.2681644355877630392 0.23560467338059343234 -0.25583139626156836677 0.18296767527541493714 -0.69277636075018989015 0.043850947383410887603 -0.44775366190139798128 0.10252624748863956028 -0.084180333594499154315 -0.22566041748573609227 0.39435471012406381197 -0.61249221126201813803 1.7830663690189831883 -0.33129523647522696184 -0.56176135156979900565 1.1370887980833517261 -0.72334810086407363983 -0.20491924244790943321;0.57292921964544618607 0.30565274903225864156 0.2497902731728530723 -0.18894729389697059729 0.88241814821670927493 0.2060687905090458627 -0.29769353408476806333 -0.48282731430365743996 0.4280280312561325351 -1.0417755901787024708 0.090224462556236423305 0.74705959165090674023 -0.38706313984734108669 -0.56460389998500082331 1.2937857251960409588 -0.0092550823845909419713 0.22356019055392215011 0.89612936486332128716 -0.42699410872785859006 0.1329811158110513758;-0.060305338750534627501 -0.41959553361561258145 -0.54681376584461327539 0.082818853681238813191 0.23984763907984699149 -0.39514765325763778758 -0.57966874665450818238 -0.072924026039143788336 0.1077925026235326128 -0.20537383339201692456 0.5608132386464443897 0.29772450261363858637 -0.40458941188135388867 -0.018152825524228227705 -0.99210837555464481685 0.93472976112351535694 -0.79149827737693856378 -0.74207561428588597607 0.028652185227010570218 0.48618366638399002078;-0.59358308735192344407 0.6474290726029052756 0.23021668608484044394 -0.56614620242352042823 0.18765700474881280568 0.32013818094626778077 -0.14446055268843199793 0.3809391644704213653 -0.079749136166812992221 -0.10616499880151325508 -0.46698256750029643047 -0.13691311042343198845 0.63495435787749510137 -0.14705792298217573721 -0.14074134248437700223 -0.13253435790310713616 0.051488007749530585733 0.50508963322648525729 0.13913255943298180606 -0.0075763194477486365402;0.57244066162143569798 0.090409544824487070303 0.62058952847723136692 0.5555360554334300982 0.053597165945925909214 -0.57251513011500809736 0.47393286032447951017 0.21888678867784633342 -0.35490590950778649892 -0.10433737487868066651 0.090731384712125259795 0.090552940390327046893 0.19725754720336188819 0.2877544596207150529 0.05032145038209179938 0.58346536383760561062 -0.47129491326917438698 -0.19687552865896917886 -0.47933294785059382681 -0.23777380870952269376;0.1153613257375884632 0.61134458710665084968 0.84288706470018393002 0.20723203976429324658 -0.89389914752147880961 0.39379068550297036122 -0.21181504569429149276 0.071559487026587043079 0.018055527922039189825 -0.5179098638893669948 -0.11983104881100303807 0.22086423897293824825 -0.60776513197123116505 0.71767994683551006307 -0.028186853997213715678 0.39761111834425155731 0.4142881883875591531 0.27283509989792942285 0.22980069589683296827 0.40834337723811126031];

% Layer 3
b3 = [1.89511674944774966;1.7138236089712481913;1.168042887145793518;1.3756415017201359952;-0.85675731662167364799;0.99955885605700367513;-0.26275922634494081054;-0.5563922960139204843;0.29294300189580330107;-0.23675158562805240225;-0.0628994217248558668;-0.21741078662255247655;-0.53916830260752512949;-0.824405180156998596;0.73029100685601078258;-1.1632926179134301936;-1.4233541623201351189;-1.4486949360048180235;-1.718700925046753536;-1.7431170811924554531];
LW3_2 = [-0.74011318992876451439 1.1174965495864712661 -0.098183799996195642024 -0.96774301002800611204 1.0722819528009337464 0.12399601785891362082 -0.56666610207298473423 -0.49861169491130147291 -0.19922798201753502689 0.21805945234704590674;-0.66910252162010375176 -0.19045131399935244509 -0.5753045648280709079 -0.59349120974657931793 -0.85738545127018417347 0.54884920597233433082 -0.33473131174418807587 -0.10880328507060417487 0.9447201222618687444 -0.59870282686637454894;-0.24524303743691192037 -0.66091544115156408701 0.2974827749898010798 -0.54759808234690188211 -0.92117408271586298518 1.4718904557887810824 0.87182811716793429113 0.10702197381422418054 0.22834555098393902184 0.38598933354892073222;-0.85831363710970987047 -0.27917308377377836326 -0.75863958532185871153 0.7139752445442161255 -0.40913740400512355055 -0.56174039534661779349 0.97053613429635221532 -0.48005116230795297216 0.36073775935588359154 0.22495819190841490065;0.033765733247202008027 -0.064140665672933805386 0.29570555820953087212 -1.2561228530370067702 0.16530670176900930102 0.70312927118040968733 0.38587163717299632903 -0.63068359981681199056 1.2234194824430060233 0.29338877170612770451;-0.64217702144701660494 1.7452878896863592839 -0.74156631701777775412 0.70565438845629013809 0.74127302631259517351 -0.62557117733371037094 0.066034539664646826895 0.35490531745489656279 -0.56267626324234087942 -0.66822622516957019823;0.034145444901928737047 3.2919279456696988184 -0.1778690775536568569 0.61880109364702784447 0.93089786044051470171 1.3343183030543521728 0.15086735666519918153 -0.41783699808647650764 0.90448413199195010215 -0.85478447856123718207;0.29793748008366005564 0.85857238079010966825 0.5805914430417111749 0.50494748847090031862 0.73481363099720675702 -0.081576530794409893299 -0.42320866262896311705 -0.49979742214935013456 0.73533141420718672876 -0.55540308799324222822;-0.6585209761112493787 0.5402129961978624495 -0.37453217758992563002 0.55419752616390161037 0.17097464963128686244 0.67773099259000302297 0.93324015451665198739 0.58936178622232404667 0.64659110314889700621 0.41878952232482957729;0.78237905223164039281 -1.3764220089235712496 -0.22558053658916610296 -0.40620887860539867109 -0.52445735298884432751 0.4932669468661485257 -1.0816306455381827778 0.57515852257978661299 0.54411846762921656229 0.15877520688723570363;0.56793299375634564985 0.47712499429519455996 0.66007412724426683948 1.3945622501002190585 -0.3026685150254664336 0.29374618961992560173 0.0017079540982433052271 -0.068324693910096420679 0.4972072487224082904 -0.39838983463218230474;-0.39776151745940813154 -0.90978526923927804937 0.22687049275205406484 -0.99702027383809777028 -0.45777192635087760042 0.385381550503210768 0.75175741969920473196 0.021853419301318243589 -0.65415032077056278759 -0.90204925299076998968;-0.30447249391128350382 0.46586936186534005921 -0.66403316515814025944 0.2159281225503608681 1.2974872648998840852 1.5605683041568707559 0.64327344376445350083 0.30785505165872995015 -0.59246197052374893754 0.50099364019188308284;-0.11546523213885695469 -0.60572806643385512793 0.63652293523848024748 -0.35383948645311147363 -1.1880466406512890654 0.68842027547002304644 0.98656190597001724996 -0.9278916014232937437 0.39614032153382466861 -0.50803148687480836898;0.45196230742061477281 0.58987981619489227025 -0.68284116429771024581 -0.4810703906338564817 0.57953039423132712837 -0.50668765696117656905 0.059741382144984263303 0.73370536067117420043 -0.57218315584011369967 0.5807305848934649628;-0.13369648465575759144 -0.20974244328263727533 0.094103765500942251898 -0.35313894905583098627 1.0765956602496637995 -0.095978449338135277125 0.66005561146467617295 1.1378108934390955831 -0.49278698891506900193 -0.30715937372067747546;0.045015519073047211007 -0.60962973028410971654 1.0581592941686275289 0.20244504942564839345 -0.31907661850346452637 0.080281453327316648627 -0.38751050296522793204 -0.89488101484903659344 0.51062254721873823193 -0.71720079190644203671;-0.46899066532959804432 -0.72057925507368325579 -0.806781726384603326 -0.7447873546840138026 0.39404232208610384669 0.8279158894504765609 0.59071248869874737331 0.34558187572826742917 -0.036519957359099186611 0.65231004545578785692;-0.26910305479417173657 -0.24180880807406712751 -0.32616630661750528608 0.34049716637589771961 -0.78097383787446550407 -1.0152390116145524335 -1.0775990065440850252 -0.20969768416351083906 -0.41558343276545745004 0.85457549767029905574;-0.11505929209006608704 0.83513544844700016156 -0.45324175536447491863 0.19624891988888265582 0.61194533793605876415 1.0947000433821101328 -0.15531753204705384119 0.6722170924382768753 0.63182402490916289572 0.78306042972962386362];

% Layer 4
b4 = 0.056747340224093133221;
LW4_3 = [0.54974722173313095297 0.36954350021532128556 -1.0794074170289256198 -0.25045165990854861837 -1.2988768855723977769 -1.0704102145391964918 1.0630932822258929438 -0.29983343708964937946 0.52648328229985652538 -0.28085219610399059231 -0.26169198039971469649 -0.68520682054098625002 -0.78005602511497829088 -0.60610809623214811914 -0.5495187748502800007 -0.35417366801906913221 0.047971549922335231242 0.12283653182674938997 -0.61589474676937872033 0.69047317800107221863];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.499999999999945;
y1_step1.xoffset = -2.00000000000019;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = tansig_apply(repmat(b3,1,Q) + LW3_2*a2);
    
    % Layer 4
    a4 = repmat(b4,1,Q) + LW4_3*a3;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a4,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(4,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
