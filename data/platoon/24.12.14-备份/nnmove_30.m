function [Y,Xf,Af] = nnmove_30(X,~,~)
%NNMOVE_30 neural network simulation function.
%
% Auto-generated by MATLAB, 07-May-2024 19:04:25.
% 
% [Y] = nnmove_30(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 3xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-13.2925490923537;-6.70139767883548;-1.99738196042707];
x1_step1.gain = [0.0638195875959219;0.168202204644631;0.502170423671263];
x1_step1.ymin = -1;

% Layer 1
b1 = [4.2111032289493683933;3.3024481263482843296;-1.3096031218907717708;2.9277931595713950763;3.2701044317152012653;-2.854830428279478749;-2.0580398111833950736;2.3754042856761308222;1.2163386220783252156;-0.82746954508732717404;-0.29381033367895759145;-1.2456593694060824618;1.4562209275050201907;2.3815084753238187076;-2.6037035772172161252;-1.2030394352504716338;-2.7216729197140741014;1.8598129359222963508;-3.6371664329424384654;-3.6582527280978340833];
IW1_1 = [-2.7620065588813069724 -2.1127951234596560326 -0.10051295471903777534;-3.2105122008291480107 -1.3792494419782472814 1.6234676193076473805;2.2558770032923818327 0.55237517754026599359 -4.0138212887871560497;-1.7753878844120369873 -1.4716471459390658705 -2.3695266189066410689;-1.7098230743158702172 1.2737761056928413872 2.1888798069326491635;1.5925931089909612925 0.011145658957340707704 -2.2448099672210122257;2.1165948667837124475 -0.97289729775988442739 2.8021229023040823414;-1.944339875684470309 1.8938915439954817632 3.0858837170094921554;-1.9013136827133452211 -1.2187741623473080654 -1.4697573071028369185;3.7425212692660525526 -0.23080417170862360665 -2.2726404314610419988;-1.6656485931732805117 -1.7758845786052799287 0.44272571580622693821;-0.19529311776109639642 -0.45547166551330464657 -3.6903687038822470257;1.2304609753969324437 -1.3797481539726479394 -2.9794202598588324093;3.2982075424241288353 0.7947817609285960927 1.6569182529375818813;-4.7423688204863196916 -0.72146122753434438479 2.58701840806492811;-1.8156874318726679007 0.83463343668864142799 3.5640269616617472614;0.93194274678140520685 -1.6110362271960412262 2.2599311789767848602;3.0465450813066015101 -2.8063748564057089396 2.7120736173338517716;-3.3778973309004611814 0.93396239885781351386 0.82477731283048905109;-1.7494789875946996638 2.3444539740544034778 2.818770878380006728];

% Layer 2
b2 = [-1.8567387899022071984;-0.9324003911721663318;-1.4870669234882780696;-0.31341026584715953041;0.022305125197957291483;0.62868212904588249845;0.31192092250588177027;-0.38619111256223276341;-0.39224142655911986566;-2.2948662035435631878];
LW2_1 = [0.056609159690820136379 -0.64406878505337850083 -0.084945621960053036004 0.34913492236840509841 -0.28053532116632984295 -0.50423274181597221855 -0.79937208383943902934 -1.5831105681861252776 -0.44305883409038621101 0.46131017125806483836 0.4773909663448929197 0.15085955701127545803 -0.44487073787219255649 1.5321104065659947313 0.77876571587970966348 0.31739018223237519534 -0.31567477692724971172 -0.33966479753267375674 0.077565251218827679924 0.54984014515249657329;0.064347238266808728935 -0.0042820881305426390651 -0.15041605516054643021 1.1584323595370409343 0.012077256713040518746 -0.85548358058463935816 0.23651302903804460875 -0.57441081272639316069 -0.28679836944588515957 -0.23466332825782895699 -0.8944300108840035346 -0.18287793000705762636 1.3634185070307032195 -1.5929649872150826173 -0.65080706415955902333 0.95487360323265690898 0.2390366544124248871 0.27834546275585636543 -0.16646758294741589856 1.1355124918999779382;0.20887803279672886858 -0.19716848903845968222 0.44473648848485841656 -0.56654267725279006118 1.1313520113841273318 -0.35027908958740006096 1.1747134866702697575 0.99267739477995498021 -1.5021334277283733272 -0.90133126473485314367 -1.1025097533922385562 -0.71960935041863527406 0.28895194424719478077 -0.75229778758289078677 -3.6287821866314686758 -0.15521651327413316102 2.0343050813636849306 -0.62768350390225258195 0.98315682491106992646 -0.24767405031388933789;0.45670695075348949343 -0.42945986027272858854 -0.19339428353415805129 -1.2486406185421385917 0.90262920814304681283 -0.793038907937616111 0.32935773655002836824 -0.98153061014565556874 -0.5766569248880093479 0.41647839749550774613 -0.28549791883650876834 -0.19998667591231980567 -0.061003210130308488379 0.25485568083160553554 -0.3129132929779738781 0.052281089182076447008 1.2088885700646709864 0.27676074635054748185 -0.69379573617008083453 -0.52961529820505104382;0.66999909780863198261 -0.46113688832462595979 1.111992253875259351 -0.4039482666338818917 0.52174783347513242759 0.87754368907810342826 0.91043105043004968202 -0.46899869490216034018 -0.53889181329122548547 1.3999635315593452756 -1.2826235802664458507 -1.0536818338459543742 -0.071241384081356454172 3.1096811005597144728 -0.17865440620910333358 -0.12922144165994051135 0.32276144483550273101 -0.59536749453634296714 -0.38334564365614232084 0.029452307785480386082;-0.074606950981994671346 0.27987146327983214444 -0.4064338529169650438 0.57285737216573417996 -0.053722605603796450002 0.76135100096720065288 -0.31298734793399790588 -0.23111248577338106003 0.19894416369347817097 0.080965378504723281572 -1.1576440688867941642 0.79339843490171413354 0.024089648644171526848 -0.33573777136913340868 0.08805332415813876823 -0.5012137885312087926 -0.94186254153900217378 -0.2506383502653840023 -0.48635295581567977719 0.14026361757312003076;-0.54068905635737285476 -0.11792976395564293279 -0.37134458694542815671 -0.36636491708698043501 0.5912846988490448874 -0.40503782305410646059 0.34557246081715764507 0.10590287695973406301 0.76324938725220581315 0.38875451829376889146 -0.38615619409111828775 -0.10264860068001076254 -0.050246846852200849343 0.24715428410421946825 2.3705156596049459239 1.3937524188049903451 -0.463214342639409693 -0.18553877479202263157 0.23762425627984559706 0.45920997558508452885;-0.19952443802662350736 -0.70652921351961683882 -0.71920483121889056122 -1.5964157206518541088 -0.22038068695004509046 -0.83404029733412177183 -0.9643391182980906029 -0.39714137391583176351 0.8503307221931912796 -2.095179004159762659 1.5127047727309070879 0.68431231043231466327 -0.11829651947361517761 -2.3878054043349754565 -3.0813679440800219034 -0.1806250502374925071 -0.97865158879448554963 0.37620972305965050264 1.3463868438663832983 0.91379483768272928845;0.22447092725165371241 0.14923669901716776764 -0.14542325725345714438 -0.72141647896824423469 0.066742328688013052851 -0.11720271633548454138 -1.5520215059893447407 0.8543867596233346573 -0.97645089971882326196 0.38731663240128044734 0.093083077361369614966 0.69647062845381679796 -0.69365212442378298974 1.2935273597214169694 -0.14900301518295247516 -0.30785340051983772769 -1.2862362581184889621 -1.1080671275917963747 -0.50791096582229122713 0.67739682768434594795;-0.92711081247542370676 -0.44152023669761580882 -0.26751961440732957564 -0.053101500125859249501 1.3296695695609082044 1.1800332021160970797 -0.11641227425307809629 0.93776423622899729438 -0.83098742871516073638 0.89262335677314741389 -0.91102013798636705122 0.27304209998666556514 0.21161414111415391415 1.7411234219804270218 0.028781488054240137592 -0.067122210409124319352 0.48907551045891095587 -1.5325869907553404392 0.38963248284144008649 0.93626487850455952788];

% Layer 3
b3 = [-1.7972885157155586988;-1.5170981143406270242;1.664420051346164664;-0.16620822652882785708;0.95000845593888605389;-0.46554094807747481433;1.4577489118005617641;0.42555553151485109309;0.16122485201641295616;0.20779838814641665712;0.061986492021390907081;0.19828684277612509956;-0.66249585280613687566;0.5549817817059325975;0.88834142173401609011;1.2120058114533276417;0.0014968185169650580213;-1.747507677107254187;1.263151303676433912;1.7416008376214617837];
LW3_2 = [0.57283892069871888975 -1.1050678011700429959 0.20078882286658564227 -0.77857897907636308688 -1.0722697967231378247 1.0355043372283860847 -0.80079721605164755349 1.0091189842055914294 -0.35086671104903527363 -0.50140599413058406508;1.4191992687227144021 0.56668594489612211795 0.27268242772261197526 -0.13299827543576275835 0.47870467983179437743 0.68224267960396900445 0.92221398709504653901 -1.2047809374973577068 0.52941078835161925475 0.25851629261954550687;-0.85125110417649352268 0.24089282917649543214 1.1988961874837908983 -0.71736949125341376021 0.88597190988811103107 -0.67160902690218582389 0.0030375801062734394953 -0.18429903475284528658 -0.098201440729936473328 -0.39790562381048577567;-0.34409157867587936153 -1.9055740993339189693 -1.2742088405924045791 0.25702393086318309212 0.081856297525739446508 -0.94096513192097686051 0.15185409833914897959 0.46925463450400484167 -0.614610415473221261 0.94438561842360202458;-0.51744025820433692253 0.89919090054486205954 0.97279838307102128869 0.8755027745019330343 0.47277459979156161163 -0.65037116965513608324 -0.36992467261110240084 1.0868065955425012525 -0.36638403341262004709 -0.05932478451727377089;0.5884130577333965828 -0.50257147836270266161 -3.418222736934747541 1.5431741119253521433 -0.2459387105433540055 -0.61428221530130633354 0.9790953806173188223 0.19319985293562086381 0.63421468491949306578 1.4992345153427297788;-0.32278707856574578861 -1.7082394489724888054 0.14737882087791268071 0.060794614513423467228 0.19083281687210082445 -0.63999934145829706633 0.74371433007344245336 -0.58942967176497096382 -0.69033828325837831574 0.33804035802973547709;-0.76519685486856181544 -0.10979327051061582576 -0.95876743002464404064 -0.93865294381651331879 -0.0047091602977627341695 0.72629510926439555529 -1.0189482377374157185 -0.17920641353922048267 0.53455022973467836156 1.0927380118079279558;0.030269895558007072628 -1.367494285932630449 0.17655751475613282175 1.1405101953601999298 0.17852788374668596139 -1.0483984851660277382 -1.0419063303364746176 1.200047424968835319 -1.227534202903082905 0.64648550519104153178;0.58819457577066525111 1.562799336721867105 -1.3774252743105737107 0.33265850440089761442 0.059314178255243724114 -0.19571161168729281354 -0.33949032648981497529 -0.028139655105960600934 -0.36017312673412466006 0.19946059719500716656;-0.044532341263175560797 -1.3078615363630223811 0.6551346438638030456 -0.53523212538433984076 0.99145597493970438752 -0.021524488237136246011 1.4508316330137092098 -0.46850037889020257342 -0.1672240880500246718 0.13830632185492680586;0.9479502275909571507 1.4793115227449717963 1.6267964337529412511 -0.15530237749873945785 -2.3471786302973081106 0.72428994591386997026 0.5289242748381692838 1.0141177512446593045 0.3852541320287048987 0.33782301935703262785;-0.59083585509606995068 -0.5663851487388528172 -0.63187901141282065698 -0.42181857274062328766 0.5196043312305267392 -0.97030101545727420742 -0.17369307181406717921 -0.58751032906575884063 0.68967779582263899485 -0.66470462797382734443;0.73493015671340289341 -0.4487998159791780628 -0.066164858304275722678 -1.4279044404265728296 -0.095182973504040396806 -0.42786382357483826455 0.78326421211993912941 -0.13838956210101530098 0.22807062218078186233 0.39658109711253225482;0.85704827926430671159 -0.25540045006107697789 0.91095071074035571801 -0.064249496231344085939 0.10299956017924091767 0.67138589215392152632 -1.2610144357150525618 0.65466196541426668887 0.56995692743798609392 -0.12310947752054479665;0.36642106892408043972 -0.67764880049135611806 -0.35605825185621392537 0.8476872590807243979 -0.083269929453590713075 -0.77606347851869350585 0.21339172424507837911 -0.091065587311185483554 -0.54074023831965978282 -1.1104516917140168086;0.9438818665446541134 1.0809910487414216007 -0.82783841894154663876 -0.95305833765840164418 0.26106067934958837595 -0.015246106916958115929 0.28840697958171296333 -3.5919440805248386006 1.088498020709931513 1.6476319967166321856;-0.24154845288479076526 0.002124851628799342973 0.97127309660771743438 -0.76801111837445323882 0.98709569811497255287 -0.40430473711382397539 0.66048921097569857075 -0.08576387531237524009 1.0469850968590692641 0.39198305591011073368;0.48530898354904994374 -0.442973564765215988 -1.2686992414793958339 0.14631445479605639792 0.072457864310058156532 0.52319990650691572398 -1.4407284268540492267 0.021258696016550539254 0.74607674691192804595 -0.061413954831900895159;-0.54126137680718899858 -0.87325654939312225 -0.61243341783516802579 1.5998817206094584353 -0.61628240167428971485 -1.6279452196291921418 -0.1203464473168662785 0.6838584519284480745 -0.80233721243383049337 -0.33398223417032663063];

% Layer 4
b4 = -0.89016759193567995823;
LW4_3 = [-0.35116382025076831042 -0.45072361313417214079 -0.75934810928888174519 -0.21120115104011599749 0.24036088319863271878 -1.1221740889791878004 -0.63398764797858409015 -0.078643397589883146104 0.014525624579882309706 -0.034699565439330656846 0.26179025691608626136 -1.1631057059027734013 -0.00029565713862125808653 0.39258790364266449302 -0.038228722535822615147 0.0026977271257089732032 0.073890696755048765332 -0.13736312632945718581 -0.0081209376738763938697 -0.024599801000896055064];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.499999999999945;
y1_step1.xoffset = -2.00000000000019;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = tansig_apply(repmat(b3,1,Q) + LW3_2*a2);
    
    % Layer 4
    a4 = repmat(b4,1,Q) + LW4_3*a3;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a4,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(4,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
