function [Y,Xf,Af] = nnmove_31(X,~,~)
%NNMOVE_31 neural network simulation function.
%
% Auto-generated by MATLAB, 07-May-2024 19:04:27.
% 
% [Y] = nnmove_31(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 3xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-13.2925490923537;-6.70139767883548;-1.99738196042707];
x1_step1.gain = [0.0638195875959219;0.168202204644631;0.502170423671263];
x1_step1.ymin = -1;

% Layer 1
b1 = [4.342296663961429104;3.4072551111685935865;-2.7038533502533081965;-2.8749952641635605488;1.7457498369508153147;-2.4248495685557900359;-1.1609667176264011346;1.206218139603446371;-1.1944397872520085002;0.83889125943231412919;-0.31631863241751817517;-0.12752770194338433618;-0.30606112672064322844;1.6009769414429750878;1.9012388679727307839;-2.9018122713167864291;3.5840739984588378952;-3.321063765977759985;-4.1815321711163333518;4.2079501416782436607];
IW1_1 = [-3.1538182232353406675 1.4387208628589382986 -0.066776335215805546208;-1.1385210381738011254 2.2041323541964157329 -2.6690889131652659749;3.269480187474564481 -2.2401707979083167466 0.35533125038731100398;2.9422703523430291384 1.4628126401506711396 -1.2288636373180685801;-3.3264779782461060265 1.5093820381287841315 -2.5423044869405950763;2.2613913350106273903 3.6642729531393287701 -1.1231719044617065606;2.7584689775043593762 2.1869494468376817764 -1.9440626169290178282;0.7785880630304830019 -2.7430859138231928895 -1.937441601483353093;2.3889922516712442935 -0.16253845720421727927 2.6626850133073203253;6.3347698280729147768 0.75539960807509942686 -0.93966081379254973172;0.24249720426199930512 -3.9729941640087562682 2.2345042494276934342;-1.4302379430754781353 -0.47838192938852192038 3.3686999924225218273;3.6111473990549201041 0.11555901710580065989 -1.7444650245661692534;2.4391157369516656139 3.0737387449532374006 -0.43584213501546864578;2.6356071934432354631 0.067245269271612631568 2.880230356459966945;0.50701142404811905262 3.7411038641131111326 0.78580138431454282788;0.55726682051061582346 3.110861985705047239 0.12128524197143818186;-1.7545320720824739702 1.5779987449082630846 -2.958579520392232709;-0.6485732256900670345 -2.5928452739799521254 -4.0111377177055658194;1.1551768681666465532 2.6713287494476989359 -2.1139192188392015304];

% Layer 2
b2 = [-1.3089964658882595749;0.69664538976988665819;0.8091761477683370174;0.2217847954121489884;-0.27995485104026618384;-0.8585728791898947776;0.87650578967554448884;1.1981581288104077299;1.4280955058465532037;-1.6243729451269106612];
LW2_1 = [0.37304415750736674706 0.099006376301538134843 0.013937076206376951618 0.0867505030085573281 -0.77216786285872873741 0.18784296531618657755 1.4875805503584003109 0.37458036975560893289 0.71444465883066032852 0.50106467156070244595 0.15990308026099628314 -0.13291095271188135829 0.87723183068954235786 -0.20464296035582055233 -0.2314462233272176761 -0.40148587053103951261 -0.52827629585225233111 1.0638119017491818319 -0.023928035671757000996 0.93661861346304564613;-0.91404985735591370855 1.2885639569009712524 0.0056188353303460074686 -0.044595181495742736155 0.00057970397787384352062 0.67942824783382815834 -0.60137972237617631777 -0.22353251677813595899 1.3372730597090893845 -5.526742609295215658 1.863595498950181284 -1.0068377602840252738 0.58015593001596876821 -0.62585371013739388157 0.51633415193765408446 -1.1388446055250178723 0.90741521412913517253 2.0994525599399884719 1.0814062562840993653 -0.38150306221866125966;-0.57502381328852603115 0.87721154259933498132 -0.36202047892509575666 -0.50773184406476934427 1.2992889138039922514 0.32970883331774525349 0.74525697094375165097 -0.82238531482508270276 0.041887994914334016061 0.26035556740964160838 0.23406771863247063936 -0.13976114222937804921 -0.31406526899970088618 0.87098229327786780285 -0.54183062911811208373 -0.1240859822221391795 0.094132906056569334852 0.23246597163294774324 -0.75582198359230323703 -0.0175483199480376377;0.45255257791940206591 -0.55647882248067292998 0.68181737440609757606 0.13000862241733837643 -1.0294804816414531157 -0.10833715758173873001 0.5448628818693594944 -0.43551092431335619581 0.63698286846051432875 0.34195199452128821616 0.96904239918754930816 0.20932172723661210401 -0.14185292817797764964 -1.1595724719290652072 -0.26402502911423569865 -0.38953720156302673594 0.0019992873930861406601 -0.959893130433360664 -0.68871086773561407401 -1.1366689031868018045;0.0012361204479470018144 -0.083256091736904569434 0.033090931953771433871 0.16669283635960804868 0.64192851583161680828 0.022106882240646857918 0.44891341932146588967 -0.73805301198037420729 -1.2451920249917924899 0.66560285661389817502 0.12648064034455006044 0.11687569178810158776 0.81520272964703066609 -0.27176857975007256973 -0.54794845724381802121 0.46743239971482930528 -0.16793268145673270753 0.83539431939028341301 1.2154013440733497653 0.6636047177079618109;-1.0787644305869152905 -0.45186125688852696314 0.74248763233737058442 0.80839871263297435888 0.27460280716017565483 -0.015720045070381476887 0.31592317440506090254 -0.29012291488938457551 0.0050918835895440153413 -1.246462804570940941 -0.55636764012133244073 0.17966823738845494329 -0.45047664371470191869 -0.10101738857580647157 -0.29889475932061976282 -0.10596224381755085797 -0.50173060562852922484 0.21280907267482090939 0.070266548172224219115 -0.51629195561619545263;0.47980940870848082236 -0.64115010138785311078 0.94513899051613092794 -0.56245635809281047113 -0.8157144964937780296 0.69343453227257545457 0.24620443779000797391 -0.12438426116290049461 -0.22425133003706068657 0.46250646695619268556 -0.04834928606237406945 -0.1919699659208563558 -1.0852245869886050222 1.4016448662827345473 -0.19815218107288856686 0.57719885480409660605 0.088559455258531427635 0.044163225270911397879 1.1865182543423160588 0.1850622693220768944;0.47638006324295956162 0.79459977713184848369 -0.17251742391964544621 0.12834641833433099722 -0.06868436752536741241 -1.4749873061372829053 -0.79511101283681862029 0.089591478199796376058 0.56997441990595332229 -0.08960131011552639746 0.24326954461214328473 -0.22342114713195160292 -0.99875188462080222163 -1.0271928290672862616 0.71224220139184057921 -0.89329558840294098765 -0.22794277067053353436 -0.56653868015824493387 -0.17463211254965033126 -0.10891313651639425442;0.70505564110575202896 0.115881569818094457 -0.32223395629182693956 -0.39041250675569527662 -0.13455953100095141561 0.2993420992063959285 0.025541624963730920339 -0.05629735032354490909 0.36249678831768067377 -0.38915877770925538792 0.22499969344808362637 -0.20290758708265344001 -0.40678640325892706509 0.34521520069772287931 -0.61753419382945995419 0.22087553883722557679 -0.086013870729889654876 -0.50471379883471734207 -0.6030582138361509914 0.41150294192393072068;-0.59418339444311762954 0.24290126354052182789 0.22718025125340257642 0.22284567039017347256 0.80270823569816951437 0.30101197816612201841 0.34282821903665700036 -0.24899921016407652874 0.72668307981851176791 0.25471098670611025394 0.75159713016239315664 -0.52204597390758655795 -0.33803325375902831817 -0.039286945168677499252 0.55743328420826032676 -0.24559235860346767533 0.23458688736240221329 0.052985720592515529737 -0.38226761743125270421 0.23316782778484015926];

% Layer 3
b3 = [1.9166292941648845893;-1.6574637459657750593;1.4795900684795910696;-1.2140859814182132226;1.0909014919699788759;0.8229644647704039695;1.0359136849901444677;-0.70512763011792323198;0.53480291696619586261;0.21527042644788652037;-0.045431249454479620542;0.21779782585539245177;0.48448076616040713915;0.43407702717376611679;-0.75693150986876922559;-0.94220700044502381232;1.3260833373849005845;-1.6459271574380394121;-2.0417754858138410512;2.0864301670563860647];
LW3_2 = [-0.84027596841778284809 1.0051271357677233897 -0.5542633798550696822 -0.4895394008165992461 0.050459719290351305598 0.067783668810452016307 0.35372537830840639073 -0.66787302900502842906 -0.078009325965918765999 0.98992143727604986481;0.59986979712155719113 -0.42599560129665159369 -0.77921974897559564965 -0.56357215408239202947 -1.2328792026072954435 -0.46498295477875678516 0.23186881405842399428 0.14872129042722484482 0.026983317628957854267 0.51088566101020316257;-0.65443633130459366587 3.3803283613303443111 0.48974099594186781825 -0.55375245229662284352 -0.87027329194304992033 0.7961159390042239492 -1.6783581296673426575 -0.464624750541951681 -0.37612707315827603738 0.14988539541277512424;0.85705981236274264567 -1.0846201295463329117 0.275210127211976463 -0.4821451379636214063 0.069541218885968481001 -0.34471665671256618291 -0.16518649801255688714 -0.51191890194988431961 1.0842915290609480561 0.27872662298767814093;-0.44440135486846460422 0.43044069028326709114 -0.63108290998775584679 0.62821392843871437517 0.12128730544883156717 0.80213970567073045181 -0.89454917633466268789 0.25317817224581001812 0.68141190793929673486 0.38941959030864176095;-0.59935253629586049406 -0.66482767837718592663 0.30571075404325365188 0.50918682851599073036 -0.82239213819175982501 -0.43526241383976954635 -0.85486377280672376511 -0.89131348821216893619 0.29617862253597720956 0.21950398918949429183;-0.55153097544898477267 0.31885508155012881604 1.0891499787654908005 0.70838689036835766899 0.44583745118617146286 -0.14655013275394160321 0.82429381608819385363 1.1024325462559947386 0.55613214559860779662 -0.23958924778597021077;0.32456531325202675475 -0.56086146025197702869 -0.10461975280705965163 0.24019463786492933899 0.20701386555105885656 0.88009492240284414866 -0.97192997846386564031 -0.75893170017442235231 -0.35929531151429527913 0.89673814176852251201;-0.44227642713829201648 0.40142180955769946049 -0.097162806605981436037 0.16886557005366117923 0.44519344607217076204 -0.21255319266317884708 0.93482282992142695655 1.1221026304133137064 0.97195311765260794523 -0.76772292621760718223;-1.4950780793358542375 4.9162171039422126739 0.48287096925978512107 -0.84889852494803741401 -0.76892007889517366426 -0.12444567386858119973 -2.6607113955790060444 -0.89489189626650633702 0.7498419534799666275 0.77046823905140326971;0.37932683211798806644 0.5944355163313409518 -0.59930174199475083618 0.36420746284747002042 -0.78471979240387912391 -0.56233935858662265073 -0.47908285907803671577 -0.16621120978780740129 -0.96331703887360453642 0.65128349263575402439;0.68252674501722609968 0.14053439752762936221 -0.44444601013673934453 0.50964718261399388766 -0.51169857473521496161 0.22438881976618504921 -0.8829957713394146479 -0.71850668282832486078 -0.79709978771080669535 -0.55883924499496917537;0.058406439236279597549 0.24605070444324300682 0.40618962139269615408 -0.45525294467024146616 0.1089366310896585921 1.0694932035918172097 -0.28385722901252247174 0.028567225735077375615 -0.94998358281093608912 -0.89547321113333322451;-0.15678200810018852462 0.23474390354591340158 -0.90803987323163370959 0.25383436653970375962 0.50326109408704833292 0.20078059911197926324 -0.29225925166555899448 0.39328045290244617593 -1.0395292945720819855 -0.68587792284163839884;-1.1340962542806924951 0.89638832364628839855 -0.90242094391321969749 -0.021027366542747238237 0.0087263114406514828009 0.3033419136945402772 0.29949373650145044712 0.69492321877507035044 -0.54191372483530142468 0.64237328034803309329;-0.47978966866694117144 0.81536715231976653051 0.15605354662185244585 0.41617984976837302247 -0.39662525575393903221 -0.44640346612372694413 -0.84226926526695344855 0.32356411689957387257 0.54299037653337167697 -0.77925607742152236401;-0.0094040054257334918658 -0.48960027031632030736 -0.58861460835695111893 -0.96573193583350191993 -0.82359182727926727452 -0.048860804468692189961 -0.803248381570821679 0.28060402932014244515 0.65204932142020133323 -0.40264312689190701056;0.29905749771202544407 -0.85959391123804762547 0.13962020679635106513 0.33284939024481569048 0.72248593904762292706 -0.60461296206759562732 -0.88569892046717391132 -0.76845014899567676281 0.30506089978164890875 -0.038850438684771046449;-0.94198036329883849671 -0.84692122455929574887 0.61666579630919715616 0.83692514496210757002 -0.16286696707612832724 0.70478170879701684814 0.45126732721462792242 0.64619615478820335852 -0.025003901928503248497 0.034419532448464462693;-0.086683062932555107749 0.56341843564758342655 0.26578277874379102608 -0.87258036571202313159 -0.072432640840973672169 -0.75905171163230222842 0.28128210005439857611 0.69064596966532854072 -0.72618732239408645412 0.69081670765355340791];

% Layer 4
b4 = -0.31735243178726091351;
LW4_3 = [-0.0099037715501269288354 -0.0052207398737015202686 0.63603386736111422461 0.0017122229685486115448 -0.0016840287061181725709 0.0015764266645714724181 0.00020601360897350620553 -0.29917687137252102492 0.021002694420213491311 -1.6080616757733909861 0.006256033320775658893 -0.0097562194855068049004 0.0047114758450898918535 0.0012381182223181908409 0.0017722177532710527148 -0.028931512813466175871 0.10235084386313236804 0.0041727322816812861123 0.019355008435151355856 -0.079738752035591206613];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.499999999999945;
y1_step1.xoffset = -2.00000000000019;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = tansig_apply(repmat(b3,1,Q) + LW3_2*a2);
    
    % Layer 4
    a4 = repmat(b4,1,Q) + LW4_3*a3;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a4,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(4,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
