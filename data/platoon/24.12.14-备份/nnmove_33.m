function [Y,Xf,Af] = nnmove_33(X,~,~)
%NNMOVE_33 neural network simulation function.
%
% Auto-generated by MATLAB, 07-May-2024 19:04:30.
% 
% [Y] = nnmove_33(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 3xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-13.2925490923537;-6.70139767883548;-1.99738196042707];
x1_step1.gain = [0.0638195875959219;0.168202204644631;0.502170423671263];
x1_step1.ymin = -1;

% Layer 1
b1 = [3.7144793222900132079;-3.0241956759058785664;2.9286490573365200341;3.2308147659149604181;-1.2877495693790486087;-1.8491418216754815784;-1.9915817539426976523;-0.49567461269215090658;-0.66342114966706955403;0.58636819317856681;0.086129217911432881527;1.6739692276687161421;-1.103831876426250691;-1.186412100191576835;-1.5525036649615171491;1.6996061251403433712;2.1655324621637093152;-3.0243308543490670104;-3.018616837431233435;3.8696487409506916677];
IW1_1 = [-0.15271025998163473281 -1.474206084910470782 -3.6546742174989272911;2.7385416935410593631 -2.7763787809877613633 0.76290738285038706135;-0.32608652587582936944 3.4034965353880441974 -1.7812316164985610989;-1.0317135970669839562 1.9223587969625324234 -2.8318487952990309964;2.6981701517071039476 2.0507079506392789092 -2.1864753722478065256;2.4417156959892669654 0.223889133458647277 -2.7784317459490761593;0.74754938249749769419 3.4532237875091484902 1.0256862926065690722;1.233143216755901328 -2.0306020628748524537 -3.2682650917749174191;2.4395560607592359226 2.3399976056060740603 -1.9230315623645002354;5.7059286408995948392 1.5025252376413733568 -0.52001554324648135985;2.2894789455951225499 -2.6070729720204663948 -1.8603814720451228304;1.0981778455914885662 -3.6201284829907169893 -0.95173958196537111753;-2.0593650421809601703 2.682420447538841124 -2.2282061855646730919;-2.3585560265941198921 2.1090743842823225229 -2.2384226569177432253;-1.1327658934652073963 -0.45508544288395785804 3.5240569603629707807;2.8887899460447834521 -3.1603357229961686059 0.70943510107780738405;0.60826367328484443053 3.5090676244946861217 2.1081418437420742507;-2.5245736504050642068 -1.8136542753334794487 2.3781416706732341204;-2.4366505294642251123 0.97183195346837325523 3.1927460124822273357;0.63412601503851717677 -1.9904030660311411438 -3.11801394384586672];

% Layer 2
b2 = [-1.6328951625684844373;-1.1986990560200172506;0.83056930211728219327;-0.32347972206143643659;-0.29266091461742038682;-0.14998123428673798552;0.50300666106322544646;-1.0578004156474403175;-1.3893528010147768725;1.6954023139224163597];
LW2_1 = [0.67029042663706916994 0.091292434379733694572 0.37897770153299437101 -0.57628294797820911466 -0.46250110668414223802 -0.34755278742926787316 0.24200410243784462039 -0.12240069794139828152 -0.16580270605380109661 -1.4271651894393240223 -0.46489519933808692853 -0.31947073512031626263 -0.16580094913320386762 -0.81052235477934042596 -0.60660364344508899137 -0.80929384578900231961 0.45179793029319254005 -0.97003141389112201853 -0.5549570956697990054 -0.16300026173308695965;0.4833545784489007846 0.30117037172965810399 -0.11537296351437417719 -0.28343969661334411647 0.18720451546553718014 -0.46227037791732372707 -0.30862970640974246583 0.02138249853138773221 -0.12896543244362057568 1.0659809282927810159 -0.49554030331553122757 -0.2012584332496827888 0.65028143434287177804 -0.47166150333552669949 -0.012611809485183735069 -0.31430023778915500143 -0.22051347842194771176 -0.16172148529825638996 -0.18221901646883298387 -0.11079924947930304413;-0.32370156277706130243 -0.48811614439659023468 -0.23190414240876067176 0.49201712042161727112 0.26283807384064744594 -0.4258295578172998086 0.29861295398247889032 0.27599242217933089849 -0.062520732609940427027 -0.096413793945318751466 0.22276030243986805202 0.14735705733341877832 -0.59698243685997953722 -0.1395017169542153157 -0.43822713517345196488 -0.63964204251970424586 -0.71368147715658569741 0.23987704679879781611 0.015723149531134961165 0.13559778659811511092;0.071232164401717396052 -0.098729596325087834452 0.79595390887401096247 0.60332835429582143405 0.63837174462889478832 0.25618036392147086611 0.11408776988871090208 0.73053960854607535857 -0.1862025689616932933 0.23662876167143842565 0.40816333878544724945 0.18190205443675125374 -0.042963477985140635651 -0.12365484704881703204 -0.074820918606505248949 -0.32311010164487424801 -0.080605959916023747769 -0.33746720528599766231 -0.94595156771837241028 -0.005539565795795375544;0.0071451559217411524105 -0.4648061782637296635 0.44549267416616444848 1.0103552800791459898 0.68250441917460868968 0.74232078036991522296 -0.80925153091980395192 0.49319978794251156939 0.18524299388460097049 -4.1488617957802329528 -0.57985618862041432564 -0.91032328699339926104 -0.37140093244915078907 -0.53028061597470010913 0.882209358405609545 0.50359388153635342711 -0.38663939676883612995 0.57326676633678630424 1.0862904664133083976 0.12650084521506310686;-0.45352646065419366384 -0.31881127188535351991 -0.0089497540274824701617 -0.6196405538268857649 -0.15919285141565930886 0.45917413135916090861 -0.49347100382263275886 -0.59723510353052533528 0.070589815221170998383 -0.0035541196158092522306 -0.48575682809786835392 0.39986197095064390794 -0.25769733845601389133 -0.0017534456930615900661 0.26223185366823165143 -0.19623752970076788205 -0.42272500141587543432 0.54048417903282142127 -0.44230180821396020141 -0.50045539321340903882;0.088153145652001080324 0.20294989834964274888 -0.5426189447342719685 -0.33482522602396130873 -0.72942526193646473054 0.073026304568400562944 -0.03193215547000266552 0.66428788477917655175 -0.6332818041664208808 -0.88548943959350268074 -0.29866247759766934022 -0.12221184282833898183 0.15098360894213769257 -0.046449085556257263541 0.51738241534428697221 0.56480039483363297936 0.90293176353692294889 -0.069705893501416787972 0.075429270942675624712 0.32692775994433503906;-0.6660402752682205163 0.35661771047733920037 -0.059961424629998927305 0.16894494677125318494 -0.53247134595883383046 0.58940908609360131987 -0.73629864885055551493 0.13571949166709795787 0.32267980669563833818 -0.42846611985551807944 -0.11980634067125199571 0.55590010137142509272 0.3014271017449994261 0.38417022519945348558 0.12862309360143936443 0.53490297826371935308 -0.0023655760598973556152 -0.24582517949353011044 0.37220401431665650627 -0.30367374676967179292;0.013525321519653004526 0.70766963759313883386 0.29284961915458740389 0.24840021914584387019 0.29418535818514590652 -0.36329382183214475877 -0.22173941183605982985 -0.43006213663369874389 0.26913499820447206456 -0.46077009662076506835 0.45110722878030995453 0.064172445070149908286 -0.10594629569971947269 -0.60917442071414484861 0.47686861555451293126 -0.14036155831371865954 0.8254760070829553209 0.26150570708979464785 0.078246302534514783344 0.04461406583822548344;0.64303441224113577768 -0.41930569014950219708 -0.42569806374520863246 0.50263439936477505299 -0.39164797489070113379 -0.30789157498904617949 -0.26560007966990106798 0.33683541210655426612 -0.54054854389142603655 -0.34756578850231412137 0.58336078820547199175 -0.46393075640270170501 0.16503127826199393002 -0.34237093861212625212 -0.63058860359880297697 -0.0058607330421963244743 -0.47438814597160233744 0.11980596735741810832 -0.66380994605981558099 -0.45019881601780503688];

% Layer 3
b3 = [1.8712396494556822191;1.7344634597705628209;-1.4292583828383675915;-1.5508911543612948769;-1.0879904806645843696;0.76816759713570392787;0.71438730019800422699;-0.64417864788822887245;0.091197565845896499948;0.12408864919797868431;0.23687949457104023887;0.60734803846536211669;-0.72343944659570025291;0.40957609786192505918;-0.82259463920211484123;1.658441441853417686;1.205339305274961248;-1.4123486904787827534;1.4569086921265235191;-2.0072701252406401906];
LW3_2 = [-0.70607374146486834299 -0.81111562799087877362 0.60770390691285558482 -0.058699658122520259607 -0.589571401196560263 -0.27873431375445656411 -0.72585175875903951148 -0.20734439367625462358 0.59957519668097747356 -0.82032891565077326046;-0.74186025539258926287 1.1221262090548715928 -0.71186901819780057377 0.096794051480121018338 -0.20639783412024395592 -0.90469617107138289303 0.79772880012672009453 0.56271935195169842103 -0.13722730421393578015 -0.14606210277368614214;0.21376050669523882775 0.71786938558024571133 0.46929522499879028352 0.067731916973365252632 -0.28817039695857166182 0.5853810014247801119 -0.94012744109375856461 -0.86138887773422578853 -0.84216108830889424564 -0.72392491530962777002;0.42292488303702746588 -0.64443953551048471784 -0.66848444839788978555 0.5415347915471837581 1.3617615083585907776 0.76705926856524486723 0.39843205516376839492 0.038303960673439108042 0.1734881353307970997 0.14789548374322331048;0.40220323428966159307 0.80337382692413583651 -1.0748722410304445418 -0.42737764615379553179 1.0843840378171960559 0.045346155681365837853 0.26526972485506561394 0.27775934954801762 0.5584022830176517127 0.51535714348312888777;-0.25718800960180210335 0.5297357959913207015 -0.3050656155498472355 -1.3999246509891571932 0.78134710462900380801 -0.68213803749157786438 1.1571055276973372106 0.049067980179765616211 0.10948390003903436807 -0.072895581852629467989;-0.77144386140374199279 0.77537442003464951412 -1.0900827938001138584 -0.46211677693158759173 -0.18964745097094121151 0.20364942558253801286 0.29945126897321544535 0.053678680144344195768 0.95665690051871654642 0.43207383053742354218;0.77113293649253156214 -0.57086874544409460519 -0.82116498775744750649 0.018519020924816640555 0.26351555185954911309 0.56622605370822753912 -0.90917059548560474891 0.6016405043953795273 -0.4470666917401948659 0.32680593643575178708;-0.76610417726337975974 -0.2164569258409183572 -0.92914647109726067331 -0.88120163578622812128 1.0080106324880488966 -0.4019486652749630351 -0.1647540987714908034 -0.0028383091909688004661 0.18043872911424641003 -0.83219534236821723905;-0.99317036694601157354 0.65937024748891470693 0.52278103590110736043 0.23522148498910108727 -0.47674705791453231285 0.47061692246140685025 0.7879073062276862327 0.13917922493347181789 -0.12679738567804216265 0.074507278509707064451;0.71502954288071296496 -0.93981365994268384334 0.20933728697497155924 0.28725458618328264526 -0.72883394997798389703 -0.27794815342277173764 -0.14768184382148416556 -0.60969649923220459176 -0.60270803981943787964 0.43470618042079800514;0.38267697078102680397 0.41711784923178335527 -0.0070313137174962576925 0.80271147263583852993 0.95888641404130414703 -0.43113625250002352018 -0.28516410960454208201 -0.45392863859349591449 -0.64282662835630743903 -0.63151725883971787656;-1.0839622771258901057 -0.37667029971301629887 0.53785592185909425478 -0.16737955696650794191 0.83585138265580827266 -0.51810372168121510139 -0.45034258195359655463 1.0617239713821493563 0.93543751491072413273 -0.63104405667759899679;1.4085192403821029661 0.14848076171840440818 -0.55013053393320543449 0.72870420979773764536 2.7764773741429720211 -0.35457483787141264031 -0.087127783944571685071 -0.42601204463841518821 1.5642867537853184512 0.30897531545524647978;-0.23133969020365754976 0.89704071239287197503 0.78308374615219866755 -0.62608991121014712089 0.058900357071357017924 0.82035267282189683336 0.66534425163545796167 0.12506104652173027914 0.083153527582641217908 -0.76097425253027339842;0.54593009255041025085 -0.60917458284261094548 -0.0083696535599243476744 -0.69933084277713897237 1.8370447607449584826 0.37700322165269806174 1.1406780832760765598 0.22831468086530815054 0.32524719078740171874 0.39614505712559638928;0.9396354874336989571 0.23278640765695407522 0.46908938882107759083 -0.83689777877920401572 -0.41823209696137680913 0.95949561643841718706 -0.3684324723753675257 -0.54710455879224040299 0.14817965961652068696 1.0167711830818406682;-0.29261324388365239635 -0.69782748587222764858 0.9009335974130259217 -0.879346970549514384 -0.18734676247680906447 -0.12310440442402514893 0.072215706416546357471 0.0067782516564929362959 -1.0118861667942160576 -0.57462229429680367065;0.67974564945824023088 0.91812839295449888422 0.6420292464652247455 -0.83033577137278524738 -0.20995028353560946099 0.05916265392823686492 0.28464428813594000456 -0.65480226042404388043 1.0453274558985063969 0.28736849023431099148;0.073346498328200476768 1.2704457234447366076 0.27587425340967103304 0.18435243502115281067 0.29541342097739392569 -1.1102064989074362789 -0.42417508664820624542 0.29575172179548564477 0.11669721236224463168 0.50360188550185314149];

% Layer 4
b4 = -0.43626304171244500996;
LW4_3 = [-0.1769543617321393536 -0.76072509304014823694 -0.46033096536739620541 -0.72236664960055430029 -0.493854296882398347 0.89129544644755720473 0.36238807987990545589 0.17109247958865542172 0.17378965648242916675 -0.33061720414339251795 -0.18066690768071291817 0.38845942539029615359 -1.3238862716796351293 -0.98928301998853607202 -0.023052944394323284655 -0.7832637702884119868 -0.36822205393016421704 -0.20712501662081145293 -0.40431693925048894922 0.39707661840437202816];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.499999999999945;
y1_step1.xoffset = -2.00000000000019;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = tansig_apply(repmat(b3,1,Q) + LW3_2*a2);
    
    % Layer 4
    a4 = repmat(b4,1,Q) + LW4_3*a3;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a4,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(4,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
