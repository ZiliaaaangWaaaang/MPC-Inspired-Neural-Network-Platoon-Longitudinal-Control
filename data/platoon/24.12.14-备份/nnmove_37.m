function [Y,Xf,Af] = nnmove_37(X,~,~)
%NNMOVE_37 neural network simulation function.
%
% Auto-generated by MATLAB, 07-May-2024 19:04:35.
% 
% [Y] = nnmove_37(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 3xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-13.2925490923537;-6.70139767883548;-1.99738196042707];
x1_step1.gain = [0.0638195875959219;0.168202204644631;0.502170423671263];
x1_step1.ymin = -1;

% Layer 1
b1 = [2.7248083470878663448;-2.3080403532734252714;3.1458198793695513196;2.7617487612336351077;2.0179563542750833527;-1.8396122000662635809;-0.95203507888397964631;-1.8812249333038655319;0.51845501534827498347;-1.2931302226717844572;-0.47834641827774065925;0.044063439358474135177;0.63999549953155776549;0.99845060018798093004;2.5315023316216764826;-2.6426360543935656366;2.8727869806107073636;-2.6633921677303598052;-4.1982276019176687498;4.0361744579751928086];
IW1_1 = [-3.4517789410777268699 2.7643850585624787364 -0.61271470366173841349;4.6509636511545906501 0.25012233756520413364 2.2743042195753599977;-2.95547935360030678 -1.8832152067171321619 -1.5557343737198161548;0.55267915050032612179 -3.2329102737804609191 2.4391863428265878611;-1.1927111625088673286 -4.4457989012351699643 0.35592123779370310466;2.4224513309998605415 2.1248084711612951203 -2.5173711777093803477;0.60349159827448417559 -2.5913138188660074235 2.6816704524601617798;2.7757429536809996584 -2.4177589932471592604 1.6391056301868902612;-2.3570195132084648115 -1.8570049332953280086 2.6680020419876124826;-3.3766695806569697602 -2.4090410948995915064 -1.1165688401589810574;-1.3568709689513884786 -2.2281955437779026319 2.5689043228124295304;-3.2536266959826498635 1.839847512270173624 1.5707132298180837005;2.0869268292615186233 -3.1157668803941946933 0.72778676231369743288;2.2810326549438029176 3.1632401123472067006 -1.4076161360343653062;1.8951775202311991197 0.67093819310315661042 -2.673591490825862671;-3.0004602519601570876 -2.2550552001285288917 1.9172538398238192503;4.1075291059968295215 -1.7664424649593115646 1.6116073038340423818;-3.6022481610753538384 -0.77561361942299378303 3.0661441796915176461;-3.2301202838807321349 0.97337319166597313647 -2.2756115346570124913;1.592473089608430703 -2.2862208073659751051 -2.2931441959868177349];

% Layer 2
b2 = [2.5062796932902027258;-1.1990460204121906607;0.51079669311681130672;0.94770498596202812358;0.35611548286978872424;-0.69936567071339694746;1.0398429474544810258;0.70175588676330435955;-1.2205312350173125324;-1.8363442025889622489];
LW2_1 = [0.18173893019252060355 0.15398381719375897614 -0.084266592632964168463 -0.17003832035751167973 1.0876932582652960591 0.045917002960198516348 0.67836149170904314065 1.2105632452331056559 0.16603525248787356916 0.89976531307496077083 -0.069602084686389967261 -0.21441448569440893501 -0.44082608492512109777 0.10479549411480822141 -0.1751677703182495105 -0.16664574658979114385 -0.11349496019046312334 0.024385218520241391804 2.1007900190816863883 0.3747885073770400588;1.4773279109885317784 -3.6560118058188129098 0.32024321538310934754 0.63018188702265154344 0.72394121507282438444 1.2077037335130862417 -0.045425012759615676639 -1.3766584279951574743 0.33819510870974661687 -0.72149752130149413798 -0.035869717336929472784 -0.77905941225577346465 -0.24075273600013133435 -0.72204149235751702296 -0.71130991767749851551 1.2659348771089085073 0.15578171381602989864 2.6363007063950396613 0.58674824654534230017 -0.30001008452652333514;-0.64628102150418409444 0.16740852822410726142 -0.44780610647050911322 -0.57213542091655766875 -0.72726637450750131197 -0.43660852432032559722 -0.078553069313960097175 -0.13111345641909868953 -0.85332776196083481857 3.9404396276954791745 0.033188662505266183778 2.0956609153160341563 0.86482588231112467181 1.1710154377342716359 -0.82559847731776614399 0.2359241955455369244 -0.68664696655198698139 0.27891406491034981263 0.81664575953566465039 0.043989960264221091013;-1.4655914095868776137 0.87609763738560042512 -0.049783221185634655981 -0.13375489824165359698 0.31706212330023619828 -0.62769907815650494154 0.059796345601096867473 0.17926265017437664762 -1.1069778484047287925 -1.3900540534528915693 -0.71087672185123540469 0.52393062973283244244 0.90173833045916140794 0.22682776513036920218 0.062375438676931745097 0.24712946458225673596 0.3467264782486205732 0.015302332028361842475 -0.71586072529496647121 0.41406062105705221388;0.26542512657373251717 -0.11792481954953755452 0.61666979867281801475 0.69859026312090322097 0.26290895050181051218 -0.35625196704060096975 0.32216353419269666558 -0.20219751919209161262 -0.4851743190800415495 0.18289811278713993814 -0.28474179351239198299 -0.55236750613740936977 0.52808545313417176725 0.35184252574949786974 0.38194303048001937428 -1.0429003923986721603 0.449489073868104827 -1.0141123034704893069 -0.56977140899357625603 0.56330082606407361201;0.61949594068826896454 -0.99885107140584061813 -1.049084935348654879 -0.30745518687093298382 1.7417032650419579376 -1.9216280084488335245 -0.22981435473683142767 -0.75178210057638561459 0.60984610948195816515 1.2069308749417158033 0.092947357040730121946 0.41396467931239455673 0.071469309619176524251 -1.1310909318615416375 0.31438748472793409672 2.2892382454906563538 -3.1054859415451070426 0.75264778744550908662 -0.97631889446736597193 0.24825687967328960437;1.0859363079224748638 -0.40494776967695278458 0.08814746984960722398 -0.077860552097470225874 0.73020637677314648162 -0.67834244553198064231 0.025950116331159681776 0.1632846723493666663 -0.44660646032937789673 0.29556603589067320659 -0.30750189518655790533 -0.09368463778307467571 -0.034982453127432512618 -0.22124445800661771133 -0.52545540410310953572 -0.18885359075336097257 0.44987334961242553266 -0.84922361701375237431 -1.0277075377939886014 0.53898448714809554794;0.44523662426583976437 -0.049482625856263458275 -0.16426973450663295839 -0.75270892059828331533 -0.60631146412046132976 0.27264203340181553115 -0.34237457844530594375 -1.1109793428220982037 -0.71531874306580445211 0.51018642986580764465 -0.45318072218434785059 0.4753184334695289559 0.049071656905693497586 -0.65923748448969454738 -0.48007673106758913528 -0.65379817008093965569 -0.39021817995843133264 0.95395447715502168506 -0.71429253996970287766 0.22167207429167379296;-0.43584969076761431728 -0.20621175179795037113 0.67092326196758078627 0.27234790644367024015 -0.4926717325735323616 0.81636897521752194162 -0.52573554271477562772 -0.38106141647783003945 -0.45150169656162741916 0.12182222890842361873 -0.56217109738845694178 0.4025468996617773132 -0.30053492728705344383 -0.2164248352954338539 -0.42034588313133491866 -0.34491138082198463666 -0.47651642002591887426 0.16144193287389632663 0.067748274821154891301 0.65642889065957898964;0.26540633717641454181 0.8015658479263738645 -0.38888610147191021715 0.23886439450106317084 -0.73379091449720135198 0.59586960968247615344 -0.55150425976030348352 0.25739639300839450842 0.89040328656797218532 -0.16691515486588512363 1.0527003065253790481 0.5422526661982306484 0.3525647452333784404 -0.84476447798423748292 -0.51492411388390590954 -0.57775690026175119396 -0.0062080057070157141502 0.061582540205005552314 0.43298029955364125687 -0.36035215387717017821];

% Layer 3
b3 = [-1.8753791792365044344;-1.5195579195948087925;-1.6866645465249845426;-1.3184404866833212555;1.109170172276580324;0.99852171317460836075;0.70153282212209422397;0.76395220360344562316;-0.10784884196055161132;0.11898313001634802655;-0.1308074985272669466;1.1975669509972177718;-0.28234182428406051635;0.91871914308338609167;-0.47445005947479024222;-0.90994164706904068218;1.5850625664033848317;1.6976721863248556144;-2.0434935989590043981;-2.2017692004179960641];
LW3_2 = [0.52167407604673665666 -0.79253250946250364262 2.1293887280299661491 0.30349890345558333538 0.70232628270802233139 -1.0992905662056182692 0.48751943242441447834 -0.52899836039159786605 -0.63838097215368994064 0.64969383855711482223;-0.97954709546686313804 -0.91943935798413023441 0.51462469943720678955 0.31354729734963848742 -0.45789316504155819221 -0.74653654815189041116 0.66150408333996701948 -0.95654352766202765945 0.62874962696708902588 -0.14538327815540241783;0.13984728805671026164 1.357512411849772338 0.085512213273405607294 0.69963811023005662015 -0.32112066720253118479 -0.89185631262726050572 -0.2911355330030127031 -0.84508302660085155011 0.11293269329675653667 0.80982781489047450663;0.95695753383189974262 -0.73973071728304629069 0.067400981851314212268 0.88636166075726552371 -0.62154318690877208287 -1.1060356273252898163 -0.7179870103485328503 -0.29841184704925705073 -0.30367760126897863637 0.022406053623417250542;-0.36728499858347507523 -0.079202992376446401668 0.21625219934464828819 0.012801168685045183696 -0.81518400459352280407 0.12971763528193575032 -0.44634757112758771669 1.1469804017428835152 0.75970263161346796021 -0.9888919298531790858;-0.69622638614380361055 -0.99856745413819214541 0.6817327571999642899 -0.4976049119482005012 1.1497703706779356381 0.86888707484171279205 0.71226662885684521864 -0.42715391065629393363 -0.46662469725504446272 0.63994738412700735708;-0.31686276358683185261 -1.5665848952827530205 0.31261620327222705562 -0.66055194524091420671 -0.46249780385341243694 -1.4411527376431647607 0.50142396506427189262 -0.57766183042246721513 -0.33669807850529764881 0.95361507991885330338;0.3569597750574739492 0.90444913364555479252 -2.0712883851087591225 0.055494372203150205136 1.0047823190816267402 1.3626644589471992308 0.86796557590166456553 -0.53074436423753668102 0.32042985269948348614 0.64043465407577937487;-0.25877490587572077319 -3.123754791060442848 -0.54527531168808496265 0.43852736471879999458 -0.075450381841264346772 -1.3573510174305192244 -1.035520393547561202 -0.87900939994567395264 -0.38793963657034091774 1.3178283962424357512;-0.67356008118285892738 0.13629488938330774905 -0.97699841243662899348 -0.99233694658897220187 0.59544351556905483758 -0.28671707633654358593 0.2601808069796601175 -0.39013041778795359837 0.37713605729213861562 -0.69549269951264180989;0.81150203893410477463 -0.90196695187284747774 0.71523964841253739877 -0.27134081279531285791 -0.90179523668734906661 -0.50270948690710726137 -0.47621333053092029797 -0.29906836207908676917 -0.81417828896646715631 0.40462668020710834682;-0.38848423725312736243 -2.2183055830109474904 2.2174056353834101785 1.4598876512070626532 1.475540708381555044 3.5465823755249035187 0.94282305600173288429 -0.4043342300294481273 -0.79085582512774454944 -0.71165834981197517717;0.00083382018608790103853 -0.73218488359236588714 -0.5616294079292873942 -0.6462294317722425685 0.1868380015127033833 0.54167432235950252473 0.9179331817094610324 0.83723191820439102351 0.58923693066360027792 -0.93970394234112286647;0.79294951125321311292 -0.39435113763422535715 -0.64474616318611965848 0.46876297795838511862 0.87861669828200561483 0.024916598599494150373 0.92817610125893323936 0.22770689886322098561 -0.43549019898256602357 0.07898780280834497014;-0.1933316019072287284 0.00089764792139979468488 0.25034257914231106135 -1.1315865847007253731 1.2419580529062932417 -0.57324740191662837407 0.086150307454242430749 -0.50855852545640900519 0.84493638160268003112 0.28328676958456089352;-0.94558756600887450272 -0.40959710283168015987 -0.37913440540340809237 0.6425760285145116768 -0.027550803286746781279 0.7936464737035505701 1.0009572354272073813 0.052715475492515949385 -0.6348300864695682888 -0.47370252914237093167;1.082220841930326527 -0.3070906577378817448 -0.062768027834339545912 -0.25953064109476092769 0.22596351830886887702 1.3810383464321236424 0.20464868809066333322 -0.20649945786056356223 0.2728079348441329044 0.34896213979217027834;0.84851635156194871179 0.35485462078612306502 0.52569189978754116144 -1.1383234996179576459 0.83923102662373760818 -0.17590884960838618079 0.42377890217868174894 -0.01901984014942540227 0.31232976089780889462 0.76013952035619647418;0.38232426463253138538 0.122974399402539597 -0.55485593095805341157 0.072958550235978802956 0.087874835973049791882 0.88678859372635543412 -0.10997909016462964482 -0.61321704346600836022 0.53887706707556681796 -0.50952454723457152319;0.076863802123158214696 -0.98158656582762560117 0.00013652400319588524347 0.4504670926172557599 -0.63366662463715661691 -0.46218273299309908797 0.36504876416204334877 -0.3178321560414619773 0.60939492539653439263 -1.071418468207497865];

% Layer 4
b4 = 0.056140288266200384648;
LW4_3 = [0.91703393386322618053 -0.31705985339510134313 1.0884056374039756676 -0.84988569416174719606 0.009481854853192217894 0.85880430221059178564 0.42087981355762982272 1.0860202845343989164 1.2061130032007234547 0.16540137907464974587 -0.60859668760273011312 -1.9519368129414167434 0.13828024373727557106 0.55161993890339411362 -0.066516756904417440044 -0.081335922544714667204 0.95435708819561992922 -0.73669647893036871444 0.043859958918114026749 0.17688196087350244179];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.499999999999945;
y1_step1.xoffset = -2.00000000000019;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = tansig_apply(repmat(b3,1,Q) + LW3_2*a2);
    
    % Layer 4
    a4 = repmat(b4,1,Q) + LW4_3*a3;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a4,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(4,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
