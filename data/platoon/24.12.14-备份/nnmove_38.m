function [Y,Xf,Af] = nnmove_38(X,~,~)
%NNMOVE_38 neural network simulation function.
%
% Auto-generated by MATLAB, 07-May-2024 19:04:36.
% 
% [Y] = nnmove_38(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 3xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-13.2925490923537;-6.70139767883548;-1.99738196042707];
x1_step1.gain = [0.0638195875959219;0.168202204644631;0.502170423671263];
x1_step1.ymin = -1;

% Layer 1
b1 = [4.0554870844307151501;-2.9253244913021054785;-3.3593229642444648597;-2.3742979482194956908;2.3574686939616409376;1.9493906617846514795;-1.42390526998738709;1.7209374259730019219;-1.2521659750246130205;-0.35642819141518300441;-0.07790311974754765556;0.37777004221481524926;-0.83719318405966436369;-1.8219252787704671714;1.8577156876386671236;-2.332439978656707158;2.5948287335848596591;-2.9515662875767851858;3.007083539941367345;4.0587944529593134035];
IW1_1 = [-3.3203874975219189736 -0.78646489934944063815 1.1468677811450433968;1.952746383304023059 3.3134602901867724611 1.8089044568406837943;2.0669338651262609829 2.6803814180158025415 -1.7898052683304916943;2.3165768831208710665 0.74470448398161004366 -3.2065926843883287845;-2.7286240530997711851 1.6709702235548613558 -2.2853912685087647283;-0.48160261943698889908 -4.1302001155241070407 -0.22744216251985596711;2.3367051708009465294 1.0065815373434328084 2.5540755189352135623;-0.88017030938371432214 0.67498613543387420144 3.1017202009374549299;1.59720035053648024 -2.4980049956906258402 2.2392928908116402908;1.1636195857420887911 0.83021812919180071333 -3.4036119777404518771;1.575213210601378977 -3.3769264789436861385 -0.97354493068537251155;2.8036190473913729093 -2.7178963568190241951 0.41004355400076458738;-6.1330623065361171697 -1.7363312023653054705 0.62543754300830423087;-2.5322461106111768814 3.0397531836908942005 0.73156576527354610917;3.3836118189832760095 0.61931901498542030193 -1.8129006133639067322;-0.52743171331903526688 3.6977446647562213222 -0.78963446462464559339;2.5838837859791836671 -1.9445140163042533565 -1.8764372964387470155;-1.0566420368167699362 2.5540270194502490142 -2.5514405235780479586;1.3369410984313554458 3.6793291122481748268 -1.4926750029601174585;3.4967641539455707189 0.19305913059811422028 3.0029781081598683201];

% Layer 2
b2 = [1.847131212947991763;-1.1569632939464857824;0.78774795446013290423;0.24636951208356819287;0.094987783396585465101;0.0054468452370615731348;0.84967707028666239477;0.91312132188933370358;1.035756895714413206;-1.363419551663937801];
LW2_1 = [-0.079091084380791779052 -0.54169643085979013453 0.25666752247777785412 -0.10902485030516495534 0.53998250220311516667 -0.22815815346343523706 0.030634672270050650189 -0.11547320199183636058 0.33979832807937393468 0.51333708320519944035 -0.17341848780253374396 -0.31363647230535163235 0.19684368146995881443 -0.0041422525661411174064 -0.74071677360212717645 -0.18351054822387591337 -0.22791687802220836345 0.1700639149532322536 0.83232032502579700317 0.77491190312731450529;0.61300131872376073527 -0.065983241146822746437 -0.2908343022177374837 -0.63642732084057895836 0.20979029511426353083 0.45458677689411042255 0.17302104385904049089 0.01601760936099618296 -0.54220928820490210676 -0.21729334718896053946 1.1782513221449282259 -0.1437984763222778517 0.45175501409126805896 -0.63427606124532565079 0.25787923250749783532 -0.37999096784370389734 -0.25405660168024890577 0.044318018045685733663 -0.49210335860202852887 -0.30922045116297947054;-0.56637426100853593969 0.28325585607174291747 0.43058780290074999408 -0.79777092219330469902 0.50084716493595593523 0.21479063434656509024 0.2086366564965510817 -0.10165182228143662679 0.22870542275342078953 0.011407103071079399345 0.31484176837052069153 0.52265430486405084487 -0.47884245382274814862 -0.12728156971894052929 -0.26445182207699702293 0.23043816624717580743 -0.5325022675498402025 0.26240254468787654885 -0.01763798663370661976 -0.060136016314386031567;-0.72368629143197593656 0.13618552743825099172 0.66076920499651325969 -0.40695306407841314034 0.42090331894136950863 0.21410873052019877005 -0.47827672961587325284 0.32298977414145335629 -1.0968892541979213817 0.45838105045221172462 -1.0546272528563509496 -0.17838085478345322432 -0.65260264184160554635 0.29360387745059929321 0.10823165143297945601 0.69818991166041910468 0.53938605157007579738 0.63897875937046288985 0.28215909319314536052 -0.029491801111902665733;0.45303939298780993017 -1.0982077896260793448 0.22964399379270064583 -0.049568015454054259461 0.12784745841700900781 0.12220036046108501138 -0.32741975088798763727 -0.14779828813931084053 -0.12232824577863951609 0.14755099777607541545 1.1131489114674513186 0.49858711668495730995 -0.10861628727908538561 -0.36085111940703573641 0.9338175564200905665 0.49856569576175102654 0.25841993413645403255 -0.23111996996016814787 0.49008265142990181662 -0.067932999199528928957;-0.13289633660482824684 0.1826057409790666497 0.034956136794991543582 0.26383371530477178757 -0.2473681317936568258 0.46678737014049376253 0.69237888233861688558 0.58812575747993278696 0.58049176731819440711 0.26375508195406427436 0.87067897041796271651 0.048791322532310325844 0.12207784195356065349 -0.63454757125453509214 -0.39665972496536738845 -0.062420861218124443215 -0.10466266695068333903 -0.49670548585458684787 -0.050440183092168390522 -0.17403006716286437139;0.72570924346184151332 -0.52452042285604649763 -0.26931658722549606244 0.17661513622972327409 0.4423671409125561893 -0.21127869937007509593 -0.086034739998773382408 -0.51093203934955011558 0.37448519199791263645 0.12637842509915450662 1.1575515374106108979 -0.28719717835824354335 0.59649550386318039852 -0.27601257534724699116 0.60065608042497609098 -0.030785344502061488814 0.062671697259125663804 0.36420308477466650787 -0.59899592000583101736 0.31233003554111610223;0.28285677266676967356 0.92199221237709305665 -1.3340610218489068473 -1.3009874613709333513 0.31552147869556629312 -1.2038996504078718353 0.8711396987092687727 0.28827990292146693507 0.39454047582207524281 -0.24921052998978257542 -0.63357705444990686239 0.17911243074329724623 3.7295300127819817071 0.87676572529473462136 -0.037642907990250981665 -0.43095611235923642068 0.28952294000962736087 0.47981970542342133879 0.63892269139551238766 -2.9481428475515101262;0.46742612795403576387 0.2186463347419602965 -0.16884187429442890083 -0.16917169300210446736 2.0122864023461080052 0.32771360611955524522 -0.73109798577477336234 0.11068864181517600043 -0.69200431959414343552 0.32289076886789602749 -0.34565343486389416006 0.35988038062854210697 2.8745274253791603947 -0.88168347333090024698 -1.2405731452611969967 0.53344216066384930741 0.43973143093864391906 0.3182890195888388174 0.3426022575609584675 -0.42561464457850894938;0.25100704950340729793 -0.89183998302116096468 0.16102435091711769788 -0.66547124612649799502 -0.58200560626636710371 0.39589114553869508839 -0.2349105814066330955 -0.46318012421731891148 0.83271503919655598391 0.02488001847098269062 -0.050643515721762552562 0.63336565611089068462 -0.21135755268231964932 0.22437634998697056354 -0.50019243981857752779 -0.77418201788160811994 0.057331998217632053338 -0.41414317329218425234 0.47994402095874899583 0.30745182403489568213];

% Layer 3
b3 = [-2.052105768755616122;-1.3518220688198776536;-1.5198409658532392452;1.0740441378313965171;-1.4132970660748480629;-1.1050997894866889659;-0.39770936178662852356;-0.82719381293007698819;-0.37709450334714633701;0.28134843253087160608;-0.35776553552154810589;-0.42663748631820558321;-0.2747534083966101659;-1.1254063738811479478;1.1971217450132416449;-0.82608642981164615016;0.70241081279458250641;1.7864266021894406045;1.6141511230844058922;-1.8566571445670458917];
LW3_2 = [0.24438920981271425314 0.30013225660448927812 0.41548952426331514642 0.70719626393061785219 -1.1084587160399737016 0.50852199188054425516 -0.14501569416244963762 0.70457492357415973938 0.024253431160746394268 0.76171196531454532508;0.79497451929609075361 0.76855753581166952326 0.47921163854032267082 -1.3015703212945701761 0.26035373299532099667 -0.66677957174492896719 1.0938315584696254312 0.3702415518210219747 0.37262250951940567578 -0.22455212341093400141;-0.13137513735204314758 0.61078768004994066221 0.56597248258041921165 0.95396461439487956202 0.39240775887691298207 -0.49957469367206641664 -0.99713867087291874203 -0.57271138938173438149 0.65065467632972351364 -0.75120973505246424473;-0.23804486141076597328 -1.0837970162108530037 0.58563548137115217784 0.89519352442854205343 0.067910235003483282457 0.079924319689380199372 -0.8062955341447201052 -0.57626113089938413303 0.60598405968104263053 0.38788281984760830667;0.40774434815525023579 -0.41338186847566837923 0.36676024823125041863 0.35431006053858582483 -0.87024615388027493079 -0.86875693527673847338 0.47130213537007892288 -0.94007502570720313795 -0.70587753862634705637 0.36548213134571261307;-0.17197868151986817065 0.30332390120775604148 0.4574910922532408053 0.97735147715201975416 -0.12582175392926728263 -1.0341444383033944199 -0.46900841679097443615 -1.443962331561246426 0.12979130479929865127 0.48201283139368106267;0.52035966167408886918 -0.13224313943196630561 -0.97997075090675633824 0.43889086005391431122 1.3902369624444661511 0.0035105052609492601659 0.27108718444896429123 0.45139317338155732218 0.84011331865292404597 0.60910402500180327312;1.3189576345374101063 0.16993137190569856942 0.46550430078393650879 0.1447160202204566537 -0.7368386391565209248 0.18448206087364960037 -0.2255553936228120171 0.71068502050178561369 0.11885158733490758243 0.40685435014056858805;0.73339950008796428449 -0.35927115675772841596 0.78126122330672664873 0.5641730882544730985 -0.50922923917743156963 0.86588735828204443923 -0.0040390781451409944747 -0.58422307360262537568 -0.24260589097025611616 -0.36813675027694242603;1.2401775750764323369 -0.70767152313450920609 -0.3294756383166872471 -0.60948763633062741363 0.14910631000420279668 -0.63367188077908487287 -0.14004359674372565681 0.26547582555784204894 0.59743687182364135779 0.78651995095316706852;-0.90419294629313151646 -0.92776852413979937761 0.16995961118603808426 -0.31316738112116748738 -0.025669884967781171625 0.084015636460087653181 -0.082031678086177714504 -0.97784595268056939688 0.65054579113634725118 -0.42674160818926076821;-0.98542222235233800642 0.48468741886575317235 -0.35230753052643620782 -0.37265474933656739243 -1.0976283923759546646 -0.16643577027346337371 0.071568450726575694176 -0.70889961353019159684 0.34077040954330495293 0.48973753700255162613;-0.027613001998742271043 -0.1950625000520647967 0.13802165930025295237 0.52845849871000383224 -0.64036037627487185642 -1.1452867465830645077 -0.68743363275246993638 0.63469919525327245236 -1.1596233091594752018 0.35264128671294237005;-0.42502873394250739736 0.31075726183007679193 0.52773701351131652171 0.037906692664349594946 -0.15769594333746328463 0.75781079801468742563 0.99193918357273092035 3.4627674921598696756 3.1540958226323061453 1.035723703345863278;0.32577738129035727077 0.9263992907344256178 0.20570297197000031453 0.75790161508073783381 0.69844916923093935957 -0.43320109256825967137 0.69779741064939793116 0.3578610226464359334 0.6770199474266498374 -0.65034925954607436527;0.025277508122668743834 1.0771955682799052578 0.63973423071849344623 0.049648344310589315187 0.16592851086440757458 -0.78100000458025875538 1.3449153383445213716 1.2597432749488066683 0.78913860841589056339 0.8699099455859121699;-0.41229444116960839439 -0.43337665215693077503 0.49385322824653571372 0.9181250585348543769 -1.1539842579380541476 0.31603492735749216802 -0.10180469876861439338 -1.271897330036060314 0.81587204443565042311 -0.81274868786591847325;0.49329091173054068209 -0.64377378124657924641 -0.2537990962680837792 0.18117391006234478956 -1.0983929316136977761 -0.25579152789586623307 0.16358058018594592853 -0.57401229118716357025 0.72002285440354329982 -0.083640044491627499323;0.62229412975069708924 -0.19708949658942415128 -0.35062863455345627539 -0.70727555362695115893 0.017562011909271611765 0.64581366379067184358 -0.85735601959966800667 -0.32307507616827235708 0.57589056825071194279 0.59860696235770127771;-0.49055469051452071927 0.65319912047727468618 -0.7400797204641575977 0.51969831281773148923 -0.58302732028643833306 -1.0023212415198108349 -0.0052757715878087351261 -0.42233819007688699898 -0.062950155104349675428 0.90065534048329332073];

% Layer 4
b4 = -0.50234611792101413474;
LW4_3 = [0.32055256698315826025 0.12724066810263873206 0.45914398999655781086 0.34820520932787696333 0.46990704436547253708 -0.68381786217593776289 -0.058970085167212575594 -0.066083854709469425082 -0.31813423466216944613 -0.0078161172351750782261 0.33960952989183512685 -0.22231485985021895435 0.065077408510711171052 -1.1218668748816775782 0.30585125467385548825 -0.056564638410336431917 -0.47450690050320998292 -0.037884601055357979005 0.32627906973484505082 -0.339570263228450131];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.499999999999945;
y1_step1.xoffset = -2.00000000000019;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = tansig_apply(repmat(b3,1,Q) + LW3_2*a2);
    
    % Layer 4
    a4 = repmat(b4,1,Q) + LW4_3*a3;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a4,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(4,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
