function [Y,Xf,Af] = nnmove_45(X,~,~)
%NNMOVE_45 neural network simulation function.
%
% Auto-generated by MATLAB, 07-May-2024 19:04:46.
% 
% [Y] = nnmove_45(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 3xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-19.0505965768031;-6.70139767883548;-1.99738196042707];
x1_step1.gain = [0.053913604005474;0.149967019141203;0.50069484362843];
x1_step1.ymin = -1;

% Layer 1
b1 = [-3.1621560670470665322;3.1024238336554064155;-3.0386558544416897298;-2.3768876628238051474;-2.4671331638342133274;-1.7801207328808819064;1.5060454568395953423;1.233252816128724616;-0.51222071208570874035;-0.81891212208611685597;0.052583492496480102596;0.89094188839631860422;-1.6186568821874149915;-1.4871420739560725632;2.2712080212296532622;2.1644071962191859804;2.3980974922806059801;-3.0610808735633177058;2.4490662318557041566;-3.3584592128425860835];
IW1_1 = [0.95267619071074660653 3.4907915793614732181 -1.9720699085219197677;-2.6544511329186262216 -2.4796369974745702258 2.2006345580827102459;3.4353779806411304243 0.24890604707446334354 0.014687745214074360983;3.9872065142195944887 0.020002278534849919633 1.7021023970754258769;2.1531291291532990151 -2.9993499305994659743 -0.51791841960527329469;4.1739813067848912098 1.019521716842129333 1.2623930916813022041;-2.3604063678813504978 1.9038668998654268982 -2.3614504143970274086;-1.0625313763738466477 2.4810072807403753536 2.3445914855794409704;2.3079298446768690134 -1.0814063421296153944 2.466302230124875372;-2.4099338342951241998 0.87049978744552169996 -2.4728111845212379372;1.1848546030201856372 -3.3794911952573811753 -1.5372200974551826214;3.1865394170180678657 2.1882405996069400622 1.1135772663258873827;-0.82816607944926157181 2.8056678694158780907 2.2501284251880524501;-3.0303272999687642653 2.2178751086692995997 -0.25605670244329781227;1.2298935295934705358 2.9411177747923020753 -1.3248014661256071189;2.9209051210604530802 -1.7800482783317932434 1.3226563986861858968;1.3147976390635562893 -1.9352386467791111713 2.9989071462119403222;-2.0546100777752238642 -0.63206141265636062165 -2.9265714713401007607;3.1810835618977613137 1.09443203179449422 -2.7714688862509166967;-2.6101610157166788007 -1.3718875573944124824 -2.6750380266850619648];

% Layer 2
b2 = [1.621949989788336044;-1.174336006188747783;0.81376304712554259346;-0.5243257658675559707;-0.42510990859564523614;0.39681767771981718562;0.69778052601465179183;-1.1422681911642893482;-0.72547110992971897137;-1.7660871655280205861];
LW2_1 = [-0.1063046236838970926 0.14074591001243466626 -0.02702638008718059523 0.63772723279850729305 -0.30655392131420927671 -0.55287282058384223937 0.62648761761817628457 0.2708254741030746704 0.26887094432871039285 0.62127758376920627637 0.04139073368913753076 -0.25396260603713988191 -0.42586924208934157088 -0.04765241224666089126 0.65335023370705846979 -0.055609431193482071476 -0.39238116130032218987 -0.52828632904092742706 -0.21251696583694776321 -0.023968288115969287044;0.85359650767523875814 -0.25272548371173186865 0.69567202020350027425 -0.46428776049525344316 0.69469781539864583486 -0.30530117961936553694 -0.5205670971299561911 -1.214502215806340546 -0.10787017905234415338 -0.13004827769318713648 0.56374400085610498756 1.2030566823754229588 -0.42367951714636198357 -0.10851192915719225229 0.35383284986709462316 0.11483047963051984386 -0.86343952491487330203 0.32491489274020579625 0.29489426491009779197 -0.62996188205914260827;-0.25910306711646197142 0.62153614613219820839 0.1956588941171195084 1.6017362070631884219 1.3151506782129347428 1.6600260886596889254 0.59392874719947652551 0.32888199708939525046 -0.41278303987116560236 -0.29961935898499542086 0.064540532833856967265 0.51036204764624515384 -0.60057151192944091544 0.72126873345246245162 0.61124900947549609675 -0.1871583866504454019 0.051981679174919262487 0.63947431582183689169 1.2687349184139864455 -0.42760043315540041675;0.12204096713533711671 -0.03207867641976336337 0.28491666881478744378 0.56592911883893282088 0.051640121639329635006 0.33557924753278517427 -0.59020799271209634096 0.48225416804160087247 -0.086392196124661382872 -0.032614612448583629734 0.57489539206765816193 -0.13022734193630830513 0.050412696028861114783 -0.035075238066548185267 -0.33184074037767646859 -0.14471196551343451508 0.58570315706223663454 -0.14500182996521654433 -0.31008738207500330386 0.41180553351756732372;0.22940927879695030556 -0.074445035795579955762 0.12146366274908351746 -0.22892096944355888599 -0.071580079428064019575 0.24631448143993514566 0.90843722013489935918 1.0512673793802063127 0.059238302059635025709 -0.50317894614725167113 0.23303361546728343368 -1.4535969989666752689 -1.0595825287872595588 0.45878231836673483146 -0.68638015289539733299 -0.3505531459068628175 0.24734397548859632376 -0.064089936356676174833 0.020243843130766776828 -0.27476022418782486412;-0.25909797748520080329 0.71239162409509315665 -0.45496104072373394489 0.6038404704450286431 0.24534833150493479126 -0.97188232406425145715 0.34749964379949016546 -0.63214002357118193043 0.66824153824466003826 0.1555020046018893709 -0.34512037067511081023 -0.17568442692579230857 -0.33660883049230960751 -0.22826077810901096443 0.77980259631507720108 -0.3257339147130913215 -0.080448921966151804019 0.9282351603613681057 -0.10641237885212576075 -0.05738533582136125244;0.20255629776987404966 -0.13903496028542119967 -0.63074173417546131049 0.099927786081573516386 1.0453563372140624033 0.61423971166564961255 0.47796077450073842785 0.01916412078738585073 0.55778211220232087886 0.4485225670635180073 0.6483894874464729563 0.14173741194388181364 0.17656433968626394915 -0.08315355076121733191 0.44411921674551424477 0.60768051453833837883 -0.49438298990458195981 0.080602993279625778644 0.49802328448679195061 -0.072728066542709302045;-0.2594183090526367419 -1.4421515120412395916 0.33270779753604123874 0.31988039290539810322 -0.01024668962317692826 -0.0072040555603696994347 0.76453997599296441567 -0.43296830489503856931 -0.11131492656483320258 0.73253150621548890342 0.44781267171140037853 1.9256445745963233218 0.098369100953056107239 -0.52311655567045367565 -0.074209994159117109724 1.0644945465160313702 0.047158981565111335321 -0.76551625515631305241 0.37737958146167238649 -0.36417143177325506098;-0.36641952422059964611 1.1556205478576968559 -0.31283256680734461419 0.056274755585020423687 0.26835521159288777682 -0.50959170441798906648 -0.66714247459974906906 0.17094268032301357385 0.51075806955514779784 -0.28654095551130126518 0.18619764562934035257 -0.78147840042501248714 -0.20649576068746783308 1.6865558372182396507 0.11430917644228139052 -0.46888445563231201385 0.7143579451418121673 -0.183150585603280458 0.71665648932641223823 -0.61218393059399700551;-0.12383301048698068525 -0.54079022014837407895 0.71399257140204197558 0.28522668087503932899 0.036086090257803772607 0.046424344030015399221 -0.36156730177602819376 -0.38114624430757970686 0.4822783789447976921 0.10867606569596277577 0.59670400930759726066 0.42363327410625140068 0.16450902713691459289 0.046549450666302623347 0.46060832886193614488 -0.10969112581376896931 -0.54294252576584667302 -0.43772357010862966709 -0.2412967395363229961 0.37518966876956849621];

% Layer 3
b3 = [1.9103059557326302897;-1.9386385212626786601;-1.6583931823533446526;0.91996452217330482171;1.3793598939104629864;1.1734092222473704314;-0.35207229885885765741;0.83212233286908909857;-0.47258118835368473354;0.21682672607394379294;0.35803133515133661602;-0.12394722509700083213;-0.25658465829069393438;-0.816895568804848482;-0.6747981555573321355;1.2311111711239797195;1.2535917582729136921;1.4007437631041541604;1.5082930807888228486;1.8353807426825985427];
LW3_2 = [-0.43649819979147758131 0.83148943479244108445 -0.34511397463447740508 -0.41417840900757335598 0.69998314286121321448 -0.2789754056775514135 0.043147339335978633634 1.3094852189564156753 0.4044859760693836348 -0.74173574175595524682;0.14449076519527803697 0.572181061052474349 0.43567718602780070025 -0.38748080401165646558 0.20318129210774169002 -0.43995790768314868568 0.43910241562306373542 0.10163834238671780319 0.21365890260882824947 -0.98115096069428187064;0.18062129289895870188 1.2032301208670317383 0.81456780346287793737 0.11196128971159645393 0.65326513170284283838 -0.57480288474179963565 -0.34116361174084430807 0.29821777385811748529 0.75855822909767867124 0.1916495154985171645;-0.21118557014673555727 0.3985246804081321037 -0.71016170774446096825 -0.39664456824870991669 1.0922001791324016384 0.86143747364130585087 -0.93211385174872096737 0.70771739153511936671 -0.15134084988561777307 -0.5297041944621503351;0.022876404300502976158 0.45768519185598860455 0.44860047351215392997 -0.41027576891860828567 1.0198416262579950153 -0.29506776936851492055 -0.28080591231256157858 -0.71262547898154626758 -0.86442718160376963432 -0.5420537508344532851;-0.32204139323733771416 -0.80838443313978536331 -0.067861747684735990171 -1.1170516718902834263 -0.050145417200435360439 0.97415793876460055056 0.00038916808836715719062 0.5603456928532544179 0.49018770474652362257 -0.21024098644012131909;0.4380264306736066926 -0.89112089615945111465 1.068753194212594515 -0.64911970882729697063 0.12312522429115106692 -0.21601508044925271657 0.49121144761930762845 0.63211586034484512631 -0.332296052139228415 -0.53330239843366777919;-0.3541568540914726837 0.63898382410206622239 -0.56727916625945884466 -1.16823788414669405 0.6139626574264680503 -0.47040163134337259487 0.19889393168895735942 -0.20889496352613418084 0.20775512871809784232 -0.96958488849115598285;-0.064403135026393429352 0.087016715034378300242 -0.41013203515943869037 -0.5923778943617302728 -0.51322166507483923947 -0.91480559702775898767 0.13828865597843012503 1.658953356951487601 -1.1889594721166754088 0.12040277161558544938;1.2298220183168855346 -0.2227481149645136882 0.14147013559893095724 0.12620120510151136561 1.0041405060062871257 -0.26764935264806766213 0.024072305699650527189 0.75661075288480239553 1.2011450683036191123 -0.16442812991905381148;0.97229673857686638172 -0.38461139782192266257 0.62050108043081220188 -0.999939721689322214 -0.53584307049302282167 0.61112935299958348612 0.039006931102908121156 0.55981005563979058248 0.80517402019977168948 0.066257302195730477523;-0.36151577466842682584 -1.0376029587422896938 -0.085922159629059885466 0.28684316566661505199 -0.55516808641907466892 0.77396416036669413163 0.41661057095930220662 -1.1324940464487998071 1.0117030175957308913 0.15525714657636988103;0.15654313017431226163 1.3672538364488782126 -0.33761147566239957385 -0.35135432622460049945 0.90237889418246464146 0.058363024735392052267 0.091494998548741782174 -0.54858777771172950732 0.65479518252607948892 -1.1593199034350607501;-0.81964666901047600334 0.17596932413438232112 0.46449883227665877961 0.82313740065267315682 -0.49557316320694366762 -0.9328055182600080153 -0.42472423947222853746 -0.73035202265675291944 -0.38595827564552859235 -0.0010630064529001564174;-0.14934282650016098004 -1.3101129958979840229 -2.4302994250335743232 -0.48031381716943949423 1.21494804575209292 -0.082786677364745903107 -0.66209605437672758299 -0.91433825012662228726 0.056968612006298893768 0.11017347739418298369;0.26906634917104554905 0.54727199255798009148 0.56091027954817529455 -0.27475007354705449636 0.085742504234641969685 -0.16075477470140447922 0.55363767713340772403 0.6090004076812459699 0.98317353009421759591 -0.94238989213126767019;1.0699654399986482378 0.19292558207485893673 -0.49032232462957942021 0.2233337171064809501 -0.055242375995273013123 1.3875296756450055113 -0.040988561160366913938 0.70571174167088379647 -0.0061190895080905863962 0.35719889737584142875;0.13003712841390716037 0.55596725419343395735 0.52585750383166818267 0.80341545171166039996 -0.55007873305762000626 0.97898548076396896267 -0.54598845291046849137 0.33614842377575354648 -0.89463676528207580763 0.81239017429883919608;0.099760557576725916729 -0.93166518769785000575 0.49127705452003894715 0.15234905473965629219 0.24946926918042189314 -0.32532515941386047631 0.43556193717696706225 -2.2146143074856405875 1.2963567979304790878 0.73862776553213826958;0.50483935986119599093 -0.034791942767015526794 -0.26340529656182604112 -0.66317503857146919977 0.6865721030721761986 -0.7855389276487863004 0.68152310792329218181 -0.75517924587665008485 -0.94237444714516138689 0.78907517460077603033];

% Layer 4
b4 = 0.45100976942167569916;
LW4_3 = [0.25546049921952029838 -0.6391649014055031941 -0.4122547268423821798 -0.47955702549921674915 0.15380651887162968827 0.19788807042186079554 0.10859323307188090135 0.16384363381604430399 0.2358422278427243779 -0.33425713365210812933 -0.057946517326663303515 0.48159527198076240717 0.31833267184692121132 0.25368321150087075333 -1.0465219113245818328 0.0082163737471155837144 -0.5669825074825679545 -0.39541766381598325575 -0.89910478855452236058 -0.5166325272469348695];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.499999999999934;
y1_step1.xoffset = -2.00000000000028;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = tansig_apply(repmat(b3,1,Q) + LW3_2*a2);
    
    % Layer 4
    a4 = repmat(b4,1,Q) + LW4_3*a3;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a4,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(4,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
