function [Y,Xf,Af] = nnmove_47(X,~,~)
%NNMOVE_47 neural network simulation function.
%
% Auto-generated by MATLAB, 07-May-2024 19:04:48.
% 
% [Y] = nnmove_47(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 3xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-19.0505965768031;-6.70139767883548;-1.99738196042707];
x1_step1.gain = [0.053913604005474;0.149967019141203;0.50069484362843];
x1_step1.ymin = -1;

% Layer 1
b1 = [-4.117323604876052201;-3.6978056512340700124;-2.6041251355325094607;-2.8103730807398616953;1.8509043735562424882;1.4912882600594998816;-1.7977516466859511102;1.2644843178061322408;0.50369752331609185525;0.43848410901752299385;0.33845822146705850653;-0.7590894135073201765;-1.3147045908964916094;-0.37204093369385188295;1.1950877977029283894;2.8039600696609312536;2.7948604606402969175;-3.4943438906750401429;-3.3108313012746917181;-2.4592215538079784665];
IW1_1 = [2.7583956014901338527 2.260923755674485669 0.63368854196664847755;0.53631988327695068186 2.0139498100607537978 2.7409311630563832907;4.2979229324749050889 -0.422568370038283736 -3.3840753196201416308;2.1223463104015940495 1.9596722220771303213 2.4409262998040404113;-1.1420379306939245634 3.5123899510469058782 0.33480040551192935538;-3.5992232433955586579 0.12383818421493075768 -0.8649877564126740026;5.2124399505171501445 -0.47675832958873615164 0.68250359060715604098;-0.15570133752142478745 2.9080445094809501683 -2.0475492079152943781;-1.0547938030404033771 2.0777109355118428269 -2.5270968682915362358;-0.80443873783889718876 0.95212107111252064495 3.4494931435377935713;0.21698658630995110164 -2.7156721951465230269 1.5807938613176866216;-1.7554090054054982684 -0.42601004660918379008 -3.0056359606813467522;-1.9347815107845696136 1.957798575500404592 2.5585762564593452772;-3.5280964581449403283 -1.5950350938611908003 -0.19147704138973209442;1.9474666605283716958 2.0262435397898634903 2.7636608689206410006;4.2225751105866642376 0.65325924912764865571 2.264828625840113574;3.451008633738636977 1.1054795779911976705 2.5302175052927453613;-3.2958377389142716751 -1.4142922147173231373 -1.4544970482564310021;-2.9924913677254254551 -1.5013047571649764667 -1.9893689233245597237;-2.7638071154934809037 -2.4958146986622091745 2.060626636113439325];

% Layer 2
b2 = [-2.3275910283369678488;-1.2912695009818000447;-0.96022789989795320764;0.63884995711579795064;-0.38506878249626691479;-0.53237233138416273359;-0.3582860092424524634;1.1714203048791946848;-0.85254382551162333215;-1.1285884067477836012];
LW2_1 = [0.91781569810739893622 0.6802648138740999828 3.6388299135589408095 -0.83879190425052574387 1.4815460010849554884 0.74317570170953395348 -1.1985571165937214388 -0.3560216119002417301 -0.30570758905096173663 0.27230069312059129727 -0.64388029114345990411 0.83881452091846397945 0.74403439070133181588 -1.216513680082681681 0.39093360862943876688 2.4817684488436171364 1.6888429680882068862 0.98960291206115469365 -0.046006916086582652636 0.092759318167481522033;0.49757288927814352641 0.16298906329318246788 0.62082657576425659407 0.27106150582125171367 0.10337197771661058021 0.44229922385032655052 0.2847490470545065433 -0.66492506217338687158 0.73676465234206611754 0.0063168996293533896669 -0.25959766607900391922 0.57589003115464210136 0.0074266544362006463309 -0.33762453367769934554 -0.8214305639587072827 -0.15255389843865435617 0.2075186820884939165 -0.099397076781541637835 0.15200039876289439533 -0.18510541248235148903;0.4192982513628007446 -0.028679397125986050288 -0.81764427380717619176 -0.87965639260799877164 -0.51142868882213177173 0.60998499185496768416 -2.8038820836571343165 -1.0474083504033568914 0.45645977226469724997 0.50695742884763128622 0.51829814967134757442 0.16572990805722287444 1.2489762931175893979 0.96811505021650223757 -0.1187992821934489851 0.4421635404201095243 -0.40896419157663216337 0.21632170033456346592 -0.10415623285504246875 1.2791459087361800595;-0.47067146071178433964 -0.67884348981540854062 -0.25274213948873436308 0.2748192269707398494 0.66888072720872793209 -0.18790137150743621564 0.011111293463334953255 -0.0870714479400530178 0.10278078431575801699 0.056921548008360335624 0.23264795510858729544 0.28781276809736477951 0.31453367383417402126 -0.436608304616172338 -0.49928734272318520127 0.40016288144355222078 0.21265337681402249337 0.030055216184757260756 -0.67397210423107956068 -0.37128963587732166651;0.79602005524045849061 0.32206812248656352393 -0.32605404243160729383 0.12023945241203946865 0.23457545868185536442 0.56748840511006271026 -0.62928408940901525703 0.27998311768383771225 -0.22501515075492090068 -0.15060104999761653177 0.033788612724888505978 0.11337005672674679846 0.76359238998004763666 1.4246796257806930708 0.18776280296542691151 0.063689571932671634746 -0.0025711411652550014012 -0.29950985264221025028 -0.25188843275243494313 0.0036738375098831861296;-0.22532479597605320487 -0.27819229598112810153 -0.41537824655439758992 -0.028188579201505407912 -0.27582331440063539985 -0.049969457750590820511 0.54356188985433939731 -0.62769425116930621655 0.15944439577722491208 0.50547824123716911249 0.27194120550055272956 -0.27010501685969656727 0.73872767163970354254 -0.4574717359366282099 0.48824721735614767804 -0.3199555331185464091 -0.53808417065471325635 0.12165174256557442778 0.68234119035347828852 0.1843274125614209058;-0.68850124141981960957 0.28004136054550771151 -0.58034001323373407555 -0.38381589555180317674 0.52610635433455676946 0.66638319846943716573 -0.61721839981654813556 -0.10256710359563121771 -0.24198970505092839978 0.28550704210225658075 0.46066554851730656672 0.62212211446894027933 -0.49224964810157367801 0.74448824406246738583 -0.76389806575980578884 0.28450496201396474616 -0.65955751421570185666 -0.0079617501154229542576 -0.27336545866365491442 0.53981154742810932845;-0.10393728002775609598 0.060060471526730205283 -0.14262758154366184105 -0.5641313588048274541 0.51970053341602218122 0.20591262542801291868 0.4334541559673891209 -0.41940971671475679727 -0.11397812558308779984 0.32407636331771588756 0.8567162045752839683 -0.42718437200524650432 0.47768516532749344394 0.061768165708668290592 -0.30147240447990042433 0.27704688286396250696 -0.050493822615987900282 0.55558105906654253747 0.29170992425861230757 -0.13754595826343365972;-0.49439430108998572155 -0.49200117577376845102 -0.36128994949280579529 0.47036470763356624802 0.20534537632944049879 -0.99192072489135085789 2.4104713020435006854 0.92124227965965643783 0.16985664339082057195 0.36689990659206517254 -0.30759034113929079046 -0.75877760118444237403 -0.22472342337901882181 -0.097242720948150784821 -0.69981315779438402203 0.23299869591408373104 0.21021081710409256216 0.44166694366925318693 -0.15076837277348822952 -1.3803855434079657094;-0.68577129521363311415 -0.57538895637035292197 -0.0040400751544265780385 -0.12127580199310278308 0.087897145473282228822 0.1279478577988620025 0.78102640307140158704 -0.27058960450940544584 0.44540423935401363131 0.063185722322476350898 0.24582385279957574831 -0.0018184022818276031341 -0.51399496971825142655 0.14858494261833113392 -0.1242977876785915925 -1.1685138662628373751 0.13923622995499412847 -0.31627031736138622176 -0.4658146439439766473 -0.47153618134683639163];

% Layer 3
b3 = [1.9104801881357496018;1.8365520851663732493;-1.3686917388598076606;1.2638689860460823322;0.97172676336011010179;0.82728396094901535118;0.88092341560651865606;-0.42329140196347142533;-0.47073915852535574977;-0.0037611269945030528783;-0.22825304889966119282;0.25135789328393803865;0.46271018743955577568;-0.75483343412420900176;-1.0430540022964129854;-0.96432047316296654049;1.553636685137862905;1.5605788855979427776;1.5755255213702883399;-1.9103148365017694754];
LW3_2 = [-0.56518197264653535772 -1.0461980072058127966 0.34336868164726586095 -0.13901709853868254863 -0.9785693516827770333 0.66257508420397248639 0.10869057515916927259 -0.63788073036542347616 0.35488884906579992728 -0.35668504603355827287;-0.71599431105148148013 0.48608547821472991579 0.32141792514530093117 0.68484466971009128056 -0.50847025102873255609 -1.2179880508791194327 -0.61126454477754954553 0.41793894821772148429 -0.36212320129947306313 0.14827533232787304396;0.89183720696228796498 0.90169098417240811649 -0.21802037028627932469 0.17658808103872289386 -0.77189075172688892401 0.16576214104335490473 0.53130452807152650507 -0.97884061033659897078 0.36539335762215657821 -0.14383214828568624544;-0.11227520327458352656 -0.66111538812044123858 -0.82616637756578559237 0.49549161665012009248 0.70422661802307195966 -0.14347658659162107475 1.0866437496486305303 -0.56352428377681185179 0.75153392400253293815 -0.53348466196801402894;-0.48894405834001558597 0.80858763353030871368 -0.28359113744420683112 -0.85088632884165371628 0.30402889066683846941 0.63493061068326372975 0.57279440595258812596 0.9445054273240940379 -0.21659271737559157578 -0.50529862750169696195;-0.67081084761451470477 -0.14674348623562663563 -0.38428156837296478798 -0.17053282010373582711 -0.64286246620404696728 -0.94235636787461196651 0.94670312186888083694 -0.31030335585557772271 0.28349524905657436102 -0.72530818362395832466;-0.33993306717856169863 -0.90283355077280591505 -0.72829691846192667892 -0.17090013295938119575 -0.88494756263477747371 0.44075375956257278887 -0.93861358513478709842 -0.4265081062888663177 0.074057363087249458711 0.35243830189903702088;0.22633465096034333097 0.4934508395559255578 1.0947742106459534828 -0.31936771035222427662 -0.21341993251191412884 0.64598251564500097643 0.27454448780304030464 0.90240828528316108237 0.19732537860282400866 -0.40556855092880134128;-0.44532750104783347389 0.20843958775743204326 -2.4420703415495461641 -0.11612300588226801001 0.62430431697498300903 1.3395037845907264984 0.1433326576254880802 0.45581631433807590081 2.3096348175913186118 1.3605980068944372174;-1.5124182218135664435 -0.026273795969341338929 0.46613430802121114116 -0.240740465542861104 1.0500672322958668481 0.57291508511242938972 0.80193047802554617842 -1.0237627726803997241 -0.25862700674824146141 -0.41329881823119835049;-2.9243261675981049308 0.89253639671292617219 -0.96937807118675056728 -0.4271804746453710111 -0.86607611264781192428 -0.41945871454431948866 -1.8676891973109917 -0.88787539940290705065 0.70842921390498347911 -0.042176377942732566628;0.94831091483215723681 -0.097389077417778219248 0.64567362069434830474 -0.0019792760654614655405 -0.15928894397026374663 -0.34165510840840479512 1.0821445823398205821 0.70684917578147066219 0.57538102723957795792 -0.89555425408195088455;0.69498012865330727195 -0.073298732231377020097 1.4064970919603514421 0.31230838371838942624 0.015577025949011979664 -1.2688842108429587707 0.75817716476816965354 0.030199032793160728722 0.360121800989254226 -0.48678990275320066505;-0.28053024548095589763 0.93621224855693596645 -0.62062730317161518556 -0.30617725675260371032 -0.57314598608860878315 0.29660660137834371497 -0.15541506081181291621 1.0836752250766488181 -0.70770969654654192205 0.14838387468513208889;-0.62869836972966952615 -0.50512295065510881553 1.620159769134629002 -0.75041272559693994459 0.72115106902643688613 0.36100306029781564776 0.71307770019716976151 0.48408003167638247177 -0.9780781919974377292 -0.21859483664359843913;0.22003582427136070265 0.67545365067409135484 1.0770621261331494445 0.47180079398320889927 -0.047237706477016687401 1.0795589984952154161 -0.26368552373585874005 0.8274550803268096999 0.55632904445725250842 -0.040699698155681036937;0.085599111155771762105 -1.2008657622784495445 -0.18835775369108417876 0.070659731870266126452 0.03365056669016600055 -0.22537100570732918059 -0.074767369111780376811 -0.83693805371850971131 0.67302130829033790516 0.76278437059583215074;0.45238611189797450773 0.20949732466372161799 0.49993705176577218907 1.0466870405750108297 0.53313214140627929183 -0.20184802238357729687 0.29372054071065561986 0.2042163653034424764 0.96100367271610009912 -0.7712139857231753437;0.64714780949139716348 -0.049000061336667982692 0.317590351420703354 -0.069924818747054168222 0.094085580018591685736 0.85476295985052774817 0.95279821788813878758 -0.95604267424030142664 -0.25808788705328755686 -0.048130739648350163995;-0.17624841686962652854 0.20701729578609689986 -1.0203092023684188216 0.84047173353919668592 0.088155399132706785403 1.1684121301582925945 0.65026307711826003555 0.25797674503983364369 -0.55405651734526784047 -0.39271142105001499711];

% Layer 4
b4 = -0.10433765452354980263;
LW4_3 = [-0.13919066014379258278 -0.44558604010522301353 -0.14629737383472543599 0.69299305081639983594 -0.048531173103875037411 0.2571592648101686529 0.0046295478354301082546 0.13969241928736719771 1.4362336922780967186 -0.22231847201437013317 -1.4245157744141763168 0.032314893300808972265 -0.099005014324069023912 -0.19656779227288587175 -0.79072613038949446373 0.34682512193677778045 0.50391409898435057801 -0.77506299920052645902 0.042188310637129133873 -0.2093264850899294871];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.499999999999934;
y1_step1.xoffset = -2.00000000000028;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = tansig_apply(repmat(b3,1,Q) + LW3_2*a2);
    
    % Layer 4
    a4 = repmat(b4,1,Q) + LW4_3*a3;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a4,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(4,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
