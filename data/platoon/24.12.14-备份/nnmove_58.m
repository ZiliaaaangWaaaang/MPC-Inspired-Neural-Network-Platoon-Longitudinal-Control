function [Y,Xf,Af] = nnmove_58(X,~,~)
%NNMOVE_58 neural network simulation function.
%
% Auto-generated by MATLAB, 07-May-2024 19:05:05.
% 
% [Y] = nnmove_58(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 3xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-19.0505965768031;-6.70139767883548;-1.99738196042707];
x1_step1.gain = [0.053913604005474;0.149967019141203;0.50069484362843];
x1_step1.ymin = -1;

% Layer 1
b1 = [-4.0099129210194277562;-3.1602455307426171593;2.6073889559423486517;-2.4459086316579456977;0.17727479096381831836;0.47069448877611413939;-1.6160772042568738449;-1.8350788739687624584;-0.89906243993433498929;-0.84130063271551869253;-0.58943681488111709932;1.8551864145223366798;-1.4150873087269018047;-1.1575353965612040774;-2.7579580879288587703;-0.51426101298757986857;3.6047291557884673097;3.4958921678542171918;-4.1006882139347977656;-3.1075266227970304023];
IW1_1 = [2.0820251439541799243 1.6235111313114174436 -2.4827062183167152298;2.8474612464524966526 2.4590033869876433137 -1.5772722168581487789;-0.0076651754643146767509 -1.9181885085117711398 3.0732090953405890588;3.113918848678602469 2.2257959731379499679 0.48061098957119013919;-6.7106632374400971841 -0.60813747528756778582 1.055956493956868858;-2.2988533237732746706 -2.7645845967110420638 1.6838439374416827032;3.6810540108969411754 1.00345031769549764 -1.7507141228601605931;2.6213719822634633516 1.688946093605011578 1.5246123984927268946;0.20170728461525683217 -3.3790315516181168576 -1.0563917840199297249;-0.71287796237422518253 -1.4292915550874030206 -3.7094326141318543222;-3.5287235040182758361 1.0633840295569452206 1.5829894142212324049;4.2490292503643072308 -1.9015920720272263544 0.54641481315059170498;-0.67044613153667353966 -0.42406560629538958551 -3.6251978128618684849;-1.5206245672389837598 -2.2053953786380087188 -2.819713701514851234;-3.48814051318952556 0.26119528750091591807 1.0635383671590166177;-2.3688911198687616633 3.7068225157715555262 0.12126415984517326108;-0.36489137582057523668 0.25472900669155967845 -4.0690990280268550805;2.0624956346035023813 1.3260766598942625993 2.8889961503936110176;-2.8374903674019056332 -0.27362763825375019389 -1.7844590494941467984;-2.751411927635445398 -3.0486982389855556974 -1.5262616033790075143];

% Layer 2
b2 = [1.865800733192880756;-1.3058719379517429449;-0.92778459369333599049;-0.68605386792651679162;0.31789526088211667032;-0.11475831876737493942;-0.85421373018911295194;1.119198132644407595;-1.224894558385378085;-1.4982587295466527344];
LW2_1 = [-0.80174368096719950127 -0.036781849092282166425 0.45041231995678837619 -0.12443022943938747416 0.13238257277608928009 0.55831707433439148325 -0.29355163059092181932 0.094173749435746134662 0.56908738291110849694 0.18701177778474112334 -0.17878599335102016155 -0.046568289660626961679 0.31004256417841313809 0.021461319007231922928 -0.72694505953684873667 0.13114169311743290036 -0.35267540338644121078 -0.023020814118817654187 0.012416363485746213791 -0.826071587924227968;0.50904127078209904234 -0.07667258211771457721 -0.70638462129850387861 0.62566784603188718705 1.6404022584601969381 0.71152772793857221867 -0.68306814364801859973 -0.54859739749930236385 0.58334322683218009509 -0.14852015784126851305 1.7089540239468044014 1.4742939907997012483 0.18653912825755197824 0.39087140476252801857 0.54027686139524921938 -1.0241779238424275622 0.10405978033006679784 0.56276451604360278047 0.94900074771206288649 -0.90301044751119396992;0.56037931458283141151 0.37585516592379469847 -0.58812779802153170028 -0.15054179726069993883 -1.3868941567103572066 -0.024636841668145191553 -0.30774682300059652551 0.085832329907613302833 0.65764963898075479154 0.46096729469788949585 -0.26988490211050042422 -0.23842151456430846213 0.13925832388268483131 -0.15166328546126395249 0.99673394430707518143 -1.04148084484122605 0.093796817047718916704 -0.32637055042120732828 0.075472004822091307008 -0.054565404029781730544;0.64190028656169617616 0.56441578717281537525 -0.8540105123491190664 -0.25492798985574405268 0.7385638826485187991 -0.84384924352374024448 0.64673093315436369632 -0.25894373279895088746 -0.31723167603419433203 -0.39979683201559407246 -1.2488315177644648823 0.0053648841519468339067 0.61492519964080494255 -1.026067026787374159 0.36778034025156303155 0.65508759101847457984 0.23320354373096452427 0.62337354746189166388 -0.39648185382782585862 0.12190631177086737325;-0.80636317307758231809 -0.59632651460641550312 0.24864345836604229145 0.74396677665005017666 0.39615124528251705049 -0.43495728915724807262 -0.18265566331129523547 -0.77515140732372200816 -1.3770132638394114721 0.057538629870122863508 0.083552100404888612895 0.55899646910792955001 0.27140637268541245586 1.5041554848420835011 0.19616669891468443976 -0.052036424207490522553 0.56316223172649559903 0.36067071512288734203 -0.00141496112868466856 -0.38942630671579758772;-0.31303717880884035507 -0.74113126340320056862 -1.3756027236167871486 -0.17042599410625858258 3.9640540509513648715 1.7055436062363593663 -2.3626043413215689348 0.67746815687020089936 -0.098399069254851118105 0.30664384760788826467 -1.1790308731129992559 -2.4624784577947660402 -0.81097607801871507416 0.84724264276809158059 0.38447676197440044943 -1.1407230730204225289 1.2495841104681377765 -1.3259094320795021815 -0.16025880871457548471 -0.21683789778940720794;0.053713810329083337691 0.36242903447728491706 0.13693650162930956493 0.36065349232901922072 0.0080629607778809186253 -0.62907627335293359039 0.46516779555340515007 0.26576208329359785054 0.42752286860634380883 -0.49750297770156692856 -0.022661841938079400893 0.43455382372857070949 -0.070739261521894386542 -0.40673281133298516687 0.75192207082276629748 -0.1854506933996588891 0.19747194719832419918 -0.78231690416709120939 0.35295507809508153141 0.82392048944877149808;0.43796215312694203314 -0.84887972989645388289 -0.10087767497131187866 -0.63078421299886455742 -0.028483408129956096222 -0.22054539580703733104 -0.52980226418288556278 -0.36053095661200845745 0.64229504677192261752 -0.26173530660046628871 -0.13771250387068259546 -0.47982986555813222918 -0.30276547339753512311 -0.19000061780740246098 -0.33066624122671500752 -0.11801114986752500591 0.080576496754260942823 -0.35059242331889717281 -0.45480159987490065276 -0.27549561507265157845;-0.32792783163861854989 0.10192462003705367313 -0.17128145898390390034 0.17754798695492618466 -2.9748075697313822729 -0.4207845647505062403 -0.1273672493720071075 0.76405831453379169371 -0.93451574218326316501 0.20275460157345975842 -0.24246344822316440171 0.28456447635090914572 -0.030471198303445030942 -0.47270223014355433611 -0.61409190903987398436 -0.32218214748528029023 -1.8126357448826240226 0.080004935952841707558 0.083196420402260398697 0.40392353406538439309;-0.2845196384903590503 0.51854894930953288057 0.018062818144416251109 0.24455174496554146768 1.102121048987506402 -0.59416155873926135289 0.34130848305594213565 0.95195938648560507467 -0.16079184282346675738 -0.66360228697390366559 0.58425156452544801944 1.2825418749976063015 0.095486421696945614213 -0.20614052168720531366 -0.6531035899932402522 0.74456355283758224317 -1.247889810369005481 0.06698482037594147287 0.044856842404119967593 -0.59459174573451012424];

% Layer 3
b3 = [-1.8429534792112041153;1.7104225312725263031;1.3236747439967468942;-1.2312509888963991678;-1.1012998032957888039;-0.89358651781054698748;0.80361993066838255384;0.50258157181649032452;0.43646764290183193147;0.023238762866290993414;0.099775055469633389116;-0.46001860391518534232;0.87645154932963631467;-0.7015240945256939753;0.89681019731922761995;1.1964608850050588718;-1.3059087033810432565;1.3929109202045086846;1.9056323217654578261;-2.0810040709649761936];
LW3_2 = [0.96937854913506893428 0.089623590321704957318 -0.43195991877942629955 0.39087821400971117791 0.2737834058598523912 0.19375114045664959539 -0.49846242108533977966 0.80243964875792972435 -0.782111822481053931 -0.72510713078438848722;-0.29540032160060386568 1.13111375018179805 -0.030804185086057044723 0.48384772968203193511 -0.94095579667416551217 0.11301091789108620722 0.69793155207976420584 -0.22097976507228900278 -0.65026761059313986646 0.2362455997901283522;-0.60857907315629611311 0.41931946108534678963 0.26087322434683102301 -0.056888090685785243361 1.0965753503006152592 0.9621449078603080407 0.29826166185362423811 -0.71319052703123608783 1.3379785940194073302 -0.03132516886331183914;0.3501211548778982996 -0.0073551600825604137104 0.67579693352116199101 -0.37149027584129362678 -0.20199058502223043998 -1.1570489114405799747 0.12460114328140049766 -0.97626812720515221411 -0.22269645908580862348 0.40424387039734416271;0.7993176564603386991 0.88053829767263469552 0.62609908464576280451 -0.60395111327086947739 -0.70097523279281526154 -0.78549438407850546984 -0.13222928605939546221 -0.2784925538611500162 0.37980603045720523481 0.42947899582156806586;0.62543544598152311931 1.1080724978802296565 -0.3351630747886792383 -0.26613403671101193426 -1.2337278975318737295 0.28915485851131655926 -0.79530578647147576188 0.43673567314862099531 -0.14160065367715349294 -0.0091846302001816499533;0.011714124372181573125 0.52743825853602699372 0.45650490778457120111 0.08940657948827196444 -0.38022543606920927717 -0.37234735202632712747 -0.44025509347623237311 0.84707946982183524032 -1.5185287624327239442 -0.30952310605115829212;-0.21498050160574935785 1.0439341062944187399 1.1058206703132846815 0.3959534084866481729 -0.17074048928146398629 -0.03784817029704413277 0.32515070766204673403 -0.78869452886046964579 0.24065715129593218125 0.46557079951577756693;-0.45696441986181701722 -1.5785737156404204828 0.8644463680810198225 1.3777804964153919087 -1.3425461174373789497 3.6276779465820956361 -0.054243382997345303276 0.74490297162754237625 1.1678431210263329199 0.6069542985777998112;-1.1492122818081871305 -0.11323002381508188996 0.45089315807604041231 0.88282360515247060295 -0.54609717059280227236 -0.57162125042582379031 -0.74365961704985272807 -0.054787956332017995198 -0.21375241024488811359 0.026806632688991277602;0.26520481642881488238 1.0517009400641157413 -0.41609209662160673293 0.043383467170014504422 1.1056382977757266417 0.75994454671426303616 -0.45669584328764872838 -0.94168827625811102333 0.58619621530008481081 -0.16222795594986397227;-0.7725020287916044559 0.55122503820899082516 -0.010116424561630508322 0.05732693155041563432 -0.92419663653525252478 0.35951690893499749224 0.33632640064290258985 -0.98695725074573659175 0.72422690409877854556 0.68861734205528712938;0.75701395308322150246 0.87485851282329984979 0.28298819284475401625 -0.92297547300678262072 1.3944081963347874087 -1.9361513457700483265 -0.12523372131208820868 -0.07081835807493234991 1.4753582289230877667 -0.11553713432648807236;-0.32012034327856980775 -0.25915761954571886472 0.46878705813916743406 0.16014010779080015134 -0.048143074306126104611 1.0734003659875164249 0.99939227777195349667 -0.58383641714865186501 -0.066212370911036724785 0.8301443893384459205;0.83437093513737259354 -0.68666618155945802204 -0.3509098116617119234 0.30837380627025129387 -0.45701558569676187238 -0.078169429393953368534 0.45314564492891512559 0.9775057768576222994 0.42156760388131780948 -0.68525927812558351526;1.0111728494822243007 1.2374800395910157125 0.68648751042998323868 -0.36751997558000903954 0.36438336427567574738 -1.8212802635269014218 -0.21588205181783184927 1.0337715289060602775 -0.020577184365069410565 1.6312251269657149777;-0.063357854692138643182 0.095243402227657966708 0.93437342325047390013 0.48564255810984618966 -0.6496139577013055888 -0.038358506645722469097 0.59991674249415327669 -0.50276529910185630001 -0.92447182270847683139 -0.73383521005797680559;0.51227428279481324047 0.38287936385501902814 1.0465294942889213914 -0.74222528353867267548 0.66485976406541047456 0.22339336711288240722 -0.46218387378148051425 -0.064716859276478688745 0.59286843727690885508 1.3195676186205089753;1.1146703894083638264 0.49695852700453635453 -0.080467342875913352995 0.41428456452243028751 0.67102232702423858512 0.50401505427959536476 -0.4999510484670481314 0.44540173144408040651 -0.56923555786392132649 0.014562774205583214199;-0.69594294719448479558 1.8083183577190060642 0.19677200360820942815 -0.79796980985320398183 0.21930574364645524787 2.1858325674684619955 -0.59551738146329280532 0.24232705712379012941 -1.375607288699121078 1.6086502050084836579];

% Layer 4
b4 = 0.3542137694478332266;
LW4_3 = [-0.23956239119176647723 -0.27325822806544486365 1.1015556758889264444 0.9029761155657385352 -0.3089679870459502431 0.2669023088186800452 0.7333622288384480381 0.039045675619016707858 -1.5307991687208730713 0.72377290371428715243 -0.72126427170900042629 1.0744513568729623376 -1.7801071183805721176 -0.13639164867181471918 0.4486293064771989525 0.82094842734619721814 0.11759861497717573331 0.26256664860972872555 0.34927049906918522515 -1.1243480642014620496];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.499999999999934;
y1_step1.xoffset = -2.00000000000028;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = tansig_apply(repmat(b3,1,Q) + LW3_2*a2);
    
    % Layer 4
    a4 = repmat(b4,1,Q) + LW4_3*a3;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a4,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(4,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
