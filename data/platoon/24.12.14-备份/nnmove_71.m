function [Y,Xf,Af] = nnmove_71(X,~,~)
%NNMOVE_71 neural network simulation function.
%
% Auto-generated by MATLAB, 07-May-2024 19:05:30.
% 
% [Y] = nnmove_71(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 3xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-19.0505965768031;-6.70139767883548;-1.99738196042707];
x1_step1.gain = [0.053913604005474;0.149967019141203;0.500604127399131];
x1_step1.ymin = -1;

% Layer 1
b1 = [4.0164273230866438524;2.8548606889459193781;-2.7842746995049640901;-2.594271604439968737;3.0340672916566453488;2.4101030790808279924;1.0821962313672459643;2.0047208715978888094;-1.3710477204568123355;-0.11354398755188176151;0.38839838258547054739;0.94784221329297124736;-1.9316358510235724921;-1.8491984909282006555;1.4640992065350288964;2.1431107207879005472;-2.5697610006739197708;3.2179161620061940141;-2.2286640423203580852;-3.8594170950059139003];
IW1_1 = [-0.53758338806377681252 -3.4672183280265884697 1.6586519387565152872;-3.6929191311002620424 2.0064498841429232456 -0.66138620520593094376;3.279759617230057156 0.2022645691090197706 -3.2166353144841650646;0.34159552809200333101 3.8501019069294954988 -0.66915150974759129987;0.35691278625323563656 1.9647065080625807365 3.0502344487172750043;-1.3010584356165419972 1.7450210272926762745 2.8845626987537658081;-3.2049779668350044659 2.8575898665237033924 0.52582890370012103087;-3.4437040117746837709 1.0780279092995304069 -1.5328574819730207413;2.5093999224834897532 1.988163656352084141 -1.8570941992577343349;3.9223275998751776505 1.9523706555385551553 -0.1147490494799919547;-2.7048323840405101848 2.8097056340096391303 0.95869195641261228946;-0.16551107197640688162 -3.2759694117114528389 -2.6670326930393937204;-1.0402543685644534133 3.6792346591141518175 -0.11757544210789150352;-3.2169405021460470984 -1.2392157499616709426 2.2213202110247793897;2.0359584902407017459 -2.9571661975788030574 1.5027885287620901256;3.909627626904794262 -1.3695888697680842494 0.70671185759410548588;-3.9473334874185481702 0.16168639307606200162 -1.9214828608745690985;2.945895190959630483 -0.90875152929572677873 2.8135071209834969785;-3.4380866047799605312 -2.6377255577212075366 1.9284270531740057564;-2.1853152650050171601 2.4224230742294259322 1.8465316592060929679];

% Layer 2
b2 = [1.7218833666880259958;-1.2936372454429769796;0.86820483194743514055;-0.12523962008782635325;0.34015898098504326885;0.52602135810907868496;0.93334463365943554081;0.73395318856534785823;-1.1758175515611299922;-1.5406699371582741609];
LW2_1 = [-0.42599833515551499552 0.54376318364842057829 -0.50496192608285361825 0.25863642148688609224 -0.12084902259378491052 0.49402241393975809824 -0.0042556204421283537823 0.20437430836173198223 -0.10561189389775246794 -0.79517235006045705603 0.12708593595356773576 -0.45538470880252923667 0.31080474685847975236 -0.19530703674477045695 0.44386732746354373713 -0.0044893243048633648534 -0.0028145731201359154398 -0.062690459724485753101 -0.39689486551099101286 -0.69612240390802315737;0.36193310793367328149 -0.59287116084609559064 -0.25509887108086903851 -0.42951801355648810965 0.10861744101076241387 0.07554164418336348219 -0.97141319412593074567 -0.35991930390708243293 0.19490707448641306221 -1.28165806786744918 0.34057649157921121574 -0.44371448557404558066 -0.39179433370530963865 0.40203623802750321214 0.081799870530386675771 -0.1302409293648137123 -0.36475185311849528391 0.45330009656665110063 -0.81977584971972505823 0.096825897373025132664;0.090520672974025453983 -0.55125162498338320383 0.21755362202737760224 -0.068696912576588733956 -0.362359002964654342 -0.022504858128416928981 0.3827682379324153783 0.93053132326019671883 0.54398112501371242988 -0.7258896705488283585 0.24352836623803875149 -0.54938085731637842368 -0.18723223412107850572 -1.4945297976449258837 -0.5716898847442057896 -0.38570442023061529691 -0.083774048003851978028 0.35454779185147394793 -0.072643419374006243383 0.025800566035732636072;-0.44391462086013960819 0.65809275739572148378 -0.14823896695583876904 1.0289820824781832354 0.63982428249159195577 -0.32308297365472848917 0.50222746728672285066 -0.56293491778327287012 -0.5364676958040135446 0.62629436669582383423 -0.67773326234555608671 0.65745287628864335083 0.26542674039087332805 0.58683788150437432574 0.58845050939151344327 1.1696208765150595266 -0.70510249684558679029 -0.0078151417834542470653 -0.048719873783662652478 -0.25715551612244591517;-0.16039138740336522648 -0.25575179712678663968 -0.15092748274069711645 -0.013371468483870290259 -0.78683556159989720413 -0.30802713360175359991 0.16159423556986482473 0.44159939817423821129 -0.18791179003762531474 -0.61383904274229073028 0.20679636573580423287 0.38537268232085142294 -0.49526423483925258173 -0.46916057782829623246 0.5091773126350385148 -0.95921376730217133844 0.23636904846516423873 -0.26485703760317463873 -0.27129868714511012895 0.19159279923844371729;0.32111646597201631836 -0.76542095058059023138 1.9358148593490160927 -0.3145188461106219191 0.69842471539914396939 0.055879244605027224291 -0.070525234553366247803 -0.13149247089774157571 1.7096895105561824568 1.8259500110134547768 -0.56465371733498892493 0.23099055374493798753 -0.43975153799310956471 1.406236391003666597 -0.091655974342100293706 0.46710067202189808899 -1.1922097125525197292 1.7557766073549214703 0.15509358381238486091 -0.25664880190229827361;0.55387249836150032056 -0.14608090160729925167 0.061376815384294854117 0.11370007489978140036 0.24934434839680869045 -0.18383373656521614925 -0.11493349012029199785 0.1715436802640135372 -0.054215188593310960352 0.81668505937579838339 -0.3969881622172128921 0.54531774701430302255 0.14968545512728273494 0.19881249403362874495 -0.14521262849961610875 -0.42192875518668571111 -0.064174085535448344153 -0.39615225692035577199 -0.64418827252095423042 -0.56110169562920331199;0.14160862269746526954 0.13208629893876491779 0.56130315358772753243 -0.40611350219661912497 -0.71695996723151844687 0.51301729852072619487 -0.13868477142227123022 0.70348462945579348649 0.13781736497262050967 -0.41769402862137539056 0.30884762782802399617 0.3501204836132510434 0.70779890105548659562 -0.20231869673381466801 -0.28621959745585645596 -0.09741704897730930901 -0.06186780400095326371 0.42094440992361892295 0.11766516538811572223 0.1608396795258497658;-1.2339221811446030586 0.83214031550563394291 1.5321877083352994919 -0.018212963616854666721 0.24647356747255366738 -0.59049949122870537543 0.3513038117934840221 -0.16670759604042501012 0.078322020578843104532 1.8775674922941472111 0.29337920796032623816 0.057781816523011952924 -0.44968412564308268831 0.45885402387262663737 -0.57714716714410208009 1.5159006112785724518 -1.9080109133266931476 -0.54128839855357691047 0.36869126012374059398 0.096629240956027886988;0.025903453989863708257 -2.3956941518129521995 -0.39123343722893094698 -0.18896167837679428425 0.33771324922412421232 -0.20907368428241202007 -1.4464004512739525588 -2.2231233922685640358 0.015963045684644058819 2.2481471454938817267 -1.0851032623029437385 -1.2813326513989473643 0.12205426038702237024 -0.79152513672578284076 0.45949844370252945769 0.39126197075506641276 -0.48467604108240225358 -0.16384652421770190545 -2.4149187025848277699 0.6891766158740979531];

% Layer 3
b3 = [2.1247891190342218515;1.6598008907825176905;-1.1620614633628092438;1.3255395040262654138;0.98252407909274741549;0.71933573283298779533;0.76614537337356891644;0.33678970337298302917;0.57661295860781303091;-0.15301177094911888599;-0.26410942357641176148;-0.12653052111984741668;-0.49180676820446550535;1.0788540786968003893;0.88803946450596671358;0.84169182042266155186;-1.1395222154451953855;1.335938243722412766;-1.6942366759277787125;-2.1382114613982889928];
LW3_2 = [-0.72228718828382942885 -0.3733874592212766963 0.55952036363727786217 -0.31872125890176311591 -0.47752711999012464883 0.66601787323749439551 -0.49771393884418657638 1.1803700654852347096 -0.96568717444380181014 0.89997293412141243785;-0.17380072225208587078 0.67277074056855390438 -0.15960470108295296554 -1.2484146280105752336 -0.59783505631164812755 0.27587665158836460755 -0.34600856351180303561 0.31193031034758172959 0.54926743547183798366 0.52366836668566407731;0.73723959863306354201 0.40057517074612136732 -0.45366098394340409472 0.92351806372041289617 -1.2573310035020843767 -0.17161562467340485405 0.6538528190698401632 0.66780334462767920733 0.25657843661852219874 0.40113933748367625043;-0.61327956847409570429 -0.79669316060776740329 0.32071298458728386693 0.61670433305032923421 -0.43052062568080368132 -0.44386507482337439479 0.091728509252594805923 0.57184488400983490841 -0.20260325077577853725 -0.81868142949190747526;-1.0618006014455709796 0.27727685576194788242 0.76307558079069193191 0.01852106897959392845 1.2658059931798981701 -0.5011907200967297138 -0.11832850824052146277 0.12537179757901878441 -0.41837473631894678272 -0.79790207414991809465;-0.45861320066648592064 0.35698194215700740362 0.28741019413137597338 -0.95953335734055777984 -1.1192330515070472163 1.4569190912458440668 -0.0082148119145839769428 -0.74415845703957406165 0.22753424489577031564 0.10780946870335103571;-0.54286336629453324498 0.27021989960178688372 0.32257666340469942634 1.03337265156672653 -0.61904021007245013664 -0.33284255457420319768 -0.17211288615881137343 -0.77009030014003476694 0.15248486620339724018 -0.91761947561340739821;-0.52857687461333147105 -0.81497806611922651854 -0.6696570722387753527 -0.57975357005241034969 1.0795272688151735796 -0.53841714048974398388 -0.23613337414249205293 -0.78236840641255178674 -0.46909837771354823133 -0.21166919760986735444;1.7162109687852404871 -1.0624252313584374718 0.24763701505854351925 -0.15552404083098089749 -0.39930226070765711954 -0.4870428335441675527 0.80750549573493501931 1.1305166131311470412 0.17335248444781706234 3.5484025669068857134;-0.74349151221495846098 1.5526311485931438838 0.23748985744686906818 0.0044290580609502774173 0.65702356623117508239 -1.0517204044799011164 -0.7226496084633118322 0.39561915159460325775 0.4026497692331513778 0.54371132367277530406;0.11001110904779366761 0.71193537074346002758 0.30423668793893277051 -1.0569120196801671252 0.31413258333521010268 -1.4928983960913466689 -0.63005482888125263763 -0.44327666981194996376 -0.016484147171627057393 0.1396202973087352639;0.22162357189434545024 -0.58476008304819016015 0.33174474072990312035 -0.73237150272817319596 0.75552928357315196628 -0.98446569012368811968 -0.44744483847165322787 0.59883103937526060978 -0.58075532695352782842 0.9261037967454651687;-0.56254120140447949616 0.75508721613534368622 0.45268324345295463118 -0.79913358969850600833 0.49101205996100616424 -1.0705428476169831509 0.23642755320802671948 -0.32075529251503798189 -0.64443730920551323127 -0.57805541485426359394;0.49458589001630304249 0.55256558975876601814 0.3487641961995507911 1.9997711376496836166 0.048702788237311528396 1.9567483418009057328 -0.40561403782398641749 0.43903419819914435429 2.7638250042416734331 0.24974410061924295912;0.3559334234220147275 -0.32728097898243985187 -0.14167724663227121429 -0.76282842896538216593 0.94048625576731503806 0.54682350376668065195 0.015492083603271290804 0.87508789451387269942 -1.015650512901355107 -0.085390745438073886731;0.49612567116458666794 -0.61528481816888047629 -0.8031227730341009563 -0.28107293845404246468 0.61108705134158392003 0.17227437730391068071 0.4821885323169295412 0.47163897711875507612 0.65323959046481583357 -1.0914791310127232027;-0.29632866175191735492 0.18683021516992556754 -0.1227716435669699846 -0.95293741645009855112 0.32606745661911412659 0.28890929538229942475 -0.38163080093875911825 0.87064930222693937001 -0.71876767401915564459 -1.0377125650812342172;0.47295201797796682097 -0.13483671771299529651 -0.52730001101197199187 0.59710228738410320304 -0.59946548897915341581 -0.42125303007859982163 -1.0685124564899186606 -1.0529302380146254858 0.82004532035609278839 -0.048661754612166763234;-0.68306054030416762934 -0.043273762023063884474 -0.72523448818146785122 -0.60300339198803565299 0.61797481941655507676 -0.22759882237120829251 -0.19907006906892815712 -0.7516874505631502279 -0.70928991224998017007 0.77553107687122757596;-0.96807311108333671257 0.75725666771861310789 0.6471398435562036866 -0.36026546984139229401 -0.15189398872254736284 0.010698730354437059609 0.57242077276326130963 0.48852134733225049956 0.54736928596867995278 0.40315282204261865262];

% Layer 4
b4 = -0.34415649543961190915;
LW4_3 = [-1.0083231598419548636 0.0039681650910673126054 0.58295979416611753976 0.13637870321512282623 0.52643140490728868031 0.55639509198265990619 0.15041304470165053897 0.3221542219788249839 1.3031247813089963383 0.72317724713480380228 -0.1876780832977893998 0.60205809058238934917 0.28369242863079829897 1.4301039839764004835 0.13184690347235328289 -0.11614369184864598017 0.36671718425191368596 0.27629477259603008044 -0.1664766219454795193 -0.51007415017726798201];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.499999999999934;
y1_step1.xoffset = -2.00000000000028;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = tansig_apply(repmat(b3,1,Q) + LW3_2*a2);
    
    % Layer 4
    a4 = repmat(b4,1,Q) + LW4_3*a3;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a4,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(4,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
