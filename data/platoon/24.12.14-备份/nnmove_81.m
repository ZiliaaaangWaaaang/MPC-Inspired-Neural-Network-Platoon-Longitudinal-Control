function [Y,Xf,Af] = nnmove_81(X,~,~)
%NNMOVE_81 neural network simulation function.
%
% Auto-generated by MATLAB, 07-May-2024 19:05:47.
% 
% [Y] = nnmove_81(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 3xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-19.0505965768031;-6.70139767883548;-1.99738196042707];
x1_step1.gain = [0.053913604005474;0.149967019141203;0.500604127399131];
x1_step1.ymin = -1;

% Layer 1
b1 = [-3.755719862815119825;4.0542154689394216405;3.886241132058426917;-3.4100294632092280622;2.3320169899106049094;-2.5511568228327310415;1.4505626395981359167;-0.72284848407564716855;-0.50543767941474837535;-0.76669814984448081407;0.89841756023213736881;0.16871077211914833893;-1.4940449813772100907;2.7736320236811118356;-1.6045392306691075301;-2.5905399792947894078;-2.899145848225067823;-2.9563668403068299462;3.3817939441604614181;-3.4977009671092944565];
IW1_1 = [3.4386196847683105915 0.50961716483814445411 -4.2831514287479084402;-1.5472077472327201431 0.56352388622455773515 -2.9274932064962939648;-1.5921624640141762708 2.6579926347102453832 0.76868097626912867959;2.6989711701199055049 1.299017302239075633 3.3753960367695015066;-1.4045260964523362812 2.6822290643967381385 2.3573119672565354676;7.3703794210828039724 -0.5427128824062954493 0.82996301332102750958;-1.5767147183458980475 -1.5465907338509878866 -2.9419864783101736805;1.799549765558719816 -3.4623738069974443476 1.1168157918487937597;-2.8331675013282695552 -4.0416945572637503759 0.62855243962568452254;1.0008960473718180317 3.0365793273726726653 1.5907494189586541822;-2.44040681125800063 2.4052037021048784382 -1.8578040779400062377;-5.3681541643617673998 -1.6833055926947895209 0.20211065702379671372;-0.68198554862621474371 4.3590678268742557577 0.40752013917982227165;2.3462887672691907781 2.4468935324111056318 -2.2015436084983477372;-2.6883424292898121521 -3.3726021858858503677 1.0039003764246359207;-3.6944408081166097979 0.18141666288396007811 -1.9659195434257070723;-0.34072914196350290172 3.0022510925287666517 2.7223271928595091929;-3.6001576484508182041 -1.4561318241968004283 -0.3162941549410474007;4.3788337009643294451 0.98017292687448687172 3.1200501198595049779;-2.5547981015466438848 -2.0197503138064991646 2.9856835438118243253];

% Layer 2
b2 = [-1.5155729995747344585;-1.0282607396425569313;-0.86935277309895242492;0.33946585191794276248;0.52622677930889405484;0.53677016240859709573;-0.62502876180146038632;1.2390917432418007138;1.4932425009064256294;1.7980401005600210596];
LW2_1 = [0.48260699786802990774 -0.27328124921598473396 -0.47478988983178599392 0.20820038405668797599 -0.42012478474621051117 -0.5801252854593309527 0.36600263190016518733 0.10448226728046314249 -0.24008510346020126014 -0.14016544566327540644 -0.24021409536595092482 -0.3685257283392214811 0.14792181751076452501 0.34562445277276948596 0.18808467129825959252 -0.14571085041550324579 0.3573664946611807558 0.49268737147150931666 0.35520226440721908157 0.36736518802321443955;-0.048526089980850159455 1.1280595190781776971 -0.15856112000499125725 -0.9461043451636769186 0.20596907486566015666 -0.39553014684697357373 -0.19853867315163392648 -0.47396923257527001638 0.31467295744896861542 -0.17297638012661364915 -0.42599353230396391767 0.93104867474603258959 -0.99198228323913506532 -0.51108796332410566521 0.81810286286284128465 0.79115536761733995519 -0.36787968698333151085 0.37829209110555622742 0.01919492834820535343 0.250292331160284931;0.29204254277548941099 0.14284954252812048781 0.16539548594044206631 1.7830435772222705815 0.45586646817341347493 1.262460797351377062 -0.53451047524349104556 0.26696092607332932989 -0.28952014465220360373 0.77340531776391863161 0.30413329330573596332 -1.2374505286303136842 -0.038672145359645901386 0.44806660763424788207 -0.41846336110436094247 -0.35256239042846237997 0.31427791120337561503 -0.52434707274800929078 0.4680370103731602005 -0.31511071470457302501;0.1037910835214663624 0.7341402461280363001 -0.77149329611748918012 -1.8774168772283506001 1.0448349189442471818 -0.19760164940785979182 0.20542517507872037896 -0.20675397085996494173 -2.4830360478694037951 -0.95176235790921726032 0.27765567360277365605 -0.79099165411872784937 0.55810909756617554933 -1.2104610658443633042 0.86704755567045121989 -0.068912737559268313903 -0.45803634553273875341 1.0381758860955525581 0.68130655126512140729 0.21220665977069264052;0.44030061151465493818 0.57559238872445050994 0.78180880526518903295 0.63918118389088340869 -0.20261600762609968673 -1.4202573766978094927 0.06474794208821398056 -0.57011682775227945363 0.71159830167058402139 -0.77626864441556897578 -0.7379356466589190866 2.212145400738836365 0.1802021915608752467 0.62672176001306867388 -0.46945734519685150543 1.3698640209142478597 0.92816511353193953404 -0.49355100990884648304 0.70115894681752233275 0.88611303164481525219;-0.62449623556915401235 -0.037013800074166547383 0.68012911354455096724 -0.29894267726995943368 0.69990607272474181233 -0.5404807511393260322 0.20427862654152997846 0.49348715923009328632 -0.68966728423857248664 -0.47316132199880739373 -0.061828661788448105452 -0.5237668387637071099 0.24879199353852343712 0.7349966489595192165 0.4030458698941652429 -0.43709533031550013016 0.53472364170328479105 -0.57101721494455592865 -0.36963810116368844838 0.030883570484852608529;1.9722518896920360199 0.68491461647194418205 -0.52829621562616257968 0.19601935104541778898 -0.47568731397790303683 -2.0893136585532690042 -1.8552613232743677685 0.28320856553005319123 0.27413771411323978322 -1.1114612633936153951 -0.52714652190423783029 -0.18257226259064118778 -1.1733528217323492271 -0.50141752320966193057 -0.52419987716405302969 0.35190522464099582844 -0.012139521533026293582 -0.48019485847834930681 -0.2700126930949508508 0.62574094485180442593;-0.51431604554486942682 -0.061558531383470324605 0.46671682581073953289 1.4471182038052612384 -0.026576949160935590261 5.5136486693330803988 -0.14818921762777506612 -0.071763254258355280157 -0.64738970012867858017 -1.0106854137511953606 1.2882432655406075295 -0.6544971336994075406 0.70821143685733656259 1.718807668266010058 -0.048387968426029437374 0.33075390400626125675 -0.60506122986108124007 0.34869277272724641392 -0.57241948524272534549 -1.6911332858705383497;3.2304912002372909718 0.35034188254096937376 -0.29824093175462079719 0.22483128781371508609 -0.34432377510220579797 -0.40688161854432841613 0.74270859241019093755 0.067807448670979680871 1.2104319344203411379 0.58074600308938129078 -0.049299165888318882689 -3.3604261359066285308 -1.1203568644675858668 0.2451703157256297505 1.7569098473111794956 -2.8033139114857923424 -0.25875445740088359736 -0.15456751727785017492 3.3437972045958987977 -0.25156797079139192608;0.17985726513199706833 0.91553825900165730634 -0.0055944891225845547189 -1.1996527059925874426 0.055779761642962992496 0.58252000095402123314 0.4031676730489500704 0.79160531597499017575 -0.90825123616355674105 0.12608755995866002819 0.83687612243200582007 0.69036683769289997059 0.41383511505233416816 0.14920999836973200536 -0.1479624516595338668 -0.37820210707754275958 -0.32026128637812606437 -0.46003472661720240522 0.21657951694812960231 -0.32133406137658487856];

% Layer 3
b3 = [-1.8406916712959597859;-1.6948205304697749884;1.5160322231280876082;-1.5727182689369310076;1.1124216844848329178;1.0748993511114228738;-0.82345923166259527015;0.020659219509647042817;-0.62541198149199095369;-0.051394701033348401398;0.3324836491801900773;-0.23420441186224827401;1.0575843984970618727;-0.65491494936118466175;-0.86144785052215822052;-1.0319350272360923171;1.3875053368500349649;1.4116736206838391698;1.7955679883631894267;1.7294152485631986149];
LW3_2 = [0.39117060098722267192 0.91733787254303811309 0.094193910364159638693 -1.2244706635504201131 1.074091897179044075 0.12828983976083649376 0.11288964637300867577 -0.38476895340047451155 -0.88789357745509567277 0.40728043901471061572;0.047781115667728711605 0.26626735506255139185 -0.75974522768278685003 -0.2009190892767079295 -0.59954810236801292511 0.15483128436412707529 1.2672299977913319413 -1.2949337484038090373 0.90805532213430328881 -0.2585133957375359004;-0.44952985068000850255 0.70418569966100197366 -0.34109538655285376318 0.73965015598106931272 0.65368374160686826269 0.099768240956783021955 -1.7964223324273138616 1.0848618911762697437 -0.72239290912283760093 0.87008181646051330205;0.78668710280890707942 0.45314244931277519735 -0.13847538124729985576 0.19180308464785336686 -0.56516198423320551658 0.48075110619021438341 -0.58764670055848955421 0.27996634696080563431 -1.114332786811174314 -0.80163134742903630059;-0.046464410876308891163 1.0332272112271290165 -0.24045180346204833577 0.011253678930843905026 -0.36640252389665617372 1.0581030875503965039 -0.89930538944868476658 -0.77246151995117429134 0.21826248703351433522 -0.11788069726738714671;-1.1361091846748070378 -0.85475511939602466516 0.10876381527821016304 0.34094896822264841862 -0.23188968725992153974 0.36378546388436067138 -0.69131181967323540594 1.2964791724481377067 -0.37784465466294808733 0.14335927801955136718;1.2549871950173128177 0.80099280874984246648 -0.32113855825069853589 0.41798430560838378822 -0.32790403596372780237 0.24178038688636066533 0.56839233182897275221 -0.74495299834263495331 1.0413457343605585503 -0.53384463808842552712;0.024251760995446066532 0.35385593594128728068 0.32802261259335613319 0.95563361331869212112 1.0395456251358168309 -0.45266102926679696594 1.2100275965213049822 -0.64924841489543783091 1.7573554425692918812 -0.34003391779548908236;0.65540221746282445459 -0.19236116325051122455 1.9839067886403201069 -1.2781142616142113777 1.4369747786743938267 -1.3242027224177914668 1.4437263278771599317 -2.1717234237354743343 -0.43188768178144582022 -0.81561153542453246335;0.11057437649789929324 -0.47774939546931571854 -0.28970883584501305741 0.29158170411668699051 -0.4869170014352925957 0.49414061800856479145 -0.24249222024095770656 -0.31693570984502605903 0.060357070739609081089 -1.1940223450998128651;-1.2456546738449065792 0.62230641117538987306 0.90956451309422892137 -1.1835427191077882991 0.050380540408346531633 0.82234147283866732003 -0.97230218130561396617 -0.46776125582257666036 -1.788250882220110638 -0.57823857076125628751;-0.08714902607112773314 0.72655864147697368782 0.60008762289871497853 -0.67452986263515413157 -0.62379937190812384529 0.33431754999908835924 0.4080055811549478384 0.019371164666145523903 0.9754420174994742343 -0.66584980962910012003;0.22108592382602973436 0.13336146508789359366 0.25632615545921355604 -0.9897710174811100714 0.56451328492887520305 -0.19358438571423372543 0.31271851895640118135 0.23541011898648367406 -1.2375306244771984154 0.96471582811333822516;-0.62165183075275465274 0.17560353798232578026 0.44905697121232596158 -0.0079922227796678391859 -1.0563934770826157727 -0.11753950295706562523 -0.5055964863527570019 2.5482711236951782752 1.7588103214590466994 -0.83083315590268769224;-0.51749564826800864559 0.4006673107717003135 -0.88495134505849459838 -1.3467312003155029743 1.0498400815610113845 -0.25506543579066420779 -1.2495787016940951286 -0.62044298859989899242 -3.7077538761444137627 0.13935496860879204029;-0.15634633385563292962 -0.85767113543139272824 -0.84440399886875616708 1.1345365746005222629 0.42847100432622159394 -1.3696532583394787075 1.3174912000276293167 0.049928397463001483736 2.0403165684202595465 0.80624146272016850023;0.29832426872095751946 -0.92221212023624077325 0.848107270376718958 -0.68577919722155733506 0.12700787497412091565 0.38116118815598681868 -0.36287862539357251812 0.91534794592552259918 -0.084339069685801112963 0.57774196337561078973;0.74516836157996657608 0.55164016319710118541 0.087617083185465044481 -1.1565584169139027093 0.58848756003517543878 -0.31105073094760693486 0.54887061671732362278 -0.40099686940860529427 -0.78335378633293040185 -0.86238539967225502636;0.12312046534859746871 0.2745068081412692651 0.43057241583068972535 1.3604830728811472262 -0.86450227807304169669 -0.70286785394562845131 0.54581666706158460389 -0.36902926599823288045 -0.10052783344937581134 -0.44319931521529504215;0.94115919799625569198 -0.91259644031420095178 -0.22516479512929693518 0.41764687333306366179 -0.14966698899422564706 -0.45227213092491302948 0.21782107026908476 -0.5690360916435878158 0.57988609608501884285 -0.80170661633772732912];

% Layer 4
b4 = -0.74925168570418587688;
LW4_3 = [0.55273458929208652002 -0.20468450630014328739 -0.95807273731343189915 -0.28469722722079054966 -0.04358517996776632708 -0.49104433944823150382 -0.49660680666245149428 0.38509402203660558772 -1.0473559846002440388 0.454815998516586939 -0.5730562384428888878 -0.37095298745481508629 0.61207025774185963574 0.46001726054728442339 -1.0182267584214577116 -0.7807838594519268538 0.29418373280309789708 -0.38993410869047934186 0.2532755559349964547 -0.18778577335035659401];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.499999999999934;
y1_step1.xoffset = -2.00000000000028;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = tansig_apply(repmat(b3,1,Q) + LW3_2*a2);
    
    % Layer 4
    a4 = repmat(b4,1,Q) + LW4_3*a3;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a4,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(4,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
