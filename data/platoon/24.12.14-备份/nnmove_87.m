function [Y,Xf,Af] = nnmove_87(X,~,~)
%NNMOVE_87 neural network simulation function.
%
% Auto-generated by MATLAB, 07-May-2024 19:06:01.
% 
% [Y] = nnmove_87(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 3xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-19.0505965768031;-6.70139767883548;-1.99738196042707];
x1_step1.gain = [0.053913604005474;0.149967019141203;0.500604127399131];
x1_step1.ymin = -1;

% Layer 1
b1 = [-3.305356535092133452;-2.9831663585890364487;3.1818759585011875402;2.2164228790911684186;2.6132625119207300024;-1.8675192440441770181;1.9503221292677883625;-0.44312252085172065819;1.4989914978596676765;0.74634447179999918731;-1.0195199397746506076;0.63336949418269417045;-1.5956161503257368928;-0.08282387301899808707;-1.9018540289514487274;1.5499314821524450281;-3.0714818029476478323;-3.0391902417892242561;4.0008507083094029255;-3.6501415650232593713];
IW1_1 = [3.1671695884842629987 0.87152565884445520883 -3.0503236625718082031;3.6183963553601183882 1.2790608979164761472 2.5723311372777635242;-2.5776064452916913616 -0.96440841250777420424 2.6308785511788013167;-1.7159163529213907751 -3.7622263329099818741 0.64826326060225747394;-0.4293487156214840228 -2.8145807720920332784 -2.1711465216285841251;2.9712393509385277568 -1.0922576957658292063 -2.2942415490482237495;-0.95296107877232005823 0.29247527586385635434 -3.0362022043832390672;5.2001696836603485963 1.4741243094385005907 -0.29153602385928106822;-2.0699279099964327244 -1.8597700146508173713 -2.7159571021856510065;-2.4448694532655603773 1.7253183076991953637 -1.8645529357747019361;-1.1139607347638420531 2.5507155714704832228 2.0876754693253380957;0.49409924259630000343 3.1679323941145254295 1.6432426415148184695;-2.5845408893338541745 0.38394952315311320357 -2.234344135451699298;-4.6135666065010703107 -2.0064402820855780085 -0.14945820108338600529;-0.11098022871625265462 0.48670748948761294317 -3.507814975250229228;2.0937260839891331798 -2.105587099543162477 -2.5919724420909489027;-3.9713626497741358889 -0.08701929012531206542 -2.6963552806714510268;-2.7306718528582560879 -1.8554359062232244071 -2.1976820331832032096;1.2414091757355234513 1.4014489366029756479 2.8732489405134371552;-1.3253973908602101339 -3.4383722617199969918 0.60615148904977778077];

% Layer 2
b2 = [1.45769381367760964;-0.9897190276594293179;0.64917569092735660785;-0.47841808142959152406;-0.44789606322594999188;-0.33148315587390425607;0.49732602335502990032;1.3438306056725739523;-1.066083711677497492;1.6714748272012498465];
LW2_1 = [-0.90016645737134892702 0.13138728361347509765 0.49886033575546778751 -0.46154660975747568985 0.088141317717808698173 -0.44282443074164684615 -0.3777427326536446639 -0.54933993989920915091 -0.42249391141331638089 -0.51345342106301739005 -0.14421079009664600212 -0.274664185474651934 -1.0346208489467008107 0.13320641015903980642 0.48561306138059434634 0.20516877064332667002 0.24042917014992370994 0.55205268674531926543 -0.66698842948871661651 0.11724743094459899595;-0.19739168404694498737 0.036698781390491805321 0.74953018768207990696 -0.13897454465631559062 0.26429107019772712928 -0.91380215598539138444 -0.32465525175962539617 -0.040700693847823113392 0.26771491122074536628 0.16223914851739579257 0.76443235871117598546 0.31309111016787771753 0.26470240865856964341 -0.67973508885602695884 0.310968447471776821 -0.15357540689798779288 0.26396176137305388254 -0.81144670061350188117 -0.35958525123452200756 -0.30363182571483704475;0.093131086230636164758 0.27394024274944278607 -0.2459613388775999665 0.42739112484834579364 -0.33807217839541786608 0.27003292502379844242 -0.25842580347336152613 -0.70316957141290770128 0.47990785617353381998 -0.35012840560137181711 -0.19692056596243751043 -1.3049290895483438568 0.052507308199866875587 0.29423211231800949772 -0.67387525374439949388 -0.57626732145870485091 0.50039395880416981388 0.87137813537374764206 -0.56831595277261837129 0.44817115501609638972;0.18547980574455791292 1.9863422846065439398 0.6799647597519075104 0.20738151607869109716 0.35490463024054758057 0.25839226710972673651 -0.23335283627940744955 1.3345777415336681493 -0.23278499941080157964 0.16026512906374118517 -0.19448185651731464407 -0.74396054572923164816 -0.55020630131776870897 1.0260747323724901392 0.065629327310615936941 0.46908814589892361413 -0.33206284732069862864 -0.13128195186028265851 0.22955408788600925596 0.15007566366978250527;0.79679673415219587351 -0.20954816641527182486 0.36278768084670548477 -0.13009006475990220197 -0.42038638434324299142 0.37999735509400311972 -0.12355513387418373683 -1.8318040377723039391 0.15954691896777994931 0.26779212518905060048 0.3449350397861171702 0.45579177635064194174 -0.33513763709571026128 0.36512465567252588849 -0.20916692698680075524 -0.23577494158605383223 -0.68030399393875240488 -0.91152958077067958165 -0.33015195056661644779 0.49637690605864687177;-0.73944984642356659243 0.18261018376612794811 -0.10525467206569401324 0.066450581726696975049 -0.24781699526781381104 -0.47920748592049861037 0.64836577622497404416 -0.95849236023514794436 0.65313339703936734715 0.58475071821220481194 0.56452610291942895149 -0.30156026209484276812 -0.48328923235444309903 0.57867677103062131749 0.24832724766354741242 -0.29216226104489767534 1.0588393763492807143 -0.060365212384492467068 0.24696748664716494659 0.78311450941400861936;0.090417558649941540128 0.81877199355533636371 0.48049168081126719665 -0.44441880423517449161 0.27614162329308267196 -0.6273095319573690487 0.97561491978870995556 0.50253889564797216138 0.52170335488238928079 -0.0022160099303154098989 0.56659269287206648347 0.38551689102279174115 -0.28225597175871702804 0.34983722284746898712 -0.51968741029542131482 0.64903631593257815613 0.16034078865225706578 0.4964807520557367182 0.095334558865414226192 0.080148548787795093062;1.1051777380418785768 0.49769263918030876015 -0.67167563059076185183 0.29823282986026344865 0.322729097521720798 0.88560010646363318543 0.2729671665751987053 2.8787784915892800086 -0.9824379759015918756 1.5378180496232851659 -1.393256990786560845 -1.4504520194303023306 -0.38632737699375352403 -2.6127076182995891962 -0.27432465233676678329 1.0572327467316771088 -2.9853197286785184694 0.40981236915161622925 -0.20323873071126075107 0.63702168374144074736;-0.46264824204878668423 0.18299480495311365447 0.42373620949106977074 -0.37640670326610725649 0.63331049059189548078 -0.78435128365275863516 -0.070861544675253587688 -0.13198946127724714428 -0.69274797887149586195 0.65144944046027197793 0.16200731842146567918 0.55749941061524921349 0.67475665620986124971 -0.84472153296964402891 0.54314851637386818428 0.12638409899566047101 0.21469212357696945692 0.6036705893080813734 0.5797975778025223903 0.44468375649922442516;0.3144001253586532485 1.3420194719481273182 -0.14287025130008568219 -0.75098782718164225347 0.27878011979032396583 -0.49166644372301676613 0.84100953480527307349 0.59386322543872727131 -0.60509232728040807103 0.32067683735904028985 -0.7446023995799743167 0.35850025661541129463 0.46451317189683560827 -0.9526011971575429893 0.48469317675544237867 0.86975583049029181471 0.29762484903355185262 -0.25306545436525534898 0.068752146579214273858 0.067181563572117269922];

% Layer 3
b3 = [-1.800719946792456394;2.0317245098715486229;1.5687680052476444814;-1.4558265198809283714;-0.65946819010375434811;0.58438638301066825331;-0.37711273295582697918;-0.61174952415910877068;-0.61153975524981951661;-0.13808223595481533552;-0.23461301838309769896;-0.19536818291237481593;-0.37016935330833627971;-0.58097399502557367512;1.0760994874700586799;1.1729718676155205248;1.1171231490954800503;1.5653395873107103231;2.0563669610792936204;-1.7814122808023291622];
LW3_2 = [0.58716495456198303238 0.058623238983595199469 -0.97683031890870763991 -2.0696631574942023768 1.1766490046364694866 -0.47815000554476738692 0.20517654475061916641 -1.300540144896684458 -0.6756594489678033888 -1.0820468563918028693;-0.54998937099466327361 -0.46632631126448059744 -0.37418324782282968988 -0.9784436333630959215 -0.47724291997492696016 0.37455326437463343225 -0.76016407293007781654 -0.78136354727543433363 -0.16844825678012831371 -0.41127996966959162739;-0.68129573599518933325 -0.91324582916631347196 0.45469042405585990974 0.65200076334308554316 -0.42129424394901515694 0.35089520241584082338 -0.60067207121307419904 0.00029172836970349676211 -0.0024525154791075389621 -1.2303495080364579284;-0.18451679786212596412 0.38474134485357835977 -0.23597228009673176796 0.80346975283596733242 -0.081285522754925482181 1.2400825575647798082 -0.75316382169207429786 0.88515523278657071149 -0.81762120858240194821 -0.53757590299295410219;0.92515025188719979266 0.48503554756791367186 -0.23458563683154676216 -0.96187897001547273401 -0.26105374758084687326 0.73508887958064583756 -0.53612042277998162021 0.20565050475830018439 0.58909412392096727196 0.71271664335989770578;-0.60275489340019905438 0.83327661845986844558 0.30547034712367809872 1.1029506349765716422 -0.34449274820225683769 -0.56421831931434063279 -0.68996268072063959842 -0.048762498402159182298 -0.1748376787688265821 -0.78822717201062497683;1.2848388985971284093 -0.83667791568191729468 0.072832582034953463612 -0.55971594864144313952 0.19115310002361354802 -0.82066470789447754086 -0.43600223932010484518 0.17959658361581770647 -0.95703465289557554385 0.75355379848258396969;0.97474039140024981709 0.029057365352424185251 0.50397735748515026799 0.26644391919550503012 0.23571774177244955717 0.69441090523347304142 0.0470538386893638097 -0.63787742131584945771 -1.0871501760810380333 -0.06985496057391978042;0.57736586395898303881 -0.29012234072870263235 0.39595412692239828623 -0.30694519826526522888 -1.135539082971783742 -0.11154660814460444496 -0.17354858096903608145 2.2682096795542370238 0.45206604050005905204 0.039398068432519070536;0.70470177455031091096 0.95184554865471826535 -0.1678291147541852435 0.26674770814679005237 0.76073571890519520178 -0.56991398824245931287 -0.48065295113653100367 0.047786899491004543317 -0.51195245206214345934 0.42168052929706956178;-1.1568212286085517437 0.80984290122717428329 -0.36139065004857706676 0.71413106454162722514 0.32414543337226092712 0.33216912756939043216 -0.37406043596869481549 -0.30759554760216695213 -0.098734304959407465097 -0.50522000389754717631;-1.9233653846256233422 -0.82480966213550188648 0.58375938058252363483 -0.90070519734277310064 0.27620778160242664967 -1.0267583647971556537 -0.86854664510099388597 2.8619875264220122624 0.37401689432373380617 0.46060916417136027468;0.027945904041279029384 -0.62738422975222962741 -0.36719276758891106205 0.27528148291289017413 0.67032012610833313637 0.79219827733683878535 -0.46632852128940538439 1.2031527999043767352 -0.83403763110359241395 -0.10527850332701257918;-0.43944288901426431515 -0.17261045498033500412 0.39169027915731230438 0.87731450389714626947 -1.4573095457285729637 0.35394813675042974266 0.57973076971235637522 1.5583460273239915228 -0.11332841409432199697 0.55345603000187593157;0.76709295814040534545 -0.51723666144212310236 0.79136908885461842988 -0.35475992547703377733 -0.58158804661050933493 -0.72104120251215031434 -1.1489164919820462618 0.83737207488645282183 0.82553731669215335565 -0.14722293099399222371;0.56019727201070856903 0.93346496786213806196 0.53296607458868683338 0.3826993652343663177 0.13835230651107385813 -1.1313097171060235713 -0.58512023864934836759 0.19458245002645566113 -0.86009108061985284355 -0.57123358427979509244;0.033265707654033298268 0.479696212753515705 0.18210243046701760083 0.77785303338207323343 -0.94237973900789218096 0.099580866546683091678 -0.65024030900559248725 0.86796805751000605245 -0.58033194812553634545 -0.82734549525051526153;0.80213912205762782914 -0.35862940418227529094 0.1642414328007965052 -0.71663032206957877346 -0.17633116106880250551 -0.35201145165297670347 -0.51046270521660530584 -1.5335241853070185059 0.011618631083654577113 -0.49718659377279511569;1.1800842064832905987 0.32376105437427910028 0.40989419397115323118 0.97348598405729414029 0.17075613171480791275 0.056529007168872831557 0.61971676806352382627 -2.0533649851577724377 -0.088743780374276076683 -0.51815430245850591096;-0.57061732281635779707 0.062374778123273431907 -0.43051523863664015179 1.2342681376593283016 0.61075393908568365031 -1.0698393884662589226 0.13283230901953049785 -0.72286184360650240777 -0.77489693091432709782 -0.70227073367099623891];

% Layer 4
b4 = -0.54304328001976776008;
LW4_3 = [-1.0265242584604994391 -0.93698891687044616461 0.16270707139072590475 -1.026894963073299305 -0.43934547567980486438 0.64390844767712951402 -0.27871923834191536518 0.58137443741578120893 0.7541194297908346833 0.62158551792445282391 -0.41859261146164028489 1.0115736511810420328 -0.27574726215003181329 -1.2250674661336831139 -0.8474642950593013202 -0.53189888902792747949 0.57599192300037316272 0.51728833876867996722 -0.60477890557254643245 -0.78627163572419822568];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.499999999999934;
y1_step1.xoffset = -2.00000000000028;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = tansig_apply(repmat(b3,1,Q) + LW3_2*a2);
    
    % Layer 4
    a4 = repmat(b4,1,Q) + LW4_3*a3;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a4,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(4,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
