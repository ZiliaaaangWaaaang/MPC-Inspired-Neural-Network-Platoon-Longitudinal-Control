function [Y,Xf,Af] = nnmove_91(X,~,~)
%NNMOVE_91 neural network simulation function.
%
% Auto-generated by MATLAB, 07-May-2024 19:06:11.
% 
% [Y] = nnmove_91(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 3xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-19.0505965768031;-6.70139767883548;-1.99738196042707];
x1_step1.gain = [0.053913604005474;0.149967019141203;0.500604127399131];
x1_step1.ymin = -1;

% Layer 1
b1 = [-3.447292022270855405;-3.1535713502383302398;-3.5546152289157464388;-2.4506039103238892451;1.8183337737479245977;2.6412986679802350487;-1.6958591065866785996;-1.3801026572958101646;1.2622476564505915597;-1.460003179748355473;-0.9909604541036689529;-0.079529595135159794617;-1.3533629640847313347;2.1406391853367225941;2.5765216058366884333;-2.6264035152769293902;-3.1751421219931068585;-3.276250651120758306;-3.815898255812351092;4.5108569499845900808];
IW1_1 = [4.517392465903479426 -1.4044384948441728245 1.9307569812357123773;0.40218881611647605556 3.1009808884130287687 3.0500029005592210751;1.4777209360449508058 2.9039325518737979515 0.95363529515880451903;3.9835076071726427394 1.1636271220448080044 2.1297354338009064634;-1.872701541715335205 3.9347076341216498108 -1.1300896103209492338;0.74487087054632217242 -3.398230844254269023 1.3600122021445559817;3.1007346070683214911 3.3002092983298076945 0.11742179978986980182;3.3421433367412243243 -1.3791852550851646519 1.5359953648937247905;-2.9699672332419631005 -2.7473560509779240135 -1.0271942482039637667;1.5498569413250440352 -1.5662086301701747537 -2.6009814019655630446;-1.5628282438036873447 -1.5669333922432593376 2.6525145371736700284;-8.5783571640026146099 -2.0457520809324680755 0.73613416169444700898;-0.97188643887546866118 3.4609976041084182796 -1.6836998613452425211;4.3634698601663988171 1.3166269006581674539 -2.6193230822033530814;-0.7894736577355210283 2.8159874138520017972 2.1945946644948968185;-1.6808411199459407648 -2.5015349137192446349 1.9167372122931110034;-2.2230506981216611173 -0.046777765927869925655 3.2227158194843732453;-3.1599979441888237375 1.621294428104983254 0.63627549953442985586;-2.1717821712815195134 1.4616662976594880785 2.2970116278259919973;0.45257157036790379712 2.2197800826780658134 1.9771859014816381972];

% Layer 2
b2 = [1.50370032638739759;1.4263218063114453393;-0.99067472999489536445;-0.76177489349428684218;-0.12550435011599886392;-0.31610488112611911937;0.88321821159733382434;0.84976127186749239595;1.5111483772715170737;-1.8719479700749404039];
LW2_1 = [-3.9834073406047076915 -0.39217055289825819564 0.33590683689453215699 -1.772684382386603863 1.2005743055452702261 -0.4449003443330846741 1.3047462999509022996 -0.9678987630897856187 0.74837293817069161506 -1.44032029838382436 -0.17089447839368865356 2.278086011196844396 0.35438021583082457422 -3.305282899577496547 1.1295071563970935369 0.63500382425986523494 0.64734539714622107986 0.29385467538088078099 0.10727024246987292011 0.27106949594534868186;-0.35993885186246826757 0.050483242339620412742 -0.46277817788777342312 2.0186412208189583595 0.84416339840241005898 -1.6309120367914047289 0.22895263119888500936 0.29134034971868133512 -1.3265997236978690488 0.63457433756554249005 -0.0069330128422200702765 2.824777266511597329 0.18899189660782381162 -0.10193698932328441875 0.067213431540577864287 -0.57865806802545349807 -0.29121190367079224925 0.010339601099924270594 0.10213025821812389549 0.41796084878927891593;-1.4863640103894761868 0.40318586601013600701 0.75241371795017464308 0.19006709504637958608 -1.0039467497667000639 0.48814254068800894126 1.2733822097997784528 1.1802816375693727657 1.1479844440976658682 0.25169124361840616855 -0.78478975268323991621 0.6539266064750450802 -1.9758250404395285571 -0.44790836103015824188 -0.060146869163037207373 -0.1485412531801990621 0.45493756916063826656 -0.44655545299883986354 0.53163552050337858912 0.14158349951384013865;0.50211320333262432491 -0.39867502839719243246 0.095715287136097546017 0.066720305238790050817 0.92474336266064871559 -1.8604737941614712948 -0.0842590055589703818 0.11649255760033495888 0.068804192333980565555 -0.071687423415590562081 -0.54882514912347246661 5.3825515483695873797 1.4812196892727822473 0.63229452863727597656 0.30903598043347901836 0.28745312038610637551 0.1659977920259501083 0.26471660078998199284 0.71992987946118980336 0.11969549949474231343;-0.12840241278408967562 -0.36251228182694200664 0.70042373892224318865 0.53529841059133542736 0.98588562992325112777 0.69198530172419003836 0.77417820664109027184 -0.704391395604207049 0.51731718527926762174 0.42651421555333990376 0.051271466346574881556 -1.3818065070574210296 -0.47975680081595217796 -0.83121233748556433429 0.88957120634413600069 0.25988462484878332992 0.49307019393637568916 0.021069381811369101987 -0.048043447642496475702 -0.13310713912372310053;-1.5123745547812048606 -1.2126951575500437563 0.096631852894208433713 0.1255824647451738163 0.7032496926119534697 -0.20937005876299108476 0.18084915457711281395 0.94296149643645055249 0.6802271673432648269 -0.22969937113852759158 0.38884873945615733293 1.7356603245064115004 0.43120217616640404978 -1.5820435735569950975 0.84026040682958547112 -0.71997026775692452016 1.2715635200328037069 -0.077413980342374857924 0.33457528165418271016 -0.44481034741289138257;0.64673047570190156375 -0.22439480515432316809 -0.23633863568748456063 -0.011082446329442847271 -0.85489300033481396834 -0.4479663964794303177 -0.61478938137256633478 1.1413695898815698904 -0.49885306707511556379 -0.41571181681376095929 0.50722872541925645429 0.024030284192173852198 0.23494916972795812371 0.13238005900181840091 1.0116742249401915466 0.0058871033624760043743 0.27107113471179872244 -0.17641840388825175134 -0.76707794949854790634 0.21635691998152942195;0.050428387461856780116 -0.50106708454312209877 0.38573348000491969323 0.58985296804176612362 0.15792175248607512317 -0.96637481369235078699 0.063043174783338304379 0.35967849116364603024 1.0647896040684907693 -0.24142681748782976459 0.68821526319902415203 3.6608148923653698326 -1.9347014675816118778 -0.021534852173260413122 0.76592871509529136809 0.11770286926635581404 -1.2584175198578557708 -0.83604905822729125298 0.15836267178232232844 -0.12173301154256987999;0.0057500318755687928815 -0.18199050386505338794 -0.32719823887775373317 -1.1903482789485941851 0.11964871055849200798 0.068033472753800269817 -1.3113777627055873687 -0.54548723588250069838 1.0418038474847364228 -0.066842838346853047926 -0.18689889484034721834 -0.88061354159531246566 1.26644964677874583 0.76817735744092729977 -0.24348924366470020564 -0.1385957994997749354 0.48026959357133841566 0.067081501491428219275 -0.17122055991079315751 0.22386239578490171875;-0.0279620624951928895 -0.217267204723813806 0.36642797023559109393 0.11200906821750136744 0.14422357217393336204 -0.12047272916524195963 0.57380908104324490626 -0.089183788053625479009 0.3096103687126980919 -0.19239129712616215295 0.26915038387652978624 0.42285640686473280336 0.09300296697130400192 -0.31122356549090701705 -0.58291073782186286767 0.60368384735482871761 0.2307851782785215744 -0.55371535937346572087 0.42821375055951987898 -0.47577125233663619674];

% Layer 3
b3 = [1.7871572806958682111;1.4451526611902807407;-0.93381164680322192861;1.3299038226128114815;-1.4635679819655411649;1.1057171728426307133;0.7144127795713737239;-1.206091863797705388;0.29398708213957824853;0.10922101252867894017;0.10477534512650411858;0.27854249221414628668;-0.82994914870911984384;0.43079506221869301452;-0.63455410783822585596;-1.1124227811412623623;-1.0427708661835037862;-1.745124679853388816;-1.9423523783171288137;1.9436655838166818633];
LW3_2 = [-0.34770085132363309777 -0.19641330807073456577 0.68957191340814394387 1.0527773532431410342 -0.53119057107106093518 -0.47566646228579051447 -0.3619689432453991329 1.2602778061689356992 0.66935972733508553034 0.70502802464619995781;-0.48541397086729576316 -1.1926210661314571304 -0.71650468114559862087 -0.031917281214124258726 -1.1090698779365537607 0.68858710059712602281 -0.033248963687567335834 -0.33813181247206297586 -0.16004555240838644337 -0.50082160555025767579;1.1788820373167003819 -0.42468043642920683123 0.78176488869601701293 0.46066138647507143267 -1.4331104303705202163 -0.064481868477450160482 -0.63744846431779500495 -0.28690165346021795356 1.218632362567826366 0.1119879420192158026;0.029661749430985567821 -1.3685494937543420946 1.379120298441102177 -2.5688946955893330326 0.77547608276204038624 -1.6511721204704754573 -0.7313250275785286858 -1.9540718100345337849 -0.49257091566046273812 0.12166774454277548556;-4.1463014518380099105 -0.7869448016329410045 -2.9727723349183063917 -2.9112799381692155976 -1.7298854327213546433 -2.2264194070492497879 -0.41747230770293319857 -2.019148316372164853 1.4087513618619602607 0.33188620282935266115;-0.73411215923306816222 -0.58305899412821304839 -0.74047626033801594581 0.19142293585704359127 0.82717447782663422462 -0.15156168890564863938 -0.19447796080412294017 1.4266948080589232362 -0.18524480558949063536 -0.039032211238584427204;-0.12829637158229237337 0.63058912292254110099 0.73782981610923004112 0.18713198490087962211 0.52828529299050808188 -0.010929717548144077255 1.2488512897046590844 0.14882300699496836538 -0.71992130167329060342 0.16260520708153025637;0.088612593322578425692 0.31945687710512071789 0.36818720753209555063 0.5957791794207152325 -0.053754416464955420696 0.37359192029914467525 -0.41929099928196433833 -0.38213750819841846296 -0.85182470088984074685 0.27456985078058926408;-0.44562414104622999345 -0.35535645641803298433 -0.50907803089244330064 0.40126820787488365339 -1.1739686524345196439 -0.36022678035377808659 -1.1889247268606319974 -1.4353535006650177674 0.63608573899479692315 -0.19247070706849053745;-0.28160507034629606027 -0.67764630762322330959 -0.4601543890344300114 0.74952250472601622544 0.69563369343907988096 0.51551991796390028711 -0.16593235026830868706 1.6815380159068213928 -1.0806794597606066421 -0.63697012675413733351;-0.58553411565565338659 -0.78900984305701271637 1.1654333124094538032 -2.8797956513485796215 -0.1519210356718215249 -1.5178883919962700144 -0.59705812205590391706 -1.7159174587373311471 0.18458916338548450597 -0.064170749163228443801;0.57128725961512671905 0.31079487323167259705 0.45154794092453703902 -1.1697179412694191925 0.407956544126105769 0.041308744379561709859 0.37480462955467874764 -1.2900656525375868711 -0.30642875566513705365 -0.64906676635334592529;0.76688092133735996647 -0.20154892338762683823 -0.011747399226991368792 0.69769203275708935319 0.35425632291710074107 -0.61492248244276959124 0.21050161557276622637 -0.89632143061126667849 -0.53956727270409265973 1.1648339467399952962;-0.045480249082974232022 0.013654289499192709748 0.86434511221699517058 0.19511613380284825725 -0.83725611647516273717 -0.049318512354650886897 -1.5145524150426741272 -0.15946039718536705876 -0.81894352338239806421 0.10945332684079274455;0.074963615735520267025 -0.59156449031772040392 0.49036694409255088267 -0.35178752276453512104 -0.034522200248379611431 -0.82991674555902850141 -0.59813925096680053972 -1.7229183761200532743 0.8471544130758948965 -0.96554927677409629894;-0.13363177592522434978 -0.37741007516537483646 -0.43161392361087896896 1.1712149617278579949 0.7375625463748507471 -0.20260845928081919198 0.31078256311297913772 -1.1816051625353722887 -0.073749396476636322473 0.19090555740293821407;-0.41287151423464674149 -0.31539105989685833897 0.012282364443214505503 0.33389035858252225086 1.2541298058430034867 0.38352805736922807034 -0.31305298921071317286 -1.0024377017319434646 -0.60248914422837784866 -0.8399382360812815973;-0.1195300036073067701 0.21985561383613169695 -0.030784422475045519069 -0.26127897034465541459 0.48036259523366148239 -0.77686731942332609702 -0.53388471951584559605 -0.37811598832004905679 -0.7092569914759224714 -0.67828998997621758882;-1.4339383362825648405 -1.1928102934865594253 -0.037881256950534680783 -1.2122341611453586463 -0.6970041650068564687 -0.97574309393596692086 -0.42412090267299534796 0.64951139027920057334 -0.1743662370394822303 0.14729237523742017002;0.55769717835642584891 0.13661901788663394219 0.27318220330805237372 0.018791075536399252238 -0.5499962569834744297 -0.64285799790945463705 -0.18108126998259241325 0.95150898806704176103 0.9148976743752413876 -0.69360990644005615646];

% Layer 4
b4 = -0.070903984342925011064;
LW4_3 = [-0.062476731111907254923 -0.025714663759392304698 -0.034266949676073264752 1.0110446371528105658 0.98276570320987177709 -0.017176710646430209256 -0.081716200219651174974 -0.35635724155064024687 -0.06588907845686162168 -0.19561229999863782858 -1.0162413203742479695 -0.061407176012177794311 0.31185101140715176804 0.012357171687942277924 -0.16705333222531701387 -0.26100029104209687691 0.099336664426153381546 -0.11848162521429422833 0.089608470330044806551 -0.076013617382914899778];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.499999999999934;
y1_step1.xoffset = -2.00000000000028;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = tansig_apply(repmat(b3,1,Q) + LW3_2*a2);
    
    % Layer 4
    a4 = repmat(b4,1,Q) + LW4_3*a3;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a4,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(4,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
