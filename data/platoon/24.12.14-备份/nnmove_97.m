function [Y,Xf,Af] = nnmove_97(X,~,~)
%NNMOVE_97 neural network simulation function.
%
% Auto-generated by MATLAB, 07-May-2024 19:06:30.
% 
% [Y] = nnmove_97(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 3xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-19.0505965768031;-6.70139767883548;-1.99738196042707];
x1_step1.gain = [0.053913604005474;0.149967019141203;0.500604127399131];
x1_step1.ymin = -1;

% Layer 1
b1 = [-3.385533961921383117;-4.4457374297028868781;3.504167834347573951;-2.5738517582861502042;3.3380681800786922153;-2.4190487504170770094;1.4640653570404127404;1.1034508576292654247;-1.1521149915007740105;-0.14044726252552727774;0.29559429010843873975;-0.77611002755676383735;1.4878108825543758797;-1.2796568207089378255;1.1302249673835442767;-0.68293060417030759801;-4.4308993190215444358;2.6906159308802757302;-2.547131493491322729;-3.1238478644771645598];
IW1_1 = [2.7027424268666861984 -0.7149387266654789741 -3.0907421852718086619;1.8086464064515070937 1.814918607152399721 4.5752812619412868145;-1.4189184756553943068 -1.8504772774167264071 3.180524038284731958;1.972871995907696796 2.2645351222611411757 -3.7230013259391783187;-1.521814709763165796 2.5327138742238681779 -1.922627938759115418;2.6001454398968419923 -0.84843728512080907045 -3.244255840117591827;-5.0606538422609173011 -3.3810570934599755155 0.41699599288048810886;-0.024437050370531912535 4.6595586222792046982 0.93922145271640788966;2.5986881081995125697 -3.2478269281457965434 -1.6520734432371355638;6.3965987836066631189 -1.1130984233729575017 -1.0154696955350610565;-7.8702757106185652347 -1.8416306253239242974 1.2680605962241997542;-4.0578115826978438108 -1.8954652561796523358 -0.24247296962651351815;2.6621963518739657495 -1.5724978324864700152 2.1778313215291675853;-0.79337469971970242533 -1.0279937170846571437 2.9403817973574515321;2.2553286623552923906 0.39359426414539505634 3.1568297319354496899;-0.71793321997670223045 -4.4124510922632431686 1.674663799127846131;-2.2103653791533632855 -0.19832902762543835884 -4.748501900834739331;0.68910967895015085016 3.8228464041917056271 1.6592824570363868819;-1.1506507318406686835 -5.0795834100325985005 1.1534080785169467109;-0.65006025679327328337 3.6858458954197748092 1.649336518415296382];

% Layer 2
b2 = [-1.5775990521413714163;1.5448797126971183236;-0.38446937960276805768;0.11629797428554390637;-0.65308538536228522009;-0.90447975067116082037;1.115225679625174493;-1.2656253489131008561;-1.5765159811792659461;-1.4221732650926701691];
LW2_1 = [0.13410972705680310191 0.90196843408625104743 -0.26768002220335562757 0.32082518420661032543 -0.20899408003373326492 0.28960544950416872156 -0.20153255335627917599 0.51000022276873280269 -0.57523173050314613253 -0.28189649995751564493 -0.10164063406690884706 0.38098812079809207809 0.50725505735042464295 0.38830383042726723808 0.25104968149882345152 -0.49548227619444329406 -0.38096601351264547386 -0.48546927406885037604 0.16744453898816716308 0.58898824386563930489;-1.1700229579203129671 2.2963526227140413916 -0.66591064006603184477 0.74718825867676208485 -0.1041306767205263939 -1.4465524470026351889 1.4423644173283491909 -0.49682999404389460718 0.033084045247130038081 -4.3862572100184644697 4.5971155257541713723 2.018589963947893029 -1.0656901151281767959 -0.73352191354568618831 -0.53002026274743896384 2.8196611027889963985 2.5701026669236304301 -0.31557781159776815416 0.12761926404302786908 -0.19527714239143140196;-0.17208487245550924127 -0.15184179335177552805 0.69960660123395834731 -1.0989367947695578565 -1.0372350100821485785 -1.0667102855649994719 0.30345665750292549756 -0.56544598571803317277 -0.27994529077614938029 -0.6420777976632403572 -0.81089047255711055318 0.34648069610193338308 -1.1771361085238738475 0.11025412939923744104 -0.2410340977374533511 -0.40758508475330251786 0.27635908981426043907 0.35215597472337423213 0.032773959199448650381 -0.42413824638470382089;-0.7468383409415626506 3.2305860577847620441 -0.2742710788486041884 1.8881043793936787001 -2.010045065267918929 0.50916203517583924487 0.30908512096927392987 2.2033277716451515893 1.7692711274516983444 4.7017362442960042301 -4.5690185997093344383 -2.9632811576393112141 -2.0604468725740550106 1.8168798633302254419 -1.5877559282613389335 0.74943237273889617978 -2.3691971877667645785 0.30746935916051448823 0.53987386320214836299 -0.20984181109670849152;1.0208002045436717076 0.4278314008598169127 0.72613879002655201678 1.197730174941557646 -0.48071468511421067138 0.51919667895813648162 0.14585802149530277538 -0.43467889402937587295 0.66721071951996635541 0.17723013281012128806 -0.24783092554595537171 0.49815906521537950402 -1.234870553028746043 -0.4451539050389561325 -0.47739734373755093877 0.014419943951146822064 0.52528787938309684513 0.13761132245506033089 -0.37463306344206609433 0.88196886769377047521;1.487037320918830785 -0.6354589813188724623 -1.5899218380859181377 -0.97442498260597731896 -0.061132470470990185607 -0.23450882909937412202 2.6790817468647158961 -0.28919487075960209621 -0.046536619883102682549 -0.15776549030685427244 -0.95217690194212389887 -1.2088940861382104774 0.67980343571836099326 0.4593009263534855724 -0.66990148659865000891 -0.30255475560539207835 -0.25975637693284880925 0.86582650238912151064 -0.53679997776112720054 0.89552124869209581703;-0.047800979711155634766 -0.068056817489004467481 -0.50841774077924273278 -0.33388323103276806858 -0.49480258395258297499 -0.83143080919420908614 0.68220624935296825253 0.19813770452170581526 0.44151146857118078737 0.062798938972651055512 0.46390144890382623011 0.55902899962514318588 -0.22874330192920108717 0.16079814741071854489 0.046149767495954126251 -0.26629645892767089821 1.8044279974359842544 -0.21902301514080740885 1.4987912670934420145 -1.1994896840515321124;0.043974922284753296953 0.41305971969301058522 -0.36958812943545232832 0.21335192405590960862 -0.2657550979765100907 0.713716466178450748 0.38245108202177219292 -0.13755158616406562566 0.8046201838001423301 -0.12346060419147135423 -0.50454512285013752848 -0.067794336199067661841 0.39717867253741906408 0.140282409757266191 0.6431968796799527599 0.11179419028695322669 0.81816055327807302167 0.15971120112441875016 0.086686981426601000811 0.94439275232626862522;0.21266113604518996349 0.49170369997350610314 -0.73623866769201573579 -0.18750051018842078809 -0.79908557672150959394 0.059622264634608464207 -2.0540881839758364791 0.39607693511420882793 -1.0743933938026677399 -0.96648864971008940916 -3.9027655747593805735 -1.407164522608602697 -1.3555375807335845462 -0.40706282839821389397 0.43087897130527685885 -1.0160010293804668802 -0.2799763379299368693 -0.2444920690492717319 0.47019087885940219484 0.98864073852760903094;0.10261124021791678818 -0.27160977698039756589 0.1590124486663575254 0.12425877171742799598 0.17210929605921113095 0.011990223300299867812 0.49360214887345388313 0.69961627756709510173 0.36863858390643439167 0.82257753993469595599 -0.029427954145050793516 0.83409426613663184558 -0.6773484755965604176 0.0092013627725518500056 -0.20626054317021638718 0.34005158929653778177 0.30818158243160803655 0.14994210080031172838 -0.69347257661919392557 0.060201030894803796156];

% Layer 3
b3 = [-1.9080307432033916104;-2.1730164805785210369;-1.6200352077933592998;0.98115491042137803479;-1.3975999144291308962;-1.2797385604088862276;-1.9511280027573809637;0.34350036669942402012;-0.41774330361052564031;-0.16355470918975148487;-0.16570784502313029574;0.3817907954623243616;0.67982313723342979728;-0.72125874302792636339;1.0981517847714907798;-2.0093033360613841154;-1.0754584640618236602;-1.5015033856974362436;-1.4641986754234017631;1.9263697781799049569];
LW3_2 = [0.096968360479921009154 -0.19925835237678427014 0.53850691762489699688 -0.70657928038280148897 -0.037734132366091764632 0.029542620436760539532 -0.75718577920219709565 -0.87279457017406802954 -0.62478170287181333808 0.67712303547367447276;1.0324915984852840456 5.3615259481745702885 -1.4828810604615940694 -6.0088063284620547577 -1.83236842260066779 1.7518258757368962986 2.4026995393774406296 -0.31202277828910529589 -1.3537702464785077439 -0.67706151420988514023;0.42534857204313464285 0.1659837917498788451 -0.77649144889455257168 -0.42073568789517118427 0.33942179521981441503 -0.014211046546757193088 0.54576614589245020515 0.60715259249664477181 1.1453643710770482489 0.52523018839633672794;-0.75039336221750030376 0.37369802195981161042 0.72266572365069936534 -0.93338464889095895671 -0.12667705031574011398 -0.66849602626170978592 1.1877145531634381026 0.26780484854384534188 0.25599060138962947963 -0.20002396227421859187;0.40648674417729324659 -0.50740229474243658814 -0.47615915577370537815 0.83260384192788305935 0.5878608508585917436 0.48106256916245393462 -0.8809118298747149467 -0.027295335120420542024 -0.14660736406161348211 -0.20232812899082117108;0.6203847046825015088 0.032016944951825825061 0.2133009774511522294 -0.93472419576651888384 -0.41092378092792058997 -1.0983508429292383468 0.84471824109192028551 -0.68166568734420063258 -0.63098655361106226191 0.7837576627720276301;2.0388702668811018448 -2.6627715418841044759 -0.35933075464864955295 -0.66187960125102796027 0.62227355255460892192 0.42135572927895104112 -1.2847512993991379027 0.29613547563921738259 -0.98893346285167149645 1.7301213194288163066;-0.7863338829246383499 -0.74001842381578086805 0.86955907696833389942 0.17164391509545176562 0.81242426396141709244 -0.7234130039099279097 -0.77563100031286846825 0.77683422891426556767 -0.048739071762015188927 -0.60112501946546337273;0.68707702902717715521 0.88686982111085033154 -0.62424951198103795225 -0.40888557399441854967 0.53293769732538209816 0.62963909602536183296 0.3914283853406494984 -0.94340664531102735868 -0.18470922217521479336 0.49026224578144816935;-0.64506557187840163348 0.94603591722953428444 -0.4033448290673302683 -0.041903873203321118091 -0.1069976434368560686 0.42757263187198607524 0.64250970388945150003 -0.35568159628604634204 -1.6697508954653639268 0.2842413439019986221;-0.047668999275559308104 0.82138490836753352831 0.28785647253743523732 -0.30761052762827129081 1.1813026262476138406 -0.34494626863351429691 -0.50292518651002104946 -0.67548034701272685609 -0.80104902910927067161 0.5738760644603514427;0.031451086659113974831 -0.79709077967010821819 -0.3311706614202456489 -0.80189105985551634159 -0.63236351135674184754 -0.053950364769893233152 0.6082075579006326338 0.64917237567404773024 0.74115895480345972413 0.76710521419770671958;-0.11636152299110440189 0.0076066157220087207702 0.41526746346040321889 0.94101721841697805182 0.86287516139171682727 -0.72913917014591556054 -0.86750763909008565822 -0.20766729646268469733 -0.16991033844417804954 -0.47443474539604729712;-0.4434131620353687353 -0.68667696832052993461 0.81699958803924266348 -0.085571462756194746624 -0.84945061569157354064 0.76961518346834378868 0.38560492054626921421 0.32478628197441189451 0.94909960777741564364 0.3868318319082510448;-0.010728816336106178006 1.2171129585210676005 -0.39330016867415451554 0.32328945218173182896 0.84514661338971430737 0.32505697880448197745 0.63389281948769060637 0.051432795570149028586 -1.568407135699660504 -0.35309720630101287808;0.57175992175750511848 1.0209439076129169788 -0.66832638336798311229 -1.5562397367728422193 1.3093643171498914324 2.3690324953969228439 -2.2181088529954045008 1.5497200576269485328 -0.29515364865060411681 -0.41823449307629401162;-0.31486565618213724349 -0.58231134706930409717 -0.28692656757050283289 -1.2555531845307719152 0.30964804739878332152 -1.2483148895640290288 0.22942918384785793151 0.39461091013796079086 0.38024918211116487399 -0.51288286840623820151;-0.25863856018041436746 0.19642391833893699249 0.53113817054311185384 0.73324241269074263982 -0.6930827585025062243 -0.16065486331243925 -0.060191435597174873517 0.10411437934019714124 -0.85793963818868290705 -0.51532188209674556489;-0.8188520854505753066 -0.40754136926547657183 0.18424922928529616217 0.98331255665044137171 -1.0356576151459406798 0.19261144261551266244 0.74663763337744870618 0.51179038021725442587 0.30974703678359699621 0.50053507586833623222;0.16462222276411639377 -0.10854062373433651101 -0.2406152915592839614 0.021528151563692032866 0.14709249004792251947 0.8957329784640314374 0.60379764611830077925 1.0469631321657735246 1.005704188935892418 0.25510457236754341404];

% Layer 4
b4 = 0.23849329308020386642;
LW4_3 = [-0.0013685607274874958105 -1.0035690904304872539 -0.28302474805377270117 0.021540665470317271746 0.037563826980572562197 0.011123005652819645608 -0.62203211026240123882 -0.0034692265129475687024 0.0083776062760770736437 0.084368294028406620733 -0.0064081595047588190209 0.010345440393135734922 0.014256473954487125164 -0.0044651708786085878705 -0.087783370178344394263 1.1269029618147470284 -0.0026560989933664923279 0.012107647470736851436 -0.0056987289077647679952 0.0080107952660406229334];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.499999999999934;
y1_step1.xoffset = -2.00000000000028;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = tansig_apply(repmat(b3,1,Q) + LW3_2*a2);
    
    % Layer 4
    a4 = repmat(b4,1,Q) + LW4_3*a3;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a4,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(4,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
