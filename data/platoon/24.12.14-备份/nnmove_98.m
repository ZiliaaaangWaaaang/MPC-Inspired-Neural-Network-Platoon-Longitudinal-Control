function [Y,Xf,Af] = nnmove_98(X,~,~)
%NNMOVE_98 neural network simulation function.
%
% Auto-generated by MATLAB, 07-May-2024 19:06:32.
% 
% [Y] = nnmove_98(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 3xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-19.0505965768031;-6.70139767883548;-1.99738196042707];
x1_step1.gain = [0.053913604005474;0.149967019141203;0.500604127399131];
x1_step1.ymin = -1;

% Layer 1
b1 = [3.7358779138911906159;-3.6489934639072716394;-3.4211547928348098324;-3.0832603296150731254;-2.9020061863742072639;-2.221464158110205922;1.5288227836928434122;-1.5387815056997986574;0.49681823391631985132;0.68260967039777786791;-0.28138968661497926194;-0.27262696121536517113;0.43514578111364188295;1.018382132253361716;-2.4954970071240820673;-2.7193017616230585887;3.2069742694759910684;-3.3835876362806507345;-3.510186641297042609;3.7956976167416609513];
IW1_1 = [-2.4559340116565526735 -1.3241489780209272364 2.7674990660043463642;0.7918145397127879237 -0.52655946716580792621 -3.7184060951759985159;2.0807122784483467193 -2.3783683479470671962 -4.4011777844083441735;3.9736737728984166118 0.54337473265586699878 2.3591033190369810058;2.231510084954584805 -1.707116955215070675 2.6500350989499086296;2.5125599216108422951 0.90090221416885574168 3.014370993882412364;-2.3604751092539597579 -3.2330319207402689052 1.5497609081634005079;5.0906814187803179905 -0.87322990574956560472 0.2826206520485017859;-3.2010767783930011987 -1.8592435980642998405 -1.2375799115864380973;-0.63049140787390189899 2.2408506074376668415 -3.0028888032814351483;6.1887745862757146398 0.99786625285430619048 -0.75133428157394155367;-5.5723031075981088733 -1.9661307476297285035 0.57779886509479416734;2.0170936506255294773 -2.5650693968728708327 1.522226632320194728;1.9170590687540365327 -1.7590408672186939043 2.5258919310702712124;-3.3343323020351745001 1.2794681667519081092 0.68345759086856805453;-1.764884966194200544 2.253560395160653762 2.3014569894602945332;3.7183409832102181092 0.5912085306562392395 3.1620086761799637287;-3.3289319945408260004 -1.594870983447408852 -1.3266535733508284522;-0.28511416907748488025 -3.3385994251755470863 0.40592140331393533614;2.6544639292606606595 -1.8944644788196010055 -1.9944172317943105188];

% Layer 2
b2 = [2.1423755669292949833;-1.4221594140090552116;0.81948829011369506148;0.20792435751101998043;0.055040206978927475046;0.049583543861999007651;-0.74024216187219127328;0.91439532161212622174;1.4384093229063095176;1.4753221603341086787];
LW2_1 = [0.28302369048296083243 -0.63882503720800765112 0.59297049651865163522 -0.15565062811736823933 0.63543424029629813621 -0.24614876689270709376 -0.18628759903405223142 1.3606766541840074058 -0.018485280486787679377 0.27628087815066970645 1.5618030228055148623 1.4281644613547350708 -0.41262908688880517438 0.015080514085149073281 -0.071525256207856352519 0.22668742266691641052 -0.48238278018116664825 -0.21334510446132143313 -0.18149436229950335897 -0.12278718681571816618;0.52150871128517084507 0.37186915341685217173 -0.38626841321710742028 -0.40737228393038477092 1.1609377490589123383 0.80416811129263809921 0.043445530473640789348 -0.93875903877373634288 0.19336942556329253518 -1.0957869414667944508 0.13723166126534810938 -0.67053866716658128144 0.0071030215587012104569 -0.32651764884062928207 0.19201754271819343467 0.041716011924673078448 -0.07048715514529110826 0.42469919683467777238 0.43346304460385248758 -0.34245632354576793777;-0.33244107470649514324 0.39323499144691298479 0.31143958832327739428 0.81590107236168896154 -0.93720690150428487275 0.075206067668644085988 -0.18122159999508608008 0.26102850998644522296 0.64105850786340001779 0.099127051710254474037 -0.049618059766149566481 -0.055661546597998941277 -0.4319700780006562324 0.24821101095004297066 0.11319254907828624201 -1.0250812916510640971 0.34851829417352403473 -0.024593460815663971408 -0.055023499624005954567 0.52252636615941872034;-0.50165743789201189262 0.15992990323321645829 -0.85650058866202960495 -2.313849324416376696 -1.4910074679994358426 0.3117864783568184972 0.41049102533562648043 -1.9659414014218326017 -0.02328875992536750747 -0.73600012182461838073 -2.7212930863438771212 2.9267519978116784962 0.82791781619949478266 -0.069132409714278003632 0.21852580816290956278 0.79931848468772470628 -0.26865149381424752173 0.57066340430106277104 -0.27197450634548930859 -0.41514319128824062055;-0.18549045049644874439 0.1373626443252339846 -0.65741854124217946609 -1.2207193290709472677 0.39634086699194820413 0.28613523845730293171 -1.358267985765426511 -1.7089683354422076089 -0.58561839571314044939 -0.002195763862490712412 -1.8079705148633673506 1.9944042210532788584 1.4626134099889658291 0.84265055986232373364 0.1598153465532884121 -0.27724113603268191186 -2.5243735632949566572 -0.16873921093737206944 -0.35933579632404205606 -0.32359300939899277028;0.64888742921834607902 -0.6342394629412602125 0.54829364240691391696 0.47919525142513402782 -0.84046214065000113269 -1.2406231041090183265 0.39143934379184819328 1.3872613137790059668 1.5511584000769136349 0.027630429740627914653 2.211139797844455579 -1.6089600539751940378 -0.0471823553668773224 0.44063817183429432323 0.45771429855351919436 -0.21947861314488911755 2.5629768909230348228 1.0541576175371836221 0.46161754265117194151 0.071642748428911537384;-0.92069938677940232896 -0.56430254901792775701 -0.57142051755811817948 0.14450656435006556388 -0.85589289521031408636 -0.076975328685978006149 -0.39609818434259630449 -1.0784012135085538908 0.19396132158879406115 -0.39517576593371550597 -1.3142026011984051515 1.0161474932085610146 0.89705725205556718915 0.20326116967578938821 0.30503081524442832162 -0.34580035987147977883 0.5544027489432350464 -0.062356778666262692445 0.23019780417645571702 -0.49273251849746046993;0.073546788181416883345 -0.23546216378096723743 -0.14779883901979218308 -0.42052091989488266099 0.46893859682167637892 -0.075842146682567682103 -0.15223407856508378022 -0.80050011933142251053 -0.11449854329475234183 0.075374299492070362394 -0.58399792009519180258 1.0741138669555228002 0.29053212300199277029 -0.15695292785331763086 -0.21174800912459126878 0.039613523184087673368 -0.62351576765113558842 -0.18714618927273540816 0.15868276217688304097 -0.59316505434936417362;0.56212511766666817259 -0.56319037887369449713 -2.3483849767292355182 0.093959445756329529331 0.44506982047652360324 -0.3212142120793992639 0.53686409894991726777 0.28279937657943587936 -0.28318426782584110724 0.064551184721287055424 -1.9733218980561517686 1.1424380779003915354 -0.011055716522137833124 0.66898967572388645664 0.53470079237697154539 -0.69765998765533987491 -0.54888561472855101897 0.27671476192410926487 -0.021080122061171876341 -0.19137407157264599289;0.064354589043187249153 0.41397332099464501098 0.21569601181298819759 0.26281209034143698799 -0.52608432578012964687 0.89940120191712225051 0.20562594114297383374 -0.73443568246065482619 -0.46871981706906595821 0.83119611000499649123 -0.95135716113052026799 0.13229486875281379343 -0.40509303821257630629 -0.95446354707105707238 -0.41537779800386659401 -0.37131223822766179499 -0.211336511947808392 0.42449789456201525439 0.089831487596479284163 -0.31894427444454975795];

% Layer 3
b3 = [-2.1691922354211183865;1.5938085276129685397;1.6393945566014300752;1.630119616823413331;0.76400611238933857639;1.6204273322922371214;0.8878994923169670761;-0.25457751216758289781;-0.053533530720101446532;-0.39552967637949731916;-0.497096996969323357;0.78953128432552621696;-0.90320407354757958895;0.81336295168277628065;0.99681173209924256451;0.98917290189525042265;-1.6294325690331923351;1.6009650511346069646;-1.4084243968518188606;-2.0472826825858416733];
LW3_2 = [-0.066790299888349738411 0.89633002695499008894 -0.29960194034053366785 -0.52770504167707910081 -0.4386115358221989724 -0.72140617331316292393 -0.39114058082413943884 -0.074711264704448318574 -0.0981540958739634678 -0.51262521157701612662;-0.95107822539660680228 0.9023106856920455332 0.92909012193329809648 -0.071691105313370862007 1.9427894039112414415 -0.053614647895517481002 -1.3086659294961646705 0.19457087841426265462 -0.71923801012424726231 1.4731314942707713911;-0.18486993257534253821 0.29286820376351713202 1.2808060142325616848 -0.97487868396272325811 -0.029055119415517569048 -0.42792343177624647677 0.0099413674559221711091 0.51987266529459763564 -0.016344611731954620387 -0.56161029996239297812;-0.75840527976719607217 -0.28906772361580951314 -0.31095430111988103805 -3.9946739871182095349 -1.4645864208929908479 3.9949893887983014551 -1.0476339935524530134 0.56537545290094970429 -2.222062304193880955 -1.1065463858198731906;-0.13837394241262779282 -0.74946567992528734248 -0.93170355495354884034 -0.71166466881997847427 0.13316881844528979939 -1.1027513439574125886 -0.11089276419139459939 -0.28141384731932111984 -0.64817809134140491611 -1.1151821291269574665;-0.74065448187600235741 -0.34860876568429560729 -0.1747621967832931611 -0.62342142937248223866 -1.2094435348729999369 0.051411774248797441345 -0.22941928781982945384 0.74240330826850298163 0.86507859224160432721 1.2485038763887099655;-0.83983540017986346715 -0.10754919431978496314 -0.64415316182402337919 -0.24686815940193793106 -0.62540837333550980404 -0.10561838041904592078 -1.1415807551394856478 0.75111107520323094899 -0.30071353501098552208 -0.47447586744005371129;0.8959563533849019823 1.0812565868020089788 -0.2927892386476863007 -0.34145142363203873082 -0.66061660129463106728 0.25520837221218628521 -0.29378500526642420398 -0.064177658230634024306 -0.063472710901768966685 0.7030412978119983114;1.0695154875518604332 0.44128878983086944343 -0.68220117532294499707 -0.19391403443036223098 -0.049083053338158544321 0.25967216358604605642 -0.09166946057527944336 0.79248720043919806955 -0.64054174666435359509 -0.80132368033798495599;-0.66577527826271598599 0.76511310003363652843 -1.1586634434122520254 0.68245704643218740859 0.17317348816806263367 0.54517095467662868291 0.045510261454720736529 -0.7846892316473281781 -0.718512145075872799 0.60086523143942804914;-1.1205366457985628248 1.0742677415875463431 0.24405364391498113319 0.38047204480402002646 0.31484432262788636381 0.52802922896572035416 0.12173767621367187486 -0.23627661954801013056 -0.84604949885517877206 -1.0996498340663853899;0.5536109852302278922 0.049567099179037253653 0.67588430598160853524 -0.98813254993007182403 -0.62192118245952510147 1.3290089301569663061 -0.70925318973713591397 -1.5099140809859921131 -0.93135902761991351539 -0.9119579865010658537;-1.5029618606208448028 1.0484337552210101219 -0.56589028087534443134 0.72241297182339392347 0.059279624957980205091 0.35041899961454886503 -0.17909438362084395546 0.09872164653235841747 0.053013930860453119254 -0.48193881234231067401;0.45948800701721881357 -0.23452547227344158753 -1.2681426262416113371 0.037449344751769975126 -0.27611346453972296366 0.34063052114828906713 0.69959137537589199951 0.45746470275984268961 -0.46578786789476239738 -0.20307417724217743937;1.0398758313163820599 0.13425911365921927576 0.99020494568085681841 0.60352879861295383179 -0.35608608039163036629 0.034876630549748599552 -0.2549091328967887371 0.92167887139583737355 0.7159727984053366745 0.24591722431280144123;0.63053834924577323306 -1.9221307222189261132 -0.037304854334590187293 -1.2684270569514881633 1.4085009460058308672 -0.23619798090932681012 0.59217494385075231111 -0.61243385483846402018 0.80166667521124856943 0.32383671324692275828;0.2850846146115316726 0.73598365901809470468 -0.4683407078163049353 0.083676979738586260149 -1.1203098368336492641 0.59818076676794684765 -0.94607362930612437513 -0.26082706607343425498 0.61146175908693356504 -1.567047298124767396;0.34719382796974807004 -0.29957581189436943703 0.74178647344917369999 -0.80815528551280479963 0.23659782634585554972 0.72152208824570929213 -0.54268028945664670282 0.47443002608701168032 0.85789828081601526844 0.2271875024214980443;-0.042707821214762908824 0.67020540572487918851 -0.41984340846693046778 0.66586707906264952506 1.623653571056888234 -0.35895639223215181079 -0.11241669105879932566 1.132301000454180695 0.95454667142344518105 1.0845840711454024508;-0.83738355686003485001 0.55337443740746039555 0.92848335908682544382 0.2431496160968042719 0.28801537052945436201 0.12447552814623032147 0.56557616972423307988 -0.9449339508556978684 0.15630118741251108894 -0.37467738789403615129];

% Layer 4
b4 = 0.692789087025999617;
LW4_3 = [0.67427766776625308598 0.37119227669643911627 -0.02098587555224446996 1.3048954534744079403 -0.063603434102315378751 -0.42011004038737109756 0.0060999897268766284375 -0.04758058212024113276 0.014394707808437646329 0.79677361011471548036 -0.43787072301961599274 -0.94605474216937879284 0.84078869608175132999 -0.0097730182458796964473 0.38993098026682093682 1.4145917857303207388 0.39981264491702184216 -0.84592860898807575865 -0.6879906550356730266 -0.64207202821152831174];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.499999999999934;
y1_step1.xoffset = -2.00000000000028;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = tansig_apply(repmat(b3,1,Q) + LW3_2*a2);
    
    % Layer 4
    a4 = repmat(b4,1,Q) + LW4_3*a3;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a4,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(4,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
