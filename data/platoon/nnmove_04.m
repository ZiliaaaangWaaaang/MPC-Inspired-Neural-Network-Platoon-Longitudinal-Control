function [Y,Xf,Af] = nnmove_04(X,~,~)
%NNMOVE_04 neural network simulation function.
%
% Auto-generated by MATLAB, 18-Jan-2025 09:34:34.
% 
% [Y] = nnmove_04(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 3xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-19.0505965768031;-6.70139767883548;-1.99738196042707];
x1_step1.gain = [0.053913604005474;0.149967019141203;0.500604127399131];
x1_step1.ymin = -1;

% Layer 1
b1 = [-3.8996124712458333228;3.7468037831136382643;-1.7738448414832050926;2.2916767959029940016;1.5842065043474782282;-2.5357321688608398524;-0.38355620834010345499;-4.4071379277804547669;-0.29427408897280898925;-1.9167240792424744544;-0.03055321618666340111;1.2668011416560869264;0.59268215349119468538;0.51127003031824569401;2.167738766961425867;-2.5293051472996888052;-2.687621469456051404;-2.4838576792260464998;3.9331062719064608935;4.1231065598223066715];
IW1_1 = [4.4865225517966722535 0.61720060282796362916 3.2383782413138995082;-0.77467594423934371672 2.1209202416597419116 -3.3891684057090900595;2.0723946565716921953 -4.3060566403468358843 2.1095986748671555766;-7.9863289161839672303 -0.53239107357764114958 3.4682008478804804419;-4.3784722878905348864 0.47566092092774103772 -0.73193754496905094609;3.0743794926360217268 -0.60209635745426193232 2.0835183028394586024;1.3513664614138169995 2.4564633322973210561 1.7669136369069642356;-2.8837022769565523461 -0.095480165206958983459 -4.5892073364625041165;1.3122161246259749223 -3.2527931712900612915 1.4113921953254380259;1.0006462668353839351 -0.91221650007726573506 -3.0504237660768072082;6.3878554449783901958 0.92461055628035104803 -0.80213082085263931464;3.5664425804422337229 0.97136988030336668398 -1.6575531014686766262;2.3378045758760950257 -3.4099484980894194663 -1.2289689494203492881;1.1592194216353137737 -2.787281409835638879 -0.99408939105221016952;2.4170867832506384154 -2.4743204456328733443 -1.7424712201690006896;-3.249950227172982764 -3.1279070463257077073 -0.44337673929052101585;-2.904420013668658207 -0.38322018246953304388 2.9909292466771755237;-3.1433666305010135034 0.30664792266440149549 3.711611643820230455;1.3035333794682568698 2.2606533171012102024 -2.0400427396252895917;2.8281120496808300757 1.5426795408701285961 -1.3814340449303892377];

% Layer 2
b2 = [-1.2943587939770839768;-1.4439542087495349509;-1.2666543942068761996;-1.2963023816775276487;-0.063569737590066843769;-0.10781418379770656146;0.94244949574667180592;-0.63087054934158093289;-1.3744661085126799183;-1.3861671280976570753];
LW2_1 = [-0.29581759081345365692 -0.17797997845799803929 0.10047204547697190236 -0.17615389287989829947 0.46215158342595191732 0.031760909694474301346 0.37156838723582752415 0.98300009199170201857 -0.083848707959956525482 0.2651671720621619488 2.1524470123021459678 0.87653009514072866004 -0.25504728295477285815 -0.057475854299898376798 0.064583440164616465196 0.10823697498461537503 -0.46492025845828566233 -0.20059634941576418021 -0.36759617612916423157 0.41966757166684198754;0.15608999862513633916 -0.049272058481027600219 0.68004295836578221301 0.5645759373125830427 0.10591763312698011801 -0.2181354553016592035 0.13509501896966732981 0.38667382369024538846 0.23630720389857146069 -0.1531815483828210811 -0.15909898808100267353 0.2026323661925267805 -0.80770376577495661685 -0.5236724257746836475 0.44761816384382180356 0.1191227539192322854 0.14037719693628911144 0.65883036751275081411 -0.63075738128304936758 -0.37901885168525600855;0.052733339922161476254 0.5512802687883270325 0.40006080251349523946 -0.35328467388500017776 0.57690879166707753622 0.55402660175219442529 0.65934500083907987555 0.22146506590401149328 0.44527159461509185912 0.046490186195875485287 0.24775559061523813598 -0.049654720834350907221 -0.34979257607372038485 -0.40449266077007750564 -0.49014569220570625152 -0.26569839137871392731 0.078205394983882237092 0.77966116865965762184 -0.19849755332912580319 -0.36763631840961152886;-0.31911334146527814415 0.0036286799718708503959 -2.1720455711886210715 -0.01362713516581194953 1.4839786331183471013 -1.2989681844333551552 0.40685524160246927527 1.1462723969044317229 1.5763261034223294832 -0.1838931077951005133 -0.72147836783596397403 -0.23884681761808529421 0.62510696234122398174 0.71206426769093378315 0.58475576488489633409 0.22973030819929007862 -0.42214144712005913229 0.48856027380122762915 -0.23086243149459742541 -0.3565117656595376272;-1.0441683881600964945 -0.089477444947297077316 -0.086261228789098809422 0.46788831499318594975 0.99964442951973553342 0.33915636466154525097 -0.35656193199483959821 0.30772274781877051453 -0.37576528403882020202 0.69112028429619476455 -0.10422283163856733978 0.31281161240135246793 0.45117482337645919976 -0.35578788291717805548 0.87965937993694232055 -0.12484414345852977435 0.57346862757523198173 0.92061434343611170394 -0.65337408734507662622 -0.1467671361865875157;1.0731838013323165004 0.26788862675302282934 -1.0364296985865601997 -0.014855371304439739938 -1.6376796361658065848 0.83141957677542355221 0.067887614097997359131 -0.13639306318202332191 -0.15308830831829797758 -0.40076014791134229043 0.40904488352692003339 1.8567923090819793419 -1.2125390784453458082 -0.34245514173661106838 0.32416133478197350914 -1.0314164457190218016 -1.4656012311374062573 -0.14977444401351416858 -0.2652765405581947733 -0.29273130784606671284;0.62313687002173989704 0.43719219716178076007 0.62904717554289046877 -0.70995699457032046542 0.60439701808271584227 -0.08028270311419478944 0.97483764958461938122 0.18498821550718733131 0.33757447177226374002 -0.55918195215373833751 -0.97554865318999439694 -0.20841026822604169499 0.59214845167150087502 0.05454929786258875396 0.015017085570627952337 0.84980578196749279041 -0.58306665542893898468 -0.43793737676540106518 0.25305346185976179685 0.39188157662243372492;-2.977487026836047157 1.601526978397739942 0.023204640924939793495 6.4009174582033638856 1.0951573050394383113 -0.39924434696153993096 -0.022783049836181189923 4.9410622288766816723 1.2620576304544166568 0.75359598564398311282 -5.2277465490130481385 -1.6586806477333126963 -0.65995733108902232544 1.3372537052140953673 -0.049213853579138967798 -0.1599886808165217611 1.1967238845538668013 1.8086830626617040885 -0.50618313556862515323 -0.21477841072207654038;-0.14846513234913438772 -0.20187881768122198367 0.14084960084324468776 -1.0454622872834928859 0.73506792268775267285 -0.045757423449516457237 -0.15547195561770288386 0.21768088372992985824 -0.37673638043151219668 1.4205223514473659385 0.565223218462400534 -0.071738583891471960352 -0.35671698164107773499 0.43099510655073497434 -0.38437211654012526374 0.17814318840697201951 -0.41864576830834249188 0.60349447357809704595 -0.5920076184743786607 0.20087534588966074467;-0.65265857487240230839 -0.044285085955246314415 -0.4931381756635775937 -0.74678597901863585928 -0.19033135027350350788 0.91410522991800691184 0.41098783610913414144 0.06712316969467267691 -0.13158059751838413476 0.38857399653249397042 0.2883642699835305967 0.29490333494621256971 -0.18555093379029741207 -0.20983154642618603858 -0.56696246256232385452 -0.66590585139742086707 -0.33331024469360182039 -0.041086536250760585798 0.731068226753217143 0.51288135765096976026];

% Layer 3
b3 = [1.8530108860764151757;-1.8054543370739548624;1.1661939232396176802;-1.5871872835996638784;0.75341850108882424397;-0.77717165129205290075;-0.77467943502803637834;0.16107330000471395404;0.009936271949203615006;-0.13619596000627892662;0.34607925116944177057;1.2459798146670744146;-0.60651525083108170922;0.54503588114818302124;-1.3940874612330216298;-0.78054740341671835502;-1.2686803043631829091;1.0845487473898132169;-2.1780743662562409568;2.0025719923872595807];
LW3_2 = [0.031827995315554261091 0.13931909925265492656 0.083026937579489326624 -0.35266131631942471136 -1.0714028871473009197 0.83931272959553426816 0.80808147386812934077 0.1015729558089983886 -0.6376409888898318945 -0.68258951096148945403;0.42436484977365246385 -0.24602604619204576641 0.29400661184745663368 -0.83049625791600711899 0.57777027040004946823 -0.53651807205052126637 -0.9400425882977773151 -0.25765841933243055495 0.62711592673054594727 -0.31672923603818070593;-0.63900400960332148781 1.0447567044308943007 -0.10653870737221349252 1.9944115595490550241 -0.79162673676561623459 -0.67661068543044244894 0.55229772786008357599 0.87701416861024406035 -0.4866695953328893931 -0.81318503932779995225;-0.032284471071282426491 0.40265613531366134525 -0.00040444695525453447371 0.98901450946978475276 0.6155565037785148963 1.6123408784855535192 -0.70748578476980061858 0.29556226297408139114 -0.30761839845125799053 0.55631000883784742506;-1.2158687325617889563 -0.56664216902228492501 -0.89159161440419798517 0.52856086345580155506 -0.37939829397738938921 -0.12851129420602086517 0.67968359327256555602 -4.2783012906131698827 1.2212902453984755269 0.85066341850930593527;0.14339748743529484587 0.57527076558193490641 0.68617288661132369576 0.44397010020817123666 0.52742514968675513476 0.44127413920848446161 1.183766066484786883 1.8127073999072467192 0.24414123652206229376 0.76993387769286170119;0.34493423881165991007 -0.29967221061879290023 1.1671695975559042147 0.47627244134230228845 -0.44024264942381596821 -0.17709493257632286101 -0.26654372181224750271 0.88317383640366931008 0.36237410868968888966 -0.62436536914201978821;-0.57399564494213184407 0.96369792677165500017 0.11498214949885689207 1.0942083448446253691 0.65328468964803332319 0.10121642898907236285 -0.37233779468569228044 0.0098259379635991760116 -0.64462951321620065581 0.78552511469471775207;-0.16916120550238761266 0.40587955772922323927 0.98557713746313568848 0.3745580582002605019 1.0306737497688827077 0.52970015541462744935 -1.0089643194597206488 0.77018270357532303549 1.0040977902582779446 0.8568398046543749258;-0.74290839157440202722 0.41421723350116018691 0.66109011534584494196 0.93335706365471382551 -0.8214758872618741492 -1.2681957615461567634 0.72116542635263480854 0.05922297653392935568 -0.69865994897615013581 -0.44996943808644801477;0.65314564215010384451 0.28672125295516120991 0.24885772659906899018 -2.4866239529199578584 1.0041390047801919128 1.3811471600697544648 -0.7988608342221155123 -1.1120508164848330601 0.9743510575054079581 0.88760116910262931711;-0.03802232736343274383 -0.9696313628246525651 0.43132013354010995121 -0.19361837979242882413 -0.34861918015246390334 -1.1988854275950335815 0.51830595077386898417 -1.7648969736867232694 -0.62921574488372145062 -0.63610515445074156116;-0.5729850653924936088 0.64932301734983877139 0.0016823415895748799771 -0.67250301066580031595 0.094133318159064116593 -0.62849036612060193985 -0.91800501004651169357 0.30790360616953721395 -0.22973761309530610353 -0.58734922930436572752;2.0945422263942599095 1.5203198177096197696 0.063996558541521933461 -0.85350115347667343535 0.37403438341983991089 -0.032569480229857283859 0.083796080493671543099 3.7789508399612725675 -0.51665583476674548091 -1.2063931305764636903;-0.84013815810055003652 -0.69678668582172376134 -0.40485698351855153865 -1.2497032025686189982 -0.86538667578922257029 -0.67943177024339063141 0.72983752830815395996 2.9203501368691964224 1.0726300036296236851 -0.84308343986573675011;-0.87214129382445093608 0.096540547434268320082 0.33733317542888624496 0.21082550320021298251 1.5939793572663500942 -2.230149612503652623 0.44889308656503495998 -0.40107767967759833105 -1.0427858491903432281 0.12106295094106764298;-0.64465650115789541186 0.73982891617667334572 0.31717905933541390429 -0.61845002302646856496 -0.48086080562761318591 0.12898039182613105225 0.18748599677525695784 0.70252029407755478552 0.40671365210032772719 -1.2263719288272516561;0.6615936157305613019 0.8307334756789593877 1.0036618862203219305 0.45411263487148284534 0.83298928784081405219 0.043056287508364952943 -0.16218220839528449395 0.25106682913828221038 1.1948384833781706682 -0.11427632527509856697;-0.68948835520022111467 0.090565637243814361979 0.97368173746268560365 -0.21130835270883929766 -0.65520628784129508748 -0.96997663498172304042 0.52895996684161850077 -0.99848035385984745815 0.066844852634549964399 -0.39974042383403085577;0.48635841308566335472 0.44152819913898955217 -0.13879673106808998462 -1.0524368687878045137 -0.2318852828893588347 0.19818209674524875363 -0.63748864671211702415 -0.32932851739263752089 -0.52388020802395462994 0.71533669982254222131];

% Layer 4
b4 = -0.57017157009992758265;
LW4_3 = [0.51411493731141821861 -0.50095458096701750428 0.62162518334120997476 0.30543496818264587178 -0.58416041953129815845 0.41034030379420893819 0.21157511209515375561 -0.29645810914534148628 0.48799079162460873293 -0.53419673504584086476 0.55464798895907885257 1.1902366081079458482 0.19738750849865033254 -1.1816456602186891089 0.46314769944915962219 -0.26169703281679623785 -0.50414889485974967442 -0.1661050594552979931 1.0449516703941907902 0.19921746589387248627];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.499999999999934;
y1_step1.xoffset = -2.00000000000028;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = tansig_apply(repmat(b3,1,Q) + LW3_2*a2);
    
    % Layer 4
    a4 = repmat(b4,1,Q) + LW4_3*a3;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a4,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(4,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
